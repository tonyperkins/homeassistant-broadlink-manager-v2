import{g as qe,a as Qe,d as et,c as z,r as b,o as De,b as i,e as s,f as e,h as E,n as ee,u as Se,t as v,i as D,w as me,j as J,v as _e,F as be,k as ke,l as pe,m as He,p as fe,q as Ee,s as Pe,T as ze,x as $e,y as Ce,z as Me,A as ce,B as Je,C as je,D as Te,E as We,G as Ge,H as tt,I as ot,J as Ve,K as lt,L as nt}from"./vendor-joC09iIB.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))w(h);new MutationObserver(h=>{for(const n of h)if(n.type==="childList")for(const $ of n.addedNodes)$.tagName==="LINK"&&$.rel==="modulepreload"&&w($)}).observe(document,{childList:!0,subtree:!0});function r(h){const n={};return h.integrity&&(n.integrity=h.integrity),h.referrerPolicy&&(n.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?n.credentials="include":h.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function w(h){if(h.ep)return;h.ep=!0;const n=r(h);fetch(h.href,n)}})();function Fe(){const l=qe(),g=l==null?void 0:l.appContext.config.globalProperties.$toast;return g||(console.warn("Toast not available"),{success:r=>console.log("Success:",r),error:r=>console.error("Error:",r),warning:r=>console.warn("Warning:",r),info:r=>console.info("Info:",r)})}const Ne="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAHBUlEQVR4nOxZC1BTVxo+9+aNZI2LNsgjWR4hgoIiRVDBslKnIKPbx1jqTrtYoakat1a6dNsdd7t1X8XHyAbEhdUu1u2mXdbasqJbtsaMIqBBECiPBmqEICEBEx4xJLlJ7s6lw6rJDeQ2FzLM+M1kBs7/3+/83zn/Oee/51JRFAXzGbCvA/AWjwX4GvNeANWXnXffHQ4+K6/dYbHeD+IFhjRkb1wn9WPQbEQ4IF/tQlXX2p5+/8OyczY74j/VxuMG3Sh/Oz9jaQDb4CmPT1LIbLXBfzrz0cmHg8fQpx1Yc1Ra+TsiXD4R0PqtRmAyj/LxbJeaujKIcPlEAINOM7vLXBaTZibCRWgRq3WGJZWX63aoNDpB8BJOX/bGlIqwpUv6iXBgWBHG7eUF8urUWvU6Z9sLGxI/IsLl8SJu6u4XigqPXkVspiVTbTQqU1/6Vn7ammh+G5FOMZyqludIKqUVU/9jcaSuTCo/unfHbiad4iBdwMu/P1bV1tO1xbk9NDC0/vwHB1xGcjqYLAh16zsHW3R6XXTu1mfFdAqMrIoSKNbGhLcQ4QGeppDJ7ACtPcqNEI6tT9O3Vqm+tygqNMDjrU9Sef6tIYM2JjUuuXzfC5knCEXsBI8WMZUCAxiCrfhWyMZkMNzYXNHVpwmXXqp5j0Hz0/1m57a3PQ8VHx4JoNMASIl9shLPFsB5ooO7iDXhCY/dAcCvT/79LwC1s/K2bDnAXcQeJRqwMzzeRt/bua0gLChcDsCDNQNBkEU/qot7o6j0kzETQpuJ40ZnT6xSrUoNWhyseHVz2ikv4n4QA5FSArE5IFlTZ0r3XU1MWODib6NCl3a9dkhSYxgbjo4XLq8sL9j7Ip36YEwMRjMNQazMhf7+RgYNnuyo7bY6ArFaWKuXRX495wLwoLk39sO9RaVnM5OTP8zLSjtjsljpp6ovi6pqr706eE8XBwGUSqEy9Guihf/92TMZhetjI5rJCHwKpBRzZqsNYtKp6KD+Pvv1w5ILdzR3UvD8HA4YefOl7N25JKUPIKuUwIJH7A5of/GJf7oLfrIz2EH786fSss+uKFzOk+8L0mqh6rpbmR0q5YyFGAQBSuHHlcUWxEaZyXfMhFD0Rgt9Oh/SBMiam58HAO+oc4XZMsK/1taT6M6uHjJw8w6VSNfvemM8TbzPlFlwsP5KyzfJeL6kCejXDgo894aASqOZ9O/uHwzq6B3ijhitkzOC7XS7j0g+V3S0vQTDDhYEoZSBobvJ+yXFNZ29gy4lOGmvlDBMIfQqSKV8539EWvXHhvbGHBSFrAwGW+vvxzLoR7RxzrNpsyPs0xcv7/lg1/ZfPtKvuw7MVhulUakWdvRq+XY3tWFT90Bk+52BCOzvyOBgjytSFKAgms+b9F/2o+BbKwUrvgjhhjSjKLAPG4YE7lJxfEIf5dyGOwMXrren/eF0RYXRNMrHDt4QbmjDEbHop9F8rqpddZd3sV6R/aWiabtWr41PW534V8m+PFHW+qSPL9TX7oM8WAaBi4IbE4S8yYNs/7asIgBA0ZStRqFM/MXxIzcgHBEBP+C6DJKLgJvK3uXvniitBsDmNzkSEAD9uv5k0aFjXy1gMQ0DQ5p4CAIwNuXLwyL/ExcpqMWeS42NUmxKXFf8VWPdz6cLnkqhGd/Pe+U1Cow/+ekJUYr4qJgvbik7f/Jw+0J/tjpvS3qxs7/LQZZfcrrkUmOdGI/cgUKIkB8pz0xK+CQjKf6z4MWckYftZqsderfsTInsZt0evDRgMRYMHhaLnk+NW1Y/nchxk5lZ+I/Pf/vl9RvbLYiVlSBcJv/VK9sKBCHc3hkF7D12/NzVltZn8YhzNj/3ev6LGeXTdQ6+uzLZ+C+5XNza05Nsd1gXcNgBvekJK/+du3lTUSiXMzzT80TgkkK8wJAGgCMAE5ooFFz3hHTr+lgZ9iMryOngkoi5WZuOc9hPtDu3r4198nTqygjCr3wYmrvVkSerZXljJoT0m0DcYm5g2Mg5WV39zrVWZZofkzaRnhB/bufm9FI/JpXQXj8F8bHyitqWxhzJmwUJT60SNJER+P+BCZjt34lzNbvickRoWVWNmGzuObnYWhER3oAdX41dPbj1jDeYEwGrInltKKCNtatub6hRfJOEnfJkcc+JgE9ltS/DkINuNI3xCo4fbXgm/0CnouvOcjK4Z/16/ZKia+3+kqIrEIQ+sgNx2Jzb5wsPxrD9GBZv+Gd9BqSXr4icg8cwMj4SLmv6+mlv+WddgGlilOPOZkEmFnrLP+sCVgtXyPHaHShkiw0XXPWWf9YF5Gb9uGzp4sCbj7ai4LkNTx2O5nPV3vLPyTeye6P32X+7KNujVKtSYJg+viEu/mx2etJZCgnD57OPfGRh3n8nfizA15j3Av4XAAD//5k1S2w3zfwVAAAAAElFTkSuQmCC",ve=Qe.create({baseURL:"./",timeout:3e4,headers:{"Content-Type":"application/json"}});ve.interceptors.request.use(l=>l,l=>Promise.reject(l));ve.interceptors.response.use(l=>l,l=>(console.error("API Error:",l),l.response?console.error("Response error:",l.response.data):l.request?console.error("No response received"):console.error("Request setup error:",l.message),Promise.reject(l)));const st=et("devices",{state:()=>({devices:[],loading:!1,error:null,selectedDevice:null}),getters:{deviceById:l=>g=>l.devices.find(r=>r.id===g),devicesByType:l=>g=>l.devices.filter(r=>r.entity_type===g),deviceCount:l=>l.devices.length,hasDevices:l=>l.devices.length>0},actions:{async loadDevices(l=!1){this.loading=!0,this.error=null;try{const g=l?`/api/devices/managed?_t=${Date.now()}`:"/api/devices/managed",r=await ve.get(g);this.devices=r.data.devices||[],console.log("ðŸ“¥ Loaded devices:",this.devices),this.devices.forEach(w=>{console.log(`ðŸ“¥ Device "${w.name}":`,{id:w.id,device:w.device,commands:w.commands,commandCount:w.commands?Object.keys(w.commands).length:0})})}catch(g){this.error=g.message,console.error("Error loading devices:",g)}finally{this.loading=!1}},async createDevice(l){this.loading=!0,this.error=null;try{console.log("ðŸª Store: Creating device with data:",l),console.log("ðŸª Store: Device commands being sent:",l.commands);const g={device_name:l.name,device:l.device,area_id:l.area||"",area_name:l.area||"",entity_type:l.entity_type,icon:l.icon,broadlink_entity:l.broadlink_entity,device_type:l.device_type||"broadlink",commands:l.commands||{}};l.device_type==="smartir"&&l.smartir_config&&(g.smartir_config=l.smartir_config),console.log("ðŸª Store: Transformed data for backend:",g);const r=await ve.post("/api/devices/managed",g);return console.log("ðŸª Store: Create response:",r.data),await this.loadDevices(),r.data}catch(g){throw console.error("Error creating device:",g),g}finally{this.loading=!1}},async updateDevice(l,g){this.loading=!0,this.error=null;try{const r=await ve.put(`/api/devices/managed/${l}`,g);return await this.loadDevices(),r.data}catch(r){throw console.error("Error updating device:",r),r}finally{this.loading=!1}},async deleteDevice(l,g=!1){this.loading=!0,this.error=null;try{await ve.delete(`/api/devices/managed/${l}`,{data:{delete_commands:g}}),this.devices=this.devices.filter(r=>r.id!==l)}catch(r){throw this.error=r.message,console.error("Error deleting device:",r),r}finally{this.loading=!1}},selectDevice(l){this.selectedDevice=l},clearSelection(){this.selectedDevice=null},clearError(){this.error=null},async syncAllAreas(){if(!this.devices||this.devices.length===0){console.log("âš ï¸ No devices to sync");return}console.log(`ðŸ”„ Syncing areas from Home Assistant for ${this.devices.length} devices...`);try{const l=await Promise.all(this.devices.map(w=>(console.log(`ðŸ”„ Syncing device: ${w.id} (${w.name})`),ve.post(`/api/devices/${w.id}/sync-area`).then(h=>h.data.success&&h.data.area?(console.log(`âœ… Synced area for ${w.name}: ${h.data.area}`),{status:"synced",device:w.name}):{status:"no_area"}).catch(h=>{var n;return((n=h.response)==null?void 0:n.status)===404?(console.log(`âŒ Device not found in HA: ${w.id}`),{status:"not_found"}):(console.warn(`âš ï¸ Failed to sync area for ${w.id}:`,h.message),{status:"error",error:h.message})})))),g=l.filter(w=>w.status==="synced").length,r=l.filter(w=>w.status==="not_found").length;await this.loadDevices(!0),g>0?console.log(`âœ… Area sync complete: ${g} synced, ${r} not found in HA`):r>0&&console.log(`â„¹ï¸ No areas synced - ${r} entities not found in HA registry (generate entities first)`)}catch(l){console.debug("Area sync error:",l)}}}});function Ke(l){const g=z(()=>l.value||l),r=z(()=>{switch(g.value){case"climate":return"mdi:air-conditioner";case"fan":return"mdi:fan";case"light":return"mdi:lightbulb";case"media_player":return"mdi:television";case"switch":return"mdi:light-switch";default:return"mdi:devices"}}),w=z(()=>`device-type-${g.value}-color`),h=z(()=>`tag-${g.value}-bg`);return{icon:r,colorClass:w,tagBgClass:h}}const at=""+new URL("broadlink-logo-BDjImjRY.png",import.meta.url).href,we=(l,g)=>{const r=l.__vccOpts||l;for(const[w,h]of g)r[w]=h;return r},it={class:"device-header"},rt={class:"device-info"},dt=["title"],ut={class:"device-labels"},ct={class:"device-type"},mt=["src","alt","title"],vt={class:"device-body"},pt={class:"device-stats"},ft={class:"stat",title:"Learned command count"},gt={class:"stat",title:"HA Assigned Area"},yt={class:"device-meta"},bt={class:"device-id",title:"Device ID"},ht={key:0,class:"storage-name"},kt={key:1,class:"broadlink-entity",title:"Controller Device"},wt={key:2,class:"controller-device"},$t={class:"device-actions"},Ct=["disabled"],St=["disabled"],_t=["disabled"],It={key:0,class:"disabled-overlay"},Dt={__name:"DeviceCard",props:{device:{type:Object,required:!0},broadlinkDevices:{type:Array,default:()=>[]}},emits:["edit","delete","learn"],setup(l){const g=l,r=z(()=>localStorage.getItem("smartir_simulate_not_installed")==="true"),w=z(()=>g.device.device_type==="smartir"&&r.value),h=b(null),n=Ke(z(()=>g.device.entity_type)),$=z(()=>g.device.icon?g.device.icon:n.icon.value),f=o=>o&&o.startsWith("mdi:")?`mdi ${o.replace(":"," mdi-")}`:`mdi mdi-${o}`,y=z(()=>({light:"Light",fan:"Fan",switch:"Switch",media_player:"Media Player",cover:"Cover"})[g.device.entity_type]||g.device.entity_type),I=z(()=>(g.device.device_type||"broadlink")==="smartir"?"SmartIR":"Broadlink"),L=z(()=>(g.device.device_type||"broadlink")==="smartir"?Ne:at),k=z(()=>(g.device.device_type||"broadlink")==="smartir"?h.value!==null?h.value:0:Object.keys(g.device.commands||{}).length),t=o=>{if(!o)return"";const m=g.broadlinkDevices.find(u=>u.entity_id===o);return m&&m.name||o},O=z(()=>{if(!g.device.device)return!1;const o=g.device.id.includes(".")?g.device.id.split(".")[1]:g.device.id;return g.device.device!==o}),B=z(()=>{if(!g.device.broadlink_entity)return"";const o=g.broadlinkDevices.find(m=>m.entity_id===g.device.broadlink_entity);return o&&o.name||g.device.broadlink_entity}),j=o=>{if(!o||typeof o!="object")return 0;let m=0;for(const u of Object.values(o))typeof u=="string"?m++:typeof u=="object"&&(m+=j(u));return m},_=async()=>{if(!(!g.device.device_code||!g.device.entity_type))try{const o=await ve.get("/api/smartir/codes/code",{params:{entity_type:g.device.entity_type,code_id:g.device.device_code}});if(o.data.success&&o.data.code){const m=o.data.code;m.commands&&(h.value=j(m.commands))}}catch(o){console.error("Error fetching SmartIR command count:",o)}};return De(async()=>{(g.device.device_type||"broadlink")==="smartir"&&await _()}),(o,m)=>(s(),i("div",{class:ee(["device-card",{disabled:w.value}])},[e("div",it,[e("div",{class:ee(["device-icon",Se(n).colorClass.value])},[e("i",{class:ee(f($.value))},null,2)],2),e("div",rt,[e("h3",{title:l.device.name},v(l.device.name),9,dt),e("div",ut,[e("span",ct,v(y.value),1)])]),e("img",{src:L.value,alt:I.value,title:I.value,class:"device-source-logo"},null,8,mt)]),e("div",vt,[e("div",pt,[e("div",ft,[m[3]||(m[3]=e("i",{class:"mdi mdi-remote"},null,-1)),e("span",null,v(k.value)+" command"+v(k.value!==1?"s":""),1)]),e("div",gt,[m[4]||(m[4]=e("i",{class:"mdi mdi-map-marker"},null,-1)),e("span",null,v(l.device.area||"No area"),1)])]),e("div",yt,[e("span",bt,[m[5]||(m[5]=e("i",{class:"mdi mdi-identifier"},null,-1)),D(" "+v(l.device.id),1)]),O.value?(s(),i("span",ht,[m[6]||(m[6]=e("i",{class:"mdi mdi-code-tags"},null,-1)),D(" "+v(l.device.device),1)])):E("",!0),l.device.broadlink_entity?(s(),i("span",kt,[m[7]||(m[7]=e("i",{class:"mdi mdi-access-point"},null,-1)),D(" "+v(B.value),1)])):E("",!0),l.device.controller_device?(s(),i("span",wt,[m[8]||(m[8]=e("i",{class:"mdi mdi-access-point"},null,-1)),D(" "+v(t(l.device.controller_device)),1)])):E("",!0)])]),e("div",$t,[e("button",{onClick:m[0]||(m[0]=u=>!w.value&&o.$emit("learn",l.device)),class:"icon-btn",title:"Manage Commands",disabled:w.value},[...m[9]||(m[9]=[e("i",{class:"mdi mdi-remote-tv"},null,-1)])],8,Ct),e("button",{onClick:m[1]||(m[1]=u=>!w.value&&o.$emit("edit",l.device)),class:"icon-btn",title:"Edit",disabled:w.value},[...m[10]||(m[10]=[e("i",{class:"mdi mdi-pencil"},null,-1)])],8,St),e("button",{onClick:m[2]||(m[2]=u=>!w.value&&o.$emit("delete",l.device)),class:"icon-btn danger",title:"Delete",disabled:w.value},[...m[11]||(m[11]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,_t)]),w.value?(s(),i("div",It,[...m[12]||(m[12]=[e("div",{class:"disabled-message"},[e("i",{class:"mdi mdi-eye-off"}),e("span",null,"SmartIR Not Installed")],-1)])])):E("",!0)],2))}},xt=we(Dt,[["__scopeId","data-v-7a7f5c18"]]),Tt={class:"icon-picker"},Rt={class:"icon-input-wrapper"},Mt=["id","placeholder"],Lt={key:0,class:"icon-preview"},Ot={key:0,class:"icon-dropdown"},At={class:"icon-grid"},Et=["onMousedown","title"],Vt={__name:"IconPicker",props:{modelValue:{type:String,default:""},inputId:{type:String,default:"icon-input"},placeholder:{type:String,default:"e.g., mdi:television"}},emits:["update:modelValue"],setup(l,{emit:g}){const r=l,w=g,h=b(r.modelValue),n=b(!1),$=["television","speaker","radio","music","video","movie","play","pause","stop","skip-next","skip-previous","volume-high","volume-medium","volume-low","volume-off","remote","remote-tv","cast","chromecast","spotify","netflix","youtube","lightbulb","lightbulb-on","lightbulb-off","lamp","floor-lamp","ceiling-light","light-switch","led-strip","led-strip-variant","wall-sconce","chandelier","spotlight","track-light","vanity-light","desk-lamp","fan","ceiling-fan","air-conditioner","thermometer","thermostat","heat-wave","snowflake","fire","radiator","water-boiler","hvac","blinds","blinds-open","window-shutter","window-shutter-open","curtains","curtains-closed","roller-shade","roller-shade-closed","garage","garage-open","gate","door","door-open","window-open","window-closed","washing-machine","tumble-dryer","dishwasher","refrigerator","stove","microwave","oven","toaster","kettle","coffee","coffee-maker","blender","robot-vacuum","robot-vacuum-variant","vacuum","broom","spray-bottle","lock","lock-open","lock-smart","key","shield","shield-check","alarm-light","bell","doorbell","camera","cctv","motion-sensor","smoke-detector","fire-extinguisher","water-alert","gas-cylinder","sofa","bed","bed-double","desk","chair","table","bookshelf","home","home-outline","home-assistant","floor-plan","room","weather-sunny","weather-night","weather-cloudy","weather-rainy","weather-snowy","weather-lightning","weather-windy","weather-fog","weather-partly-cloudy","umbrella","water","water-percent","phone","cellphone","tablet","laptop","desktop-tower","monitor","keyboard","mouse","printer","router","router-wireless","access-point","wifi","bluetooth","usb","hdmi-port","ethernet","power","power-plug","power-socket","battery","battery-charging","lightning-bolt","flash","solar-panel","solar-power","leaf","tree","flower","sprout","grass","watering-can","shovel","fence","pool","hot-tub","silverware","silverware-fork-knife","food","food-apple","glass-wine","glass-cocktail","bottle-wine","pot","pot-steam","shower","shower-head","bathtub","toilet","sink","faucet","hand-wash","car","car-side","garage-variant","tools","hammer","wrench","screwdriver","toolbox","ladder","heart","heart-pulse","run","walk","bike","dumbbell","yoga","scale-bathroom","thermometer-lines","clock","clock-outline","timer","alarm","calendar","calendar-today","calendar-clock","history","bell-ring","bell-alert","alert","alert-circle","information","help-circle","check","check-circle","close-circle","minus-circle","plus-circle","arrow-up","arrow-down","arrow-left","arrow-right","chevron-up","chevron-down","menu","dots-vertical","dots-horizontal","cog","tune","circle","square","triangle","hexagon","star","star-outline","heart-outline","plus","minus","close","check-bold","eye","eye-off","account","account-group","baby","dog","cat","paw","gift","balloon","party-popper","candle","book","book-open","newspaper","email","message","phone-classic"];me(()=>r.modelValue,k=>{h.value=k});const f=z(()=>{if(!h.value)return $.slice(0,50);const k=h.value.toLowerCase().replace("mdi:","");return $.filter(t=>t.toLowerCase().includes(k)).slice(0,50)}),y=()=>{n.value=!0,w("update:modelValue",h.value)},I=()=>{setTimeout(()=>{n.value=!1},200)},L=k=>{h.value=`mdi:${k}`,w("update:modelValue",h.value),n.value=!1};return(k,t)=>(s(),i("div",Tt,[e("div",Rt,[J(e("input",{id:l.inputId,"onUpdate:modelValue":t[0]||(t[0]=O=>h.value=O),type:"text",placeholder:l.placeholder,onInput:y,onFocus:t[1]||(t[1]=O=>n.value=!0),onBlur:I},null,40,Mt),[[_e,h.value]]),h.value?(s(),i("div",Lt,[e("i",{class:ee(`mdi mdi-${h.value.replace("mdi:","")}`)},null,2)])):E("",!0)]),n.value&&f.value.length>0?(s(),i("div",Ot,[e("div",At,[(s(!0),i(be,null,ke(f.value,O=>(s(),i("div",{key:O,class:"icon-option",onMousedown:pe(B=>L(O),["prevent"]),title:O},[e("i",{class:ee(`mdi mdi-${O}`)},null,2),e("span",null,v(O),1)],40,Et))),128))])])):E("",!0)]))}},jt=we(Vt,[["__scopeId","data-v-a64f5011"]]),Ut={key:0,class:"dropdown-label"},Ft={key:0,class:"required"},Pt=["placeholder","disabled","onKeydown"],Nt={class:"dropdown-icons"},Bt={key:0,class:"mdi mdi-loading mdi-spin"},qt={key:2,class:"mdi mdi-chevron-down"},Ht={key:1,class:"error-message"},zt={key:2,class:"hint-message"},Jt={key:0,class:"dropdown-menu"},Wt=["onMousedown","onMouseenter"],Gt={class:"option-content"},Kt={class:"option-label"},Xt={key:0,class:"option-description"},Yt={key:0,class:"mdi mdi-check selected-icon"},Zt={key:3,class:"dropdown-menu"},Qt={__name:"SearchableDropdown",props:{modelValue:{type:[String,Number,Object],default:null},options:{type:Array,required:!0,default:()=>[]},label:{type:String,default:""},placeholder:{type:String,default:"Search..."},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},error:{type:String,default:""},hint:{type:String,default:""},optionLabel:{type:String,default:"label"},optionValue:{type:String,default:"value"},optionDescription:{type:String,default:"description"},filterMethod:{type:Function,default:null}},emits:["update:modelValue","change","search"],setup(l,{emit:g}){const r=l,w=g,h=b(null),n=b(null),$=b(""),f=b(!1),y=b(0),I=b(!1),L=T=>typeof T=="string"||typeof T=="number"?T:T[r.optionLabel]||T.label||T.name||String(T),k=T=>typeof T=="string"||typeof T=="number"?T:T[r.optionValue]||T.value||T.id||T,t=T=>typeof T=="string"||typeof T=="number"?"":T[r.optionDescription]||T.description||"",O=T=>{const F=k(T);return typeof r.modelValue=="object"?k(r.modelValue)===F:r.modelValue===F},B=z(()=>{if(!$.value)return r.options;if(r.filterMethod)return r.options.filter(F=>r.filterMethod(F,$.value));const T=$.value.toLowerCase();return r.options.filter(F=>{const Z=L(F).toLowerCase(),de=t(F).toLowerCase();return Z.includes(T)||de.includes(T)})}),j=z(()=>{if(!r.modelValue)return"";const T=r.options.find(F=>{const Z=k(F);return typeof r.modelValue=="object"?Z===k(r.modelValue):Z===r.modelValue});return T?L(T):""});me(()=>r.modelValue,T=>{I.value||($.value=j.value)}),me(()=>r.options,()=>{!I.value&&r.modelValue&&($.value=j.value)},{deep:!0}),me($,T=>{w("search",T),y.value=0}),De(()=>{$.value=j.value});const _=()=>{var T;I.value=!0,f.value=!0,(T=n.value)==null||T.select()},o=()=>{I.value=!1,setTimeout(()=>{f.value=!1,r.modelValue?$.value=j.value:$.value=""},200)},m=()=>{var T;f.value=!1,(T=n.value)==null||T.blur()},u=T=>{const F=k(T);w("update:modelValue",F),w("change",F,T),$.value=L(T),m()},P=()=>{var T;w("update:modelValue",null),w("change",null,null),$.value="",(T=n.value)==null||T.focus()},Y=()=>{if(!f.value){f.value=!0;return}y.value<B.value.length-1&&y.value++},ne=()=>{y.value>0&&y.value--},te=()=>{B.value.length>0&&y.value>=0&&u(B.value[y.value])},ge=T=>{h.value&&!h.value.contains(T.target)&&(f.value=!1,r.modelValue?$.value=j.value:$.value="")};return De(()=>{document.addEventListener("click",ge)}),He(()=>{document.removeEventListener("click",ge)}),(T,F)=>(s(),i("div",{class:"searchable-dropdown",ref_key:"dropdownRef",ref:h},[l.label?(s(),i("label",Ut,[D(v(l.label)+" ",1),l.required?(s(),i("span",Ft,"*")):E("",!0)])):E("",!0),e("div",{class:ee(["dropdown-input-wrapper",{"has-error":l.error,disabled:l.disabled}])},[J(e("input",{ref_key:"inputRef",ref:n,type:"text","onUpdate:modelValue":F[0]||(F[0]=Z=>$.value=Z),placeholder:l.placeholder,disabled:l.disabled||l.loading,onFocus:_,onBlur:o,onKeydown:[Ee(pe(Y,["prevent"]),["down"]),Ee(pe(ne,["prevent"]),["up"]),Ee(pe(te,["prevent"]),["enter"]),Ee(m,["escape"])],class:"dropdown-input"},null,40,Pt),[[_e,$.value]]),e("div",Nt,[l.loading?(s(),i("i",Bt)):l.modelValue&&!l.disabled?(s(),i("i",{key:1,class:"mdi mdi-close-circle clear-icon",onClick:P})):(s(),i("i",qt))])],2),l.error?(s(),i("div",Ht,v(l.error),1)):E("",!0),l.hint&&!l.error?(s(),i("div",zt,v(l.hint),1)):E("",!0),fe(ze,{name:"dropdown"},{default:Pe(()=>[f.value&&B.value.length>0?(s(),i("div",Jt,[(s(!0),i(be,null,ke(B.value,(Z,de)=>(s(),i("div",{key:k(Z),class:ee(["dropdown-item",{highlighted:de===y.value,selected:O(Z)}]),onMousedown:pe(he=>u(Z),["prevent"]),onMouseenter:he=>y.value=de},[e("div",Gt,[e("div",Kt,v(L(Z)),1),t(Z)?(s(),i("div",Xt,v(t(Z)),1)):E("",!0)]),O(Z)?(s(),i("i",Yt)):E("",!0)],42,Wt))),128))])):E("",!0)]),_:1}),f.value&&B.value.length===0&&!l.loading?(s(),i("div",Zt,[...F[1]||(F[1]=[e("div",{class:"dropdown-item no-results"},[e("i",{class:"mdi mdi-magnify"}),D(" No results found ")],-1)])])):E("",!0)],512))}},Ue=we(Qt,[["__scopeId","data-v-679ce35f"]]),eo={class:"smartir-selector"},to={class:"form-group"},oo={class:"form-group"},lo={class:"form-group"},no=["value"],so={key:0,class:"error-message"},ao={class:"form-group"},io={class:"form-group"},ro={key:1,class:"code-info"},uo={class:"info-content"},co={class:"info-row"},mo={class:"info-value"},vo={class:"info-row"},po={class:"info-value"},fo={key:0,class:"info-row"},go={class:"info-value"},yo={class:"info-row"},bo={class:"info-value"},ho={__name:"SmartIRDeviceSelector",props:{entityType:{type:String,required:!0},modelValue:{type:Object,default:()=>({})},broadlinkDevices:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(l,{expose:g,emit:r}){const w=l,h=r,n=b([]),$=b([]),f=b(""),y=b(""),I=b(""),L=b(""),k=b(""),t=b(null),O=b(!1),B=b(!1),j=b({manufacturer:"",model:"",controller:""});De(async()=>{if(await _(),w.modelValue&&(f.value=w.modelValue.manufacturer||"",y.value=w.modelValue.device_code||"",I.value=w.modelValue.controller_device||"",L.value=w.modelValue.temperature_sensor||"",k.value=w.modelValue.humidity_sensor||"",f.value&&(await o(f.value),y.value&&$.value.length>0))){const T=$.value.find(F=>F.code===y.value);T&&(t.value={code:T.code,manufacturer:f.value,models:T.models,controller:T.controller})}}),me(()=>w.entityType,async T=>{T&&(f.value="",y.value="",$.value=[],t.value=null,await _())});const _=async()=>{if(w.entityType){O.value=!0,j.value.manufacturer="";try{const T=await ve.get("/api/smartir/codes/manufacturers",{params:{entity_type:w.entityType}});if(T.data.success)n.value=T.data.manufacturers||[];else throw new Error(T.data.error||"Failed to load manufacturers")}catch(T){console.error("Error loading manufacturers:",T),j.value.manufacturer="Failed to load manufacturers. Please try again.",n.value=[]}finally{O.value=!1}}},o=async T=>{if(!(!T||!w.entityType)){B.value=!0,j.value.model="";try{const F=await ve.get("/api/smartir/codes/models",{params:{entity_type:w.entityType,manufacturer:T}});if(F.data.success){const Z=F.data.models||[];$.value=Z.map(de=>{const he=de.models&&de.models.length>0?de.models.join(", "):`Code ${de.code}`;return{code:de.code,label:he,description:`Code: ${de.code}`,models:de.models,controller:de.controller}})}else throw new Error(F.data.error||"Failed to load models")}catch(F){console.error("Error loading models:",F),j.value.model="Failed to load models. Please try again.",$.value=[]}finally{B.value=!1}}},m=async T=>{f.value=T,y.value="",t.value=null,$.value=[],T&&await o(T),te()},u=()=>{const T=$.value.find(F=>F.code===y.value);T&&(t.value={code:T.code,manufacturer:f.value,models:T.models,controller:T.controller}),te()},P=()=>{te()},Y=()=>{te()},ne=()=>{te()},te=()=>{var F,Z;const T={manufacturer:f.value,model:((Z=(F=t.value)==null?void 0:F.models)==null?void 0:Z[0])||"",device_code:y.value,controller_device:I.value};w.entityType==="climate"&&(L.value&&(T.temperature_sensor=L.value),k.value&&(T.humidity_sensor=k.value)),h("update:modelValue",T),h("change",T)};return g({validate:()=>{let T=!0;return j.value={manufacturer:"",model:"",controller:""},f.value||(j.value.manufacturer="Manufacturer is required",T=!1),y.value||(j.value.model="Model is required",T=!1),I.value||(j.value.controller="Broadlink controller is required",T=!1),T}}),(T,F)=>(s(),i("div",eo,[e("div",to,[fe(Ue,{modelValue:f.value,"onUpdate:modelValue":F[0]||(F[0]=Z=>f.value=Z),options:n.value,label:"Manufacturer",placeholder:"Search manufacturers...",required:"",loading:O.value,error:j.value.manufacturer,hint:"Select the device manufacturer",onChange:m},null,8,["modelValue","options","loading","error"])]),e("div",oo,[fe(Ue,{modelValue:y.value,"onUpdate:modelValue":F[1]||(F[1]=Z=>y.value=Z),options:$.value,"option-label":"label","option-value":"code","option-description":"description",label:"Model",placeholder:"Search models...",required:"",disabled:!f.value,loading:B.value,error:j.value.model,hint:"Select the device model",onChange:u},null,8,["modelValue","options","disabled","loading","error"])]),e("div",lo,[F[6]||(F[6]=e("label",{for:"controller-device"},[e("i",{class:"mdi mdi-remote"}),D(" Controller Device * ")],-1)),J(e("select",{id:"controller-device","onUpdate:modelValue":F[2]||(F[2]=Z=>I.value=Z),required:"",onChange:P},[F[5]||(F[5]=e("option",{value:""},"-- Select Controller Device --",-1)),(s(!0),i(be,null,ke(l.broadlinkDevices,Z=>(s(),i("option",{key:Z.entity_id,value:Z.entity_id},[D(v(Z.name||Z.entity_id)+" ",1),Z.area_name?(s(),i(be,{key:0},[D(" - "+v(Z.area_name),1)],64)):E("",!0)],8,no))),128))],544),[[$e,I.value]]),F[7]||(F[7]=e("small",null,"Which remote device will send the IR/RF commands",-1)),j.value.controller?(s(),i("div",so,v(j.value.controller),1)):E("",!0)]),l.entityType==="climate"?(s(),i(be,{key:0},[e("div",ao,[F[8]||(F[8]=e("label",{for:"temperature-sensor"},"Temperature Sensor",-1)),J(e("input",{id:"temperature-sensor","onUpdate:modelValue":F[3]||(F[3]=Z=>L.value=Z),type:"text",placeholder:"e.g., sensor.living_room_temperature",onInput:Y},null,544),[[_e,L.value]]),F[9]||(F[9]=e("small",null,"Optional: Temperature sensor entity for current temperature",-1))]),e("div",io,[F[10]||(F[10]=e("label",{for:"humidity-sensor"},"Humidity Sensor",-1)),J(e("input",{id:"humidity-sensor","onUpdate:modelValue":F[4]||(F[4]=Z=>k.value=Z),type:"text",placeholder:"e.g., sensor.living_room_humidity",onInput:ne},null,544),[[_e,k.value]]),F[11]||(F[11]=e("small",null,"Optional: Humidity sensor entity for current humidity",-1))])],64)):E("",!0),t.value?(s(),i("div",ro,[F[16]||(F[16]=e("div",{class:"info-header"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Selected Device Code")],-1)),e("div",uo,[e("div",co,[F[12]||(F[12]=e("span",{class:"info-label"},"Code ID:",-1)),e("span",mo,v(t.value.code_id),1)]),e("div",vo,[F[13]||(F[13]=e("span",{class:"info-label"},"Manufacturer:",-1)),e("span",po,v(t.value.manufacturer),1)]),t.value.models&&t.value.models.length>0?(s(),i("div",fo,[F[14]||(F[14]=e("span",{class:"info-label"},"Supported Models:",-1)),e("span",go,v(t.value.models.join(", ")),1)])):E("",!0),e("div",yo,[F[15]||(F[15]=e("span",{class:"info-label"},"Controller:",-1)),e("span",bo,v(t.value.controller||"Broadlink"),1)])])])):E("",!0)]))}},ko=we(ho,[["__scopeId","data-v-1911c8f6"]]),wo={class:"modal-content"},$o={class:"modal-header"},Co={class:"form-group"},So={class:"form-group"},_o=["disabled"],Io={key:0,class:"smartir-notice"},Do={key:0,class:"notice-success"},xo={key:1,class:"notice-warning"},To={key:1,class:"smartir-notice"},Ro={key:2},Mo={class:"form-group"},Lo=["disabled"],Oo=["disabled"],Ao={key:0},Eo={key:1},Vo={key:2},jo={key:3},Uo={key:0,class:"form-group"},Fo={class:"area-display-readonly"},Po=["value"],No=["disabled"],Bo=["href"],qo={key:1,class:"form-group"},Ho={class:"form-group"},zo={key:2,class:"form-group"},Jo=["value"],Wo=["value"],Go={key:2},Ko={key:3},Xo={key:3,class:"smartir-section"},Yo={class:"modal-footer"},Zo={type:"submit",form:"device-form",class:"btn btn-primary"},Qo={__name:"DeviceForm",props:{device:{type:Object,default:null}},emits:["save","cancel"],setup(l,{emit:g}){const r=l,w=g,h=Ce("smartirStatus"),n=Ce("smartirEnabled"),$=z(()=>{var x;return localStorage.getItem("smartir_simulate_not_installed")==="true"?!1:((x=h==null?void 0:h.value)==null?void 0:x.installed)||!1}),f=z(()=>!!r.device),y=z(()=>["climate","media_player","fan","light"].includes(t.value.entity_type)),I=z(()=>$.value?!y.value&&t.value.entity_type?"(Not supported for this type)":"(Pre-configured Codes)":"(Requires SmartIR)"),L=z(()=>{var x;const G=((x=r.device)==null?void 0:x.commands)||{};return Object.keys(G).length>0}),k=z(()=>{if(!t.value.broadlink_entity)return"";const G=_.value.find(x=>x.entity_id===t.value.broadlink_entity);return G&&G.name||t.value.broadlink_entity}),t=b({name:"",entity_type:"",device_type:"broadlink",device:"",area:"",icon:"",broadlink_entity:"",enabled:!0,commands:{}}),O=b({}),B=b(null),j=b([]),_=b([]),o=b(null),m=b(null),u=b(null),P=b(!1);De(async()=>{r.device&&(t.value={...r.device,device_type:r.device.device_type||"broadlink"},t.value.device_type==="smartir"&&(O.value={manufacturer:r.device.manufacturer,model:r.device.model,device_code:r.device.device_code,controller_device:r.device.controller_device,temperature_sensor:r.device.temperature_sensor,humidity_sensor:r.device.humidity_sensor})),await Promise.all([Y(),ne()]),o.value&&(o.value.setCustomValidity(""),o.value.oninvalid=()=>{o.value.setCustomValidity("Device name is required")}),m.value&&(m.value.setCustomValidity(""),m.value.oninvalid=()=>{m.value.setCustomValidity("Entity type is required")}),u.value&&(u.value.setCustomValidity(""),u.value.oninvalid=()=>{u.value.setCustomValidity("Broadlink device is required")})});const Y=async()=>{try{const G=await ve.get("/api/areas");j.value=G.data.areas||[]}catch(G){console.error("Error loading areas:",G),j.value=[]}},ne=async()=>{try{const x=(await ve.get("/api/remote/devices")).data.devices||[];_.value=x,console.log("Loaded remote devices:",x)}catch(G){console.error("Error loading remote devices:",G),_.value=[]}},te=G=>{const x=G==="nameInput"?o.value:G==="typeSelect"?m.value:G==="broadlinkSelect"?u.value:null;x&&x.setCustomValidity("")},ge=G=>{if(!G)return"";const x=G.toLowerCase();for(const S of j.value){const V=S.toLowerCase();if(x.includes(V))return S}return""},T=(G,x="")=>{const S=x.toLowerCase();return S.includes("tv")?"mdi:television":S.includes("lamp")?"mdi:lamp":S.includes("ceiling")?"mdi:ceiling-light":S.includes("floor")?"mdi:floor-lamp":S.includes("desk")?"mdi:desk-lamp":S.includes("fan")?"mdi:fan":S.includes("ac")||S.includes("air con")?"mdi:air-conditioner":S.includes("heater")?"mdi:radiator":S.includes("blind")?"mdi:blinds":S.includes("curtain")?"mdi:curtains":S.includes("garage")?"mdi:garage":S.includes("speaker")||S.includes("stereo")?"mdi:speaker":S.includes("receiver")?"mdi:audio-video":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:television",cover:"mdi:window-shutter",climate:"mdi:thermostat"}[G]||"mdi:devices"};me(()=>t.value.name,G=>{if(!f.value&&G&&!t.value.area){const x=ge(G);x&&(t.value.area=x)}!f.value&&G&&t.value.entity_type&&(P.value||!t.value.icon)&&(t.value.icon=T(t.value.entity_type,G),P.value=!0)}),me(()=>t.value.entity_type,G=>{!f.value&&G&&(P.value||!t.value.icon)&&(t.value.icon=T(G,t.value.name),P.value=!0)}),me(()=>t.value.icon,(G,x)=>{x!==void 0&&G!==x&&!P.value&&(P.value=!1),G||(P.value=!1)});const F=b(!1),Z=async()=>{var G;if((G=r.device)!=null&&G.id){F.value=!0;try{const x=await ve.post(`/api/devices/${r.device.id}/sync-area`);x.data.success?(t.value.area=x.data.area||"",x.data.area?console.log(`Area synced: ${x.data.area}`):console.log("No area assigned in Home Assistant")):console.warn(x.data.message||"Entity not found in HA")}catch(x){console.error("Failed to sync area:",x)}finally{F.value=!1}}},de=()=>{var S;return!((S=r.device)!=null&&S.id)||!t.value.entity_type?"#":`/config/entities/entity/${`${t.value.entity_type}.${r.device.id}`}`},he=async()=>{if(t.value.device_type==="smartir"){if(B.value&&!B.value.validate())return;const G={...t.value,smartir_config:{manufacturer:O.value.manufacturer,model:O.value.model,code_id:O.value.device_code,controller_device:O.value.controller_device}};w("save",G)}else w("save",{...t.value})},Ie=G=>{O.value=G};return(G,x)=>(s(),i("div",{class:"modal-overlay",onClick:x[11]||(x[11]=pe(S=>G.$emit("cancel"),["self"]))},[e("div",wo,[e("div",$o,[e("h2",null,v(f.value?"Edit Device":"Add New Device"),1),e("button",{onClick:x[0]||(x[0]=S=>G.$emit("cancel")),class:"close-btn"},[...x[12]||(x[12]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("form",{id:"device-form",onSubmit:pe(he,["prevent"]),class:"modal-body"},[e("div",Co,[x[13]||(x[13]=e("label",{for:"device-name"},"Device Name *",-1)),J(e("input",{id:"device-name",ref_key:"nameInput",ref:o,"onUpdate:modelValue":x[1]||(x[1]=S=>t.value.name=S),type:"text",placeholder:"e.g., Living Room TV",required:"",onInput:x[2]||(x[2]=S=>te("nameInput"))},null,544),[[_e,t.value.name]]),x[14]||(x[14]=e("small",null,"Friendly name for this device",-1))]),e("div",So,[x[21]||(x[21]=e("label",{for:"entity-type"},"Entity Type *",-1)),J(e("select",{id:"entity-type",ref_key:"typeSelect",ref:m,"onUpdate:modelValue":x[3]||(x[3]=S=>t.value.entity_type=S),required:"",onChange:x[4]||(x[4]=S=>te("typeSelect"))},[x[15]||(x[15]=Me('<option value="" data-v-ac633105>-- Select Type --</option><option value="light" data-v-ac633105>ðŸ’¡ Light</option><option value="fan" data-v-ac633105>ðŸŒ€ Fan</option><option value="switch" data-v-ac633105>ðŸ”Œ Switch</option><option value="media_player" data-v-ac633105>ðŸ“º Media Player</option><option value="cover" data-v-ac633105>ðŸªŸ Cover (Blinds/Curtains)</option>',6)),e("option",{value:"climate",disabled:!$.value}," ðŸŒ¡ï¸ Climate "+v($.value?"":"(Requires SmartIR)"),9,_o)],544),[[$e,t.value.entity_type]]),t.value.entity_type==="climate"?(s(),i("div",Io,[$.value?(s(),i("div",Do,[...x[16]||(x[16]=[e("i",{class:"mdi mdi-check-circle"},null,-1),e("span",null,"SmartIR detected! Climate entities will be created via SmartIR profiles.",-1)])])):(s(),i("div",xo,[...x[17]||(x[17]=[e("i",{class:"mdi mdi-alert"},null,-1),e("div",null,[e("strong",null,"SmartIR Required"),e("p",null,"Climate entities (AC, heaters) require SmartIR integration."),e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"smartir-link"}," Install SmartIR â†’ ")],-1)])]))])):$.value&&["media_player","fan","light"].includes(t.value.entity_type)?(s(),i("div",To,[...x[18]||(x[18]=[e("div",{class:"notice-info"},[e("i",{class:"mdi mdi-information"}),e("span",null,"ðŸ’¡ SmartIR available! You can use pre-configured codes or learn your own.")],-1)])])):!$.value&&t.value.entity_type?(s(),i("small",Ro,[x[19]||(x[19]=D(" ðŸ’¡ Tip: Install ",-1)),x[20]||(x[20]=e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"inline-link"},"SmartIR",-1)),D(" for pre-configured "+v(t.value.entity_type==="climate"?"climate":t.value.entity_type)+" device codes ",1)])):E("",!0)]),e("div",Mo,[x[24]||(x[24]=e("label",{for:"device-type"},"Device Type *",-1)),J(e("select",{id:"device-type","onUpdate:modelValue":x[5]||(x[5]=S=>t.value.device_type=S),required:"",disabled:f.value},[x[22]||(x[22]=e("option",{value:""},"-- Select Device Type --",-1)),x[23]||(x[23]=e("option",{value:"broadlink"},"ðŸ“¡ Broadlink Device (Learn IR Codes)",-1)),Se(n)?(s(),i("option",{key:0,value:"smartir",disabled:!$.value||!y.value}," ðŸŒ SmartIR Device "+v(I.value),9,Oo)):E("",!0)],8,Lo),[[$e,t.value.device_type]]),f.value?(s(),i("small",Ao,"Cannot change device type after creation")):t.value.device_type==="smartir"?(s(),i("small",Eo,"Using pre-configured codes from SmartIR repository")):t.value.device_type==="broadlink"?(s(),i("small",Vo,"Learn and store your own IR codes")):(s(),i("small",jo,"Choose how to configure this device"))]),f.value?(s(),i("div",Uo,[x[27]||(x[27]=e("label",{for:"device-area"},"Area",-1)),e("div",Fo,[e("input",{id:"device-area",value:t.value.area||"Not assigned",type:"text",readonly:"",class:"readonly-input"},null,8,Po),e("button",{type:"button",onClick:Z,disabled:F.value,class:"sync-area-btn",title:"Sync area from Home Assistant"},[e("i",{class:ee(F.value?"mdi mdi-loading mdi-spin":"mdi mdi-refresh")},null,2)],8,No)]),e("small",null,[x[25]||(x[25]=e("i",{class:"mdi mdi-information-outline"},null,-1)),x[26]||(x[26]=D(" Set area in Home Assistant, then click sync. ",-1)),e("a",{href:de(),target:"_blank",class:"inline-link"},"Open in HA â†’",8,Bo)])])):(s(),i("div",qo,[...x[28]||(x[28]=[e("div",{class:"info-notice"},[e("i",{class:"mdi mdi-information-outline"}),e("span",null,[e("strong",null,"Area Assignment:"),D(" After generating entities and restarting Home Assistant, you can assign areas in HA and sync them here.")])],-1)])])),e("div",Ho,[x[29]||(x[29]=e("label",{for:"device-icon"},"Icon",-1)),fe(jt,{modelValue:t.value.icon,"onUpdate:modelValue":x[6]||(x[6]=S=>t.value.icon=S),inputId:"device-icon",placeholder:"e.g., mdi:television"},null,8,["modelValue"]),x[30]||(x[30]=e("small",null,"Optional: Material Design Icon name",-1))]),t.value.device_type==="broadlink"?(s(),i("div",zo,[x[32]||(x[32]=e("label",{for:"broadlink-entity"},"Remote Device *",-1)),!f.value||!L.value?J((s(),i("select",{key:0,id:"broadlink-entity",ref_key:"broadlinkSelect",ref:u,"onUpdate:modelValue":x[7]||(x[7]=S=>t.value.broadlink_entity=S),required:"",onChange:x[8]||(x[8]=S=>te("broadlinkSelect"))},[x[31]||(x[31]=e("option",{value:""},"-- Select Remote Device --",-1)),(s(!0),i(be,null,ke(_.value,S=>(s(),i("option",{key:S.entity_id,value:S.entity_id},[D(v(S.name||S.entity_id)+" ",1),S.area_name?(s(),i(be,{key:0},[D(" - "+v(S.area_name),1)],64)):E("",!0)],8,Jo))),128))],544)),[[$e,t.value.broadlink_entity]]):(s(),i("input",{key:1,id:"broadlink-entity",value:k.value,type:"text",readonly:"",disabled:""},null,8,Wo)),!f.value||!L.value?(s(),i("small",Go,"Required: Select which remote device to use for sending commands")):(s(),i("small",Ko,"Cannot change remote device after commands are learned"))])):E("",!0),t.value.device_type==="smartir"?(s(),i("div",Xo,[x[33]||(x[33]=e("div",{class:"section-header"},[e("i",{class:"mdi mdi-cloud-download"}),e("span",null,"SmartIR Device Configuration")],-1)),fe(ko,{ref_key:"smartirSelector",ref:B,"entity-type":t.value.entity_type,modelValue:O.value,"onUpdate:modelValue":x[9]||(x[9]=S=>O.value=S),"broadlink-devices":_.value,onChange:Ie},null,8,["entity-type","modelValue","broadlink-devices"])])):E("",!0)],32),e("div",Yo,[e("button",{type:"button",onClick:x[10]||(x[10]=S=>G.$emit("cancel")),class:"btn btn-secondary"}," Cancel "),e("button",Zo,[x[34]||(x[34]=e("i",{class:"mdi mdi-check"},null,-1)),D(" "+v(f.value?"Update":"Create"),1)])])])]))}},el=we(Qo,[["__scopeId","data-v-ac633105"]]),tl={class:"modal-header"},ol={class:"modal-body"},ll={class:"message-text"},nl={key:0,class:"checkbox-option"},sl={class:"modal-footer"},al={__name:"ConfirmDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},dangerMode:{type:Boolean,default:!1},checkboxLabel:{type:String,default:""}},emits:["confirm","cancel"],setup(l,{emit:g}){const r=l,w=g,h=b(!1);me(()=>r.isOpen,f=>{f&&(h.value=!1)});const n=()=>{w("confirm",h.value)},$=()=>{w("cancel")};return(f,y)=>l.isOpen?(s(),i("div",{key:0,class:"modal-overlay",onClick:pe($,["self","stop"])},[e("div",{class:"modal-dialog confirm-dialog",onClick:y[1]||(y[1]=pe(()=>{},["stop"]))},[e("div",tl,[e("h2",null,v(l.title),1)]),e("div",ol,[e("p",ll,v(l.message),1),l.checkboxLabel?(s(),i("div",nl,[e("label",null,[J(e("input",{type:"checkbox","onUpdate:modelValue":y[0]||(y[0]=I=>h.value=I)},null,512),[[ce,h.value]]),e("span",null,v(l.checkboxLabel),1)])])):E("",!0)]),e("div",sl,[l.showCancel?(s(),i("button",{key:0,onClick:pe($,["stop"]),class:"btn btn-secondary"},v(l.cancelText),1)):E("",!0),e("button",{onClick:pe(n,["stop"]),class:ee(["btn",l.dangerMode?"btn-danger":"btn-primary"])},v(l.confirmText),3)])])])):E("",!0)}},Re=we(al,[["__scopeId","data-v-6404e72a"]]),il={class:"modal-content"},rl={class:"modal-header"},dl={class:"modal-body"},ul={key:0,class:"smartir-info"},cl={class:"form-group"},ml=["value"],vl={class:"form-group"},pl=["disabled"],fl={label:"Suggested Commands"},gl=["value"],yl=["disabled"],bl={class:"form-group"},hl={class:"radio-group"},kl={class:"radio-label"},wl=["disabled"],$l={class:"radio-label"},Cl=["disabled"],Sl={class:"learn-action"},_l=["disabled"],Il={key:0,class:"mdi mdi-loading mdi-spin"},Dl={key:1,class:"mdi mdi-remote-tv"},xl={key:0,class:"learning-status"},Tl={key:1,class:"result-message success"},Rl={key:2,class:"section-divider"},Ml={key:3,class:"learned-commands"},Ll={class:"command-list"},Ol={class:"command-info"},Al={class:"command-name"},El={class:"learned-status"},Vl={class:"command-actions"},jl=["onClick","disabled"],Ul=["onClick"],Fl={key:4,class:"untracked-commands"},Pl={class:"command-list"},Nl={class:"command-name"},Bl={class:"modal-footer"},ql=["disabled"],Hl={__name:"CommandLearner",props:{device:{type:Object,required:!0}},emits:["cancel","learned"],setup(l,{emit:g}){const r=l,w=g,h=b([]),n=b(""),$=b(""),f=b(""),y=b("ir"),I=b(!1),L=b(""),k=b("success"),t=b([]),O=b([]),B=b(!1),j=b(""),_=b(!1),o=b(null),m=b(null),u=b(""),P=b(""),Y=z(()=>r.device.device_type==="smartir");z(()=>{if(Y.value)return!1;const R=$.value==="__custom__"?f.value:$.value;return n.value&&R.trim()});const ne=()=>{o.value&&o.value.setCustomValidity("")},te=()=>{m.value&&m.value.setCustomValidity("")},ge=z(()=>{const R=h.value.find(d=>d.entity_id===n.value);return R?R.name||R.entity_id:n.value}),T={light:["turn_on","turn_off","toggle","brightness_up","brightness_down","dim","bright"],fan:["turn_on","turn_off","toggle","speed_low","speed_medium","speed_high","speed_1","speed_2","speed_3","speed_4","speed_5","oscillate_on","oscillate_off","direction_forward","direction_reverse"],switch:["turn_on","turn_off","toggle"],media_player:["turn_on","turn_off","toggle","volume_up","volume_down","volume_mute","play","pause","stop","play_pause","next_track","previous_track","channel_up","channel_down","source_hdmi1","source_hdmi2","source_hdmi3","source_tv","source_aux","source_bluetooth","menu","home","back","select","arrow_up","arrow_down","arrow_left","arrow_right"],cover:["open","close","stop","open_tilt","close_tilt","position_0","position_25","position_50","position_75","position_100"]},F=z(()=>{const R=r.device.entity_type||"switch";return T[R]||T.switch});De(async()=>{await Z(),await de(),await V(),o.value&&(o.value.setCustomValidity(""),o.value.oninvalid=()=>{o.value.setCustomValidity("Command name is required")}),r.device.broadlink_entity&&(n.value=r.device.broadlink_entity)}),me($,async R=>{R==="__custom__"&&(await Je(),m.value&&(m.value.setCustomValidity(""),m.value.oninvalid=()=>{m.value.setCustomValidity("Custom command name is required")}))});const Z=async()=>{try{const R=await ve.get("/api/broadlink/devices");h.value=R.data.devices||[]}catch(R){console.error("Error loading Broadlink devices:",R)}},de=async()=>{try{if(Y.value){const R=await ve.get("/api/smartir/codes/code",{params:{entity_type:r.device.entity_type,code_id:r.device.device_code}});if(R.data.success&&R.data.code){const d=R.data.code.commands||{},N=R.data.code.commandType||"ir";t.value=Object.keys(d).map(le=>({name:le,type:N}))}}else{if(console.log("ðŸ“‹ Loading commands for device:",r.device),console.log("ðŸ“‹ Device commands:",r.device.commands),console.log("ðŸ“‹ Device ID:",r.device.id),r.device.commands&&Object.keys(r.device.commands).length>0)console.log("âœ… Using commands from device object"),t.value=Object.entries(r.device.commands).map(([R,d])=>({name:R,type:d.command_type||d.type||"ir"}));else if(r.device.id){console.log("ðŸŒ Fetching commands from API for device ID:",r.device.id);const d=(await ve.get(`/api/commands/${r.device.id}`)).data.commands||{};t.value=Object.entries(d).map(([N,le])=>({name:N,type:le.command_type||le.type||"ir"}))}else console.log("âš ï¸ No commands found and no device ID");console.log("ðŸ“‹ Final learned commands:",t.value)}}catch(R){console.error("Error loading commands:",R)}},he=async()=>{var R,d;L.value="",k.value="",I.value=!0;try{let N=r.device.id.split(".")[1];r.device.device&&(N=r.device.device);const le=$.value==="__custom__"?f.value:$.value,re=await ve.post("/api/commands/learn",{entity_id:n.value,device:N,device_id:r.device.id,command:le.trim(),command_type:y.value});if(re.data.success){L.value=`Command "${le}" learned successfully!`,k.value="success",t.value.includes(le)||t.value.push(le);const q=O.value.indexOf(le);q>-1&&O.value.splice(q,1);const C={...r.device.commands};C[le]=!0,$.value="",f.value="",w("learned",{commands:C,commandName:le})}else L.value=re.data.error||"Failed to learn command",k.value="error"}catch(N){L.value=((d=(R=N.response)==null?void 0:R.data)==null?void 0:d.error)||"Error learning command",k.value="error"}finally{I.value=!1}},Ie=async R=>{try{P.value=R,u.value="";let d=r.device.id.split(".")[1];r.device.device&&(d=r.device.device);const N=Y.value?r.device.controller_device:n.value||r.device.broadlink_entity;if(!N){console.error("Missing entity_id for test command:",{isSmartIR:Y.value,controller_device:r.device.controller_device,broadlink_entity:r.device.broadlink_entity,selectedBroadlink:n.value,device:r.device}),L.value="Missing Broadlink remote entity. Please select a Broadlink device.",k.value="error",P.value="";return}(await ve.post("/api/commands/test",{entity_id:N,device:d,command:R,device_id:r.device.id})).data.success&&(u.value=R,setTimeout(()=>{u.value===R&&(u.value="")},2e3))}catch(d){L.value=`Failed to send command: ${d.message}`,k.value="error"}finally{P.value=""}},G=R=>{j.value=R,B.value=!0},x=()=>{B.value=!1,j.value=""},S=async()=>{const R=j.value;B.value=!1;try{await ve.delete(`/api/commands/${r.device.id}/${R}`),await de(),await V(),L.value=`Command "${R}" deleted`,k.value="success",w("learned")}catch(d){L.value=`Failed to delete command: ${d.message}`,k.value="error"}finally{j.value=""}},V=async()=>{try{const R=r.device.device||r.device.id.split(".")[1],N=(await ve.get("/api/commands/untracked")).data.untracked||{};N[R]?O.value=Object.keys(N[R].commands):O.value=[]}catch(R){console.error("Error loading untracked commands:",R),O.value=[]}},K=()=>{O.value.length!==0&&(_.value=!0)},ue=async()=>{_.value=!1;try{const R=r.device.device||r.device.id.split(".")[1],d=await ve.post("/api/commands/import",{device_id:r.device.id,source_device:R,commands:O.value});d.data.success&&(L.value=`Imported ${d.data.imported_count} commands successfully!`,k.value="success",await de(),await V(),w("learned"))}catch(R){L.value=`Failed to import commands: ${R.message}`,k.value="error"}};return(R,d)=>(s(),i("div",{class:"modal-overlay",onClick:d[7]||(d[7]=pe(N=>R.$emit("cancel"),["self"]))},[e("div",il,[e("div",rl,[e("h2",null,v(Y.value?"Commands for":"Learn Commands for")+" "+v(l.device.name),1),e("button",{onClick:d[0]||(d[0]=N=>R.$emit("cancel")),class:"close-btn"},[...d[8]||(d[8]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",dl,[Y.value?(s(),i("div",ul,[d[12]||(d[12]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[d[11]||(d[11]=e("h3",null,"SmartIR Device",-1)),e("p",null,[d[9]||(d[9]=D("This device uses SmartIR code file ",-1)),e("strong",null,v(l.device.device_code),1),d[10]||(d[10]=D(". Commands are pre-configured and cannot be learned. View the commands below.",-1))])])])):(s(),i("form",{key:1,onSubmit:pe(he,["prevent"])},[e("div",cl,[d[13]||(d[13]=e("label",{for:"broadlink-entity"},"Broadlink Device",-1)),e("input",{id:"broadlink-entity",value:ge.value,type:"text",readonly:"",disabled:""},null,8,ml),d[14]||(d[14]=e("small",null,"Commands will be learned using this device (set when device was created)",-1))]),e("div",vl,[d[17]||(d[17]=e("label",{for:"command-name"},"Command Name *",-1)),J(e("select",{id:"command-name",ref_key:"commandSelect",ref:o,"onUpdate:modelValue":d[1]||(d[1]=N=>$.value=N),disabled:I.value,required:"",onChange:ne},[d[15]||(d[15]=e("option",{value:""},"-- Select or type command --",-1)),e("optgroup",fl,[(s(!0),i(be,null,ke(F.value,N=>(s(),i("option",{key:N,value:N},v(N),9,gl))),128))]),d[16]||(d[16]=e("option",{value:"__custom__"},"Custom command...",-1))],40,pl),[[$e,$.value]]),$.value==="__custom__"?J((s(),i("input",{key:0,ref_key:"customCommandInput",ref:m,"onUpdate:modelValue":d[2]||(d[2]=N=>f.value=N),type:"text",placeholder:"Enter custom command name",disabled:I.value,required:"",class:"custom-command-input",onInput:te},null,40,yl)),[[_e,f.value]]):E("",!0),e("small",null,"Select a suggested command for "+v(l.device.entity_type||"this device")+", or enter a custom one.",1)]),e("div",bl,[d[20]||(d[20]=e("label",null,"Command Type",-1)),e("div",hl,[e("label",kl,[J(e("input",{type:"radio","onUpdate:modelValue":d[3]||(d[3]=N=>y.value=N),value:"ir",disabled:I.value},null,8,wl),[[je,y.value]]),d[18]||(d[18]=e("span",null,"IR (Infrared)",-1))]),e("label",$l,[J(e("input",{type:"radio","onUpdate:modelValue":d[4]||(d[4]=N=>y.value=N),value:"rf",disabled:I.value},null,8,Cl),[[je,y.value]]),d[19]||(d[19]=e("span",null,"RF (Radio Frequency)",-1))])])]),e("div",Sl,[e("button",{type:"submit",class:"btn btn-primary btn-large",disabled:I.value},[I.value?(s(),i("i",Il)):(s(),i("i",Dl)),D(" "+v(I.value?"Learning...":"Learn Command"),1)],8,_l)]),I.value?(s(),i("div",xl,[...d[21]||(d[21]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Point your remote at the Broadlink device and press the button...",-1),e("small",null,"This may take up to 30 seconds",-1)])])):E("",!0),L.value&&k.value==="success"&&!L.value.includes("sent successfully")?(s(),i("div",Tl,[d[22]||(d[22]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("p",null,v(L.value),1)])):E("",!0)],32)),t.value.length>0||O.value.length>0?(s(),i("div",Rl)):E("",!0),t.value.length>0?(s(),i("div",Ml,[e("h3",null,"Tracked Commands ("+v(t.value.length)+")",1),e("div",Ll,[(s(!0),i(be,null,ke(t.value,N=>(s(),i("div",{key:N.name,class:"command-item"},[e("div",Ol,[e("span",Al,v(N.name),1)]),e("div",El,[d[23]||(d[23]=e("i",{class:"mdi mdi-check-circle"},null,-1)),d[24]||(d[24]=e("span",null,"Learned",-1)),e("span",{class:ee(["command-type-badge",N.type||"ir"])},v((N.type||"ir").toUpperCase()),3)]),e("div",Vl,[e("button",{type:"button",onClick:le=>Ie(N.name),class:"icon-btn",title:"Test command",disabled:P.value===N.name},[e("i",{class:ee(["mdi mdi-play",{"mdi-spin":P.value===N.name}])},null,2)],8,jl),e("button",{type:"button",onClick:le=>G(N.name),class:"icon-btn danger",title:"Delete and re-learn"},[...d[25]||(d[25]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Ul)])]))),128))])])):E("",!0),O.value.length>0?(s(),i("div",Fl,[e("h3",null,[d[26]||(d[26]=e("i",{class:"mdi mdi-alert"},null,-1)),D(" Untracked Commands ("+v(O.value.length)+") ",1)]),d[29]||(d[29]=e("p",{class:"untracked-info"}," These commands exist in Broadlink storage but are not tracked in this device. ",-1)),e("div",Pl,[(s(!0),i(be,null,ke(O.value,N=>(s(),i("div",{key:N,class:"command-item untracked"},[e("span",Nl,v(N),1),d[27]||(d[27]=e("span",{class:"untracked-badge"},"Not tracked",-1))]))),128))]),e("button",{type:"button",onClick:K,class:"btn btn-secondary"},[...d[28]||(d[28]=[e("i",{class:"mdi mdi-import"},null,-1),D(" Import All Untracked Commands ",-1)])])])):E("",!0)]),e("div",Bl,[e("button",{type:"button",onClick:d[5]||(d[5]=N=>R.$emit("cancel")),class:"btn btn-secondary",disabled:I.value}," Close ",8,ql)])]),fe(Re,{isOpen:B.value,title:"Delete Command?",message:`Delete command '${j.value}'? This will remove it from Broadlink storage.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:S,onCancel:x},null,8,["isOpen","message"]),fe(Re,{isOpen:_.value,title:"Import Commands?",message:`Import ${O.value.length} untracked command${O.value.length>1?"s":""} into this device?`,confirmText:"Import",cancelText:"Cancel",onConfirm:ue,onCancel:d[6]||(d[6]=N=>_.value=!1)},null,8,["isOpen","message"])]))}},zl=we(Hl,[["__scopeId","data-v-ed228f8b"]]),Jl={class:"modal-container error-dialog"},Wl={class:"modal-header"},Gl={class:"modal-body"},Kl={class:"error-message"},Xl={key:0,class:"error-suggestion"},Yl=["open"],Zl={class:"debug-content"},Ql={class:"debug-info"},en={key:0,class:"debug-section-title"},tn={key:1},on={__name:"ErrorDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Error"},message:{type:String,required:!0},suggestion:{type:String,default:""},details:{type:String,default:""},error:{type:Object,default:null},context:{type:Object,default:()=>({})}},emits:["close"],setup(l,{emit:g}){const r=l,w=g,h=Ce("toast"),n=b(!1),$=()=>{w("close")},f=z(()=>{var O,B,j,_,o,m,u,P,Y,ne,te;const k=new Date().toISOString(),t=r.error||{};return{error:JSON.stringify({message:r.message,title:r.title,details:r.details,errorObject:t.message||t.toString(),timestamp:k},null,2),request:JSON.stringify({method:((B=(O=t.config)==null?void 0:O.method)==null?void 0:B.toUpperCase())||"N/A",url:((j=t.config)==null?void 0:j.url)||"N/A",baseURL:((_=t.config)==null?void 0:_.baseURL)||"N/A",headers:((o=t.config)==null?void 0:o.headers)||{},data:(m=t.config)!=null&&m.data?JSON.parse(t.config.data):"N/A",params:((u=t.config)==null?void 0:u.params)||{}},null,2),response:JSON.stringify({status:((P=t.response)==null?void 0:P.status)||"N/A",statusText:((Y=t.response)==null?void 0:Y.statusText)||"N/A",data:((ne=t.response)==null?void 0:ne.data)||"N/A",headers:((te=t.response)==null?void 0:te.headers)||{}},null,2),browser:JSON.stringify({userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,viewport:`${window.innerWidth}x${window.innerHeight}`,screenResolution:`${window.screen.width}x${window.screen.height}`,colorDepth:window.screen.colorDepth,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timestamp:k},null,2),appState:JSON.stringify({currentRoute:window.location.pathname,currentURL:window.location.href,referrer:document.referrer||"N/A",context:r.context||{},localStorage:{smartir_simulate:localStorage.getItem("smartir_simulate_not_installed"),theme:localStorage.getItem("theme")}},null,2),stackTrace:t.stack||null}}),y=async()=>{const k=L();try{await navigator.clipboard.writeText(k),h==null||h.success("Debug information copied to clipboard","âœ… Copied")}catch(t){console.error("Failed to copy:",t),h==null||h.error("Failed to copy to clipboard","âŒ Copy Failed")}},I=()=>{const k=L(),t=new Blob([k],{type:"text/plain"}),O=URL.createObjectURL(t),B=document.createElement("a");B.href=O;const j=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);B.download=`broadlink-manager-error-${j}.txt`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(O),h==null||h.success("Debug report downloaded","âœ… Downloaded")},L=()=>`Broadlink Manager - Error Report
${"=".repeat(60)}

Generated: ${new Date().toISOString()}
Title: ${r.title}
Message: ${r.message}
${r.suggestion?`Suggestion: ${r.suggestion}
`:""}
${"=".repeat(60)}

ERROR DETAILS
${"-".repeat(60)}
${f.value.error}

REQUEST INFORMATION
${"-".repeat(60)}
${f.value.request}

RESPONSE INFORMATION
${"-".repeat(60)}
${f.value.response}

BROWSER INFORMATION
${"-".repeat(60)}
${f.value.browser}

APPLICATION STATE
${"-".repeat(60)}
${f.value.appState}

${f.value.stackTrace?`STACK TRACE
${"-".repeat(60)}
${f.value.stackTrace}

`:""}
${"=".repeat(60)}
End of Report
`;return me(()=>r.isOpen,k=>{if(k){const t=O=>{O.key==="Escape"&&$()};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)}}),(k,t)=>(s(),Te(We,{to:"body"},[fe(ze,{name:"modal"},{default:Pe(()=>[l.isOpen?(s(),i("div",{key:0,class:"modal-overlay",onClick:pe($,["self"])},[e("div",Jl,[e("div",Wl,[t[2]||(t[2]=e("div",{class:"header-icon error-icon"},[e("i",{class:"mdi mdi-alert-circle"})],-1)),e("h3",null,v(l.title),1),e("button",{onClick:$,class:"close-button"},[...t[1]||(t[1]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Gl,[e("p",Kl,v(l.message),1),l.suggestion?(s(),i("p",Xl,[t[3]||(t[3]=e("i",{class:"mdi mdi-lightbulb-on"},null,-1)),D(" "+v(l.suggestion),1)])):E("",!0),e("details",{class:"debug-section",open:n.value},[e("summary",{onClick:t[0]||(t[0]=O=>n.value=!n.value)},[e("i",{class:ee(["mdi",n.value?"mdi-chevron-down":"mdi-chevron-right"])},null,2),t[4]||(t[4]=D(" Debug Information ",-1))]),e("div",Zl,[e("div",{class:"debug-actions"},[e("button",{onClick:y,class:"btn-debug btn-copy"},[...t[5]||(t[5]=[e("i",{class:"mdi mdi-content-copy"},null,-1),D(" Copy to Clipboard ",-1)])]),e("button",{onClick:I,class:"btn-debug btn-download"},[...t[6]||(t[6]=[e("i",{class:"mdi mdi-download"},null,-1),D(" Download Report ",-1)])])]),e("div",Ql,[t[7]||(t[7]=e("div",{class:"debug-section-title"},"Error Details",-1)),e("pre",null,v(f.value.error),1),t[8]||(t[8]=e("div",{class:"debug-section-title"},"Request Information",-1)),e("pre",null,v(f.value.request),1),t[9]||(t[9]=e("div",{class:"debug-section-title"},"Response Information",-1)),e("pre",null,v(f.value.response),1),t[10]||(t[10]=e("div",{class:"debug-section-title"},"Browser Information",-1)),e("pre",null,v(f.value.browser),1),t[11]||(t[11]=e("div",{class:"debug-section-title"},"Application State",-1)),e("pre",null,v(f.value.appState),1),f.value.stackTrace?(s(),i("div",en,"Stack Trace")):E("",!0),f.value.stackTrace?(s(),i("pre",tn,v(f.value.stackTrace),1)):E("",!0)])])],8,Yl)]),e("div",{class:"modal-footer"},[e("button",{onClick:$,class:"btn btn-primary"}," OK ")])])])):E("",!0)]),_:1})]))}},ln=we(on,[["__scopeId","data-v-23858149"]]),nn={key:0,class:"discovery-banner"},sn={class:"banner-content"},an={class:"banner-text"},rn={class:"modal-dialog"},dn={class:"modal-header"},un={class:"modal-body"},cn={class:"device-list"},mn={class:"device-info"},vn={class:"device-details"},pn={class:"command-count"},fn={class:"device-actions"},gn=["onClick"],yn=["onClick"],bn={class:"modal-footer"},hn={class:"modal-dialog modal-dialog-small"},kn={class:"modal-header"},wn={class:"modal-body"},$n={class:"warning-message"},Cn={class:"modal-footer"},Sn=["disabled"],_n=["disabled"],In={__name:"DeviceDiscovery",emits:["adopt"],setup(l,{expose:g,emit:r}){const w=Fe(),h=r,n=b([]),$=b(!1),f=b(!1),y=b(null),I=b(!1),L=z(()=>n.value.length>0);De(async()=>{await k()});const k=async()=>{try{const j=await ve.get("/api/devices/discover");n.value=j.data.untracked_devices||[]}catch(j){console.error("Error loading untracked devices:",j),n.value=[]}},t=j=>{$.value=!1,h("adopt",j)},O=j=>{y.value=j,f.value=!0},B=async()=>{if(y.value){I.value=!0;try{const j=await ve.delete(`/api/devices/untracked/${encodeURIComponent(y.value.device_name)}`);if(j.data.success)n.value=n.value.filter(_=>_.device_name!==y.value.device_name),f.value=!1,y.value=null,console.log("Device deleted successfully");else throw new Error(j.data.error||"Failed to delete device")}catch(j){console.error("Error deleting device:",j),w.error(`Failed to delete device: ${j.message}`)}finally{I.value=!1}}};return g({refresh:k}),(j,_)=>{var o,m,u;return L.value?(s(),i("div",nn,[e("div",sn,[_[9]||(_[9]=e("div",{class:"banner-icon"},[e("i",{class:"mdi mdi-radar"})],-1)),e("div",an,[_[7]||(_[7]=e("h3",null,"Untracked Devices Found",-1)),e("p",null,v(n.value.length)+" device"+v(n.value.length>1?"s":"")+" with learned commands found in Broadlink storage",1)]),e("button",{onClick:_[0]||(_[0]=P=>$.value=!0),class:"btn btn-primary"},[..._[8]||(_[8]=[e("i",{class:"mdi mdi-eye"},null,-1),D(" View Devices ",-1)])])]),$.value?(s(),i("div",{key:0,class:"modal-overlay",onClick:_[3]||(_[3]=pe(P=>$.value=!1,["self"]))},[e("div",rn,[e("div",dn,[_[11]||(_[11]=e("h2",null,"Discovered Devices",-1)),e("button",{onClick:_[1]||(_[1]=P=>$.value=!1),class:"close-btn"},[..._[10]||(_[10]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",un,[_[16]||(_[16]=e("p",{class:"info-text"}," These devices have learned commands in Broadlink storage but are not being tracked. Adopt them to manage their commands and generate Home Assistant entities. ",-1)),e("div",cn,[(s(!0),i(be,null,ke(n.value,P=>(s(),i("div",{key:P.device_name,class:"discovered-device"},[e("div",mn,[_[13]||(_[13]=e("div",{class:"device-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),e("div",vn,[e("h4",null,v(P.device_name),1),e("span",pn,[_[12]||(_[12]=e("i",{class:"mdi mdi-remote"},null,-1)),D(" "+v(P.command_count)+" command"+v(P.command_count>1?"s":""),1)])])]),e("div",fn,[e("button",{onClick:Y=>t(P),class:"btn btn-primary"},[..._[14]||(_[14]=[e("i",{class:"mdi mdi-plus"},null,-1),D(" Adopt ",-1)])],8,gn),e("button",{onClick:Y=>O(P),class:"btn btn-danger",title:"Delete all commands"},[..._[15]||(_[15]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,yn)])]))),128))])]),e("div",bn,[e("button",{onClick:_[2]||(_[2]=P=>$.value=!1),class:"btn btn-secondary"}," Close ")])])])):E("",!0),f.value?(s(),i("div",{key:1,class:"modal-overlay",onClick:_[6]||(_[6]=pe(P=>f.value=!1,["self"]))},[e("div",hn,[e("div",kn,[_[18]||(_[18]=e("h2",null,"Delete Untracked Device",-1)),e("button",{onClick:_[4]||(_[4]=P=>f.value=!1),class:"close-btn"},[..._[17]||(_[17]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",wn,[e("div",$n,[_[20]||(_[20]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[e("p",null,[e("strong",null,'Are you sure you want to delete "'+v((o=y.value)==null?void 0:o.device_name)+'"?',1)]),e("p",null,"This will permanently delete all "+v((m=y.value)==null?void 0:m.command_count)+" command"+v(((u=y.value)==null?void 0:u.command_count)>1?"s":"")+" from Broadlink storage.",1),_[19]||(_[19]=e("p",{class:"warning-text"},"This action cannot be undone.",-1))])])]),e("div",Cn,[e("button",{onClick:_[5]||(_[5]=P=>f.value=!1),class:"btn btn-secondary",disabled:I.value}," Cancel ",8,Sn),e("button",{onClick:B,class:"btn btn-danger",disabled:I.value},[e("i",{class:ee(["mdi",I.value?"mdi-loading mdi-spin":"mdi-delete"])},null,2),D(" "+v(I.value?"Deleting...":"Delete"),1)],8,_n)])])])):E("",!0)])):E("",!0)}}},Dn=we(In,[["__scopeId","data-v-24463050"]]),xn={class:"device-list-card"},Tn={class:"card-header"},Rn={class:"header-badges"},Mn={class:"header-info"},Ln={class:"header-right"},On=["disabled"],An=["disabled"],En={class:"card-body"},Vn={key:0,class:"filter-bar"},jn={class:"filter-row filter-row-search"},Un={class:"filter-group filter-search"},Fn={class:"filter-row filter-row-dropdowns"},Pn={class:"filter-group"},Nn=["value"],Bn={class:"filter-group"},qn=["value"],Hn={class:"filter-group"},zn={key:0,class:"filter-group filter-toggle"},Jn={class:"toggle-label"},Wn={class:"filter-results"},Gn={key:1,class:"loading-state"},Kn={key:2,class:"error-state"},Xn={key:3,class:"empty-state"},Yn={key:4,class:"device-grid"},Zn={key:5,class:"no-results"},Qn={__name:"DeviceList",setup(l){const g=st(),r=Fe(),w=b(!1),h=b(!1),n=b(null),$=b(!1),f=b(null),y=b(null),I=b(!0),L=b(!1),k=b(!1),t=()=>{I.value=!I.value},O=b(!1),B=b({title:"Error",message:"",suggestion:"",details:"",error:null,context:{}}),j=b(!1),_=b({success:!1,title:"",message:""}),o=b({search:"",broadlinkDevice:"",area:"",entityType:"",showSmartIROnly:!1}),m=b([]),u=Ce("smartirStatus"),P=Ce("smartirEnabled"),Y=z(()=>{var p;return localStorage.getItem("smartir_simulate_not_installed")==="true"?!1:((p=u==null?void 0:u.value)==null?void 0:p.installed)||!1}),ne=z(()=>{const c=new Map;return g.devices.forEach(p=>{if(p.broadlink_entity){const M=m.value.find(H=>H.entity_id===p.broadlink_entity),U=M&&M.name||p.broadlink_entity;c.set(p.broadlink_entity,{entity_id:p.broadlink_entity,friendly_name:U})}}),Array.from(c.values()).sort((p,M)=>p.friendly_name.localeCompare(M.friendly_name))}),te=z(()=>{const c=new Set;return g.devices.forEach(p=>{p.area&&c.add(p.area)}),Array.from(c).sort()}),ge=z(()=>{let c=g.devices;if(o.value.search){const M=o.value.search.toLowerCase();c=c.filter(U=>{var oe,Q,W,ye,xe;if((oe=U.name)!=null&&oe.toLowerCase().includes(M)||(Q=U.entity_type)!=null&&Q.toLowerCase().includes(M)||(W=U.area)!=null&&W.toLowerCase().includes(M)||(ye=U.id)!=null&&ye.toLowerCase().includes(M)||Object.keys(U.commands||{}).some(Le=>Le.toLowerCase().includes(M)))return!0;const ae=m.value.find(Le=>Le.entity_id===U.broadlink_entity);return!!((xe=ae==null?void 0:ae.name)!=null&&xe.toLowerCase().includes(M))})}o.value.broadlinkDevice&&(c=c.filter(M=>M.broadlink_entity===o.value.broadlinkDevice||M.controller_device===o.value.broadlinkDevice)),o.value.area&&(c=c.filter(M=>M.area===o.value.area)),o.value.entityType&&(c=c.filter(M=>M.entity_type===o.value.entityType)),o.value.showSmartIROnly&&(c=c.filter(M=>M.device_type==="smartir"));const p=localStorage.getItem("smartir_simulate_not_installed")==="true";return(!(P!=null&&P.value)||p)&&(c=c.filter(M=>M.device_type!=="smartir")),c}),T=z(()=>o.value.search||o.value.broadlinkDevice||o.value.area||o.value.entityType||o.value.showSmartIROnly),F=()=>{o.value.search="",o.value.broadlinkDevice="",o.value.area="",o.value.entityType="",o.value.showSmartIROnly=!1},Z=async()=>{try{const c=await ve.get("/api/remote/devices");m.value=c.data.devices||[]}catch(c){console.error("Error loading remote devices:",c)}};De(async()=>{await Promise.all([g.loadDevices(),Z()])});const de=c=>{n.value=c,w.value=!0},he=z(()=>{if(!f.value)return"";const c=Object.keys(f.value.commands||{}).length;return c===0?"This device has no commands. The device will be removed from tracking.":`This device has ${c} learned command${c>1?"s":""}. What would you like to do?`}),Ie=z(()=>{if(!f.value)return"";const c=Object.keys(f.value.commands||{}).length;return c===0?"":`Also delete all ${c} command${c>1?"s":""} from Broadlink storage`}),G=c=>{f.value=c,$.value=!0},x=()=>{$.value=!1,f.value=null},S=async c=>{var M,U;const p=f.value;$.value=!1;try{await g.deleteDevice(p.id,c),y.value&&await y.value.refresh()}catch(H){const ae=((U=(M=H.response)==null?void 0:M.data)==null?void 0:U.error)||H.message||"Unknown error";d("Failed to Delete Device",ae)}finally{f.value=null}},V=async c=>{var p,M,U,H,ae;try{console.log("ðŸ’¾ Saving device data:",c),console.log("ðŸ’¾ Device commands:",c.commands),console.log("ðŸ’¾ Selected device:",n.value),(p=n.value)!=null&&p.id&&n.value.id!==null?await g.updateDevice(n.value.id,c):await g.createDevice(c),K(),y.value&&await y.value.refresh()}catch(oe){let Q="Failed to save device",W="",ye="";(U=(M=oe.response)==null?void 0:M.data)!=null&&U.error?(Q=oe.response.data.error,W=oe.response.data.suggestion||""):oe.message&&(Q=oe.message),oe.response&&(ye=`Status: ${oe.response.status}
URL: ${((H=oe.config)==null?void 0:H.url)||"N/A"}`),d("Failed to Save Device",Q,W,ye,oe,{action:"save_device",deviceData:c,isEdit:!!((ae=n.value)!=null&&ae.id)})}},K=()=>{w.value=!1,n.value=null},ue=c=>{n.value=c,h.value=!0},R=()=>{h.value=!1,n.value=null},d=(c,p,M="",U="",H=null,ae={})=>{B.value={title:c,message:p,suggestion:M,details:U,error:H,context:ae},O.value=!0},N=()=>{O.value=!1},le=()=>{j.value=!1},re=async c=>{if(c&&c.commands&&n.value){const p=g.devices.findIndex(M=>M.id===n.value.id);p!==-1&&(g.devices[p].commands=c.commands,console.log(`Optimistically updated device ${n.value.id} with new command: ${c.commandName}`))}g.loadDevices(),y.value&&y.value.refresh()},q=c=>{const p=c.split("_"),M=[];for(let U=0;U<p.length;U++){const H=p[U],ae=p[U+1];H&&ae==="s"&&p[U+2]?(M.push(H.charAt(0).toUpperCase()+H.slice(1)+"'s"),U++):H!=="s"&&M.push(H.charAt(0).toUpperCase()+H.slice(1))}return M.join(" ")},C=(c,p)=>{const M=c.toLowerCase(),U=p.map(Q=>Q.toLowerCase());return M.includes("lamp")||M.includes("light")?"light":M.includes("fan")?"fan":M.includes("tv")||M.includes("stereo")||M.includes("speaker")||M.includes("receiver")?"media_player":M.includes("blind")||M.includes("curtain")||M.includes("shade")||M.includes("garage")?"cover":U.some(Q=>Q.includes("volume")||Q.includes("channel")||Q.includes("play")||Q.includes("pause")||Q.includes("mute"))?"media_player":U.some(Q=>Q.includes("fan_speed")||Q.includes("fan_low")||Q.includes("fan_high"))?"fan":U.some(Q=>Q.includes("open")||Q.includes("close")||Q.includes("stop"))?"cover":"switch"},se=(c,p)=>{const M=c.toLowerCase();return M.includes("tv")?"mdi:television":M.includes("stereo")||M.includes("receiver")||M.includes("speaker")?"mdi:speaker":M.includes("lamp")?"mdi:lamp":M.includes("light")?"mdi:lightbulb":M.includes("fan")?"mdi:fan":M.includes("blind")?"mdi:blinds":M.includes("curtain")?"mdi:curtains":M.includes("garage")?"mdi:garage":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:speaker",cover:"mdi:window-shutter"}[p]||"mdi:devices"},X=c=>{const p=c.toLowerCase().split("_");for(let H=0;H<p.length-2;H++)if(p[H+1]==="s"){const ae=p.slice(H,H+3),oe=q(ae.join("_"));return console.log("Detected possessive area:",oe,"from",c),oe}const M=[["living","room"],["dining","room"],["master","bedroom"],["guest","bedroom"],["family","room"],["laundry","room"],["home","office"]];for(let H=0;H<p.length-1;H++){const ae=[p[H],p[H+1]],oe=M.find(Q=>Q[0]===ae[0]&&Q[1]===ae[1]);if(oe)return q(oe.join("_"))}const U=["kitchen","bedroom","bathroom","garage","office","basement","attic","hallway","entryway","patio","deck","yard","garden"];for(const H of p)if(U.includes(H))return H.charAt(0).toUpperCase()+H.slice(1);return""},ie=async c=>{const p=q(c.device_name),M=X(c.device_name),U=C(c.device_name,c.commands),H=se(c.device_name,U);let ae="";try{console.log("Finding Broadlink owner for:",c.device_name);const Q=await ve.post("/api/devices/find-broadlink-owner",{device_name:c.device_name});console.log("Broadlink owner response:",Q.data),ae=Q.data.broadlink_entity||"",console.log("Detected Broadlink entity:",ae)}catch(Q){console.error("Error finding Broadlink owner:",Q)}n.value={id:null,device:c.device_name,name:p,entity_type:U,commands:{},area:M,icon:H,broadlink_entity:ae,enabled:!0};const oe={};c.commands.forEach(Q=>{oe[Q]=Q}),n.value.commands=oe,w.value=!0},A=async()=>{k.value=!0;try{await g.syncAllAreas(),r.success("Areas synced from Home Assistant")}catch(c){console.error("Error syncing areas:",c),r.error("Failed to sync areas")}finally{k.value=!1}},a=async()=>{var c,p;L.value=!0;try{const M=await ve.post("/api/entities/generate",{});if(M.data.success){const U=M.data.broadlink_count||0,H=M.data.smartir_count||0,ae=M.data.total_count||0,oe=M.data.errors||[];let Q="âœ… Entity Generation Successful",W=[];const ye=[];U>0&&ye.push(`${U} Broadlink native`),H>0&&ye.push(`${H} SmartIR`),ye.length>0&&W.push(`Generated ${ye.join(" and ")} entity configuration${ae!==1?"s":""}.`),U>0&&(W.push(`
ðŸ“ Broadlink entities created in:`),W.push("  â€¢ broadlink_manager/entities.yaml"),W.push("  â€¢ broadlink_manager/helpers.yaml")),H>0&&(W.push(`
ðŸ“ SmartIR entities created in:`),W.push("  â€¢ smartir/climate.yaml"),W.push("  â€¢ smartir/media_player.yaml"),W.push("  â€¢ smartir/fan.yaml")),W.push(`
ðŸ“ Next steps:`),W.push("1. Check your configuration.yaml includes the generated files"),W.push("2. Restart Home Assistant to load the new entities"),oe.length>0&&(Q="âš ï¸ Entity Generation Completed with Errors",W.push(`
âš ï¸ ${oe.length} error${oe.length!==1?"s":""} occurred:`),oe.forEach(xe=>{W.push(`  â€¢ ${xe}`)})),_.value={success:!0,title:Q,message:W.join(`
`)},j.value=!0}else _.value={success:!1,title:"âŒ Entity Generation Failed",message:M.data.message||`Failed to generate entities.

Please check that you have at least one device configured.`},j.value=!0}catch(M){console.error("Error generating entities:",M);const U=((p=(c=M.response)==null?void 0:c.data)==null?void 0:p.error)||M.message||"Unknown error occurred";_.value={success:!1,title:"âŒ Entity Generation Error",message:`Failed to generate entities:

${U}

Please check the logs for more details.`},j.value=!0}finally{L.value=!1}};return(c,p)=>{var M;return s(),i("div",xn,[e("div",Tn,[e("button",{class:"icon-button chevron-button",onClick:t},[e("i",{class:ee(["mdi",I.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2)]),e("div",{class:"header-left",onClick:t},[p[8]||(p[8]=e("div",{class:"header-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),p[9]||(p[9]=e("h3",null,"Managed Devices",-1)),e("div",Rn,[e("span",Mn,v(Se(g).deviceCount)+" devices",1)])]),e("div",Ln,[I.value?(s(),i("button",{key:0,onClick:pe(A,["stop"]),class:"btn btn-secondary",disabled:k.value,title:"Sync all areas from Home Assistant"},[e("i",{class:ee(["mdi",k.value?"mdi-loading mdi-spin":"mdi-refresh"])},null,2),D(" "+v(k.value?"Syncing...":"Sync Areas"),1)],8,On)):E("",!0),I.value?(s(),i("button",{key:1,onClick:pe(a,["stop"]),class:"btn btn-secondary",disabled:L.value,title:"Generate entities for all devices"},[e("i",{class:ee(["mdi",L.value?"mdi-loading mdi-spin":"mdi-file-code"])},null,2),D(" "+v(L.value?"Generating...":"Generate Entities"),1)],8,An)):E("",!0),I.value?(s(),i("button",{key:2,onClick:p[0]||(p[0]=pe(U=>w.value=!0,["stop"])),class:"btn btn-primary"},[...p[10]||(p[10]=[e("i",{class:"mdi mdi-plus"},null,-1),D(" Add Device ",-1)])])):E("",!0)])]),J(e("div",En,[fe(Dn,{ref_key:"discoveryRef",ref:y,onAdopt:ie},null,512),Se(g).hasDevices?(s(),i("div",Vn,[e("div",jn,[e("div",Un,[e("label",null,[p[11]||(p[11]=e("i",{class:"mdi mdi-magnify"},null,-1)),J(e("input",{"onUpdate:modelValue":p[1]||(p[1]=U=>o.value.search=U),type:"text",placeholder:"Search devices, commands...",class:"search-input"},null,512),[[_e,o.value.search]])])])]),e("div",Fn,[e("div",Pn,[e("label",null,[p[13]||(p[13]=e("i",{class:"mdi mdi-access-point"},null,-1)),J(e("select",{"onUpdate:modelValue":p[2]||(p[2]=U=>o.value.broadlinkDevice=U)},[p[12]||(p[12]=e("option",{value:""},"All Controller Devices",-1)),(s(!0),i(be,null,ke(ne.value,U=>(s(),i("option",{key:U.entity_id,value:U.entity_id},v(U.friendly_name),9,Nn))),128))],512),[[$e,o.value.broadlinkDevice]])])]),e("div",Bn,[e("label",null,[p[15]||(p[15]=e("i",{class:"mdi mdi-home-map-marker"},null,-1)),J(e("select",{"onUpdate:modelValue":p[3]||(p[3]=U=>o.value.area=U)},[p[14]||(p[14]=e("option",{value:""},"All Areas",-1)),(s(!0),i(be,null,ke(te.value,U=>(s(),i("option",{key:U,value:U},v(U),9,qn))),128))],512),[[$e,o.value.area]])])]),e("div",Hn,[e("label",null,[p[17]||(p[17]=e("i",{class:"mdi mdi-shape"},null,-1)),J(e("select",{"onUpdate:modelValue":p[4]||(p[4]=U=>o.value.entityType=U)},[...p[16]||(p[16]=[Me('<option value="" data-v-d5ce8664>All Types</option><option value="light" data-v-d5ce8664>Light</option><option value="fan" data-v-d5ce8664>Fan</option><option value="switch" data-v-d5ce8664>Switch</option><option value="media_player" data-v-d5ce8664>Media Player</option><option value="cover" data-v-d5ce8664>Cover</option><option value="climate" data-v-d5ce8664>Climate</option>',7)])],512),[[$e,o.value.entityType]])])]),Y.value?(s(),i("div",zn,[e("label",Jn,[p[18]||(p[18]=e("span",{class:"toggle-text"},[e("img",{src:Ne,alt:"SmartIR",class:"smartir-icon"}),D(" SmartIR Only ")],-1)),J(e("input",{type:"checkbox","onUpdate:modelValue":p[5]||(p[5]=U=>o.value.showSmartIROnly=U),class:"toggle-checkbox"},null,512),[[ce,o.value.showSmartIROnly]]),p[19]||(p[19]=e("span",{class:"toggle-slider"},null,-1))])])):E("",!0),T.value?(s(),i("button",{key:1,onClick:F,class:"btn-clear-filters"},[...p[20]||(p[20]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),D(" Clear ",-1)])])):E("",!0),e("div",Wn,v(ge.value.length)+" of "+v(Se(g).deviceCount),1)])])):E("",!0),Se(g).loading?(s(),i("div",Gn,[...p[21]||(p[21]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading devices...",-1)])])):Se(g).error?(s(),i("div",Kn,[p[22]||(p[22]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,v(Se(g).error),1),e("button",{onClick:p[6]||(p[6]=U=>Se(g).loadDevices()),class:"btn btn-secondary"}," Retry ")])):Se(g).hasDevices?(s(),i("div",Yn,[(s(!0),i(be,null,ke(ge.value,U=>(s(),Te(xt,{key:U.id,device:U,"broadlink-devices":m.value,onEdit:de,onDelete:G,onLearn:ue},null,8,["device","broadlink-devices"]))),128))])):(s(),i("div",Xn,[p[24]||(p[24]=e("i",{class:"mdi mdi-devices"},null,-1)),p[25]||(p[25]=e("h3",null,"No Devices Yet",-1)),p[26]||(p[26]=e("p",null,"Get started by adding your first managed device",-1)),e("button",{onClick:p[7]||(p[7]=U=>w.value=!0),class:"btn btn-primary"},[...p[23]||(p[23]=[e("i",{class:"mdi mdi-plus"},null,-1),D(" Add Your First Device ",-1)])])])),Se(g).hasDevices&&ge.value.length===0?(s(),i("div",Zn,[...p[27]||(p[27]=[e("i",{class:"mdi mdi-filter-off"},null,-1),e("h3",null,"No devices match your filters",-1),e("p",null,"Try adjusting your search or filter criteria",-1)])])):E("",!0)],512),[[Ge,I.value]]),w.value?(s(),Te(el,{key:0,device:n.value,onSave:V,onCancel:K},null,8,["device"])):E("",!0),h.value?(s(),Te(zl,{key:1,device:n.value,onLearned:re,onCancel:R},null,8,["device"])):E("",!0),fe(Re,{isOpen:$.value,title:`Delete ${(M=f.value)==null?void 0:M.name}?`,message:he.value,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,checkboxLabel:Ie.value,onConfirm:S,onCancel:x},null,8,["isOpen","title","message","checkboxLabel"]),fe(ln,{isOpen:O.value,title:B.value.title,message:B.value.message,suggestion:B.value.suggestion,details:B.value.details,error:B.value.error,context:B.value.context,onClose:N},null,8,["isOpen","title","message","suggestion","details","error","context"]),fe(Re,{isOpen:j.value,title:_.value.title,message:_.value.message,confirmText:"OK",showCancel:!1,dangerMode:!_.value.success,onConfirm:le,onCancel:le},null,8,["isOpen","title","message","dangerMode"])])}}},es=we(Qn,[["__scopeId","data-v-d5ce8664"]]),ts={class:"banner-content"},os={class:"banner-icon"},ls={class:"banner-message"},ns={class:"banner-actions"},ss={__name:"SmartIRBanner",setup(l){const g=Ce("smartirStatus"),r=b(!1),w=z(()=>!(!g.value||r.value||localStorage.getItem("smartir_banner_dismissed")==="true")),h=z(()=>{var L;return(L=g.value)!=null&&L.installed?"banner-success":"banner-info"}),n=z(()=>{var L;return(L=g.value)!=null&&L.installed?"mdi mdi-check-circle":"mdi mdi-information"}),$=z(()=>{var L;return(L=g.value)!=null&&L.installed?`SmartIR Detected (v${g.value.version})`:"Want Climate Device Support?"}),f=z(()=>{var L;return(L=g.value)!=null&&L.installed?"You can now create climate device profiles with full temperature and HVAC mode control.":"Install SmartIR to unlock AC/heater control with temperature settings, HVAC modes, and 120+ pre-configured device profiles."});function y(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function I(){var L;if(r.value=!0,(L=g.value)!=null&&L.installed)localStorage.setItem("smartir_banner_dismissed","true");else{const k=parseInt(localStorage.getItem("smartir_banner_dismiss_count")||"0");k>=2?localStorage.setItem("smartir_banner_dismissed","true"):localStorage.setItem("smartir_banner_dismiss_count",String(k+1))}}return De(()=>{var t;const L=localStorage.getItem("smartir_last_status"),k=(t=g.value)!=null&&t.installed?"installed":"not_installed";L!==k&&(localStorage.removeItem("smartir_banner_dismissed"),localStorage.removeItem("smartir_banner_dismiss_count"),localStorage.setItem("smartir_last_status",k))}),(L,k)=>{var t,O;return w.value?(s(),i("div",{key:0,class:ee(["smartir-banner",h.value])},[e("div",ts,[e("div",os,[e("i",{class:ee(n.value)},null,2)]),e("div",ls,[e("strong",null,v($.value),1),e("p",null,v(f.value),1)]),e("div",ns,[(t=L.status)!=null&&t.installed?E("",!0):(s(),i("button",{key:0,onClick:y,class:"btn-primary"}," Learn More ")),e("button",{onClick:I,class:"btn-text"},v((O=L.status)!=null&&O.installed?"Got it":"Dismiss"),1)])])],2)):E("",!0)}}},as=we(ss,[["__scopeId","data-v-7bbcbcd7"]]),Oe="api/smartir",Xe={async getStatus(){try{const l=await fetch(`${Oe}/status`);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){return console.error("Error fetching SmartIR status:",l),{installed:!1,version:null,error:l.message}}},async getInstallInstructions(){try{const l=await fetch(`${Oe}/install-instructions`);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){throw console.error("Error fetching install instructions:",l),l}},async getPlatforms(){try{const l=await fetch(`${Oe}/platforms`);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){throw console.error("Error fetching platforms:",l),l}},async getPlatformCodes(l){try{const g=await fetch(`${Oe}/platforms/${l}/codes`);if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);return await g.json()}catch(g){throw console.error(`Error fetching codes for ${l}:`,g),g}},async getNextCode(l){try{const g=await fetch(`${Oe}/platforms/${l}/next-code`);if(!g.ok)throw new Error(`HTTP error! status: ${g.status}`);return await g.json()}catch(g){throw console.error(`Error fetching next code for ${l}:`,g),g}},async validateCode(l,g){try{const r=await fetch(`${Oe}/validate-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:l,code:g})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){throw console.error("Error validating code:",r),r}}},is={class:"profile-card"},rs={class:"profile-card-header"},ds=["title"],us={class:"profile-details"},cs=["title"],ms={class:"profile-meta"},vs=["title"],ps=["title"],fs=["title"],gs={class:"profile-card-footer"},ys=["title"],bs={key:0,class:"learned-indicator"},hs={class:"profile-actions"},ks={__name:"SmartIRProfileCard",props:{profile:{type:Object,required:!0}},emits:["edit","download","delete","commands"],setup(l){const g=l,r=Ke(z(()=>g.profile.platform)),w=z(()=>g.profile.wizardCreated===!0),h=f=>f.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase()),n=f=>f&&f.startsWith("mdi:")?`mdi ${f.replace(":"," mdi-")}`:`mdi mdi-${f}`,$=f=>{if(!f)return"";const y=f.toLowerCase();return y.includes("broadlink")?"broadlink-tag":y.includes("not set")?"not-set-tag":"default-controller-tag"};return(f,y)=>(s(),i("div",is,[e("div",rs,[e("div",{class:ee(["profile-icon",Se(r).colorClass.value]),title:h(l.profile.platform)},[e("i",{class:ee(n(Se(r).icon.value))},null,2)],10,ds),e("div",us,[e("h4",{title:`${l.profile.manufacturer} ${l.profile.model}`},v(l.profile.manufacturer)+" "+v(l.profile.model),9,cs),e("div",ms,[e("span",{class:"tag platform-tag",title:h(l.profile.platform)},v(h(l.profile.platform)),9,vs),l.profile.controllerBrand?(s(),i("span",{key:0,class:ee(["tag controller-tag",$(l.profile.controllerBrand)]),title:"Controller: "+l.profile.controllerBrand},[y[4]||(y[4]=e("i",{class:"mdi mdi-remote-tv"},null,-1)),D(" "+v(l.profile.controllerBrand),1)],10,ps)):E("",!0)])]),e("div",{class:"code-badge",title:"Device Code: "+l.profile.code},v(l.profile.code),9,fs)]),e("div",gs,[e("div",{class:"profile-stats",title:l.profile.commandCount+" total commands"+(l.profile.learnedCount>0?", "+l.profile.learnedCount+" learned":"")},[y[5]||(y[5]=e("i",{class:"mdi mdi-remote"},null,-1)),e("span",null,v(l.profile.commandCount)+" command"+v(l.profile.commandCount!==1?"s":""),1),l.profile.learnedCount>0?(s(),i("span",bs,"( "+v(l.profile.learnedCount)+" learned )",1)):E("",!0)],8,ys),e("div",hs,[e("button",{onClick:y[0]||(y[0]=I=>f.$emit("commands")),class:"action-btn",title:"Commands"},[...y[6]||(y[6]=[e("i",{class:"mdi mdi-remote-tv"},null,-1)])]),w.value?(s(),i("button",{key:0,onClick:y[1]||(y[1]=I=>f.$emit("edit")),class:"action-btn",title:"Edit Profile"},[...y[7]||(y[7]=[e("i",{class:"mdi mdi-pencil"},null,-1)])])):E("",!0),e("button",{onClick:y[2]||(y[2]=I=>f.$emit("download")),class:"action-btn",title:"Download JSON"},[...y[8]||(y[8]=[e("i",{class:"mdi mdi-download"},null,-1)])]),e("button",{onClick:y[3]||(y[3]=I=>f.$emit("delete")),class:"action-btn delete",title:"Delete Profile"},[...y[9]||(y[9]=[e("i",{class:"mdi mdi-delete"},null,-1)])])])])]))}},ws=we(ks,[["__scopeId","data-v-302fbb40"]]),$s={class:"modal-container"},Cs={class:"modal-body"},Ss={key:0,class:"selection-section"},_s={class:"form-group"},Is={class:"form-group"},Ds={class:"form-group"},xs={key:0,class:"code-info"},Ts={class:"form-actions"},Rs=["disabled"],Ms={key:1,class:"testing-section"},Ls={class:"code-header"},Os={class:"code-details"},As={class:"code-badge"},Es={class:"device-selector"},Vs=["value"],js={class:"commands-section"},Us={class:"commands-header"},Fs={key:0,class:"tested-count"},Ps={key:0,class:"filters-section"},Ns={class:"filter-row"},Bs={class:"filter-row"},qs={key:1,class:"empty-state"},Hs={key:2,class:"empty-state"},zs={key:3,class:"commands-list"},Js={class:"command-name"},Ws={class:"command-actions"},Gs={key:0,class:"status-badge success"},Ks=["onClick","disabled"],Xs={__name:"SmartIRCodeTester",props:{isOpen:{type:Boolean,default:!1}},emits:["close","clone"],setup(l,{emit:g}){const r=l,w=g,h=Ce("toast"),n=b("climate"),$=b(""),f=b([]),y=b(!1),I=b(null),L=b(""),k=b([]),t=b(!1),O=z(()=>k.value.map(q=>({code:q.code,label:`${q.models.join(", ")} (Code: ${q.code})`,value:q.code}))),B=b(null),j=b(null),_=b(!1),o=b([]),m=b(""),u=b([]),P=b(new Set),Y=b(null),ne=b(""),te=b(""),ge=b(""),T=b(""),F=z(()=>{let q=u.value;if(ne.value){const C=ne.value.toLowerCase();q=q.filter(se=>(se.label||se.name).toLowerCase().includes(C))}return te.value&&(q=q.filter(C=>C.mode===te.value)),ge.value&&(q=q.filter(C=>C.fanSpeed===ge.value)),T.value&&(q=q.filter(C=>C.swingMode===T.value)),q}),Z=z(()=>ne.value||te.value||ge.value||T.value);me(()=>r.isOpen,q=>{q&&(de(),Ie())}),me(n,()=>{r.isOpen&&($.value="",I.value=null,k.value=[],de())});async function de(){var q;y.value=!0;try{const C=await fetch(`/api/smartir/codes/manufacturers?entity_type=${n.value}`);if(!C.ok)throw new Error("Failed to load manufacturers");const se=await C.json();f.value=se.manufacturers||[]}catch(C){console.error("Error loading manufacturers:",C),(q=h.value)==null||q.error("Failed to load manufacturers","âŒ Error")}finally{y.value=!1}}async function he(){var q;if($.value){t.value=!0;try{const C=await fetch(`/api/smartir/codes/models?entity_type=${n.value}&manufacturer=${encodeURIComponent($.value)}`);if(!C.ok)throw new Error("Failed to load models");const se=await C.json();k.value=se.models||[]}catch(C){console.error("Error loading models:",C),(q=h.value)==null||q.error("Failed to load models","âŒ Error")}finally{t.value=!1}}}async function Ie(){try{const q=await fetch("/api/remote/devices");if(!q.ok)throw new Error("Failed to load devices");const C=await q.json();o.value=C.devices||[]}catch(q){console.error("Error loading Broadlink devices:",q)}}async function G(){var q,C;if(I.value){_.value=!0;try{const se=await fetch(`/api/smartir/codes/code?entity_type=${n.value}&code_id=${I.value.code}`);if(!se.ok)throw new Error("Failed to load code");const X=await se.json();j.value=X.code,B.value=I.value.code,x(X.code),(q=h.value)==null||q.success(`Loaded ${u.value.length} commands`,"âœ… Code Loaded")}catch(se){console.error("Error loading code:",se),(C=h.value)==null||C.error(se.message||"Failed to load code","âŒ Error")}finally{_.value=!1}}}function x(q){const C=[];if(!q.commands){u.value=C;return}if(n.value==="climate"){const X=q.commands;for(const[ie,A]of Object.entries(X)){if(ie==="off"){typeof A=="string"&&C.push({name:"off",label:"OFF",data:A,mode:"off"});continue}if(typeof A=="object"){for(const[a,c]of Object.entries(A))if(typeof c=="object")for(const[p,M]of Object.entries(c)){if(typeof M!="object")continue;const U=Object.keys(M),H=U.includes("24")?"24":U[0];if(H&&typeof M[H]=="string"){const ae=`${ie}_${H}_${a}_${p}`,oe=`${ie.toUpperCase()} ${H}Â°C ${a} ${p}`;C.push({name:ae,label:oe,data:M[H],mode:ie,temperature:H,fanSpeed:a,swingMode:p})}}}}}else for(const[X,ie]of Object.entries(q.commands))typeof ie=="string"&&C.push({name:X,label:X.toUpperCase().replace(/_/g," "),data:ie});u.value=C}async function S(q){var C,se,X;if(!m.value){(C=h.value)==null||C.warning("Please select a Broadlink device first","âš ï¸ No Device");return}Y.value=q;try{const ie=u.value.find(a=>a.name===q);if(!ie||!ie.data)throw new Error(`Command "${q}" not found`);const A=await fetch("/api/commands/send-raw",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_id:m.value,command:ie.data,command_type:"ir"})});if(!A.ok){const a=await A.json();throw new Error(a.error||"Failed to send command")}P.value.add(q),(se=h.value)==null||se.success(`Command sent: ${ie.label||q}`,"âœ… Tested")}catch(ie){console.error("Error testing command:",ie),(X=h.value)==null||X.error("Failed to test command","âŒ Error")}finally{Y.value=null}}function V(){var q,C,se,X;if(!j.value){(q=h.value)==null||q.error("No profile data to download","âŒ Error");return}try{const ie=j.value.manufacturer||"unknown",A=((C=j.value.supportedModels)==null?void 0:C[0])||B.value,a=`${ie.toLowerCase().replace(/\s+/g,"_")}_${A.toLowerCase().replace(/\s+/g,"_")}.json`,c=JSON.stringify(j.value,null,2),p=new Blob([c],{type:"application/json"}),M=URL.createObjectURL(p),U=document.createElement("a");U.href=M,U.download=a,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(M),(se=h.value)==null||se.success(`Downloaded ${a}`,"âœ… Download Complete")}catch(ie){console.error("Error downloading JSON:",ie),(X=h.value)==null||X.error(ie.message||"Failed to download JSON","âŒ Download Error")}}function K(){$.value="",I.value=null,L.value="",k.value=[]}function ue(){I.value=null,L.value="",he()}function R(){L.value?I.value=k.value.find(q=>q.code===L.value):I.value=null}function d(){ne.value="",te.value="",ge.value="",T.value=""}function N(){B.value=null,j.value=null,u.value=[],P.value.clear(),Y.value=null,d()}function le(q){const C=q.toLowerCase();return C.includes("power")||C.includes("off")||C==="off"?"mdi-power":C.includes("cool")?"mdi-snowflake":C.includes("heat")?"mdi-fire":C.includes("fan")?"mdi-fan":C.includes("auto")?"mdi-auto-fix":C.includes("dry")?"mdi-water-percent":C.includes("temp")?"mdi-thermometer":C.includes("swing")?"mdi-swap-vertical":"mdi-remote"}function re(){N(),$.value="",I.value=null,w("close")}return(q,C)=>{var se;return l.isOpen?(s(),i("div",{key:0,class:"modal-overlay",onClick:pe(re,["self"])},[e("div",$s,[e("div",{class:"modal-header"},[C[9]||(C[9]=e("h3",null,[e("i",{class:"mdi mdi-test-tube"}),D(" Test SmartIR Code ")],-1)),e("button",{onClick:re,class:"close-btn"},[...C[8]||(C[8]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Cs,[B.value?(s(),i("div",Ms,[e("div",Ls,[e("div",Os,[e("h4",null,v(j.value.manufacturer)+" - "+v(((se=j.value.supportedModels)==null?void 0:se[0])||"Unknown"),1),e("span",As,"Code: "+v(B.value),1)]),e("button",{onClick:N,class:"btn-secondary-small"},[...C[14]||(C[14]=[e("i",{class:"mdi mdi-arrow-left"},null,-1),D(" Change Code ",-1)])])]),e("div",Es,[C[16]||(C[16]=e("label",null,[e("i",{class:"mdi mdi-remote"}),D(" Broadlink Device ")],-1)),J(e("select",{"onUpdate:modelValue":C[3]||(C[3]=X=>m.value=X),class:"form-select"},[C[15]||(C[15]=e("option",{value:""},"Select device to test with...",-1)),(s(!0),i(be,null,ke(o.value,X=>(s(),i("option",{key:X.entity_id,value:X.entity_id},v(X.friendly_name||X.entity_id),9,Vs))),128))],512),[[$e,m.value]])]),e("div",js,[e("div",Us,[e("h5",null,"Sample Commands ("+v(F.value.length)+" / "+v(u.value.length)+")",1),P.value.size>0?(s(),i("span",Fs,v(P.value.size)+" tested ",1)):E("",!0)]),n.value==="climate"&&u.value.length>0?(s(),i("div",Ps,[e("div",Ns,[J(e("input",{"onUpdate:modelValue":C[4]||(C[4]=X=>ne.value=X),type:"text",placeholder:"Search commands...",class:"search-input"},null,512),[[_e,ne.value]])]),e("div",Bs,[J(e("select",{"onUpdate:modelValue":C[5]||(C[5]=X=>te.value=X),class:"filter-select"},[...C[17]||(C[17]=[e("option",{value:""},"All Modes",-1),e("option",{value:"cool"},"Cool",-1),e("option",{value:"heat"},"Heat",-1),e("option",{value:"off"},"Off",-1)])],512),[[$e,te.value]]),J(e("select",{"onUpdate:modelValue":C[6]||(C[6]=X=>ge.value=X),class:"filter-select"},[...C[18]||(C[18]=[Me('<option value="" data-v-06deb9e0>All Fan Speeds</option><option value="low" data-v-06deb9e0>Low</option><option value="mid" data-v-06deb9e0>Mid</option><option value="high" data-v-06deb9e0>High</option><option value="auto" data-v-06deb9e0>Auto</option>',5)])],512),[[$e,ge.value]]),J(e("select",{"onUpdate:modelValue":C[7]||(C[7]=X=>T.value=X),class:"filter-select"},[...C[19]||(C[19]=[e("option",{value:""},"All Swing",-1),e("option",{value:"stop"},"Stop",-1),e("option",{value:"swing"},"Swing",-1)])],512),[[$e,T.value]]),Z.value?(s(),i("button",{key:0,onClick:d,class:"btn-clear-filters"},[...C[20]||(C[20]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),D(" Clear ",-1)])])):E("",!0)])])):E("",!0),u.value.length===0?(s(),i("div",qs,[...C[21]||(C[21]=[e("i",{class:"mdi mdi-alert-circle"},null,-1),e("p",null,"No commands found in this code",-1)])])):F.value.length===0?(s(),i("div",Hs,[C[22]||(C[22]=e("i",{class:"mdi mdi-filter-off"},null,-1)),C[23]||(C[23]=e("p",null,"No commands match your filters",-1)),e("button",{onClick:d,class:"btn-secondary-small"}," Clear Filters ")])):(s(),i("div",zs,[(s(!0),i(be,null,ke(F.value,X=>(s(),i("div",{key:X.name,class:ee(["command-item",{tested:P.value.has(X.name),testing:Y.value===X.name}])},[e("div",Js,[e("i",{class:ee(["mdi",le(X.mode||X.name)])},null,2),e("span",null,v(X.label||X.name),1)]),e("div",Ws,[P.value.has(X.name)?(s(),i("span",Gs,[...C[24]||(C[24]=[e("i",{class:"mdi mdi-check"},null,-1),D(" Tested ",-1)])])):E("",!0),e("button",{onClick:ie=>S(X.name),disabled:!m.value||Y.value===X.name,class:"btn-test"},[e("i",{class:ee(["mdi",Y.value===X.name?"mdi-loading mdi-spin":"mdi-play"])},null,2),C[25]||(C[25]=D(" Test ",-1))],8,Ks)])],2))),128))]))]),e("div",{class:"modal-actions"},[e("button",{onClick:V,class:"btn-primary"},[...C[26]||(C[26]=[e("i",{class:"mdi mdi-download"},null,-1),D(" Download JSON ",-1)])]),e("button",{onClick:re,class:"btn-secondary"}," Close ")])])):(s(),i("div",Ss,[C[13]||(C[13]=e("div",{class:"info-banner"},[e("i",{class:"mdi mdi-information"}),e("p",null,"Select a SmartIR code from the index to test commands with your Broadlink device.")],-1)),e("div",_s,[C[11]||(C[11]=e("label",null,[e("i",{class:"mdi mdi-shape"}),D(" Platform ")],-1)),J(e("select",{"onUpdate:modelValue":C[0]||(C[0]=X=>n.value=X),onChange:K,class:"form-select"},[...C[10]||(C[10]=[e("option",{value:"climate"},"Climate (AC/Heater)",-1),e("option",{value:"media_player"},"Media Player (TV/Audio)",-1),e("option",{value:"fan"},"Fan",-1),e("option",{value:"light"},"Light",-1)])],544),[[$e,n.value]])]),e("div",Is,[fe(Ue,{modelValue:$.value,"onUpdate:modelValue":C[1]||(C[1]=X=>$.value=X),options:f.value,label:"Manufacturer",placeholder:"Search manufacturers...",loading:y.value,disabled:y.value,onChange:ue},null,8,["modelValue","options","loading","disabled"])]),e("div",Ds,[fe(Ue,{modelValue:L.value,"onUpdate:modelValue":C[2]||(C[2]=X=>L.value=X),options:O.value,"option-label":"label","option-value":"code",label:"Model",placeholder:"Search models...",loading:t.value,disabled:!$.value||t.value,onChange:R},null,8,["modelValue","options","loading","disabled"])]),I.value?(s(),i("div",xs,[C[12]||(C[12]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[e("strong",null,v($.value)+" - "+v(I.value.models[0]),1),e("p",null,"Code: "+v(I.value.code),1)])])):E("",!0),e("div",Ts,[e("button",{onClick:G,disabled:!I.value||_.value,class:"btn-primary"},[e("i",{class:ee(["mdi",_.value?"mdi-loading mdi-spin":"mdi-download"])},null,2),D(" "+v(_.value?"Loading...":"Load Commands"),1)],8,Rs)])]))])])])):E("",!0)}}},Ys=we(Xs,[["__scopeId","data-v-06deb9e0"]]),Zs={class:"smartir-status-card"},Qs={class:"card-header"},ea=["src"],ta={class:"header-badges"},oa=["title"],la={class:"header-info"},na={class:"header-info"},sa={class:"header-info"},aa={class:"header-right"},ia={key:0,class:"card-body loading-state"},ra={key:1,class:"card-body error-state"},da={key:2,class:"card-body installed-state"},ua={key:0,class:"help-panel"},ca={key:0,class:"recommendation"},ma={key:0,class:"next-steps"},va={key:1,class:"filter-bar"},pa={class:"filter-row"},fa={class:"filter-group filter-search"},ga={class:"filter-group"},ya={class:"filter-results"},ba={key:2,class:"loading-state"},ha={key:3,class:"empty-state"},ka={key:4,class:"profiles-grid"},wa={key:5,class:"no-results"},$a={key:3,class:"card-body not-installed-state"},Ca={class:"benefits-section"},Sa={class:"benefits-list"},_a={class:"recommendation"},Ia={__name:"SmartIRStatusCard",emits:["create-profile","show-install-guide","edit-profile"],setup(l,{expose:g,emit:r}){const w=r,h=Ce("smartirStatus");Ce("smartirEnabled");const n=Ce("refreshSmartIR"),$=b(!1),f=b(null),y=b((h==null?void 0:h.value)||null),I=b(localStorage.getItem("smartir_simulate_not_installed")==="true"),L=b(!1),k=b(!0),t=b([]),O=b(!1),B=b({search:"",platform:""}),j=b({show:!1,title:"",message:"",platform:null,profile:null}),_=b(!1),o=["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"],m=["climate","media_player","fan","light"],u=z(()=>I.value?{installed:!1,recommendation:{message:"Install SmartIR to unlock climate device support!",benefits:["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"]}}:y.value),P=z(()=>{var R,d;return((d=(R=u.value)==null?void 0:R.platforms)==null?void 0:d.length)||0}),Y=z(()=>{var R;return(R=u.value)!=null&&R.device_counts?Object.values(u.value.device_counts).reduce((d,N)=>d+N,0):0});function ne(){var R;I.value=!I.value,localStorage.setItem("smartir_simulate_not_installed",I.value.toString()),!I.value&&((R=y.value)!=null&&R.installed)&&x()}const te=z(()=>{let R=t.value;if(B.value.search){const d=B.value.search.toLowerCase();R=R.filter(N=>{var le,re,q,C;return((le=N.manufacturer)==null?void 0:le.toLowerCase().includes(d))||((re=N.model)==null?void 0:re.toLowerCase().includes(d))||((q=N.code)==null?void 0:q.toString().includes(d))||((C=N.platform)==null?void 0:C.toLowerCase().includes(d))})}return B.value.platform&&(R=R.filter(d=>d.platform===B.value.platform)),R}),ge=z(()=>B.value.search||B.value.platform);function T(){B.value.search="",B.value.platform=""}async function F(){$.value=!0,f.value=null;try{if(n)await n();else{const R=await Xe.getStatus();y.value=R}}catch(R){f.value=R.message||"Failed to refresh SmartIR status",console.error("Error refreshing SmartIR status:",R)}finally{$.value=!1}}function Z(){w("create-profile")}function de(){_.value=!0}function he(){w("show-install-guide")}function Ie(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function G(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}async function x(){O.value=!0;const R=[];try{for(const d of m)try{const N=await fetch(`api/smartir/platforms/${d}/profiles`);if(N.ok){const re=((await N.json()).profiles||[]).map(q=>({...q,platform:d}));R.push(...re)}}catch(N){console.error(`Error loading ${d} profiles:`,N)}t.value=R}finally{O.value=!1}}function S(R,d,N){w("edit-profile",{platform:R,profile:d,startStep:N})}async function V(R,d){var N,le;try{const re=await fetch(`api/smartir/platforms/${R}/profiles/${d.code}`);if(!re.ok)throw new Error("Failed to fetch profile");const q=await re.json(),C=JSON.stringify(q.profile,null,2),se=new Blob([C],{type:"application/json"}),X=URL.createObjectURL(se),ie=document.createElement("a");ie.href=X,ie.download=`smartir_${R}_${d.manufacturer}_${d.model}_${d.code}.json`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(X),(N=Ce("toast").value)==null||N.success(`Downloaded ${d.manufacturer} ${d.model}`,"âœ… Profile Downloaded")}catch(re){console.error("Error downloading profile:",re),(le=Ce("toast").value)==null||le.error("Failed to download profile","âŒ Download Error")}}function K(R,d){j.value={show:!0,title:`Delete ${d.manufacturer} ${d.model}?`,message:`Device Code: ${d.code}

This will remove the profile and update your configuration.`,platform:R,profile:d}}async function ue(){var le,re,q;const R=Ce("toast"),{platform:d,profile:N}=j.value;j.value.show=!1;try{const C=await fetch(`api/smartir/profiles/${N.code}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:d})});if(C.ok)await x(),await Je(),await F(),(le=R.value)==null||le.success(`${N.manufacturer} ${N.model} has been removed`,"âœ… Profile Deleted");else{const se=await C.json();(re=R.value)==null||re.error(se.error||"Unknown error","âŒ Delete Failed")}}catch(C){console.error("Error deleting profile:",C),(q=R.value)==null||q.error("Failed to delete profile","âŒ Delete Error")}}return me(h,R=>{R&&(y.value=R)},{immediate:!0}),De(async()=>{var R;h!=null&&h.value&&(y.value=h.value),y.value||await F(),(R=y.value)!=null&&R.installed&&await x()}),g({loadAllProfiles:x,refreshStatus:F}),(R,d)=>{var N,le,re,q,C,se,X,ie,A,a;return s(),i("div",Zs,[e("div",Qs,[e("button",{class:"icon-button chevron-button",onClick:d[0]||(d[0]=c=>k.value=!k.value)},[e("i",{class:ee(["mdi",k.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2)]),e("div",{class:"header-left",onClick:d[1]||(d[1]=c=>k.value=!k.value)},[e("img",{src:Se(Ne),alt:"SmartIR",class:"smartir-logo"},null,8,ea),d[8]||(d[8]=e("h3",null,"SmartIR Integration",-1)),e("div",ta,[e("div",{class:ee(["simulation-toggle-pill",{active:I.value}]),onClick:pe(ne,["stop"]),title:I.value?"Click to show as installed":"Click to simulate not-installed"},[e("i",{class:ee(["mdi",I.value?"mdi-eye-off":"mdi-eye"])},null,2),e("span",null,v(I.value?"Simulating: Not Installed":"Simulation Mode"),1)],10,oa),(N=u.value)!=null&&N.installed?(s(),i(be,{key:0},[d[7]||(d[7]=e("div",{class:"status-badge-mini success"},[e("i",{class:"mdi mdi-check-circle"}),e("span",null,"Installed")],-1)),e("span",la,"v"+v(u.value.version||"Unknown"),1),e("span",na,v(P.value)+" platform"+v(P.value!==1?"s":""),1),e("span",sa,v(Y.value)+" device"+v(Y.value!==1?"s":""),1)],64)):E("",!0)])]),e("div",aa,[(le=y.value)!=null&&le.installed&&k.value?(s(),i("button",{key:0,onClick:d[2]||(d[2]=pe(c=>L.value=!L.value,["stop"])),class:ee(["icon-button",{active:L.value}]),title:"Show help"},[...d[9]||(d[9]=[e("i",{class:"mdi mdi-help-circle"},null,-1)])],2)):E("",!0),(re=y.value)!=null&&re.installed&&k.value?(s(),i("button",{key:1,onClick:pe(F,["stop"]),class:"icon-button",title:"Refresh status"},[...d[10]||(d[10]=[e("i",{class:"mdi mdi-refresh"},null,-1)])])):E("",!0),(q=y.value)!=null&&q.installed&&k.value?(s(),i("button",{key:2,onClick:pe(de,["stop"]),class:"btn btn-secondary"},[...d[11]||(d[11]=[e("i",{class:"mdi mdi-test-tube"},null,-1),D(" Test Codes ",-1)])])):E("",!0),(C=y.value)!=null&&C.installed&&k.value?(s(),i("button",{key:3,onClick:pe(Z,["stop"]),class:"btn btn-primary"},[...d[12]||(d[12]=[e("i",{class:"mdi mdi-plus"},null,-1),D(" Create SmartIR Profile ",-1)])])):E("",!0)])]),J(e("div",null,[$.value?(s(),i("div",ia,[...d[13]||(d[13]=[e("div",{class:"spinner"},null,-1),e("p",null,"Checking SmartIR installation...",-1)])])):f.value?(s(),i("div",ra,[d[14]||(d[14]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,v(f.value),1),e("button",{onClick:F,class:"btn-secondary"}," Try Again ")])):(se=u.value)!=null&&se.installed?(s(),i("div",da,[L.value?(s(),i("div",ua,[y.value.recommendation?(s(),i("div",ca,[e("p",null,v(y.value.recommendation.message),1),y.value.recommendation.next_steps?(s(),i("div",ma,[d[15]||(d[15]=e("strong",null,"Next Steps:",-1)),e("ul",null,[(s(!0),i(be,null,ke(y.value.recommendation.next_steps,(c,p)=>(s(),i("li",{key:p},v(c),1))),128))])])):E("",!0)])):E("",!0),e("div",{class:"help-actions"},[e("button",{onClick:Ie,class:"btn-secondary"},[...d[16]||(d[16]=[e("i",{class:"mdi mdi-book-open-variant"},null,-1),D(" View Documentation ",-1)])])])])):E("",!0),t.value.length>0&&!I.value?(s(),i("div",va,[e("div",pa,[e("div",fa,[e("label",null,[d[17]||(d[17]=e("i",{class:"mdi mdi-magnify"},null,-1)),J(e("input",{"onUpdate:modelValue":d[3]||(d[3]=c=>B.value.search=c),type:"text",placeholder:"Search profiles...",class:"search-input"},null,512),[[_e,B.value.search]])])]),e("div",ga,[e("label",null,[d[19]||(d[19]=e("i",{class:"mdi mdi-shape"},null,-1)),J(e("select",{"onUpdate:modelValue":d[4]||(d[4]=c=>B.value.platform=c)},[...d[18]||(d[18]=[Me('<option value="" data-v-4c696eec>All Platforms</option><option value="climate" data-v-4c696eec>Climate</option><option value="media_player" data-v-4c696eec>Media Player</option><option value="fan" data-v-4c696eec>Fan</option><option value="light" data-v-4c696eec>Light</option>',5)])],512),[[$e,B.value.platform]])])]),ge.value?(s(),i("button",{key:0,onClick:T,class:"btn-clear-filters"},[...d[20]||(d[20]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),D(" Clear ",-1)])])):E("",!0),e("div",ya,v(te.value.length)+" of "+v(t.value.length),1)])])):E("",!0),O.value?(s(),i("div",ba,[...d[21]||(d[21]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading profiles...",-1)])])):t.value.length===0?(s(),i("div",ha,[...d[22]||(d[22]=[e("i",{class:"mdi mdi-file-document-outline"},null,-1),e("h3",null,"No Profiles Yet",-1),e("p",null,"Create your first SmartIR profile to get started",-1)])])):I.value?E("",!0):(s(),i("div",ka,[(s(!0),i(be,null,ke(te.value,c=>(s(),Te(ws,{key:`${c.platform}-${c.code}`,profile:c,onEdit:p=>S(c.platform,c),onCommands:p=>S(c.platform,c,2),onDownload:p=>V(c.platform,c),onDelete:p=>K(c.platform,c)},null,8,["profile","onEdit","onCommands","onDownload","onDelete"]))),128))])),t.value.length>0&&te.value.length===0&&!I.value?(s(),i("div",wa,[...d[23]||(d[23]=[e("i",{class:"mdi mdi-filter-off"},null,-1),e("h3",null,"No profiles match your filters",-1),e("p",null,"Try adjusting your search or filter criteria",-1)])])):E("",!0)])):(s(),i("div",$a,[d[29]||(d[29]=e("div",{class:"status-badge warning"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Not Installed")],-1)),e("div",Ca,[d[25]||(d[25]=e("h4",null,"Why Install SmartIR?",-1)),e("ul",Sa,[(s(!0),i(be,null,ke(((ie=(X=y.value)==null?void 0:X.recommendation)==null?void 0:ie.benefits)||o,(c,p)=>(s(),i("li",{key:p},[d[24]||(d[24]=e("i",{class:"mdi mdi-check"},null,-1)),e("span",null,v(c),1)]))),128))])]),e("div",_a,[e("p",null,v(((a=(A=y.value)==null?void 0:A.recommendation)==null?void 0:a.message)||"Install SmartIR to unlock climate device support!"),1)]),e("div",{class:"card-actions"},[e("button",{onClick:he,class:"btn-primary"},[...d[26]||(d[26]=[e("i",{class:"mdi mdi-download"},null,-1),D(" Install SmartIR ",-1)])]),e("button",{onClick:G,class:"btn-secondary"},[...d[27]||(d[27]=[e("i",{class:"mdi mdi-github"},null,-1),D(" View on GitHub ",-1)])]),e("button",{onClick:Ie,class:"btn-secondary"},[...d[28]||(d[28]=[e("i",{class:"mdi mdi-help-circle"},null,-1),D(" Learn More ",-1)])])])]))],512),[[Ge,k.value]]),fe(Re,{isOpen:j.value.show,title:j.value.title,message:j.value.message,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:ue,onCancel:d[5]||(d[5]=c=>j.value.show=!1)},null,8,["isOpen","title","message"]),fe(Ys,{isOpen:_.value,onClose:d[6]||(d[6]=c=>_.value=!1)},null,8,["isOpen"])])}}},Da=we(Ia,[["__scopeId","data-v-4c696eec"]]),xa={class:"climate-form"},Ta={class:"learning-mode-section"},Ra={class:"mode-toggle"},Ma={class:"mode-content"},La={class:"mode-stats"},Oa={class:"stat-badge"},Aa={class:"stat-badge time"},Ea={class:"mode-content"},Va={class:"mode-stats"},ja={class:"stat-badge"},Ua={class:"stat-badge time warning"},Fa={key:0,class:"command-breakdown"},Pa={class:"warning-text"},Na={class:"form-section"},Ba={key:0,class:"help-text"},qa={key:1,class:"help-text"},Ha={class:"form-row"},za={class:"form-group"},Ja={class:"form-group"},Wa={class:"form-group"},Ga={key:2,class:"representative-temp-section"},Ka={class:"form-group"},Xa=["value"],Ya={class:"form-section"},Za={class:"checkbox-grid"},Qa={class:"checkbox-item"},ei={class:"checkbox-item"},ti={class:"checkbox-item"},oi={class:"checkbox-item"},li={class:"checkbox-item"},ni={class:"checkbox-item"},si={class:"form-section"},ai={class:"checkbox-grid"},ii={class:"checkbox-item"},ri={class:"checkbox-item"},di={class:"checkbox-item"},ui={class:"checkbox-item"},ci={class:"form-section"},mi={class:"checkbox-grid"},vi={class:"checkbox-item"},pi={class:"checkbox-item"},fi={class:"checkbox-item"},gi={class:"checkbox-item"},yi={class:"form-section"},bi={class:"form-group"},hi={class:"form-group"},ki={class:"form-group"},wi={key:0,class:"validation-summary"},$i={__name:"ClimateProfileForm",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(l,{emit:g}){const r=l,w=g,h=b("quick"),n=b({minTemp:16,maxTemp:30,precision:1,representativeTemp:24,modes:["off","auto","cool","heat"],fanModes:["auto","low","medium","high"],swingModes:[],tempSensor:"",humiditySensor:"",powerSensor:"",learningMode:"quick",...r.modelValue}),$=z(()=>{const _=[],o=n.value.minTemp||16,m=n.value.maxTemp||30,u=n.value.precision||1;for(let P=o;P<=m;P+=u)_.push(P);return _}),f=z(()=>n.value.modes.filter(_=>_!=="off").length),y=z(()=>n.value.fanModes.length||1),I=z(()=>n.value.swingModes.length||1),L=z(()=>{const _=n.value.minTemp||16,o=n.value.maxTemp||30,m=n.value.precision||1;return Math.floor((o-_)/m)+1}),k=z(()=>{const _=n.value.modes.includes("off")?1:0;return f.value*y.value*I.value+_}),t=z(()=>Math.ceil(k.value*30/60)),O=z(()=>{const _=n.value.modes.includes("off")?1:0;return f.value*L.value*y.value*I.value+_}),B=z(()=>Math.ceil(O.value*30/60)),j=z(()=>{const _=[];return(!n.value.minTemp||n.value.minTemp<10||n.value.minTemp>35)&&_.push("Minimum temperature must be between 10Â°C and 35Â°C"),(!n.value.maxTemp||n.value.maxTemp<10||n.value.maxTemp>35)&&_.push("Maximum temperature must be between 10Â°C and 35Â°C"),n.value.minTemp>=n.value.maxTemp&&_.push("Minimum temperature must be less than maximum temperature"),(!n.value.modes||n.value.modes.length===0)&&_.push("At least one HVAC mode must be selected"),_});return me(h,_=>{n.value.learningMode=_}),me(n,_=>{w("update:modelValue",_)},{deep:!0,immediate:!0}),(_,o)=>(s(),i("div",xa,[o[63]||(o[63]=e("h3",null,"Climate Device Configuration",-1)),e("div",Ta,[e("div",Ra,[e("label",{class:ee(["mode-option",{active:h.value==="quick"}])},[J(e("input",{type:"radio",value:"quick","onUpdate:modelValue":o[0]||(o[0]=m=>h.value=m)},null,512),[[je,h.value]]),e("div",Ma,[o[23]||(o[23]=e("div",{class:"mode-header"},[e("i",{class:"mdi mdi-flash"}),e("strong",null,"Quick Mode (Recommended)")],-1)),o[24]||(o[24]=e("p",null,"Learn one temperature per mode combination",-1)),e("div",La,[e("span",Oa,v(k.value)+" commands",1),e("span",Aa,"~"+v(t.value)+" min",1)])])],2),e("label",{class:ee(["mode-option",{active:h.value==="complete"}])},[J(e("input",{type:"radio",value:"complete","onUpdate:modelValue":o[1]||(o[1]=m=>h.value=m)},null,512),[[je,h.value]]),e("div",Ea,[o[25]||(o[25]=e("div",{class:"mode-header"},[e("i",{class:"mdi mdi-check-all"}),e("strong",null,"Complete Mode")],-1)),o[26]||(o[26]=e("p",null,"Learn all temperature combinations",-1)),e("div",Va,[e("span",ja,v(O.value)+" commands",1),e("span",Ua,"~"+v(B.value)+" min",1)])])],2)]),h.value==="complete"?(s(),i("div",Fa,[o[27]||(o[27]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[e("strong",null,"Complete mode will require learning "+v(O.value)+" commands",1),e("p",null,"This includes all combinations of modes ("+v(f.value)+"), temperatures ("+v(L.value)+"), fan speeds ("+v(y.value)+"), and swing modes ("+v(I.value)+").",1),e("p",Pa,"â±ï¸ Estimated time: "+v(B.value)+" minutes at ~30 seconds per command",1)])])):E("",!0)]),e("div",Na,[o[33]||(o[33]=e("h4",null,"Temperature Range",-1)),h.value==="quick"?(s(),i("p",Ba," Define the full temperature range your device supports. You'll select one temperature to learn below. ")):(s(),i("p",qa," Define the temperature range. All temperatures in this range will be learned. ")),e("div",Ha,[e("div",za,[o[28]||(o[28]=e("label",null,"Minimum Temperature (Â°C) *",-1)),J(e("input",{"onUpdate:modelValue":o[2]||(o[2]=m=>n.value.minTemp=m),type:"number",min:"10",max:"35",placeholder:"16"},null,512),[[_e,n.value.minTemp,void 0,{number:!0}]])]),e("div",Ja,[o[29]||(o[29]=e("label",null,"Maximum Temperature (Â°C) *",-1)),J(e("input",{"onUpdate:modelValue":o[3]||(o[3]=m=>n.value.maxTemp=m),type:"number",min:"10",max:"35",placeholder:"30"},null,512),[[_e,n.value.maxTemp,void 0,{number:!0}]])]),e("div",Wa,[o[31]||(o[31]=e("label",null,"Precision",-1)),J(e("select",{"onUpdate:modelValue":o[4]||(o[4]=m=>n.value.precision=m)},[...o[30]||(o[30]=[e("option",{value:1},"1Â°C (Whole degrees)",-1),e("option",{value:.5},"0.5Â°C (Half degrees)",-1)])],512),[[$e,n.value.precision,void 0,{number:!0}]])])]),h.value==="quick"?(s(),i("div",Ga,[e("div",Ka,[o[32]||(o[32]=e("label",null,"Representative Temperature to Learn *",-1)),J(e("select",{"onUpdate:modelValue":o[5]||(o[5]=m=>n.value.representativeTemp=m)},[(s(!0),i(be,null,ke($.value,m=>(s(),i("option",{key:m,value:m},v(m)+"Â°C ",9,Xa))),128))],512),[[$e,n.value.representativeTemp,void 0,{number:!0}]]),e("small",null,"This temperature will be learned for all mode combinations. The device profile will still show the full range ("+v(n.value.minTemp)+"Â°C - "+v(n.value.maxTemp)+"Â°C).",1)])])):E("",!0)]),e("div",Ya,[o[40]||(o[40]=e("h4",null,"Supported HVAC Modes *",-1)),o[41]||(o[41]=e("p",{class:"help-text"},"Select all modes your device supports",-1)),e("div",Za,[e("label",Qa,[J(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":o[6]||(o[6]=m=>n.value.modes=m)},null,512),[[ce,n.value.modes]]),o[34]||(o[34]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),D(" Off ")],-1))]),e("label",ei,[J(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":o[7]||(o[7]=m=>n.value.modes=m)},null,512),[[ce,n.value.modes]]),o[35]||(o[35]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),D(" Auto ")],-1))]),e("label",ti,[J(e("input",{type:"checkbox",value:"cool","onUpdate:modelValue":o[8]||(o[8]=m=>n.value.modes=m)},null,512),[[ce,n.value.modes]]),o[36]||(o[36]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-snowflake"}),D(" Cool ")],-1))]),e("label",oi,[J(e("input",{type:"checkbox",value:"heat","onUpdate:modelValue":o[9]||(o[9]=m=>n.value.modes=m)},null,512),[[ce,n.value.modes]]),o[37]||(o[37]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fire"}),D(" Heat ")],-1))]),e("label",li,[J(e("input",{type:"checkbox",value:"dry","onUpdate:modelValue":o[10]||(o[10]=m=>n.value.modes=m)},null,512),[[ce,n.value.modes]]),o[38]||(o[38]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-water-percent"}),D(" Dry ")],-1))]),e("label",ni,[J(e("input",{type:"checkbox",value:"fan_only","onUpdate:modelValue":o[11]||(o[11]=m=>n.value.modes=m)},null,512),[[ce,n.value.modes]]),o[39]||(o[39]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan"}),D(" Fan Only ")],-1))])])]),e("div",si,[o[46]||(o[46]=e("h4",null,"Fan Modes",-1)),o[47]||(o[47]=e("p",{class:"help-text"},"Select all fan speeds your device supports",-1)),e("div",ai,[e("label",ii,[J(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":o[12]||(o[12]=m=>n.value.fanModes=m)},null,512),[[ce,n.value.fanModes]]),o[42]||(o[42]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),D(" Auto ")],-1))]),e("label",ri,[J(e("input",{type:"checkbox",value:"low","onUpdate:modelValue":o[13]||(o[13]=m=>n.value.fanModes=m)},null,512),[[ce,n.value.fanModes]]),o[43]||(o[43]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-1"}),D(" Low ")],-1))]),e("label",di,[J(e("input",{type:"checkbox",value:"medium","onUpdate:modelValue":o[14]||(o[14]=m=>n.value.fanModes=m)},null,512),[[ce,n.value.fanModes]]),o[44]||(o[44]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-2"}),D(" Medium ")],-1))]),e("label",ui,[J(e("input",{type:"checkbox",value:"high","onUpdate:modelValue":o[15]||(o[15]=m=>n.value.fanModes=m)},null,512),[[ce,n.value.fanModes]]),o[45]||(o[45]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-3"}),D(" High ")],-1))])])]),e("div",ci,[o[52]||(o[52]=e("h4",null,"Swing Modes (Optional)",-1)),o[53]||(o[53]=e("p",{class:"help-text"},"Select if your device has swing/oscillation",-1)),e("div",mi,[e("label",vi,[J(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":o[16]||(o[16]=m=>n.value.swingModes=m)},null,512),[[ce,n.value.swingModes]]),o[48]||(o[48]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),D(" Off ")],-1))]),e("label",pi,[J(e("input",{type:"checkbox",value:"vertical","onUpdate:modelValue":o[17]||(o[17]=m=>n.value.swingModes=m)},null,512),[[ce,n.value.swingModes]]),o[49]||(o[49]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-vertical"}),D(" Vertical ")],-1))]),e("label",fi,[J(e("input",{type:"checkbox",value:"horizontal","onUpdate:modelValue":o[18]||(o[18]=m=>n.value.swingModes=m)},null,512),[[ce,n.value.swingModes]]),o[50]||(o[50]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),D(" Horizontal ")],-1))]),e("label",gi,[J(e("input",{type:"checkbox",value:"both","onUpdate:modelValue":o[19]||(o[19]=m=>n.value.swingModes=m)},null,512),[[ce,n.value.swingModes]]),o[51]||(o[51]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-arrow-all"}),D(" Both ")],-1))])])]),e("div",yi,[o[60]||(o[60]=e("h4",null,"Sensors (Optional)",-1)),o[61]||(o[61]=e("p",{class:"help-text"},"Link external sensors for better climate control",-1)),e("div",bi,[o[54]||(o[54]=e("label",null,"Temperature Sensor",-1)),J(e("input",{"onUpdate:modelValue":o[20]||(o[20]=m=>n.value.tempSensor=m),type:"text",placeholder:"sensor.living_room_temperature"},null,512),[[_e,n.value.tempSensor]]),o[55]||(o[55]=e("small",null,"Entity ID of temperature sensor",-1))]),e("div",hi,[o[56]||(o[56]=e("label",null,"Humidity Sensor",-1)),J(e("input",{"onUpdate:modelValue":o[21]||(o[21]=m=>n.value.humiditySensor=m),type:"text",placeholder:"sensor.living_room_humidity"},null,512),[[_e,n.value.humiditySensor]]),o[57]||(o[57]=e("small",null,"Entity ID of humidity sensor",-1))]),e("div",ki,[o[58]||(o[58]=e("label",null,"Power Sensor",-1)),J(e("input",{"onUpdate:modelValue":o[22]||(o[22]=m=>n.value.powerSensor=m),type:"text",placeholder:"binary_sensor.ac_power"},null,512),[[_e,n.value.powerSensor]]),o[59]||(o[59]=e("small",null,"Entity ID of power sensor (to detect on/off state)",-1))])]),j.value.length>0?(s(),i("div",wi,[o[62]||(o[62]=e("h4",null,[e("i",{class:"mdi mdi-alert-circle"}),D(" Please fix the following: ")],-1)),e("ul",null,[(s(!0),i(be,null,ke(j.value,(m,u)=>(s(),i("li",{key:u},v(m),1))),128))])])):E("",!0)]))}},Ci=we($i,[["__scopeId","data-v-8e22502e"]]),Si={class:"command-wizard"},_i={class:"device-selection-section"},Ii={class:"input-wrapper"},Di=["value"],xi={key:0,class:"validation-tooltip"},Ti={class:"form-group"},Ri={key:0,class:"edit-mode-banner"},Mi={class:"wizard-info"},Li={key:0},Oi={key:1},Ai={class:"progress-info"},Ei={class:"progress-bar"},Vi={class:"progress-text"},ji={class:"commands-grid"},Ui={class:"command-header"},Fi={class:"command-icon"},Pi={class:"command-info"},Ni={key:0,class:"learning-indicator"},Bi={key:0,class:"ir-learning-steps"},qi={key:1,class:"rf-learning-steps"},Hi={class:"command-actions"},zi=["onClick","disabled"],Ji={key:1,class:"learned-status"},Wi=["onClick","disabled"],Gi=["onClick"],Ki={class:"quick-actions"},Xi=["disabled"],Yi=["disabled"],Zi={__name:"CommandLearningWizard",props:{modelValue:{type:Object,default:()=>({})},platform:{type:String,required:!0},config:{type:Object,required:!0},broadlinkDevice:{type:String,default:""},manufacturer:{type:String,required:!0},model:{type:String,required:!0},commandType:{type:String,default:"ir"}},emits:["update:modelValue","update:broadlinkDevice","update:commandType"],setup(l,{emit:g}){const r=Ce("toast"),w=l,h=g,n=b({...w.modelValue}),$=b(null),f=b(null),y=b([]),I=b(w.broadlinkDevice),L=b(w.commandType),k=b(!1),t=b([]),O=b(!1),B=b(!1),j=b({show:!1,commandKey:null,commandLabel:""}),_=b(!1),o=z(()=>{const S=[];if(w.platform==="climate"){const V=w.config.modes||[],K=w.config.fanModes||[],ue=w.config.minTemp||16,R=w.config.maxTemp||30,d=w.config.learningMode||"quick",N=w.config.representativeTemp||24,le=w.config.precision||1,re=[];if(d==="quick")re.push(N);else for(let q=ue;q<=R;q+=le)re.push(q);V.forEach(q=>{q==="off"?S.push({key:"off",label:"Power Off",description:"Turn device off",icon:"mdi mdi-power",mode:"off"}):re.forEach(C=>{K.forEach(se=>{const X=`${q}_${C}_${se}`;S.push({key:X,label:`${q.toUpperCase()} ${C}Â°C ${se}`,description:`Mode: ${q}, Temp: ${C}Â°C, Fan: ${se}`,icon:Y(q),mode:q,temp:C,fanMode:se})})})})}else if(w.platform==="media_player"){const V=w.config.features||[];V.includes("turn_on")&&(S.push({key:"turn_on",label:"Power On",description:"Turn on the device",icon:"mdi mdi-power"}),S.push({key:"turn_off",label:"Power Off",description:"Turn off the device",icon:"mdi mdi-power-off"})),V.includes("volume")&&(S.push({key:"volume_up",label:"Volume Up",description:"Increase volume",icon:"mdi mdi-volume-plus"}),S.push({key:"volume_down",label:"Volume Down",description:"Decrease volume",icon:"mdi mdi-volume-minus"})),V.includes("mute")&&S.push({key:"mute",label:"Mute",description:"Toggle mute",icon:"mdi mdi-volume-mute"}),V.includes("source")&&(S.push({key:"source_hdmi1",label:"Source: HDMI 1",description:"Switch to HDMI 1",icon:"mdi mdi-import"}),S.push({key:"source_hdmi2",label:"Source: HDMI 2",description:"Switch to HDMI 2",icon:"mdi mdi-import"}),S.push({key:"source_hdmi3",label:"Source: HDMI 3",description:"Switch to HDMI 3",icon:"mdi mdi-import"})),V.includes("channel")&&(S.push({key:"channel_up",label:"Channel Up",description:"Next channel",icon:"mdi mdi-chevron-up"}),S.push({key:"channel_down",label:"Channel Down",description:"Previous channel",icon:"mdi mdi-chevron-down"}))}else if(w.platform==="fan"){const V=w.config.speedLevels||3,K=w.config.features||[];S.push({key:"turn_on",label:"Power On",description:"Turn on the fan",icon:"mdi mdi-power"}),S.push({key:"turn_off",label:"Power Off",description:"Turn off the fan",icon:"mdi mdi-power-off"});for(let ue=1;ue<=V;ue++){const R=ue===1?"Low":ue===V?"High":ue===2&&V===3?"Medium":`Speed ${ue}`;S.push({key:`speed_${ue}`,label:`${R}`,description:`Set fan to speed level ${ue}`,icon:"mdi mdi-fan"})}K.includes("oscillate")&&(S.push({key:"oscillate_on",label:"Oscillate On",description:"Enable oscillation",icon:"mdi mdi-sync"}),S.push({key:"oscillate_off",label:"Oscillate Off",description:"Disable oscillation",icon:"mdi mdi-sync-off"})),K.includes("direction")&&(S.push({key:"direction_forward",label:"Direction: Forward",description:"Set direction to forward",icon:"mdi mdi-rotate-right"}),S.push({key:"direction_reverse",label:"Direction: Reverse",description:"Set direction to reverse",icon:"mdi mdi-rotate-left"}))}else if(w.platform==="light"){const V=w.config.features||[];V.includes("turn_on")&&(S.push({key:"turn_on",label:"Power On",description:"Turn on the light",icon:"mdi mdi-lightbulb-on"}),S.push({key:"turn_off",label:"Power Off",description:"Turn off the light",icon:"mdi mdi-lightbulb-off"})),V.includes("brightness")&&(S.push({key:"brightness_up",label:"Brightness Up",description:"Increase brightness",icon:"mdi mdi-brightness-7"}),S.push({key:"brightness_down",label:"Brightness Down",description:"Decrease brightness",icon:"mdi mdi-brightness-5"})),V.includes("color_temp")&&(S.push({key:"color_temp_warm",label:"Warm White",description:"Set to warm white",icon:"mdi mdi-weather-sunset"}),S.push({key:"color_temp_cool",label:"Cool White",description:"Set to cool white",icon:"mdi mdi-weather-sunny"})),V.includes("rgb")&&(S.push({key:"color_red",label:"Color: Red",description:"Set color to red",icon:"mdi mdi-palette"}),S.push({key:"color_green",label:"Color: Green",description:"Set color to green",icon:"mdi mdi-palette"}),S.push({key:"color_blue",label:"Color: Blue",description:"Set color to blue",icon:"mdi mdi-palette"}))}return S}),m=z(()=>o.value.length),u=z(()=>Object.keys(n.value).length),P=z(()=>m.value===0?0:Math.round(u.value/m.value*100));function Y(S){return{off:"mdi mdi-power",auto:"mdi mdi-autorenew",cool:"mdi mdi-snowflake",heat:"mdi mdi-fire",dry:"mdi mdi-water-percent",fan_only:"mdi mdi-fan"}[S]||"mdi mdi-remote"}async function ne(S){if(!$.value){if(!I.value){B.value=!0,window.scrollTo({top:0,behavior:"smooth"});return}B.value=!1,$.value=S.key;try{const V=w.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_"),K=w.model.toLowerCase().replace(/[^a-z0-9]+/g,"_"),ue=`${V}_${K}`,R=await fetch("/api/commands/learn",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_id:I.value,device:ue,command:S.key,command_type:L.value})});if(!R.ok)throw new Error(`Failed to learn command: ${R.statusText}`);const d=await R.json();if(d.success&&d.code)n.value[S.key]=d.code,h("update:modelValue",n.value),O.value=!0,k.value&&t.value.length>0&&setTimeout(()=>{const N=t.value.shift();N?ne(N):k.value=!1},1e3);else throw new Error(d.error||"Failed to learn command")}catch(V){console.error("Error learning command:",V),r.error(`Error learning command: ${V.message}`),k.value=!1,t.value=[]}finally{k.value||($.value=null)}}}async function te(S){if(!I.value){r.error("Please select a Broadlink device first");return}if(!n.value[S]){r.error("Command not learned yet");return}f.value=S;try{const V=n.value[S],K=await fetch("/api/commands/send-raw",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_id:I.value,command:V,command_type:L.value})});if(!K.ok){const ue=await K.json();throw new Error(ue.error||"Failed to send command")}r.success("Command sent successfully")}catch(V){console.error("Error testing command:",V),r.error(`Error testing command: ${V.message}`)}finally{f.value=null}}function ge(S){const V=o.value.find(K=>K.key===S);j.value={show:!0,commandKey:S,commandLabel:V?V.label:S}}function T(){const S=j.value.commandKey;delete n.value[S],h("update:modelValue",n.value),j.value.show=!1}function F(){const S=o.value.filter(K=>!n.value[K.key]);if(S.length===0)return;k.value=!0,t.value=[...S];const V=t.value.shift();V&&ne(V)}function Z(){_.value=!0}function de(){n.value={},h("update:modelValue",n.value),_.value=!1}me(()=>w.modelValue,S=>{n.value={...S}},{deep:!0}),De(async()=>{await he()});async function he(){try{const S=w.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_"),V=w.model.toLowerCase().replace(/[^a-z0-9]+/g,"_"),K=`${S}_${V}`,ue=await fetch(`/api/commands/broadlink/${K}`);if(!ue.ok)return;const R=await ue.json();if(R.commands){const d=o.value.map(le=>le.key),N={};for(const[le,re]of Object.entries(R.commands))d.includes(le)&&(N[le]=re);Object.keys(N).length>0&&(n.value={...n.value,...N},h("update:modelValue",n.value),console.log(`Loaded ${Object.keys(N).length} existing commands for ${K}`))}}catch(S){console.error("Error loading existing commands:",S)}}function Ie(){h("update:broadlinkDevice",I.value)}function G(){h("update:commandType",L.value)}async function x(){try{const S=await fetch("/api/remote/devices");if(S.ok){const K=(await S.json()).devices||[];y.value=K}}catch(S){console.error("Error loading remote devices:",S),y.value=[]}}return me(()=>w.broadlinkDevice,S=>{I.value=S}),me(I,S=>{S&&(B.value=!1)}),me(()=>w.commandType,S=>{L.value=S}),De(async()=>{await x(),await he()}),(S,V)=>(s(),i("div",Si,[V[23]||(V[23]=e("h3",null,"Learn IR Commands",-1)),e("div",_i,[e("div",{class:ee(["form-group",{"has-error":B.value}])},[V[6]||(V[6]=e("label",null,"Broadlink Device *",-1)),e("div",Ii,[J(e("select",{"onUpdate:modelValue":V[0]||(V[0]=K=>I.value=K),onChange:Ie},[V[4]||(V[4]=e("option",{value:""},"Select Broadlink device...",-1)),(s(!0),i(be,null,ke(y.value,K=>(s(),i("option",{key:K.entity_id,value:K.entity_id},v(K.name)+v(K.area_name?" ("+K.area_name+")":""),9,Di))),128))],544),[[$e,I.value]]),B.value?(s(),i("div",xi,[...V[5]||(V[5]=[e("i",{class:"mdi mdi-alert"},null,-1),D(" Device is required ",-1)])])):E("",!0)]),e("small",null,"This device will be used to learn commands ("+v(y.value.length)+" devices found)",1)],2),e("div",Ti,[V[8]||(V[8]=e("label",null,"Command Type *",-1)),J(e("select",{"onUpdate:modelValue":V[1]||(V[1]=K=>L.value=K),onChange:G},[...V[7]||(V[7]=[e("option",{value:"ir"},"ðŸ“¡ Infrared (IR) - Most common for AC, TV, etc.",-1),e("option",{value:"rf"},"ðŸ“» Radio Frequency (RF) - For RF remotes",-1)])],544),[[$e,L.value]]),V[9]||(V[9]=e("small",null,"Select the type of commands your device uses",-1))])]),u.value>0&&!O.value?(s(),i("div",Ri,[V[11]||(V[11]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[V[10]||(V[10]=e("strong",null,"Editing Existing Profile",-1)),e("p",null,v(u.value)+" command"+v(u.value!==1?"s":"")+' already learned. You can re-learn any command by clicking the delete icon and then "Learn Command".',1)])])):E("",!0),e("div",Mi,[V[15]||(V[15]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[V[14]||(V[14]=e("p",null,[e("strong",null,"How it works:")],-1)),l.commandType==="ir"?(s(),i("ol",Li,[...V[12]||(V[12]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Point your IR remote directly at the Broadlink device")],-1),e("li",null,"Press the button on your remote",-1),e("li",null,"Wait for confirmation (up to 30 seconds)",-1)])])):(s(),i("ol",Oi,[...V[13]||(V[13]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Step 1:"),D(" Hold button on remote - Broadlink scans for RF frequency")],-1),e("li",null,[e("strong",null,"Step 2:"),D(" Watch for Home Assistant notification, then press and release button")],-1),e("li",null,"Keep remote within 5cm of Broadlink (RF doesn't need line-of-sight)",-1),e("li",null,"Wait for confirmation (may take up to 30 seconds)",-1)])]))])]),e("div",Ai,[e("div",Ei,[e("div",{class:"progress-fill",style:tt({width:P.value+"%"})},null,4)]),e("span",Vi,v(u.value)+" / "+v(m.value)+" commands learned ("+v(P.value)+"%) ",1)]),e("div",ji,[(s(!0),i(be,null,ke(o.value,K=>(s(),i("div",{key:K.key,class:ee(["command-card",{learned:n.value[K.key],learning:$.value===K.key}])},[e("div",Ui,[e("div",Fi,[e("i",{class:ee(K.icon)},null,2)]),e("div",Pi,[e("h4",null,v(K.label),1),e("p",null,v(K.description),1)])]),$.value===K.key?(s(),i("div",Ni,[l.commandType==="ir"?(s(),i("div",Bi,[...V[16]||(V[16]=[e("p",null,[e("strong",null,"Point your remote directly at the Broadlink device and press the button.")],-1),e("small",null,"Listening for up to 30 seconds...",-1)])])):(s(),i("div",qi,[...V[17]||(V[17]=[e("p",{class:"rf-title"},[e("strong",null,"Learning request sent to device.")],-1),e("p",{class:"rf-subtitle"},[D("RF learning is a "),e("strong",null,"two-step process"),D(":")],-1),e("ol",null,[e("li",null,[e("strong",null,"Step 1 - Frequency Sweep (~10-15 seconds):"),D(" Press and hold the button on your remote until the notification updates. ")]),e("li",null,[e("strong",null,"Step 2 - Learn Signal:"),D(" Press and release the button once. ")])],-1),e("p",{class:"rf-note"},"Follow the Home Assistant notifications (ðŸ””) for real-time instructions.",-1)])]))])):E("",!0),e("div",Hi,[n.value[K.key]?(s(),i("div",Ji,[V[19]||(V[19]=e("i",{class:"mdi mdi-check-circle"},null,-1)),V[20]||(V[20]=e("span",null,"Learned",-1)),e("span",{class:ee(["command-type-badge",L.value])},v(L.value.toUpperCase()),3),e("button",{onClick:ue=>te(K.key),class:"icon-btn",title:"Test command",disabled:f.value===K.key,style:{"margin-left":"auto"}},[e("i",{class:ee(["mdi mdi-play",{"mdi-spin":f.value===K.key}])},null,2)],8,Wi),e("button",{onClick:ue=>ge(K.key),class:"icon-btn danger",title:"Delete and re-learn"},[...V[18]||(V[18]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Gi)])):(s(),i("button",{key:0,onClick:ue=>ne(K),class:ee(["btn-learn",{learning:$.value===K.key}]),disabled:$.value!==null},[e("i",{class:ee(["mdi mdi-radio-tower",{"mdi-spin":$.value===K.key}])},null,2),D(" "+v($.value===K.key?"Listening...":"Learn Command"),1)],10,zi))])],2))),128))]),e("div",Ki,[e("button",{onClick:F,class:"btn-secondary",disabled:$.value!==null||u.value===m.value},[...V[21]||(V[21]=[e("i",{class:"mdi mdi-play-circle"},null,-1),D(" Learn All Remaining ",-1)])],8,Xi),e("button",{onClick:Z,class:"btn-text",disabled:u.value===0},[...V[22]||(V[22]=[e("i",{class:"mdi mdi-delete-sweep"},null,-1),D(" Clear All ",-1)])],8,Yi)]),fe(Re,{isOpen:j.value.show,title:"Delete Learned Command?",message:`Are you sure you want to delete the '${j.value.commandLabel}' command?

You will need to re-learn this command.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:T,onCancel:V[2]||(V[2]=K=>j.value.show=!1)},null,8,["isOpen","message"]),fe(Re,{isOpen:_.value,title:"Delete All Learned Commands?",message:"Are you sure you want to delete all learned commands? This cannot be undone.\\n\\nYou will need to re-learn all commands.",confirmText:"Delete All",cancelText:"Cancel",dangerMode:!0,onConfirm:de,onCancel:V[3]||(V[3]=K=>_.value=!1)},null,8,["isOpen"])]))}},Qi=we(Zi,[["__scopeId","data-v-28c731bb"]]),er={class:"profile-preview"},tr={class:"preview-summary"},or={class:"summary-card"},lr={class:"stats-grid"},nr={class:"stat-item"},sr={class:"stat-value"},ar={class:"stat-item"},ir={class:"stat-value"},rr={class:"stat-item"},dr={class:"stat-value"},ur={class:"preview-tabs"},cr={class:"preview-content"},mr={key:0,class:"tab-content"},vr={class:"code-header"},pr={class:"code-block"},fr={key:1,class:"tab-content"},gr={class:"code-header"},yr={class:"code-block"},br={key:2,class:"tab-content"},hr={class:"instructions"},kr={class:"step-item"},wr={class:"step-content"},$r={class:"code-path"},Cr={__name:"ProfilePreview",props:{profile:{type:Object,required:!0},jsonData:{type:Object,required:!0},yamlConfig:{type:String,required:!0}},setup(l){const g=Fe(),r=l,w=b("json"),h=b(!1),n=b(!1),$=z(()=>Object.keys(r.profile.commands||{}).length),f=z(()=>JSON.stringify(r.jsonData,null,2));async function y(){try{await navigator.clipboard.writeText(f.value),h.value=!0,setTimeout(()=>{h.value=!1},2e3)}catch(L){console.error("Failed to copy JSON:",L),g.error("Failed to copy to clipboard")}}async function I(){try{await navigator.clipboard.writeText(r.yamlConfig),n.value=!0,setTimeout(()=>{n.value=!1},2e3)}catch(L){console.error("Failed to copy YAML:",L),g.error("Failed to copy to clipboard")}}return(L,k)=>{var t;return s(),i("div",er,[k[22]||(k[22]=e("h3",null,"Preview & Save",-1)),e("div",tr,[e("div",or,[k[4]||(k[4]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("div",null,[k[3]||(k[3]=e("h4",null,"Profile Ready!",-1)),e("p",null,v(l.profile.manufacturer)+" "+v(l.profile.model),1)])]),e("div",lr,[e("div",nr,[e("span",sr,v($.value),1),k[5]||(k[5]=e("span",{class:"stat-label"},"Commands Learned",-1))]),e("div",ar,[e("span",ir,v(l.profile.platform),1),k[6]||(k[6]=e("span",{class:"stat-label"},"Platform",-1))]),e("div",rr,[e("span",dr,v(((t=l.profile.config.modes)==null?void 0:t.length)||0),1),k[7]||(k[7]=e("span",{class:"stat-label"},"HVAC Modes",-1))])])]),e("div",ur,[e("button",{onClick:k[0]||(k[0]=O=>w.value="json"),class:ee(["tab-button",{active:w.value==="json"}])},[...k[8]||(k[8]=[e("i",{class:"mdi mdi-code-json"},null,-1),D(" SmartIR JSON ",-1)])],2),e("button",{onClick:k[1]||(k[1]=O=>w.value="yaml"),class:ee(["tab-button",{active:w.value==="yaml"}])},[...k[9]||(k[9]=[e("i",{class:"mdi mdi-file-code"},null,-1),D(" YAML Config ",-1)])],2),e("button",{onClick:k[2]||(k[2]=O=>w.value="instructions"),class:ee(["tab-button",{active:w.value==="instructions"}])},[...k[10]||(k[10]=[e("i",{class:"mdi mdi-information"},null,-1),D(" Instructions ",-1)])],2)]),e("div",cr,[w.value==="json"?(s(),i("div",mr,[e("div",vr,[k[12]||(k[12]=e("h4",null,"SmartIR Device Code JSON",-1)),e("button",{onClick:y,class:"btn-copy"},[k[11]||(k[11]=e("i",{class:"mdi mdi-content-copy"},null,-1)),D(" "+v(h.value?"Copied!":"Copy"),1)])]),e("pre",pr,[e("code",null,v(f.value),1)]),k[13]||(k[13]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),D(" Save this as "),e("code",null,"10000.json"),D(" in your SmartIR codes directory ")],-1))])):E("",!0),w.value==="yaml"?(s(),i("div",fr,[e("div",gr,[k[15]||(k[15]=e("h4",null,"Home Assistant Configuration",-1)),e("button",{onClick:I,class:"btn-copy"},[k[14]||(k[14]=e("i",{class:"mdi mdi-content-copy"},null,-1)),D(" "+v(n.value?"Copied!":"Copy"),1)])]),e("pre",yr,[e("code",null,v(l.yamlConfig),1)]),k[16]||(k[16]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),D(" Add this to your "),e("code",null,"configuration.yaml"),D(" file ")],-1))])):E("",!0),w.value==="instructions"?(s(),i("div",br,[e("div",hr,[k[20]||(k[20]=e("h4",null,"Installation Steps",-1)),e("div",kr,[k[19]||(k[19]=e("div",{class:"step-number"},"1",-1)),e("div",wr,[k[17]||(k[17]=e("h5",null,"Get Next Code Number",-1)),k[18]||(k[18]=e("p",null,"Custom device codes start at 10000. Check your SmartIR codes directory to find the next available number.",-1)),e("div",$r,[e("code",null,"/config/custom_components/smartir/codes/"+v(l.profile.platform)+"/",1)])])]),k[21]||(k[21]=Me('<div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>2</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Save JSON File</h5><p data-v-cbf0874d>Copy the JSON from the &quot;SmartIR JSON&quot; tab and save it as <code data-v-cbf0874d>10000.json</code> (or your next available number) in the codes directory.</p></div></div><div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>3</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Update Configuration</h5><p data-v-cbf0874d>Copy the YAML from the &quot;YAML Config&quot; tab and add it to your <code data-v-cbf0874d>configuration.yaml</code> file. Update the <code data-v-cbf0874d>device_code</code> to match your JSON filename.</p></div></div><div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>4</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Restart Home Assistant</h5><p data-v-cbf0874d>Restart Home Assistant to load the new configuration. Your climate entity will appear in the UI.</p></div></div><div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>5</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Test Your Device</h5><p data-v-cbf0874d>Go to your climate entity and test different modes, temperatures, and fan speeds to ensure everything works correctly.</p></div></div><div class="tips-section" data-v-cbf0874d><h4 data-v-cbf0874d><i class="mdi mdi-lightbulb" data-v-cbf0874d></i> Tips </h4><ul data-v-cbf0874d><li data-v-cbf0874d>Keep a backup of your JSON file in case you need to modify it</li><li data-v-cbf0874d>Test all commands to ensure they work as expected</li><li data-v-cbf0874d>You can share your profile with the SmartIR community on GitHub</li><li data-v-cbf0874d>If a command doesn&#39;t work, you can re-learn it and update the JSON</li></ul></div>',5))])])):E("",!0)])])}}},Sr=we(Cr,[["__scopeId","data-v-cbf0874d"]]),_r={class:"wizard-body"},Ir={key:0,class:"warning-section"},Dr={class:"warning-box"},xr={class:"instructions"},Tr={class:"code-block"},Rr={class:"steps"},Mr={key:0},Lr={class:"help-section"},Or={key:0,class:"help-content"},Ar={class:"help-step"},Er={key:0,class:"help-step"},Vr={class:"help-step"},jr={class:"help-step"},Ur={class:"checklist"},Fr={class:"checkbox-label"},Pr={key:0,class:"checkbox-label"},Nr={class:"wizard-footer"},Br=["disabled"],qr={__name:"SmartIRSetupWizard",props:{show:{type:Boolean,default:!1},platform:{type:String,required:!0},warnings:{type:Array,default:()=>[]},configPath:{type:String,default:"/config"}},emits:["close","complete"],setup(l,{emit:g}){const r=l,w=g,h=Ce("toast"),n=b(!1),$=b(!1),f=b(!1),y=z(()=>r.warnings.length>0?n.value&&$.value:n.value);function I(){const k=`${r.platform}: !include smartir/${r.platform}.yaml`;navigator.clipboard.writeText(k).then(()=>{var t;(t=h.value)==null||t.success("Include line copied to clipboard!","âœ… Copied")}).catch(t=>{var O;console.error("Failed to copy:",t),(O=h.value)==null||O.error("Failed to copy to clipboard","âŒ Copy Failed")})}function L(){w("complete")}return(k,t)=>l.show?(s(),i("div",{key:0,class:"modal-overlay",onClick:t[5]||(t[5]=pe(()=>{},["stop"]))},[e("div",{class:"setup-wizard",onClick:t[4]||(t[4]=pe(()=>{},["stop"]))},[t[31]||(t[31]=e("div",{class:"wizard-header"},[e("h2",null,[e("i",{class:"mdi mdi-cog"}),D(" SmartIR Configuration Setup ")])],-1)),e("div",_r,[l.warnings.length>0?(s(),i("div",Ir,[e("div",Dr,[t[11]||(t[11]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[t[9]||(t[9]=e("h3",null,"âš ï¸ Configuration Migration Needed",-1)),t[10]||(t[10]=e("p",null,"We detected existing platform entries in your configuration.yaml:",-1)),e("ul",null,[(s(!0),i(be,null,ke(l.warnings,O=>(s(),i("li",{key:O.platform},[e("strong",null,v(O.platform)+":",1),D(" "+v(O.message),1)]))),128))]),e("p",null,[t[6]||(t[6]=e("strong",null,"Action Required:",-1)),t[7]||(t[7]=D(" Move these entries to ",-1)),e("code",null,"smartir/"+v(l.platform)+".yaml",1),t[8]||(t[8]=D(" before continuing.",-1))])])])])):E("",!0),e("div",xr,[t[27]||(t[27]=e("h3",null,"ðŸ“ One-Time Setup",-1)),t[28]||(t[28]=e("p",null,[D("To enable SmartIR device management, add this line to your "),e("code",null,"configuration.yaml"),D(":")],-1)),e("div",Tr,[e("code",null,v(l.platform)+": !include smartir/"+v(l.platform)+".yaml",1),e("button",{onClick:I,class:"copy-btn",title:"Copy to clipboard"},[...t[12]||(t[12]=[e("i",{class:"mdi mdi-content-copy"},null,-1)])])]),e("div",Rr,[t[19]||(t[19]=e("h4",null,"Steps:",-1)),e("ol",null,[l.warnings.length>0?(s(),i("li",Mr,[t[13]||(t[13]=e("strong",null,"Move existing entries:",-1)),t[14]||(t[14]=D(" Copy any existing ",-1)),e("code",null,v(l.platform)+":",1),t[15]||(t[15]=D(" entries from configuration.yaml to ",-1)),e("code",null,"smartir/"+v(l.platform)+".yaml",1)])):E("",!0),t[16]||(t[16]=e("li",null,[e("strong",null,"Add include line:"),D(" Add the line above to your configuration.yaml ")],-1)),t[17]||(t[17]=e("li",null,[e("strong",null,"Save changes:"),D(" Save configuration.yaml ")],-1)),t[18]||(t[18]=e("li",null,[e("strong",null,"Continue here:"),D(` Click "I've Completed Setup" below `)],-1))])]),e("div",Lr,[e("button",{onClick:t[0]||(t[0]=O=>f.value=!f.value),class:"help-toggle"},[e("i",{class:ee(["mdi",f.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2),D(" "+v(f.value?"Hide":"Show")+" Detailed Instructions ",1)]),f.value?(s(),i("div",Or,[t[26]||(t[26]=e("h4",null,"Detailed Setup Guide:",-1)),e("div",Ar,[t[21]||(t[21]=e("h5",null,"1. Open configuration.yaml",-1)),e("p",null,[t[20]||(t[20]=D("Location: ",-1)),e("code",null,v(l.configPath)+"/configuration.yaml",1)])]),l.warnings.length>0?(s(),i("div",Er,[t[22]||(t[22]=e("h5",null,"2. Migrate Existing Entries (If Any)",-1)),e("p",null,"If you have existing "+v(l.platform)+" entries, cut them from configuration.yaml and paste into:",1),e("p",null,[e("code",null,v(l.configPath)+"/smartir/"+v(l.platform)+".yaml",1)]),t[23]||(t[23]=e("p",{class:"note"},"Broadlink Manager will create this file automatically.",-1))])):E("",!0),e("div",Vr,[e("h5",null,v(l.warnings.length>0?"3":"2")+". Add Include Line",1),t[24]||(t[24]=e("p",null,"Add this to configuration.yaml:",-1)),e("pre",null,v(l.platform)+": !include smartir/"+v(l.platform)+".yaml",1)]),e("div",jr,[e("h5",null,v(l.warnings.length>0?"4":"3")+". Restart Home Assistant",1),t[25]||(t[25]=e("p",null,"After saving, you'll need to restart HA for changes to take effect.",-1))])])):E("",!0)])]),e("div",Ur,[e("label",Fr,[J(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=O=>n.value=O)},null,512),[[ce,n.value]]),t[29]||(t[29]=e("span",null,"I've added the include line to configuration.yaml",-1))]),l.warnings.length>0?(s(),i("label",Pr,[J(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=O=>$.value=O)},null,512),[[ce,$.value]]),e("span",null,"I've migrated existing "+v(l.platform)+" entries (if any)",1)])):E("",!0)])]),e("div",Nr,[e("button",{onClick:t[3]||(t[3]=O=>k.$emit("close")),class:"btn-secondary"}," Cancel "),e("button",{onClick:L,class:"btn-primary",disabled:!y.value},[...t[30]||(t[30]=[e("i",{class:"mdi mdi-check"},null,-1),D(" I've Completed Setup ",-1)])],8,Br)])])])):E("",!0)}},Hr=we(qr,[["__scopeId","data-v-f6fe4c03"]]),zr={class:"modal-header"},Jr={class:"progress-steps"},Wr={class:"step-number"},Gr={key:0,class:"mdi mdi-check"},Kr={key:1},Xr={class:"step-label"},Yr={class:"modal-body"},Zr={key:0,class:"step-content"},Qr={class:"form-group"},ed={class:"form-group"},td={class:"form-group"},od={key:1,class:"step-content"},ld={key:1,class:"platform-form"},nd={class:"form-section"},sd={class:"checkbox-grid"},ad={class:"checkbox-item"},id={class:"checkbox-item"},rd={class:"checkbox-item"},dd={class:"checkbox-item"},ud={class:"checkbox-item"},cd={key:2,class:"platform-form"},md={class:"form-section"},vd={class:"form-group"},pd={class:"form-section"},fd={class:"checkbox-grid"},gd={class:"checkbox-item"},yd={class:"checkbox-item"},bd={key:3,class:"platform-form"},hd={class:"form-section"},kd={class:"checkbox-grid"},wd={class:"checkbox-item"},$d={class:"checkbox-item"},Cd={class:"checkbox-item"},Sd={class:"checkbox-item"},_d={key:2,class:"step-content"},Id={key:3,class:"step-content"},Dd={class:"modal-footer"},xd=["disabled"],Td={key:2,class:"save-buttons"},Rd=["disabled"],Md=["disabled"],Ld={__name:"SmartIRProfileBuilder",props:{show:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},editData:{type:Object,default:null},startStep:{type:Number,default:0}},emits:["close","save"],setup(l,{emit:g}){const r=l,w=g,h=Ce("toast"),n=b(0),$=b(!1),f=b([]),y=b(!1),I=b([]),L=b("/config"),k=b(!1),t=b(null),O=b(!1),B=b(!1),j=b(""),_=b("ir"),o=b(!1),m=[{label:"Device Info",key:"info"},{label:"Configuration",key:"config"},{label:"Learn Commands",key:"commands"},{label:"Preview & Save",key:"preview"}],u=b({platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}}),P=b(["turn_on"]),Y=b(3),ne=b([]),te=b(["turn_on"]);me(()=>u.value.platform,A=>{A==="media_player"?u.value.config={features:P.value}:A==="fan"?u.value.config={speedLevels:Y.value,features:ne.value}:A==="light"&&(u.value.config={features:te.value})}),me(P,A=>{u.value.platform==="media_player"&&(u.value.config={features:A})},{deep:!0}),me(Y,A=>{u.value.platform==="fan"&&(u.value.config={speedLevels:A,features:ne.value})}),me(ne,A=>{u.value.platform==="fan"&&(u.value.config={speedLevels:Y.value,features:A})},{deep:!0}),me(te,A=>{u.value.platform==="light"&&(u.value.config={features:A})},{deep:!0});function ge(A){const a=new Set,c=Object.keys(A);return c.some(p=>p==="off"||p.includes("_off"))&&a.add("off"),c.some(p=>p.includes("auto"))&&a.add("auto"),c.some(p=>p.includes("cool"))&&a.add("cool"),c.some(p=>p.includes("heat"))&&a.add("heat"),c.some(p=>p.includes("dry"))&&a.add("dry"),c.some(p=>p.includes("fan_only"))&&a.add("fan_only"),Array.from(a)}function T(A){const a=new Set,c=Object.keys(A);return c.some(p=>p.includes("auto"))&&a.add("auto"),c.some(p=>p.includes("low"))&&a.add("low"),c.some(p=>p.includes("medium")||p.includes("mid"))&&a.add("medium"),c.some(p=>p.includes("high"))&&a.add("high"),Array.from(a)}function F(A){const a=new Set,c=Object.keys(A);return c.some(p=>p.includes("swing_off")||p.includes("_off"))&&a.add("off"),c.some(p=>p.includes("vertical"))&&a.add("vertical"),c.some(p=>p.includes("horizontal"))&&a.add("horizontal"),c.some(p=>p.includes("both"))&&a.add("both"),Array.from(a)}function Z(A){for(const a of Object.values(A))if(typeof a=="string"&&a.startsWith("sc")||Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0].startsWith("sc"))return"rf";return"ir"}me(()=>u.value.commandType,(A,a)=>{!a||O.value||o.value||(Object.keys(u.value.commands).length>0&&A!==a?(j.value=A,u.value.commandType=a,O.value=!0):A!==a&&(_.value=A))}),me(()=>r.editData,async A=>{var a,c,p;if(A&&r.editMode){console.log("ðŸ”§ Edit mode activated, loading profile data:",A),o.value=!0,f.value.length===0&&(console.log("ðŸ“¡ Loading Broadlink devices..."),await ie(),console.log("ðŸ“¡ Devices loaded:",f.value.length));const M=A.profile,U=M.controller_data;console.log("ðŸŽ® Controller data from profile:",U),console.log("ðŸŽ® Available devices:",f.value.map(W=>W.entity_id));const H=M.commands||{},ae=Z(H);console.log("ðŸ” Inferred command type:",ae);let oe={};if(A.platform==="climate"){const W=M.operationModes||ge(H),ye=M.fanModes||T(H),xe=M.swingModes||F(H);console.log("ðŸ” Inferred modes:",W),console.log("ðŸ” Inferred fan modes:",ye),console.log("ðŸ” Inferred swing modes:",xe),oe={minTemp:M.minTemperature,maxTemp:M.maxTemperature,precision:M.precision,modes:W,fanModes:ye,swingModes:xe}}else if(A.platform==="media_player"){const W=[];(H.on||H.off)&&W.push("turn_on"),(H.volumeUp||H.volumeDown)&&W.push("volume"),H.mute&&W.push("mute"),H.sources&&W.push("source"),(H.channelUp||H.channelDown)&&W.push("channel"),oe={features:W},P.value=W,console.log("ðŸ” Inferred media player features:",W)}else if(A.platform==="fan"){const W=((a=M.speed)==null?void 0:a.length)||Object.keys(H.default||{}).length||3,ye=[];(H.oscillate_on||H.oscillate_off)&&ye.push("oscillate"),(H.direction_forward||H.direction_reverse)&&ye.push("direction"),oe={speedLevels:W,features:ye},Y.value=W,ne.value=ye,console.log("ðŸ” Inferred fan config:",oe)}else if(A.platform==="light"){const W=[];oe={features:W},te.value=W,console.log("ðŸ” Inferred light features:",W)}const Q=await C(M.manufacturer,(c=M.supportedModels)==null?void 0:c[0],H);u.value={platform:A.platform,manufacturer:M.manufacturer||"",model:((p=M.supportedModels)==null?void 0:p[0])||"",broadlinkDevice:U||"",commandType:ae,config:oe,commands:Q},console.log("âœ… Profile populated:",u.value),console.log("âœ… Selected device:",u.value.broadlinkDevice),console.log("âœ… Command type:",u.value.commandType),console.log("âœ… Commands (with learned codes):",Q),_.value=ae,setTimeout(()=>{o.value=!1},100)}},{immediate:!0});const de=z(()=>{switch(n.value){case 0:return u.value.platform&&u.value.manufacturer&&u.value.model;case 1:return!0;case 2:return u.value.broadlinkDevice&&u.value.commandType&&Object.keys(u.value.commands).length>0;case 3:return!0;default:return!1}}),he=b(null);async function Ie(){if(n.value!==3){he.value=null;return}if(console.log("ðŸ” Generating JSON with commands:",u.value.commands),Object.values(u.value.commands).some(a=>typeof a=="string"?a==="pending":typeof a=="object"?Object.values(a).some(c=>typeof c=="string"?c==="pending":typeof c=="object"?Object.values(c).some(p=>p==="pending"):!1):!1)){console.warn('âš ï¸ Commands still contain "pending" placeholders!'),console.log("ðŸ“¦ Attempting to fetch from Broadlink storage...");const a=await C(u.value.manufacturer,u.value.model,u.value.commands);u.value.commands=a,console.log("âœ… Updated commands:",a)}he.value=se(u.value),console.log("ðŸ“„ Generated JSON:",he.value)}const G=z(()=>n.value!==3?null:X(u.value));function x(){u.value.config={},u.value.commands={}}function S(){O.value=!1,u.value.commandType=j.value,_.value=j.value,u.value.commands={},j.value=""}function V(){O.value=!1,j.value=""}async function K(){n.value<m.length-1&&(n.value++,n.value===3&&await Ie())}function ue(){n.value>0&&n.value--}function R(){O.value||(B.value=!0)}function d(){B.value=!1,N()}function N(){w("close"),setTimeout(()=>{n.value=0,u.value={platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}},_.value="ir"},300)}async function le(){var A,a,c,p,M;$.value=!0;try{if(!k.value){const W=await fetch("api/smartir/config/check");if(W.ok){const ye=await W.json();if(!((A=ye.platforms[u.value.platform])==null?void 0:A.file_exists)){I.value=ye.configuration_warnings||[],L.value=ye.config_path||"/config",t.value={platform:u.value.platform,json:he.value},y.value=!0,$.value=!1;return}}}let U;if(r.editMode&&((a=r.editData)!=null&&a.code))U=parseInt(r.editData.code),console.log("ðŸ“ Edit mode: Using existing code",U);else{const W=await fetch(`api/smartir/platforms/${u.value.platform}/next-code`);if(!W.ok)throw new Error("Failed to get next code number");U=(await W.json()).next_code,console.log("âœ¨ New profile: Using next code",U)}const H=await fetch("api/smartir/profiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:u.value.platform,json:he.value,code_number:U})});if(!H.ok){const W=await H.json();throw new Error(W.error||"Failed to save profile")}const ae=await H.json(),oe={name:`${u.value.manufacturer} ${u.value.model}`,unique_id:`${u.value.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_")}_${u.value.model.toLowerCase().replace(/[^a-z0-9]+/g,"_")}`,device_code:U,controller_data:u.value.broadlinkDevice},Q=await fetch("api/smartir/config/add-device",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:u.value.platform,device_config:oe})});if(!Q.ok){const W=await Q.json();console.error("Failed to add device to config:",W),(c=h.value)==null||c.warning(`Profile saved but failed to add to config file: ${W.error}`,"âš ï¸ Partial Success")}w("save",{json:he.value,yaml:G.value,profile:u.value,saved_to:ae.path}),(p=h.value)==null||p.success(`File: ${ae.filename}
Device Code: ${U}
Added to: smartir/${u.value.platform}.yaml

âš ï¸ Restart Home Assistant to activate`,"âœ… Profile Saved Successfully!"),N()}catch(U){console.error("Error saving profile:",U),(M=h.value)==null||M.error(U.message,"âŒ Error Saving Profile")}finally{$.value=!1}}async function re(){k.value=!0,y.value=!1,t.value&&(await le(),t.value=null)}function q(){var A,a;try{const c=JSON.stringify(he.value,null,2),p=new Blob([c],{type:"application/json"}),M=URL.createObjectURL(p),U=document.createElement("a");U.href=M;const H=u.value.manufacturer.toLowerCase().replace(/\s+/g,"_"),ae=u.value.model.toLowerCase().replace(/\s+/g,"_");U.download=`smartir_${u.value.platform}_${H}_${ae}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(M),(A=h.value)==null||A.success("You can manually upload this file to your SmartIR codes directory.","âœ… Profile Downloaded")}catch(c){console.error("Error downloading profile:",c),(a=h.value)==null||a.error(c.message,"âŒ Error Downloading Profile")}}async function C(A,a,c){const p=A.toLowerCase().replace(/[^a-z0-9]+/g,"_"),M=a.toLowerCase().replace(/[^a-z0-9]+/g,"_"),U=`${p}_${M}`;try{const H=await fetch("/api/commands/all");if(!H.ok)return console.error("Failed to fetch commands from Broadlink storage"),c;const oe=(await H.json())[U]||{};console.log(`ðŸ” Fetching learned commands for device: ${U}`),console.log("ðŸ“¦ Device commands from storage:",oe);const Q={...c};for(const[W,ye]of Object.entries(Q))if(ye==="pending"&&oe[W])Q[W]=oe[W];else if(typeof ye=="object"){for(const[xe,Le]of Object.entries(ye))if(typeof Le=="object")for(const[Ae,Ze]of Object.entries(Le)){const Be=`${W}_${xe}_${Ae}`;Ze==="pending"&&oe[Be]&&(Q[W][xe][Ae]=oe[Be])}else if(Le==="pending"){const Ae=`${W}_${xe}`;oe[Ae]&&(Q[W][xe]=oe[Ae])}}return console.log("âœ… Merged commands:",Q),Q}catch(H){return console.error("Error fetching learned commands:",H),c}}function se(A){const a={manufacturer:A.manufacturer,supportedModels:[A.model],supportedController:"Broadlink",commandsEncoding:"Base64",commandType:A.commandType||"ir",commands:{}};return A.platform==="climate"&&(a.minTemperature=A.config.minTemp,a.maxTemperature=A.config.maxTemp,a.precision=A.config.precision||1,a.operationModes=A.config.modes||[],a.fanModes=A.config.fanModes&&A.config.fanModes.length>0?A.config.fanModes:["auto"],A.config.swingModes&&A.config.swingModes.length>0&&(a.swingModes=A.config.swingModes),a.commands=A.commands),a}function X(A){let a=`# SmartIR ${A.platform} configuration
`;return a+=`# Generated by Broadlink Manager v2

`,A.platform==="climate"&&(a+=`climate:
`,a+=`  - platform: smartir
`,a+=`    name: ${A.manufacturer} ${A.model}
`,a+=`    unique_id: ${A.manufacturer.toLowerCase()}_${A.model.toLowerCase().replace(/\s+/g,"_")}
`,a+=`    device_code: 10000  # Change this to your custom code number
`,a+=`    controller_data: ${A.broadlinkDevice}
`,A.config.tempSensor&&(a+=`    temperature_sensor: ${A.config.tempSensor}
`),A.config.humiditySensor&&(a+=`    humidity_sensor: ${A.config.humiditySensor}
`),A.config.powerSensor&&(a+=`    power_sensor: ${A.config.powerSensor}
`)),a}async function ie(){try{console.log("Fetching remote devices from api/remote/devices...");const A=await fetch("api/remote/devices");if(console.log("Response status:",A.status,A.ok),A.ok){const a=await A.json();console.log("Loaded remote devices response:",a);const c=a.devices||[];console.log("Extracted devices array:",c),console.log("Device count:",c.length),f.value=c,console.log("broadlinkDevices.value set to:",f.value),console.log("Final device count:",f.value.length)}else console.error("Response not OK:",A.status,A.statusText),f.value=[]}catch(A){console.error("Error loading remote devices:",A),f.value=[]}}return me(()=>r.show,A=>{if(A){const a=Number.isInteger(r.startStep)?r.startStep:0;n.value=Math.min(Math.max(a,0),m.length-1)}}),me(()=>r.startStep,A=>{if(r.show){const a=Number.isInteger(A)?A:0;n.value=Math.min(Math.max(a,0),m.length-1)}}),De(()=>{r.show&&ie()}),(A,a)=>l.show?(s(),i("div",{key:0,class:"modal-overlay",onClick:R},[e("div",{class:"modal-container",onClick:a[19]||(a[19]=pe(()=>{},["stop"]))},[e("div",zr,[e("h2",null,[a[22]||(a[22]=e("i",{class:"mdi mdi-file-document-edit"},null,-1)),D(" "+v(l.editMode?"Edit SmartIR Profile":"Create SmartIR Profile"),1)]),e("button",{onClick:N,class:"close-button"},[...a[23]||(a[23]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Jr,[(s(),i(be,null,ke(m,(c,p)=>e("div",{key:p,class:ee(["step",{active:n.value===p,completed:n.value>p}])},[e("div",Wr,[n.value>p?(s(),i("i",Gr)):(s(),i("span",Kr,v(p+1),1))]),e("span",Xr,v(c.label),1)],2)),64))]),e("div",Yr,[n.value===0?(s(),i("div",Zr,[a[29]||(a[29]=e("h3",null,"Device Information",-1)),e("div",Qr,[a[25]||(a[25]=e("label",null,"Platform Type *",-1)),J(e("select",{"onUpdate:modelValue":a[0]||(a[0]=c=>u.value.platform=c),onChange:x},[...a[24]||(a[24]=[Me('<option value="" data-v-dc23b1c0>Select platform...</option><option value="climate" data-v-dc23b1c0>ðŸŒ¡ï¸ Climate (AC, Heater, Heat Pump)</option><option value="media_player" data-v-dc23b1c0>ðŸ“º Media Player (TV, Receiver)</option><option value="fan" data-v-dc23b1c0>ðŸŒ€ Fan</option><option value="light" data-v-dc23b1c0>ðŸ’¡ Light (LED Strip, IR Light)</option>',5)])],544),[[$e,u.value.platform]])]),e("div",ed,[a[26]||(a[26]=e("label",null,"Manufacturer *",-1)),J(e("input",{"onUpdate:modelValue":a[1]||(a[1]=c=>u.value.manufacturer=c),type:"text",placeholder:"e.g., Daikin, LG, Samsung"},null,512),[[_e,u.value.manufacturer]])]),e("div",td,[a[27]||(a[27]=e("label",null,"Model(s) *",-1)),J(e("input",{"onUpdate:modelValue":a[2]||(a[2]=c=>u.value.model=c),type:"text",placeholder:"e.g., FTXS35K, Multiple models"},null,512),[[_e,u.value.model]]),a[28]||(a[28]=e("small",null,'Enter model number or "Multiple" if it works with many models',-1))])])):E("",!0),n.value===1?(s(),i("div",od,[u.value.platform==="climate"?(s(),Te(Ci,{key:0,modelValue:u.value.config,"onUpdate:modelValue":a[3]||(a[3]=c=>u.value.config=c)},null,8,["modelValue"])):u.value.platform==="media_player"?(s(),i("div",ld,[a[36]||(a[36]=e("h3",null,"Media Player Configuration",-1)),a[37]||(a[37]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),D(" Configure the features your media player supports. You'll learn the IR commands in the next step. ")],-1)),e("div",nd,[a[35]||(a[35]=e("h4",null,"Supported Features",-1)),e("div",sd,[e("label",ad,[J(e("input",{type:"checkbox",value:"turn_on","onUpdate:modelValue":a[4]||(a[4]=c=>P.value=c)},null,512),[[ce,P.value]]),a[30]||(a[30]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),D(" Power On/Off ")],-1))]),e("label",id,[J(e("input",{type:"checkbox",value:"volume","onUpdate:modelValue":a[5]||(a[5]=c=>P.value=c)},null,512),[[ce,P.value]]),a[31]||(a[31]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-volume-high"}),D(" Volume Control ")],-1))]),e("label",rd,[J(e("input",{type:"checkbox",value:"mute","onUpdate:modelValue":a[6]||(a[6]=c=>P.value=c)},null,512),[[ce,P.value]]),a[32]||(a[32]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-volume-mute"}),D(" Mute ")],-1))]),e("label",dd,[J(e("input",{type:"checkbox",value:"source","onUpdate:modelValue":a[7]||(a[7]=c=>P.value=c)},null,512),[[ce,P.value]]),a[33]||(a[33]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-import"}),D(" Source Selection ")],-1))]),e("label",ud,[J(e("input",{type:"checkbox",value:"channel","onUpdate:modelValue":a[8]||(a[8]=c=>P.value=c)},null,512),[[ce,P.value]]),a[34]||(a[34]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-numeric"}),D(" Channel Control ")],-1))])])])])):u.value.platform==="fan"?(s(),i("div",cd,[a[44]||(a[44]=e("h3",null,"Fan Configuration",-1)),a[45]||(a[45]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),D(" Configure the features your fan supports. You'll learn the IR commands in the next step. ")],-1)),e("div",md,[a[40]||(a[40]=e("h4",null,"Fan Speed Levels",-1)),e("div",vd,[a[39]||(a[39]=e("label",null,"Number of Speed Levels *",-1)),J(e("select",{"onUpdate:modelValue":a[9]||(a[9]=c=>Y.value=c)},[...a[38]||(a[38]=[e("option",{value:1},"1 Speed",-1),e("option",{value:2},"2 Speeds",-1),e("option",{value:3},"3 Speeds (Low/Med/High)",-1),e("option",{value:4},"4 Speeds",-1),e("option",{value:5},"5 Speeds",-1),e("option",{value:6},"6 Speeds",-1)])],512),[[$e,Y.value,void 0,{number:!0}]])])]),e("div",pd,[a[43]||(a[43]=e("h4",null,"Additional Features",-1)),e("div",fd,[e("label",gd,[J(e("input",{type:"checkbox",value:"oscillate","onUpdate:modelValue":a[10]||(a[10]=c=>ne.value=c)},null,512),[[ce,ne.value]]),a[41]||(a[41]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-sync"}),D(" Oscillation ")],-1))]),e("label",yd,[J(e("input",{type:"checkbox",value:"direction","onUpdate:modelValue":a[11]||(a[11]=c=>ne.value=c)},null,512),[[ce,ne.value]]),a[42]||(a[42]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-rotate-3d-variant"}),D(" Direction (Forward/Reverse) ")],-1))])])])])):u.value.platform==="light"?(s(),i("div",bd,[a[51]||(a[51]=e("h3",null,"Light Configuration",-1)),a[52]||(a[52]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),D(" Configure the features your light supports. You'll learn the IR commands in the next step. ")],-1)),e("div",hd,[a[50]||(a[50]=e("h4",null,"Supported Features",-1)),e("div",kd,[e("label",wd,[J(e("input",{type:"checkbox",value:"turn_on","onUpdate:modelValue":a[12]||(a[12]=c=>te.value=c)},null,512),[[ce,te.value]]),a[46]||(a[46]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),D(" Power On/Off ")],-1))]),e("label",$d,[J(e("input",{type:"checkbox",value:"brightness","onUpdate:modelValue":a[13]||(a[13]=c=>te.value=c)},null,512),[[ce,te.value]]),a[47]||(a[47]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-brightness-6"}),D(" Brightness Control ")],-1))]),e("label",Cd,[J(e("input",{type:"checkbox",value:"color_temp","onUpdate:modelValue":a[14]||(a[14]=c=>te.value=c)},null,512),[[ce,te.value]]),a[48]||(a[48]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-thermometer"}),D(" Color Temperature ")],-1))]),e("label",Sd,[J(e("input",{type:"checkbox",value:"rgb","onUpdate:modelValue":a[15]||(a[15]=c=>te.value=c)},null,512),[[ce,te.value]]),a[49]||(a[49]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-palette"}),D(" RGB Color ")],-1))])])])])):E("",!0)])):E("",!0),n.value===2?(s(),i("div",_d,[fe(Qi,{modelValue:u.value.commands,"onUpdate:modelValue":a[16]||(a[16]=c=>u.value.commands=c),platform:u.value.platform,config:u.value.config,broadlinkDevice:u.value.broadlinkDevice,"onUpdate:broadlinkDevice":a[17]||(a[17]=c=>u.value.broadlinkDevice=c),manufacturer:u.value.manufacturer,model:u.value.model,commandType:u.value.commandType,"onUpdate:commandType":a[18]||(a[18]=c=>u.value.commandType=c)},null,8,["modelValue","platform","config","broadlinkDevice","manufacturer","model","commandType"])])):E("",!0),n.value===3?(s(),i("div",Id,[fe(Sr,{profile:u.value,"json-data":he.value,"yaml-config":G.value},null,8,["profile","json-data","yaml-config"])])):E("",!0)]),e("div",Dd,[n.value>0?(s(),i("button",{key:0,onClick:ue,class:"btn-secondary"},[...a[53]||(a[53]=[e("i",{class:"mdi mdi-arrow-left"},null,-1),D(" Back ",-1)])])):E("",!0),a[57]||(a[57]=e("div",{class:"spacer"},null,-1)),e("button",{onClick:N,class:"btn-text"}," Cancel "),n.value<m.length-1?(s(),i("button",{key:1,onClick:K,class:"btn-primary",disabled:!de.value},[...a[54]||(a[54]=[D(" Next ",-1),e("i",{class:"mdi mdi-arrow-right"},null,-1)])],8,xd)):(s(),i("div",Td,[e("button",{onClick:le,class:"btn-primary",disabled:$.value},[a[55]||(a[55]=e("i",{class:"mdi mdi-cloud-upload"},null,-1)),D(" "+v($.value?"Saving...":"Save to SmartIR"),1)],8,Rd),e("button",{onClick:q,class:"btn-secondary",disabled:$.value},[...a[56]||(a[56]=[e("i",{class:"mdi mdi-download"},null,-1),D(" Download JSON ",-1)])],8,Md)]))])]),fe(Hr,{show:y.value,platform:u.value.platform,warnings:I.value,"config-path":L.value,onClose:a[20]||(a[20]=c=>y.value=!1),onComplete:re},null,8,["show","platform","warnings","config-path"]),fe(Re,{isOpen:O.value,title:"Change Command Type?",message:"Changing the command type will clear all learned commands. Continue?",confirmText:"Continue",cancelText:"Cancel",dangerMode:!0,onConfirm:S,onCancel:V},null,8,["isOpen"]),fe(Re,{isOpen:B.value,title:"Close Profile Builder?",message:"Are you sure you want to close? Your progress will be lost.",confirmText:"Close",cancelText:"Keep Editing",dangerMode:!0,onConfirm:d,onCancel:a[21]||(a[21]=c=>B.value=!1)},null,8,["isOpen"])])):E("",!0)}},Od=we(Ld,[["__scopeId","data-v-dc23b1c0"]]),Ad={class:"dashboard"},Ed={__name:"Dashboard",setup(l){const g=Fe(),r=Ce("smartirEnabled"),w=b(!1),h=b(!1),n=b(null),$=b(0),f=b(null);function y(){h.value=!1,n.value=null,$.value=0,w.value=!0}async function I({platform:O,profile:B,startStep:j}){$.value=Number.isInteger(j)?j:0;try{const _=await fetch(`api/smartir/platforms/${O}/profiles/${B.code}`);if(!_.ok)throw new Error("Failed to load profile");const o=await _.json();let m="";try{const u=await fetch(`api/smartir/config/get-device?platform=${O}&code=${B.code}`);u.ok?(m=(await u.json()).controller_data||"",console.log("âœ… Found controller_data from YAML:",m)):console.warn("âš ï¸ No YAML entry found for this profile (this is OK for profiles not yet added to config)")}catch(u){console.warn("âš ï¸ Could not fetch controller_data from config:",u)}h.value=!0,n.value={platform:O,code:B.code,profile:{...o.profile,controller_data:m}},w.value=!0}catch(_){console.error("Error loading profile for edit:",_),g.error("Failed to load profile for editing")}}function L(){w.value=!1,h.value=!1,n.value=null}function k(){console.log("Show install guide clicked"),window.open("https://github.com/smartHomeHub/SmartIR","_blank")}async function t(O){console.log("Profile saved:",O),L(),f.value&&f.value.loadAllProfiles&&(await f.value.loadAllProfiles(),console.log("âœ… Profiles list refreshed"))}return(O,B)=>(s(),i("div",Ad,[Se(r)?(s(),Te(as,{key:0})):E("",!0),B[0]||(B[0]=Me('<div class="welcome-banner" data-v-fbe628f8><div class="banner-content" data-v-fbe628f8><div class="banner-icon" data-v-fbe628f8><i class="mdi mdi-rocket-launch" data-v-fbe628f8></i></div><div class="banner-text" data-v-fbe628f8><h2 data-v-fbe628f8>Welcome to Broadlink Manager v2!</h2><p data-v-fbe628f8>Manage your IR/RF devices with a modern Vue 3 interface</p></div></div><div class="status-badges" data-v-fbe628f8><span class="badge success" data-v-fbe628f8><i class="mdi mdi-check-circle" data-v-fbe628f8></i> Vue 3 Ready </span><span class="badge warning" data-v-fbe628f8><i class="mdi mdi-beta" data-v-fbe628f8></i> Beta </span></div></div>',1)),fe(es),Se(r)?(s(),Te(Da,{key:1,ref_key:"smartirStatusCard",ref:f,onCreateProfile:y,onEditProfile:I,onShowInstallGuide:k},null,512)):E("",!0),fe(Od,{show:w.value,editMode:h.value,editData:n.value,startStep:$.value,onClose:L,onSave:t},null,8,["show","editMode","editData","startStep"])]))}},Vd=we(Ed,[["__scopeId","data-v-fbe628f8"]]),jd={class:"toast-container"},Ud={class:"toast-content"},Fd={key:0,class:"toast-title"},Pd={class:"toast-message"},Nd={key:1,class:"toast-description"},Bd=["onClick"],qd={__name:"Toast",setup(l,{expose:g}){const r=b([]);let w=0;function h(f){const y={success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information"};return y[f]||y.info}function n({message:f,title:y,description:I,type:L="info",duration:k=5e3}){const t=w++,O={id:t,message:f,title:y,description:I,type:L};return r.value.push(O),k>0&&setTimeout(()=>{$(t)},k),t}function $(f){const y=r.value.findIndex(I=>I.id===f);y>-1&&r.value.splice(y,1)}return g({addToast:n,removeToast:$,show:n,success:(f,y)=>n({message:f,title:y,type:"success"}),error:(f,y)=>n({message:f,title:y,type:"error",duration:8e3}),warning:(f,y)=>n({message:f,title:y,type:"warning",duration:6e3}),info:(f,y)=>n({message:f,title:y,type:"info"})}),(f,y)=>(s(),Te(We,{to:"body"},[e("div",jd,[fe(ot,{name:"toast"},{default:Pe(()=>[(s(!0),i(be,null,ke(r.value,I=>(s(),i("div",{key:I.id,class:ee(["toast",[`toast-${I.type}`]])},[e("i",{class:ee(["mdi",h(I.type)])},null,2),e("div",Ud,[I.title?(s(),i("div",Fd,v(I.title),1)):E("",!0),e("div",Pd,v(I.message),1),I.description?(s(),i("div",Nd,v(I.description),1)):E("",!0)]),e("button",{onClick:L=>$(I.id),class:"toast-close"},[...y[0]||(y[0]=[e("i",{class:"mdi mdi-close"},null,-1)])],8,Bd)],2))),128))]),_:1})])]))}},Hd=we(qd,[["__scopeId","data-v-bf1fd466"]]),zd={id:"app",class:"app-container"},Jd={class:"app-header"},Wd={class:"header-content"},Gd={class:"header-right"},Kd=["title"],Xd={class:"settings-menu-container"},Yd={key:0,class:"settings-menu"},Zd=["title"],Qd={class:"toggle-content"},eu={key:0,class:"not-installed-label"},tu={key:0,href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"menu-item menu-link menu-subitem"},ou=["disabled"],lu=["disabled"],nu=["disabled"],su={class:"app-main"},au={__name:"App",setup(l){const g=b(null),r=b("light"),w=b(null),h=b(!1),n=b(!1),$=b(!1),f=b(localStorage.getItem("smartir_enabled")!=="false"),y=z(()=>{var m;return((m=w.value)==null?void 0:m.installed)||!1}),I=z(()=>({light:"mdi mdi-weather-sunny",medium:"mdi mdi-weather-partly-cloudy",dark:"mdi mdi-weather-night"})[r.value]),L=z(()=>({light:"Switch to Medium Theme",medium:"Switch to Dark Theme",dark:"Switch to Light Theme"})[r.value]),k=()=>{const m=["light","medium","dark"],P=(m.indexOf(r.value)+1)%m.length;r.value=m[P],document.body.classList.remove("medium-mode","dark-mode"),r.value==="medium"?document.body.classList.add("medium-mode"):r.value==="dark"&&document.body.classList.add("dark-mode"),localStorage.setItem("theme",r.value)},t=async()=>{try{const m=await Xe.getStatus();w.value=m,m.installed?console.log("âœ… SmartIR detected:",m.version):console.log("â„¹ï¸ SmartIR not detected")}catch(m){console.error("Error checking SmartIR:",m),w.value={installed:!1,error:m.message}}},O=async()=>{var m,u;n.value=!0;try{const Y=(await ve.get("/api/diagnostics/markdown")).data.markdown;await navigator.clipboard.writeText(Y),(m=g.value)==null||m.success("Diagnostic summary copied to clipboard!"),h.value=!1}catch(P){console.error("Error copying diagnostics:",P),(u=g.value)==null||u.error("Failed to copy diagnostics")}finally{n.value=!1}},B=async()=>{var m,u;n.value=!0;try{const P=await ve.get("/api/diagnostics/download",{responseType:"blob"}),Y=window.URL.createObjectURL(new Blob([P.data])),ne=document.createElement("a");ne.href=Y;const te=P.headers["content-disposition"];let ge="broadlink_manager_diagnostics.zip";if(te){const T=te.match(/filename="?(.+)"?/);T&&(ge=T[1])}ne.setAttribute("download",ge),document.body.appendChild(ne),ne.click(),ne.remove(),window.URL.revokeObjectURL(Y),(m=g.value)==null||m.success("Diagnostic bundle downloaded!"),h.value=!1}catch(P){console.error("Error downloading diagnostics:",P),(u=g.value)==null||u.error("Failed to download diagnostics")}finally{n.value=!1}},j=()=>{y.value&&(f.value=!f.value,localStorage.setItem("smartir_enabled",f.value.toString()),window.location.reload())},_=async()=>{var m,u,P;$.value=!0;try{const Y=await ve.post("/api/smartir/refresh-index");Y.data.success?(m=g.value)==null||m.success(`Updated to v${Y.data.version} (${Y.data.total_devices} devices)`,"âœ… Index Updated"):(u=g.value)==null||u.error(Y.data.error||"Unknown error","âŒ Update Failed")}catch(Y){console.error("Error updating SmartIR index:",Y),(P=g.value)==null||P.error("Failed to update device index","âŒ Update Error")}finally{$.value=!1,h.value=!1}},o=m=>{m.target.closest(".settings-menu-container")||(h.value=!1)};return De(async()=>{const m=localStorage.getItem("theme");m&&["light","medium","dark"].includes(m)?(r.value=m,m==="medium"?document.body.classList.add("medium-mode"):m==="dark"&&document.body.classList.add("dark-mode")):localStorage.getItem("darkMode")==="true"&&(r.value="dark",document.body.classList.add("dark-mode"),localStorage.setItem("theme","dark")),await t();const u=qe();u&&g.value&&(u.appContext.config.globalProperties.$toast=g.value),document.addEventListener("click",o)}),He(()=>{document.removeEventListener("click",o)}),Ve("smartirStatus",w),Ve("smartirEnabled",f),Ve("refreshSmartIR",t),Ve("toast",g),(m,u)=>(s(),i("div",zd,[e("header",Jd,[e("div",Wd,[u[13]||(u[13]=e("div",{class:"header-left"},[e("i",{class:"mdi mdi-remote"}),e("h1",null,"Broadlink Manager v2"),e("span",{class:"beta-badge"},"BETA")],-1)),e("div",Gd,[e("button",{onClick:k,class:"icon-button",title:L.value},[e("i",{class:ee(I.value)},null,2)],8,Kd),e("div",Xd,[e("button",{onClick:u[0]||(u[0]=P=>h.value=!h.value),class:"icon-button",title:"Settings"},[...u[2]||(u[2]=[e("i",{class:"mdi mdi-cog"},null,-1)])]),h.value?(s(),i("div",Yd,[u[9]||(u[9]=e("div",{class:"menu-section-title"},"Integration Settings",-1)),e("div",{class:ee(["menu-item toggle-item",{disabled:!y.value}]),onClick:u[1]||(u[1]=P=>y.value?j():null),title:y.value?"":"SmartIR is not installed"},[e("div",Qd,[u[3]||(u[3]=e("i",{class:"mdi mdi-air-conditioner"},null,-1)),u[4]||(u[4]=e("span",null,"SmartIR Integration",-1)),y.value?E("",!0):(s(),i("span",eu,"(Not Installed)"))]),e("div",{class:ee(["toggle-switch",{active:f.value&&y.value,disabled:!y.value}])},[...u[5]||(u[5]=[e("div",{class:"toggle-slider"},null,-1)])],2)],10,Zd),f.value?(s(),i("a",tu,[...u[6]||(u[6]=[e("i",{class:"mdi mdi-github"},null,-1),e("span",null,"SmartIR on GitHub",-1)])])):E("",!0),f.value?(s(),i("button",{key:1,onClick:_,class:"menu-item menu-subitem",disabled:$.value},[e("i",{class:ee(["mdi",$.value?"mdi-loading mdi-spin":"mdi-refresh"])},null,2),e("span",null,v($.value?"Updating...":"Update Device Index"),1)],8,ou)):E("",!0),u[10]||(u[10]=e("div",{class:"menu-divider"},null,-1)),u[11]||(u[11]=e("div",{class:"menu-section-title"},"Diagnostics",-1)),e("button",{onClick:O,class:"menu-item",disabled:n.value},[...u[7]||(u[7]=[e("i",{class:"mdi mdi-content-copy"},null,-1),e("span",null,"Copy Diagnostics",-1)])],8,lu),e("button",{onClick:B,class:"menu-item",disabled:n.value},[...u[8]||(u[8]=[e("i",{class:"mdi mdi-download"},null,-1),e("span",null,"Download Diagnostics",-1)])],8,nu),u[12]||(u[12]=Me('<div class="menu-divider" data-v-b6ab76ba></div><div class="menu-section-title" data-v-b6ab76ba>Help &amp; Support</div><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2#readme" target="_blank" class="menu-item menu-link" data-v-b6ab76ba><i class="mdi mdi-book-open-variant" data-v-b6ab76ba></i><span data-v-b6ab76ba>Documentation</span></a><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2/issues" target="_blank" class="menu-item menu-link" data-v-b6ab76ba><i class="mdi mdi-bug" data-v-b6ab76ba></i><span data-v-b6ab76ba>Report Issue</span></a><div class="menu-divider" data-v-b6ab76ba></div><div class="menu-section-title" data-v-b6ab76ba>Community</div><a href="https://community.home-assistant.io/t/broadlink-manager-modern-web-interface-for-broadlink-devices/938473" target="_blank" class="menu-item menu-link" data-v-b6ab76ba><i class="mdi mdi-forum" data-v-b6ab76ba></i><span data-v-b6ab76ba>HA Forum Discussion</span></a><a href="https://www.reddit.com/r/homeassistant/comments/1o1q3kf/release_broadlink_manager_addon_a_modern_web_ui/" target="_blank" class="menu-item menu-link" data-v-b6ab76ba><i class="mdi mdi-reddit" data-v-b6ab76ba></i><span data-v-b6ab76ba>Reddit Discussion</span></a><div class="menu-divider" data-v-b6ab76ba></div><div class="menu-section-title" data-v-b6ab76ba>Project</div><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2" target="_blank" class="menu-item menu-link" data-v-b6ab76ba><i class="mdi mdi-github" data-v-b6ab76ba></i><span data-v-b6ab76ba>GitHub Repository</span></a><a href="https://ko-fi.com/tonyperkins" target="_blank" class="menu-item menu-link menu-item-sponsor" data-v-b6ab76ba><i class="mdi mdi-coffee" data-v-b6ab76ba></i><span data-v-b6ab76ba>Support on Ko-fi</span></a>',12))])):E("",!0)])])])]),e("main",su,[fe(Vd)]),u[14]||(u[14]=e("footer",{class:"app-footer"},[e("p",null,"Broadlink Manager v2.0.0-beta.1 | Built with Vue 3")],-1)),fe(Hd,{ref_key:"toastRef",ref:g},null,512)]))}},iu=we(au,[["__scopeId","data-v-b6ab76ba"]]),Ye=lt(iu),ru=nt();Ye.use(ru);Ye.mount("#app");
