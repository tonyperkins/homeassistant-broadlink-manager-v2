import{g as et,r as g,o as Ae,a as Xe,b as rt,d as dt,c as X,e as n,f as l,h as e,i as M,n as Z,u as _e,t as m,j as x,F as me,k as $e,w as re,l as G,v as Oe,m as ce,p as be,q as He,s as Ge,T as tt,x as Ie,y as Me,z as Fe,A as fe,B as ot,C as ze,D as Pe,E as lt,G as Je,H as ut,I as ct,J as mt,K as qe,L as vt,M as pt}from"./vendor-DGiFqQ_g.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const k of document.querySelectorAll('link[rel="modulepreload"]'))w(k);new MutationObserver(k=>{for(const s of k)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&w(c)}).observe(document,{childList:!0,subtree:!0});function r(k){const s={};return k.integrity&&(s.integrity=k.integrity),k.referrerPolicy&&(s.referrerPolicy=k.referrerPolicy),k.crossOrigin==="use-credentials"?s.credentials="include":k.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function w(k){if(k.ep)return;k.ep=!0;const s=r(k);fetch(k.href,s)}})();let Qe=!1;function Be(){const t=et(),d=t==null?void 0:t.appContext.config.globalProperties.$toast;return d||(Qe||(console.warn("Toast notification system not yet initialized - using console fallback"),Qe=!0),{success:r=>console.log("✓",r),error:r=>console.error("✗",r),warning:r=>console.warn("⚠",r),info:r=>console.info("ℹ",r)})}function Ye(){const t=g(!1),d=g(!1),r=g(!1),w=g(0),k=767,s=768,c=1023,f=1024,S=()=>{const $=window.innerWidth;w.value=$,t.value=$<=k,d.value=$>=s&&$<=c,r.value=$>=f};return Ae(()=>{S(),window.addEventListener("resize",S)}),Xe(()=>{window.removeEventListener("resize",S)}),{isMobile:t,isTablet:d,isDesktop:r,screenWidth:w,isMobileOrTablet:()=>t.value||d.value,isTabletOrDesktop:()=>d.value||r.value}}const Ze="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAHBUlEQVR4nOxZC1BTVxo+9+aNZI2LNsgjWR4hgoIiRVDBslKnIKPbx1jqTrtYoakat1a6dNsdd7t1X8XHyAbEhdUu1u2mXdbasqJbtsaMIqBBECiPBmqEICEBEx4xJLlJ7s6lw6rJDeQ2FzLM+M1kBs7/3+/83zn/Oee/51JRFAXzGbCvA/AWjwX4GvNeANWXnXffHQ4+K6/dYbHeD+IFhjRkb1wn9WPQbEQ4IF/tQlXX2p5+/8OyczY74j/VxuMG3Sh/Oz9jaQDb4CmPT1LIbLXBfzrz0cmHg8fQpx1Yc1Ra+TsiXD4R0PqtRmAyj/LxbJeaujKIcPlEAINOM7vLXBaTZibCRWgRq3WGJZWX63aoNDpB8BJOX/bGlIqwpUv6iXBgWBHG7eUF8urUWvU6Z9sLGxI/IsLl8SJu6u4XigqPXkVspiVTbTQqU1/6Vn7ammh+G5FOMZyqludIKqUVU/9jcaSuTCo/unfHbiad4iBdwMu/P1bV1tO1xbk9NDC0/vwHB1xGcjqYLAh16zsHW3R6XXTu1mfFdAqMrIoSKNbGhLcQ4QGeppDJ7ACtPcqNEI6tT9O3Vqm+tygqNMDjrU9Sef6tIYM2JjUuuXzfC5knCEXsBI8WMZUCAxiCrfhWyMZkMNzYXNHVpwmXXqp5j0Hz0/1m57a3PQ8VHx4JoNMASIl9shLPFsB5ooO7iDXhCY/dAcCvT/79LwC1s/K2bDnAXcQeJRqwMzzeRt/bua0gLChcDsCDNQNBkEU/qot7o6j0kzETQpuJ40ZnT6xSrUoNWhyseHVz2ikv4n4QA5FSArE5IFlTZ0r3XU1MWODib6NCl3a9dkhSYxgbjo4XLq8sL9j7Ip36YEwMRjMNQazMhf7+RgYNnuyo7bY6ArFaWKuXRX495wLwoLk39sO9RaVnM5OTP8zLSjtjsljpp6ovi6pqr706eE8XBwGUSqEy9Guihf/92TMZhetjI5rJCHwKpBRzZqsNYtKp6KD+Pvv1w5ILdzR3UvD8HA4YefOl7N25JKUPIKuUwIJH7A5of/GJf7oLfrIz2EH786fSss+uKFzOk+8L0mqh6rpbmR0q5YyFGAQBSuHHlcUWxEaZyXfMhFD0Rgt9Oh/SBMiam58HAO+oc4XZMsK/1taT6M6uHjJw8w6VSNfvemM8TbzPlFlwsP5KyzfJeL6kCejXDgo894aASqOZ9O/uHwzq6B3ijhitkzOC7XS7j0g+V3S0vQTDDhYEoZSBobvJ+yXFNZ29gy4lOGmvlDBMIfQqSKV8539EWvXHhvbGHBSFrAwGW+vvxzLoR7RxzrNpsyPs0xcv7/lg1/ZfPtKvuw7MVhulUakWdvRq+XY3tWFT90Bk+52BCOzvyOBgjytSFKAgms+b9F/2o+BbKwUrvgjhhjSjKLAPG4YE7lJxfEIf5dyGOwMXrren/eF0RYXRNMrHDt4QbmjDEbHop9F8rqpddZd3sV6R/aWiabtWr41PW534V8m+PFHW+qSPL9TX7oM8WAaBi4IbE4S8yYNs/7asIgBA0ZStRqFM/MXxIzcgHBEBP+C6DJKLgJvK3uXvniitBsDmNzkSEAD9uv5k0aFjXy1gMQ0DQ5p4CAIwNuXLwyL/ExcpqMWeS42NUmxKXFf8VWPdz6cLnkqhGd/Pe+U1Cow/+ekJUYr4qJgvbik7f/Jw+0J/tjpvS3qxs7/LQZZfcrrkUmOdGI/cgUKIkB8pz0xK+CQjKf6z4MWckYftZqsderfsTInsZt0evDRgMRYMHhaLnk+NW1Y/nchxk5lZ+I/Pf/vl9RvbLYiVlSBcJv/VK9sKBCHc3hkF7D12/NzVltZn8YhzNj/3ev6LGeXTdQ6+uzLZ+C+5XNza05Nsd1gXcNgBvekJK/+du3lTUSiXMzzT80TgkkK8wJAGgCMAE5ooFFz3hHTr+lgZ9iMryOngkoi5WZuOc9hPtDu3r4198nTqygjCr3wYmrvVkSerZXljJoT0m0DcYm5g2Mg5WV39zrVWZZofkzaRnhB/bufm9FI/JpXQXj8F8bHyitqWxhzJmwUJT60SNJER+P+BCZjt34lzNbvickRoWVWNmGzuObnYWhER3oAdX41dPbj1jDeYEwGrInltKKCNtatub6hRfJOEnfJkcc+JgE9ltS/DkINuNI3xCo4fbXgm/0CnouvOcjK4Z/16/ZKia+3+kqIrEIQ+sgNx2Jzb5wsPxrD9GBZv+Gd9BqSXr4icg8cwMj4SLmv6+mlv+WddgGlilOPOZkEmFnrLP+sCVgtXyPHaHShkiw0XXPWWf9YF5Gb9uGzp4sCbj7ai4LkNTx2O5nPV3vLPyTeye6P32X+7KNujVKtSYJg+viEu/mx2etJZCgnD57OPfGRh3n8nfizA15j3Av4XAAD//5k1S2w3zfwVAAAAAElFTkSuQmCC",ne=rt.create({baseURL:"./",timeout:3e4,headers:{"Content-Type":"application/json"}});ne.interceptors.request.use(t=>t,t=>Promise.reject(t));ne.interceptors.response.use(t=>t,t=>(console.error("API Error:",t),t.response?console.error("Response error:",t.response.data):t.request?console.error("No response received"):console.error("Request setup error:",t.message),Promise.reject(t)));const ft=dt("devices",{state:()=>({devices:[],loading:!1,error:null,selectedDevice:null}),getters:{deviceById:t=>d=>t.devices.find(r=>r.id===d),devicesByType:t=>d=>t.devices.filter(r=>r.entity_type===d),deviceCount:t=>t.devices.length,hasDevices:t=>t.devices.length>0},actions:{async loadDevices(t=!1){this.loading=!0,this.error=null;try{const d=t?`/api/devices/managed?_t=${Date.now()}`:"/api/devices/managed",r=await ne.get(d);this.devices=r.data.devices||[],console.log("📥 Loaded devices:",this.devices),this.devices.forEach(w=>{console.log(`📥 Device "${w.name}":`,{id:w.id,device:w.device,commands:w.commands,commandCount:w.commands?Object.keys(w.commands).length:0})})}catch(d){this.error=d.message,console.error("Error loading devices:",d)}finally{this.loading=!1}},async createDevice(t){this.loading=!0,this.error=null;try{console.log("🏪 Store: Creating device with data:",t),console.log("🏪 Store: Device commands being sent:",t.commands);const d={device_name:t.name,device:t.device,area_id:t.area||"",area_name:t.area||"",entity_type:t.entity_type,icon:t.icon,broadlink_entity:t.broadlink_entity,device_type:t.device_type||"broadlink",commands:t.commands||{}};t.device_type==="smartir"&&t.smartir_config&&(d.smartir_config=t.smartir_config),console.log("🏪 Store: Transformed data for backend:",d);const r=await ne.post("/api/devices/managed",d);return console.log("🏪 Store: Create response:",r.data),await this.loadDevices(),r.data}catch(d){throw console.error("Error creating device:",d),d}finally{this.loading=!1}},async updateDevice(t,d){this.loading=!0,this.error=null;try{const r=await ne.put(`/api/devices/managed/${t}`,d);return await this.loadDevices(),r.data}catch(r){throw console.error("Error updating device:",r),r}finally{this.loading=!1}},async deleteDevice(t,d=!1){this.loading=!0,this.error=null;try{await ne.delete(`/api/devices/managed/${t}`,{data:{delete_commands:d}}),this.devices=this.devices.filter(r=>r.id!==t)}catch(r){throw this.error=r.message,console.error("Error deleting device:",r),r}finally{this.loading=!1}},selectDevice(t){this.selectedDevice=t},clearSelection(){this.selectedDevice=null},clearError(){this.error=null},updateDeviceCommands(t,d){const r=this.devices.findIndex(w=>w.id===t);if(r!==-1){const w={...this.devices[r],commands:d};this.devices.splice(r,1,w),console.log(`✅ Store: Updated commands for ${t}, count: ${Object.keys(d).length}`)}else console.warn(`⚠️ Store: Device ${t} not found for command update`)},async syncAllAreas(){if(!this.devices||this.devices.length===0){console.log("⚠️ No devices to sync");return}console.log(`🔄 Syncing areas from Home Assistant for ${this.devices.length} devices...`);try{const t=await Promise.all(this.devices.map(w=>(console.log(`🔄 Syncing device: ${w.id} (${w.name})`),ne.post(`/api/devices/${w.id}/sync-area`).then(k=>k.data.success&&k.data.area?(console.log(`✅ Synced area for ${w.name}: ${k.data.area}`),{status:"synced",device:w.name}):{status:"no_area"}).catch(k=>{var s;return((s=k.response)==null?void 0:s.status)===404?(console.log(`❌ Device not found in HA: ${w.id}`),{status:"not_found"}):(console.warn(`⚠️ Failed to sync area for ${w.id}:`,k.message),{status:"error",error:k.message})})))),d=t.filter(w=>w.status==="synced").length,r=t.filter(w=>w.status==="not_found").length;await this.loadDevices(!0),d>0?console.log(`✅ Area sync complete: ${d} synced, ${r} not found in HA`):r>0&&console.log(`ℹ️ No areas synced - ${r} entities not found in HA registry (generate entities first)`)}catch(t){console.debug("Area sync error:",t)}}}});function nt(t){const d=X(()=>t.value||t),r=X(()=>{switch(d.value){case"climate":return"mdi:air-conditioner";case"fan":return"mdi:fan";case"light":return"mdi:lightbulb";case"media_player":return"mdi:television";case"switch":return"mdi:light-switch";default:return"mdi:devices"}}),w=X(()=>`device-type-${d.value}-color`),k=X(()=>`tag-${d.value}-bg`);return{icon:r,colorClass:w,tagBgClass:k}}const gt=""+new URL("broadlink-logo-BDjImjRY.png",import.meta.url).href,Ce=(t,d)=>{const r=t.__vccOpts||t;for(const[w,k]of d)r[w]=k;return r},yt={class:"device-header"},bt={class:"device-info"},ht=["title"],kt={class:"device-labels"},wt={class:"device-type"},$t=["src","alt","title"],Ct={class:"device-body"},_t={class:"device-stats"},St={class:"stat",title:"Learned command count"},It={class:"stat",title:"HA Assigned Area"},Dt={class:"device-meta"},Tt={class:"device-id",title:"Device ID"},xt={key:0,class:"storage-name"},Mt={key:1,class:"broadlink-entity",title:"Controller Device"},Rt={key:2,class:"controller-device"},Lt={class:"device-actions"},Ot=["disabled"],At=["disabled"],Et=["disabled"],Vt={key:0,class:"disabled-overlay"},Pt={__name:"DeviceCard",props:{device:{type:Object,required:!0},broadlinkDevices:{type:Array,default:()=>[]}},emits:["edit","delete","learn"],setup(t){const d=t,r=X(()=>localStorage.getItem("smartir_simulate_not_installed")==="true"),w=X(()=>d.device.device_type==="smartir"&&r.value),k=g(null),s=nt(X(()=>d.device.entity_type)),c=X(()=>d.device.icon?d.device.icon:s.icon.value),f=a=>a&&a.startsWith("mdi:")?`mdi ${a.replace(":"," mdi-")}`:`mdi mdi-${a}`,S=X(()=>({light:"Light",fan:"Fan",switch:"Switch",media_player:"Media Player",cover:"Cover"})[d.device.entity_type]||d.device.entity_type),$=X(()=>(d.device.device_type||"broadlink")==="smartir"?"SmartIR":"Broadlink"),E=X(()=>(d.device.device_type||"broadlink")==="smartir"?Ze:gt),C=X(()=>(d.device.device_type||"broadlink")==="smartir"?k.value!==null?k.value:0:Object.keys(d.device.commands||{}).length),o=a=>{if(!a)return"";const b=d.broadlinkDevices.find(p=>p.entity_id===a);return b&&b.name||a},R=X(()=>{if(!d.device.device)return!1;const a=d.device.id.includes(".")?d.device.id.split(".")[1]:d.device.id;return d.device.device!==a}),q=X(()=>{if(!d.device.broadlink_entity)return"";const a=d.broadlinkDevices.find(b=>b.entity_id===d.device.broadlink_entity);return a&&a.name||d.device.broadlink_entity}),V=a=>{if(!a||typeof a!="object")return 0;let b=0;for(const p of Object.values(a))typeof p=="string"?b++:typeof p=="object"&&(b+=V(p));return b},I=async()=>{if(!(!d.device.device_code||!d.device.entity_type))try{const a=await ne.get("/api/smartir/codes/code",{params:{entity_type:d.device.entity_type,code_id:d.device.device_code}});if(a.data.success&&a.data.code){const b=a.data.code;b.commands&&(k.value=V(b.commands))}}catch(a){console.error("Error fetching SmartIR command count:",a)}};return Ae(async()=>{(d.device.device_type||"broadlink")==="smartir"&&await I()}),(a,b)=>(l(),n("div",{class:Z(["device-card",{disabled:w.value}])},[e("div",yt,[e("div",{class:Z(["device-icon",_e(s).colorClass.value])},[e("i",{class:Z(f(c.value))},null,2)],2),e("div",bt,[e("h3",{title:t.device.name},m(t.device.name),9,ht),e("div",kt,[e("span",wt,m(S.value),1)])]),e("img",{src:E.value,alt:$.value,title:$.value,class:"device-source-logo"},null,8,$t)]),e("div",Ct,[e("div",_t,[e("div",St,[b[3]||(b[3]=e("i",{class:"mdi mdi-remote"},null,-1)),e("span",null,m(C.value)+" command"+m(C.value!==1?"s":""),1)]),e("div",It,[b[4]||(b[4]=e("i",{class:"mdi mdi-map-marker"},null,-1)),e("span",null,m(t.device.area||"No area"),1)])]),e("div",Dt,[e("span",Tt,[b[5]||(b[5]=e("i",{class:"mdi mdi-identifier"},null,-1)),x(" "+m(t.device.id),1)]),R.value?(l(),n("span",xt,[b[6]||(b[6]=e("i",{class:"mdi mdi-code-tags"},null,-1)),x(" "+m(t.device.device),1)])):M("",!0),t.device.broadlink_entity?(l(),n("span",Mt,[b[7]||(b[7]=e("i",{class:"mdi mdi-access-point"},null,-1)),x(" "+m(q.value),1)])):M("",!0),t.device.controller_device?(l(),n("span",Rt,[b[8]||(b[8]=e("i",{class:"mdi mdi-access-point"},null,-1)),x(" "+m(o(t.device.controller_device)),1)])):M("",!0)])]),e("div",Lt,[e("button",{onClick:b[0]||(b[0]=p=>!w.value&&a.$emit("learn",t.device)),class:"icon-btn",title:"Manage Commands",disabled:w.value},[...b[9]||(b[9]=[e("i",{class:"mdi mdi-remote-tv"},null,-1)])],8,Ot),e("button",{onClick:b[1]||(b[1]=p=>!w.value&&a.$emit("edit",t.device)),class:"icon-btn",title:"Edit",disabled:w.value},[...b[10]||(b[10]=[e("i",{class:"mdi mdi-pencil"},null,-1)])],8,At),e("button",{onClick:b[2]||(b[2]=p=>!w.value&&a.$emit("delete",t.device)),class:"icon-btn danger",title:"Delete",disabled:w.value},[...b[11]||(b[11]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Et)]),w.value?(l(),n("div",Vt,[...b[12]||(b[12]=[e("div",{class:"disabled-message"},[e("i",{class:"mdi mdi-eye-off"}),e("span",null,"SmartIR Not Installed")],-1)])])):M("",!0)],2))}},jt=Ce(Pt,[["__scopeId","data-v-7a7f5c18"]]),Ut={name:"DeviceListView",props:{devices:{type:Array,required:!0}},methods:{getDeviceCommands(t){return t.commands&&typeof t.commands=="object"?Object.keys(t.commands):[]},getCommandType(t,d){return t.commands&&t.commands[d]&&t.commands[d].type||"ir"},getCommandTypeClass(t,d){return this.getCommandType(t,d)==="rf"?"command-rf":"command-ir"},getCommandTypeLabel(t,d){return this.getCommandType(t,d)==="rf"?"RF Command":"IR Command"},sendCommand(t,d){this.$emit("send-command",{device:t,command:d})},openCommands(t){this.$emit("open-commands",t)},editDevice(t){this.$emit("edit-device",t)},deleteDevice(t){this.$emit("delete-device",t)}}},Ft={class:"device-list-view"},Nt={class:"device-table"},Bt={class:"device-info"},Ht={class:"device-name"},qt={class:"device-entity"},zt={class:"device-area"},Jt={class:"device-type"},Wt=["title"],Kt={key:0,class:"mdi mdi-sparkles",style:{color:"#9c27b0"}},Xt={key:1,class:"mdi mdi-view-grid",style:{color:"#2196f3"}},Gt={class:"device-commands"},Yt={key:0,class:"command-list"},Zt=["onClick","title"],Qt={key:0,class:"no-commands"},eo={key:1,class:"smartir-info"},to={class:"profile-code"},oo={class:"device-actions"},lo=["onClick"],no=["onClick"],so=["onClick"];function ao(t,d,r,w,k,s){return l(),n("div",Ft,[e("table",Nt,[d[3]||(d[3]=e("thead",null,[e("tr",null,[e("th",null,"Device"),e("th",null,"Room/Area"),e("th",null,"Type"),e("th",null,"Commands"),e("th",null,"Actions")])],-1)),e("tbody",null,[(l(!0),n(me,null,$e(r.devices,c=>(l(),n("tr",{key:c.entity_id,class:"device-row"},[e("td",Bt,[e("div",Ht,m(c.friendly_name||c.name),1),e("div",qt,m(c.entity_id),1)]),e("td",zt,m(c.area||"No Area"),1),e("td",Jt,[e("div",{class:"type-icon",title:c.device_type==="smartir"?"SmartIR":"Broadlink"},[c.device_type==="smartir"?(l(),n("i",Kt)):(l(),n("i",Xt))],8,Wt)]),e("td",Gt,[(c.device_type||"broadlink")==="broadlink"?(l(),n("div",Yt,[(l(!0),n(me,null,$e(s.getDeviceCommands(c),f=>(l(),n("button",{key:f,class:Z(["command-btn",s.getCommandTypeClass(c,f)]),onClick:S=>s.sendCommand(c,f),title:s.getCommandTypeLabel(c,f)},m(f),11,Zt))),128)),s.getDeviceCommands(c).length===0?(l(),n("span",Qt," No commands ")):M("",!0)])):c.device_type==="smartir"?(l(),n("div",eo,[e("span",to,"Profile: "+m(c.device_code),1)])):M("",!0)]),e("td",oo,[e("button",{class:"action-btn commands",onClick:f=>s.openCommands(c),title:"Manage Commands"},[...d[0]||(d[0]=[e("i",{class:"mdi mdi-remote-tv"},null,-1)])],8,lo),e("button",{class:"action-btn edit",onClick:f=>s.editDevice(c),title:"Edit"},[...d[1]||(d[1]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])],8,no),e("button",{class:"action-btn delete",onClick:f=>s.deleteDevice(c),title:"Delete"},[...d[2]||(d[2]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])],8,so)])]))),128))])])])}const io=Ce(Ut,[["render",ao],["__scopeId","data-v-96afef5a"]]),ro={class:"icon-picker"},uo={class:"icon-input-wrapper"},co=["id","placeholder"],mo={key:0,class:"icon-preview"},vo={key:0,class:"icon-dropdown"},po={class:"icon-grid"},fo=["onMousedown","title"],go={__name:"IconPicker",props:{modelValue:{type:String,default:""},inputId:{type:String,default:"icon-input"},placeholder:{type:String,default:"e.g., mdi:television"}},emits:["update:modelValue"],setup(t,{emit:d}){const r=t,w=d,k=g(r.modelValue),s=g(!1),c=["television","speaker","radio","music","video","movie","play","pause","stop","skip-next","skip-previous","volume-high","volume-medium","volume-low","volume-off","remote","remote-tv","cast","chromecast","spotify","netflix","youtube","lightbulb","lightbulb-on","lightbulb-off","lamp","floor-lamp","ceiling-light","light-switch","led-strip","led-strip-variant","wall-sconce","chandelier","spotlight","track-light","vanity-light","desk-lamp","fan","ceiling-fan","air-conditioner","thermometer","thermostat","heat-wave","snowflake","fire","radiator","water-boiler","hvac","blinds","blinds-open","window-shutter","window-shutter-open","curtains","curtains-closed","roller-shade","roller-shade-closed","garage","garage-open","gate","door","door-open","window-open","window-closed","washing-machine","tumble-dryer","dishwasher","refrigerator","stove","microwave","oven","toaster","kettle","coffee","coffee-maker","blender","robot-vacuum","robot-vacuum-variant","vacuum","broom","spray-bottle","lock","lock-open","lock-smart","key","shield","shield-check","alarm-light","bell","doorbell","camera","cctv","motion-sensor","smoke-detector","fire-extinguisher","water-alert","gas-cylinder","sofa","bed","bed-double","desk","chair","table","bookshelf","home","home-outline","home-assistant","floor-plan","room","weather-sunny","weather-night","weather-cloudy","weather-rainy","weather-snowy","weather-lightning","weather-windy","weather-fog","weather-partly-cloudy","umbrella","water","water-percent","phone","cellphone","tablet","laptop","desktop-tower","monitor","keyboard","mouse","printer","router","router-wireless","access-point","wifi","bluetooth","usb","hdmi-port","ethernet","power","power-plug","power-socket","battery","battery-charging","lightning-bolt","flash","solar-panel","solar-power","leaf","tree","flower","sprout","grass","watering-can","shovel","fence","pool","hot-tub","silverware","silverware-fork-knife","food","food-apple","glass-wine","glass-cocktail","bottle-wine","pot","pot-steam","shower","shower-head","bathtub","toilet","sink","faucet","hand-wash","car","car-side","garage-variant","tools","hammer","wrench","screwdriver","toolbox","ladder","heart","heart-pulse","run","walk","bike","dumbbell","yoga","scale-bathroom","thermometer-lines","clock","clock-outline","timer","alarm","calendar","calendar-today","calendar-clock","history","bell-ring","bell-alert","alert","alert-circle","information","help-circle","check","check-circle","close-circle","minus-circle","plus-circle","arrow-up","arrow-down","arrow-left","arrow-right","chevron-up","chevron-down","menu","dots-vertical","dots-horizontal","cog","tune","circle","square","triangle","hexagon","star","star-outline","heart-outline","plus","minus","close","check-bold","eye","eye-off","account","account-group","baby","dog","cat","paw","gift","balloon","party-popper","candle","book","book-open","newspaper","email","message","phone-classic"];re(()=>r.modelValue,C=>{k.value=C});const f=X(()=>{if(!k.value)return c.slice(0,50);const C=k.value.toLowerCase().replace("mdi:","");return c.filter(o=>o.toLowerCase().includes(C)).slice(0,50)}),S=()=>{s.value=!0,w("update:modelValue",k.value)},$=()=>{setTimeout(()=>{s.value=!1},200)},E=C=>{k.value=`mdi:${C}`,w("update:modelValue",k.value),s.value=!1};return(C,o)=>(l(),n("div",ro,[e("div",uo,[G(e("input",{id:t.inputId,"onUpdate:modelValue":o[0]||(o[0]=R=>k.value=R),type:"text",placeholder:t.placeholder,onInput:S,onFocus:o[1]||(o[1]=R=>s.value=!0),onBlur:$},null,40,co),[[Oe,k.value]]),k.value?(l(),n("div",mo,[e("i",{class:Z(`mdi mdi-${k.value.replace("mdi:","")}`)},null,2)])):M("",!0)]),s.value&&f.value.length>0?(l(),n("div",vo,[e("div",po,[(l(!0),n(me,null,$e(f.value,R=>(l(),n("div",{key:R,class:"icon-option",onMousedown:ce(q=>E(R),["prevent"]),title:R},[e("i",{class:Z(`mdi mdi-${R}`)},null,2),e("span",null,m(R),1)],40,fo))),128))])])):M("",!0)]))}},yo=Ce(go,[["__scopeId","data-v-a64f5011"]]),bo={key:0,class:"dropdown-label"},ho={key:0,class:"required"},ko=["placeholder","disabled","onKeydown"],wo={class:"dropdown-icons"},$o={key:0,class:"mdi mdi-loading mdi-spin"},Co={key:2,class:"mdi mdi-chevron-down"},_o={key:1,class:"error-message"},So={key:2,class:"hint-message"},Io={key:0,class:"dropdown-menu"},Do=["onMousedown","onMouseenter"],To={class:"option-content"},xo={class:"option-label"},Mo={key:0,class:"option-description"},Ro={key:0,class:"mdi mdi-check selected-icon"},Lo={key:3,class:"dropdown-menu"},Oo={__name:"SearchableDropdown",props:{modelValue:{type:[String,Number,Object],default:null},options:{type:Array,required:!0,default:()=>[]},label:{type:String,default:""},placeholder:{type:String,default:"Search..."},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},error:{type:String,default:""},hint:{type:String,default:""},optionLabel:{type:String,default:"label"},optionValue:{type:String,default:"value"},optionDescription:{type:String,default:"description"},filterMethod:{type:Function,default:null}},emits:["update:modelValue","change","search"],setup(t,{emit:d}){const r=t,w=d,k=g(null),s=g(null),c=g(""),f=g(!1),S=g(0),$=g(!1),E=A=>typeof A=="string"||typeof A=="number"?A:A[r.optionLabel]||A.label||A.name||String(A),C=A=>typeof A=="string"||typeof A=="number"?A:A[r.optionValue]||A.value||A.id||A,o=A=>typeof A=="string"||typeof A=="number"?"":A[r.optionDescription]||A.description||"",R=A=>{const N=C(A);return typeof r.modelValue=="object"?C(r.modelValue)===N:r.modelValue===N},q=X(()=>{if(!c.value)return r.options;if(r.filterMethod)return r.options.filter(N=>r.filterMethod(N,c.value));const A=c.value.toLowerCase();return r.options.filter(N=>{const le=E(N).toLowerCase(),de=o(N).toLowerCase();return le.includes(A)||de.includes(A)})}),V=X(()=>{if(!r.modelValue)return"";const A=r.options.find(N=>{const le=C(N);return typeof r.modelValue=="object"?le===C(r.modelValue):le===r.modelValue});return A?E(A):""});re(()=>r.modelValue,A=>{$.value||(c.value=V.value)}),re(()=>r.options,()=>{!$.value&&r.modelValue&&(c.value=V.value)},{deep:!0}),re(c,A=>{w("search",A),S.value=0}),Ae(()=>{c.value=V.value});const I=()=>{var A;$.value=!0,f.value=!0,(A=s.value)==null||A.select()},a=()=>{$.value=!1,setTimeout(()=>{f.value=!1,r.modelValue?c.value=V.value:c.value=""},200)},b=()=>{var A;f.value=!1,(A=s.value)==null||A.blur()},p=A=>{const N=C(A);w("update:modelValue",N),w("change",N,A),c.value=E(A),b()},L=()=>{var A;w("update:modelValue",null),w("change",null,null),c.value="",(A=s.value)==null||A.focus()},J=()=>{if(!f.value){f.value=!0;return}S.value<q.value.length-1&&S.value++},Q=()=>{S.value>0&&S.value--},H=()=>{q.value.length>0&&S.value>=0&&p(q.value[S.value])},te=A=>{k.value&&!k.value.contains(A.target)&&(f.value=!1,r.modelValue?c.value=V.value:c.value="")};return Ae(()=>{document.addEventListener("click",te)}),Xe(()=>{document.removeEventListener("click",te)}),(A,N)=>(l(),n("div",{class:"searchable-dropdown",ref_key:"dropdownRef",ref:k},[t.label?(l(),n("label",bo,[x(m(t.label)+" ",1),t.required?(l(),n("span",ho,"*")):M("",!0)])):M("",!0),e("div",{class:Z(["dropdown-input-wrapper",{"has-error":t.error,disabled:t.disabled}])},[G(e("input",{ref_key:"inputRef",ref:s,type:"text","onUpdate:modelValue":N[0]||(N[0]=le=>c.value=le),placeholder:t.placeholder,disabled:t.disabled||t.loading,onFocus:I,onBlur:a,onKeydown:[He(ce(J,["prevent"]),["down"]),He(ce(Q,["prevent"]),["up"]),He(ce(H,["prevent"]),["enter"]),He(b,["escape"])],class:"dropdown-input"},null,40,ko),[[Oe,c.value]]),e("div",wo,[t.loading?(l(),n("i",$o)):t.modelValue&&!t.disabled?(l(),n("i",{key:1,class:"mdi mdi-close-circle clear-icon",onClick:L})):(l(),n("i",Co))])],2),t.error?(l(),n("div",_o,m(t.error),1)):M("",!0),t.hint&&!t.error?(l(),n("div",So,m(t.hint),1)):M("",!0),be(tt,{name:"dropdown"},{default:Ge(()=>[f.value&&q.value.length>0?(l(),n("div",Io,[(l(!0),n(me,null,$e(q.value,(le,de)=>(l(),n("div",{key:C(le),class:Z(["dropdown-item",{highlighted:de===S.value,selected:R(le)}]),onMousedown:ce(he=>p(le),["prevent"]),onMouseenter:he=>S.value=de},[e("div",To,[e("div",xo,m(E(le)),1),o(le)?(l(),n("div",Mo,m(o(le)),1)):M("",!0)]),R(le)?(l(),n("i",Ro)):M("",!0)],42,Do))),128))])):M("",!0)]),_:1}),f.value&&q.value.length===0&&!t.loading?(l(),n("div",Lo,[...N[1]||(N[1]=[e("div",{class:"dropdown-item no-results"},[e("i",{class:"mdi mdi-magnify"}),x(" No results found ")],-1)])])):M("",!0)],512))}},We=Ce(Oo,[["__scopeId","data-v-679ce35f"]]),Ao={class:"smartir-selector"},Eo={class:"form-group"},Vo={class:"form-group"},Po={class:"form-group"},jo=["value"],Uo={key:0,class:"error-message"},Fo={class:"form-group"},No={class:"form-group"},Bo={key:1,class:"code-info"},Ho={class:"info-content"},qo={class:"info-row"},zo={class:"info-value"},Jo={class:"info-row"},Wo={class:"info-value"},Ko={key:0,class:"info-row"},Xo={class:"info-value"},Go={class:"info-row"},Yo={class:"info-value"},Zo={__name:"SmartIRDeviceSelector",props:{entityType:{type:String,required:!0},modelValue:{type:Object,default:()=>({})},broadlinkDevices:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(t,{expose:d,emit:r}){const w=t,k=r,s=g([]),c=g([]),f=g(""),S=g(""),$=g(""),E=g(""),C=g(""),o=g(null),R=g(!1),q=g(!1),V=g({manufacturer:"",model:"",controller:""});Ae(async()=>{if(await I(),w.modelValue&&(f.value=w.modelValue.manufacturer||"",S.value=w.modelValue.device_code||"",$.value=w.modelValue.controller_device||"",E.value=w.modelValue.temperature_sensor||"",C.value=w.modelValue.humidity_sensor||"",f.value&&(await a(f.value),S.value&&c.value.length>0))){const A=c.value.find(N=>N.code===S.value);A&&(o.value={code:A.code,manufacturer:f.value,models:A.models,controller:A.controller})}}),re(()=>w.entityType,async A=>{A&&(f.value="",S.value="",c.value=[],o.value=null,await I())});const I=async()=>{if(w.entityType){R.value=!0,V.value.manufacturer="";try{const A=await ne.get("/api/smartir/codes/manufacturers",{params:{entity_type:w.entityType}});if(A.data.success)s.value=A.data.manufacturers||[];else throw new Error(A.data.error||"Failed to load manufacturers")}catch(A){console.error("Error loading manufacturers:",A),V.value.manufacturer="Failed to load manufacturers. Please try again.",s.value=[]}finally{R.value=!1}}},a=async A=>{if(!(!A||!w.entityType)){q.value=!0,V.value.model="";try{const N=await ne.get("/api/smartir/codes/models",{params:{entity_type:w.entityType,manufacturer:A}});if(N.data.success){const le=N.data.models||[];c.value=le.map(de=>{const he=de.models&&de.models.length>0?de.models.join(", "):`Code ${de.code}`;return{code:de.code,label:he,description:`Code: ${de.code}`,models:de.models,controller:de.controller}})}else throw new Error(N.data.error||"Failed to load models")}catch(N){console.error("Error loading models:",N),V.value.model="Failed to load models. Please try again.",c.value=[]}finally{q.value=!1}}},b=async A=>{f.value=A,S.value="",o.value=null,c.value=[],A&&await a(A),H()},p=()=>{const A=c.value.find(N=>N.code===S.value);A&&(o.value={code:A.code,manufacturer:f.value,models:A.models,controller:A.controller}),H()},L=()=>{H()},J=()=>{H()},Q=()=>{H()},H=()=>{var N,le;const A={manufacturer:f.value,model:((le=(N=o.value)==null?void 0:N.models)==null?void 0:le[0])||"",device_code:S.value,controller_device:$.value};w.entityType==="climate"&&(E.value&&(A.temperature_sensor=E.value),C.value&&(A.humidity_sensor=C.value)),k("update:modelValue",A),k("change",A)};return d({validate:()=>{let A=!0;return V.value={manufacturer:"",model:"",controller:""},f.value||(V.value.manufacturer="Manufacturer is required",A=!1),S.value||(V.value.model="Model is required",A=!1),$.value||(V.value.controller="Broadlink controller is required",A=!1),A}}),(A,N)=>(l(),n("div",Ao,[e("div",Eo,[be(We,{modelValue:f.value,"onUpdate:modelValue":N[0]||(N[0]=le=>f.value=le),options:s.value,label:"Manufacturer",placeholder:"Search manufacturers...",required:"",loading:R.value,error:V.value.manufacturer,hint:"Select the device manufacturer",onChange:b},null,8,["modelValue","options","loading","error"])]),e("div",Vo,[be(We,{modelValue:S.value,"onUpdate:modelValue":N[1]||(N[1]=le=>S.value=le),options:c.value,"option-label":"label","option-value":"code","option-description":"description",label:"Model",placeholder:"Search models...",required:"",disabled:!f.value,loading:q.value,error:V.value.model,hint:"Select the device model",onChange:p},null,8,["modelValue","options","disabled","loading","error"])]),e("div",Po,[N[6]||(N[6]=e("label",{for:"controller-device"},[e("i",{class:"mdi mdi-remote"}),x(" Controller Device * ")],-1)),G(e("select",{id:"controller-device","onUpdate:modelValue":N[2]||(N[2]=le=>$.value=le),required:"",onChange:L},[N[5]||(N[5]=e("option",{value:""},"-- Select Controller Device --",-1)),(l(!0),n(me,null,$e(t.broadlinkDevices,le=>(l(),n("option",{key:le.entity_id,value:le.entity_id},[x(m(le.name||le.entity_id)+" ",1),le.area_name?(l(),n(me,{key:0},[x(" - "+m(le.area_name),1)],64)):M("",!0)],8,jo))),128))],544),[[Ie,$.value]]),N[7]||(N[7]=e("small",null,"Which remote device will send the IR/RF commands",-1)),V.value.controller?(l(),n("div",Uo,m(V.value.controller),1)):M("",!0)]),t.entityType==="climate"?(l(),n(me,{key:0},[e("div",Fo,[N[8]||(N[8]=e("label",{for:"temperature-sensor"},"Temperature Sensor",-1)),G(e("input",{id:"temperature-sensor","onUpdate:modelValue":N[3]||(N[3]=le=>E.value=le),type:"text",placeholder:"e.g., sensor.living_room_temperature",onInput:J},null,544),[[Oe,E.value]]),N[9]||(N[9]=e("small",null,"Optional: Temperature sensor entity for current temperature",-1))]),e("div",No,[N[10]||(N[10]=e("label",{for:"humidity-sensor"},"Humidity Sensor",-1)),G(e("input",{id:"humidity-sensor","onUpdate:modelValue":N[4]||(N[4]=le=>C.value=le),type:"text",placeholder:"e.g., sensor.living_room_humidity",onInput:Q},null,544),[[Oe,C.value]]),N[11]||(N[11]=e("small",null,"Optional: Humidity sensor entity for current humidity",-1))])],64)):M("",!0),o.value?(l(),n("div",Bo,[N[16]||(N[16]=e("div",{class:"info-header"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Selected Device Code")],-1)),e("div",Ho,[e("div",qo,[N[12]||(N[12]=e("span",{class:"info-label"},"Code ID:",-1)),e("span",zo,m(o.value.code_id),1)]),e("div",Jo,[N[13]||(N[13]=e("span",{class:"info-label"},"Manufacturer:",-1)),e("span",Wo,m(o.value.manufacturer),1)]),o.value.models&&o.value.models.length>0?(l(),n("div",Ko,[N[14]||(N[14]=e("span",{class:"info-label"},"Supported Models:",-1)),e("span",Xo,m(o.value.models.join(", ")),1)])):M("",!0),e("div",Go,[N[15]||(N[15]=e("span",{class:"info-label"},"Controller:",-1)),e("span",Yo,m(o.value.controller||"Broadlink"),1)])])])):M("",!0)]))}},Qo=Ce(Zo,[["__scopeId","data-v-1911c8f6"]]),el={class:"modal-content"},tl={class:"modal-header"},ol={class:"input-wrapper"},ll={key:0,class:"validation-tooltip"},nl={class:"input-wrapper"},sl=["disabled"],al={key:0,class:"validation-tooltip"},il={key:0,class:"smartir-notice"},rl={key:0,class:"notice-success"},dl={key:1,class:"notice-warning"},ul={key:1,class:"smartir-notice"},cl={key:2},ml={class:"form-group"},vl=["disabled"],pl=["disabled"],fl={key:0},gl={key:1},yl={key:2},bl={key:3},hl={key:0,class:"form-group"},kl={class:"area-display-readonly"},wl=["value"],$l=["disabled"],Cl=["href"],_l={key:1,class:"form-group"},Sl={class:"form-group"},Il={class:"input-wrapper"},Dl=["value"],Tl=["value"],xl={key:2,class:"validation-tooltip"},Ml={key:0},Rl={key:1},Ll={key:3,class:"smartir-section"},Ol={class:"modal-footer"},Al={type:"submit",form:"device-form",class:"btn btn-primary"},El={__name:"DeviceForm",props:{device:{type:Object,default:null}},emits:["save","cancel"],setup(t,{emit:d}){const r=t,w=d,k=Me("smartirStatus"),s=Me("smartirEnabled"),c=X(()=>{var u;return localStorage.getItem("smartir_simulate_not_installed")==="true"?!1:((u=k==null?void 0:k.value)==null?void 0:u.installed)||!1}),f=X(()=>!!r.device),S=X(()=>["climate","media_player","fan","light"].includes(o.value.entity_type)),$=X(()=>c.value?!S.value&&o.value.entity_type?"(Not supported for this type)":"(Pre-configured Codes)":"(Requires SmartIR)"),E=X(()=>{var u;const D=((u=r.device)==null?void 0:u.commands)||{};return Object.keys(D).length>0}),C=X(()=>{if(!o.value.broadlink_entity)return"";const D=a.value.find(u=>u.entity_id===o.value.broadlink_entity);return D&&D.name||o.value.broadlink_entity}),o=g({name:"",entity_type:"",device_type:"broadlink",device:"",area:"",icon:"",broadlink_entity:"",enabled:!0,commands:{}}),R=g({name:"",entity_type:"",broadlink_entity:""}),q=g({}),V=g(null),I=g([]),a=g([]),b=g(null),p=g(null),L=g(null),J=g(!1);Ae(async()=>{r.device&&(o.value={...r.device,device_type:r.device.device_type||"broadlink"},o.value.device_type==="smartir"&&(q.value={manufacturer:r.device.manufacturer,model:r.device.model,device_code:r.device.device_code,controller_device:r.device.controller_device,temperature_sensor:r.device.temperature_sensor,humidity_sensor:r.device.humidity_sensor})),await Promise.all([Q(),H()])});const Q=async()=>{try{const D=await ne.get("/api/areas");I.value=D.data.areas||[]}catch(D){console.error("Error loading areas:",D),I.value=[]}},H=async()=>{try{const u=(await ne.get("/api/remote/devices")).data.devices||[];a.value=u,console.log("Loaded remote devices:",u)}catch(D){console.error("Error loading remote devices:",D),a.value=[]}},te=D=>{if(!D)return"";const u=D.toLowerCase();for(const P of I.value){const ge=P.toLowerCase();if(u.includes(ge))return P}return""},A=(D,u="")=>{const P=u.toLowerCase();return P.includes("tv")?"mdi:television":P.includes("lamp")?"mdi:lamp":P.includes("ceiling")?"mdi:ceiling-light":P.includes("floor")?"mdi:floor-lamp":P.includes("desk")?"mdi:desk-lamp":P.includes("fan")?"mdi:fan":P.includes("ac")||P.includes("air con")?"mdi:air-conditioner":P.includes("heater")?"mdi:radiator":P.includes("blind")?"mdi:blinds":P.includes("curtain")?"mdi:curtains":P.includes("garage")?"mdi:garage":P.includes("speaker")||P.includes("stereo")?"mdi:speaker":P.includes("receiver")?"mdi:audio-video":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:television",cover:"mdi:window-shutter",climate:"mdi:thermostat"}[D]||"mdi:devices"};re(()=>o.value.name,D=>{if(!f.value&&D&&!o.value.area){const u=te(D);u&&(o.value.area=u)}!f.value&&D&&o.value.entity_type&&(J.value||!o.value.icon)&&(o.value.icon=A(o.value.entity_type,D),J.value=!0)}),re(()=>o.value.entity_type,D=>{!f.value&&D&&(J.value||!o.value.icon)&&(o.value.icon=A(D,o.value.name),J.value=!0)}),re(()=>o.value.icon,(D,u)=>{u!==void 0&&D!==u&&!J.value&&(J.value=!1),D||(J.value=!1)});const N=g(!1),le=async()=>{var D;if((D=r.device)!=null&&D.id){N.value=!0;try{const u=await ne.post(`/api/devices/${r.device.id}/sync-area`);u.data.success?(o.value.area=u.data.area||"",u.data.area?console.log(`Area synced: ${u.data.area}`):console.log("No area assigned in Home Assistant")):console.warn(u.data.message||"Entity not found in HA")}catch(u){console.error("Failed to sync area:",u)}finally{N.value=!1}}},de=()=>{var P;return!((P=r.device)!=null&&P.id)||!o.value.entity_type?"#":`/config/entities/entity/${`${o.value.entity_type}.${r.device.id}`}`},he=()=>{R.value={name:"",entity_type:"",broadlink_entity:""};let D=!0;return(!o.value.name||o.value.name.trim()==="")&&(R.value.name="Device name is required",D=!1),o.value.entity_type||(R.value.entity_type="Entity type is required",D=!1),o.value.device_type==="broadlink"&&!o.value.broadlink_entity&&(R.value.broadlink_entity="Broadlink device is required",D=!1),D},De=D=>{R.value[D]=""},Te=async()=>{if(o.value.device_type==="smartir"){if(V.value&&!V.value.validate())return;const D={...o.value,smartir_config:{manufacturer:q.value.manufacturer,model:q.value.model,code_id:q.value.device_code,controller_device:q.value.controller_device}};w("save",D)}else{if(!he())return;w("save",{...o.value})}},xe=D=>{q.value=D};return(D,u)=>(l(),n("div",{class:"modal-overlay",onClick:u[11]||(u[11]=ce(P=>D.$emit("cancel"),["self"]))},[e("div",el,[e("div",tl,[e("h2",null,m(f.value?"Edit Device":"Add New Device"),1),e("button",{onClick:u[0]||(u[0]=P=>D.$emit("cancel")),class:"close-btn"},[...u[12]||(u[12]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("form",{id:"device-form",onSubmit:ce(Te,["prevent"]),class:"modal-body"},[e("div",{class:Z(["form-group",{"has-error":R.value.name}])},[u[14]||(u[14]=e("label",{for:"device-name"},"Device Name *",-1)),e("div",ol,[G(e("input",{id:"device-name",ref_key:"nameInput",ref:b,"onUpdate:modelValue":u[1]||(u[1]=P=>o.value.name=P),type:"text",placeholder:"e.g., Living Room TV",onInput:u[2]||(u[2]=P=>De("name"))},null,544),[[Oe,o.value.name]]),R.value.name?(l(),n("div",ll,[u[13]||(u[13]=e("i",{class:"mdi mdi-alert"},null,-1)),x(" "+m(R.value.name),1)])):M("",!0)]),u[15]||(u[15]=e("small",null,"Friendly name for this device",-1))],2),e("div",{class:Z(["form-group",{"has-error":R.value.entity_type}])},[u[23]||(u[23]=e("label",{for:"entity-type"},"Entity Type *",-1)),e("div",nl,[G(e("select",{id:"entity-type",ref_key:"typeSelect",ref:p,"onUpdate:modelValue":u[3]||(u[3]=P=>o.value.entity_type=P),onChange:u[4]||(u[4]=P=>De("entity_type"))},[u[16]||(u[16]=Fe('<option value="" data-v-94bc1fe5>-- Select Type --</option><option value="light" data-v-94bc1fe5>💡 Light</option><option value="fan" data-v-94bc1fe5>🌀 Fan</option><option value="switch" data-v-94bc1fe5>🔌 Switch</option><option value="media_player" data-v-94bc1fe5>📺 Media Player</option><option value="cover" data-v-94bc1fe5>🪟 Cover (Blinds/Curtains)</option>',6)),e("option",{value:"climate",disabled:!c.value}," 🌡️ Climate "+m(c.value?"":"(Requires SmartIR)"),9,sl)],544),[[Ie,o.value.entity_type]]),R.value.entity_type?(l(),n("div",al,[u[17]||(u[17]=e("i",{class:"mdi mdi-alert"},null,-1)),x(" "+m(R.value.entity_type),1)])):M("",!0)]),o.value.entity_type==="climate"?(l(),n("div",il,[c.value?(l(),n("div",rl,[...u[18]||(u[18]=[e("i",{class:"mdi mdi-check-circle"},null,-1),e("span",null,"SmartIR detected! Climate entities will be created via SmartIR profiles.",-1)])])):(l(),n("div",dl,[...u[19]||(u[19]=[e("i",{class:"mdi mdi-alert"},null,-1),e("div",null,[e("strong",null,"SmartIR Required"),e("p",null,"Climate entities (AC, heaters) require SmartIR integration."),e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"smartir-link"}," Install SmartIR → ")],-1)])]))])):c.value&&["media_player","fan","light"].includes(o.value.entity_type)?(l(),n("div",ul,[...u[20]||(u[20]=[e("div",{class:"notice-info"},[e("i",{class:"mdi mdi-information"}),e("span",null,"💡 SmartIR available! You can use pre-configured codes or learn your own.")],-1)])])):!c.value&&o.value.entity_type?(l(),n("small",cl,[u[21]||(u[21]=x(" 💡 Tip: Install ",-1)),u[22]||(u[22]=e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"inline-link"},"SmartIR",-1)),x(" for pre-configured "+m(o.value.entity_type==="climate"?"climate":o.value.entity_type)+" device codes ",1)])):M("",!0)],2),e("div",ml,[u[26]||(u[26]=e("label",{for:"device-type"},"Device Type *",-1)),G(e("select",{id:"device-type","onUpdate:modelValue":u[5]||(u[5]=P=>o.value.device_type=P),required:"",disabled:f.value},[u[24]||(u[24]=e("option",{value:""},"-- Select Device Type --",-1)),u[25]||(u[25]=e("option",{value:"broadlink"},"📡 Broadlink Device (Learn IR Codes)",-1)),_e(s)?(l(),n("option",{key:0,value:"smartir",disabled:!c.value||!S.value}," 🌐 SmartIR Device "+m($.value),9,pl)):M("",!0)],8,vl),[[Ie,o.value.device_type]]),f.value?(l(),n("small",fl,"Cannot change device type after creation")):o.value.device_type==="smartir"?(l(),n("small",gl,"Using pre-configured codes from SmartIR repository")):o.value.device_type==="broadlink"?(l(),n("small",yl,"Learn and store your own IR codes")):(l(),n("small",bl,"Choose how to configure this device"))]),f.value?(l(),n("div",hl,[u[29]||(u[29]=e("label",{for:"device-area"},"Area",-1)),e("div",kl,[e("input",{id:"device-area",value:o.value.area||"Not assigned",type:"text",readonly:"",class:"readonly-input"},null,8,wl),e("button",{type:"button",onClick:le,disabled:N.value,class:"sync-area-btn",title:"Sync area from Home Assistant"},[e("i",{class:Z(N.value?"mdi mdi-loading mdi-spin":"mdi mdi-refresh")},null,2)],8,$l)]),e("small",null,[u[27]||(u[27]=e("i",{class:"mdi mdi-information-outline"},null,-1)),u[28]||(u[28]=x(" Set area in Home Assistant, then click sync. ",-1)),e("a",{href:de(),target:"_blank",class:"inline-link"},"Open in HA →",8,Cl)])])):(l(),n("div",_l,[...u[30]||(u[30]=[e("div",{class:"info-notice"},[e("i",{class:"mdi mdi-information-outline"}),e("span",null,[e("strong",null,"Area Assignment:"),x(" After generating entities and restarting Home Assistant, you can assign areas in HA and sync them here.")])],-1)])])),e("div",Sl,[u[31]||(u[31]=e("label",{for:"device-icon"},"Icon",-1)),be(yo,{modelValue:o.value.icon,"onUpdate:modelValue":u[6]||(u[6]=P=>o.value.icon=P),inputId:"device-icon",placeholder:"e.g., mdi:television"},null,8,["modelValue"]),u[32]||(u[32]=e("small",null,"Optional: Material Design Icon name",-1))]),o.value.device_type==="broadlink"?(l(),n("div",{key:2,class:Z(["form-group",{"has-error":R.value.broadlink_entity}])},[u[35]||(u[35]=e("label",{for:"broadlink-entity"},"Remote Device *",-1)),e("div",Il,[!f.value||!E.value?G((l(),n("select",{key:0,id:"broadlink-entity",ref_key:"broadlinkSelect",ref:L,"onUpdate:modelValue":u[7]||(u[7]=P=>o.value.broadlink_entity=P),onChange:u[8]||(u[8]=P=>De("broadlink_entity"))},[u[33]||(u[33]=e("option",{value:""},"-- Select Remote Device --",-1)),(l(!0),n(me,null,$e(a.value,P=>(l(),n("option",{key:P.entity_id,value:P.entity_id},[x(m(P.name||P.entity_id)+" ",1),P.area_name?(l(),n(me,{key:0},[x(" - "+m(P.area_name),1)],64)):M("",!0)],8,Dl))),128))],544)),[[Ie,o.value.broadlink_entity]]):(l(),n("input",{key:1,id:"broadlink-entity",value:C.value,type:"text",readonly:"",disabled:""},null,8,Tl)),R.value.broadlink_entity?(l(),n("div",xl,[u[34]||(u[34]=e("i",{class:"mdi mdi-alert"},null,-1)),x(" "+m(R.value.broadlink_entity),1)])):M("",!0)]),!f.value||!E.value?(l(),n("small",Ml,"Required: Select which remote device to use for sending commands")):(l(),n("small",Rl,"Cannot change remote device after commands are learned"))],2)):M("",!0),o.value.device_type==="smartir"?(l(),n("div",Ll,[u[36]||(u[36]=e("div",{class:"section-header"},[e("i",{class:"mdi mdi-cloud-download"}),e("span",null,"SmartIR Device Configuration")],-1)),be(Qo,{ref_key:"smartirSelector",ref:V,"entity-type":o.value.entity_type,modelValue:q.value,"onUpdate:modelValue":u[9]||(u[9]=P=>q.value=P),"broadlink-devices":a.value,onChange:xe},null,8,["entity-type","modelValue","broadlink-devices"])])):M("",!0)],32),e("div",Ol,[e("button",{type:"button",onClick:u[10]||(u[10]=P=>D.$emit("cancel")),class:"btn btn-secondary"}," Cancel "),e("button",Al,[u[37]||(u[37]=e("i",{class:"mdi mdi-check"},null,-1)),x(" "+m(f.value?"Update":"Create"),1)])])])]))}},Vl=Ce(El,[["__scopeId","data-v-94bc1fe5"]]),Pl={class:"modal-header"},jl={class:"modal-body"},Ul={class:"message-text"},Fl={key:0,class:"checkbox-option"},Nl={class:"modal-footer"},Bl=["disabled"],Hl={__name:"ConfirmDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},dangerMode:{type:Boolean,default:!1},confirmDisabled:{type:Boolean,default:!1},checkboxLabel:{type:String,default:""}},emits:["confirm","cancel"],setup(t,{emit:d}){const r=t,w=d,k=g(!1);re(()=>r.isOpen,f=>{f&&(k.value=!1)});const s=()=>{w("confirm",k.value)},c=()=>{w("cancel")};return(f,S)=>t.isOpen?(l(),n("div",{key:0,class:"modal-overlay",onClick:ce(c,["self","stop"])},[e("div",{class:"modal-dialog confirm-dialog",onClick:S[1]||(S[1]=ce(()=>{},["stop"]))},[e("div",Pl,[e("h2",null,m(t.title),1)]),e("div",jl,[e("p",Ul,m(t.message),1),t.checkboxLabel?(l(),n("div",Fl,[e("label",null,[G(e("input",{type:"checkbox","onUpdate:modelValue":S[0]||(S[0]=$=>k.value=$)},null,512),[[fe,k.value]]),e("span",null,m(t.checkboxLabel),1)])])):M("",!0)]),e("div",Nl,[t.showCancel?(l(),n("button",{key:0,onClick:ce(c,["stop"]),class:"btn btn-secondary"},m(t.cancelText),1)):M("",!0),t.confirmText?(l(),n("button",{key:1,onClick:ce(s,["stop"]),class:Z(["btn",t.dangerMode?"btn-danger":"btn-primary"]),disabled:t.confirmDisabled},m(t.confirmText),11,Bl)):M("",!0)])])])):M("",!0)}},Ue=Ce(Hl,[["__scopeId","data-v-9cea6cb3"]]),ql={class:"modal-content"},zl={class:"modal-header"},Jl={class:"modal-body"},Wl={key:0,class:"smartir-info"},Kl={key:0,class:"climate-note"},Xl={class:"form-group"},Gl=["value"],Yl={class:"form-group"},Zl=["disabled"],Ql={label:"Suggested Commands"},en=["value"],tn=["disabled"],on={class:"form-group"},ln={class:"radio-group"},nn={class:"radio-label"},sn=["disabled"],an={class:"radio-label"},rn=["disabled"],dn={class:"learn-action"},un=["disabled"],cn={key:0,class:"mdi mdi-loading mdi-spin"},mn={key:1,class:"mdi mdi-remote-tv"},vn={key:0,class:"learning-status"},pn={key:0},fn={key:1},gn={key:2,class:"rf-instructions"},yn={key:0},bn={key:1,class:"rf-action"},hn={key:2,class:"rf-status"},kn={key:3,class:"rf-success"},wn={key:1,class:"result-message success"},$n={key:2,class:"section-divider"},Cn={key:3,class:"loading-commands"},_n={key:4,class:"learned-commands"},Sn={class:"command-list"},In={class:"command-info"},Dn={class:"command-name"},Tn={class:"command-right"},xn=["title"],Mn={class:"command-actions"},Rn=["onClick","disabled"],Ln=["onClick"],On={key:5,class:"untracked-commands"},An={class:"command-list"},En={class:"command-name"},Vn={class:"modal-footer"},Pn=["disabled"],jn={__name:"CommandLearner",props:{device:{type:Object,required:!0}},emits:["cancel","learned"],setup(t,{emit:d}){const r=t,w=d,k=g([]),s=g(""),c=g(""),f=g(""),S=g("ir"),$=g(!1),E=g(""),C=g(""),o=g(""),R=g("success"),q=g([]),V=g([]),I=g(!1),a=g(!1),b=g(""),p=g(!1),L=g(null),J=g(null),Q=g(""),H=g(""),te=X(()=>r.device.device_type==="smartir");X(()=>{if(te.value)return!1;const W=c.value==="__custom__"?f.value:c.value;return s.value&&W.trim()});const A=()=>{L.value&&L.value.setCustomValidity("")},N=()=>{J.value&&J.value.setCustomValidity("")},le=X(()=>{const W=k.value.find(O=>O.entity_id===s.value);return W?W.name||W.entity_id:s.value}),de={light:["turn_on","turn_off","toggle","brightness_up","brightness_down","dim","bright"],fan:["turn_on","turn_off","toggle","speed_low","speed_medium","speed_high","speed_1","speed_2","speed_3","speed_4","speed_5","oscillate_on","oscillate_off","direction_forward","direction_reverse"],switch:["turn_on","turn_off","toggle"],media_player:["turn_on","turn_off","toggle","volume_up","volume_down","volume_mute","play","pause","stop","play_pause","next_track","previous_track","channel_up","channel_down","source_hdmi1","source_hdmi2","source_hdmi3","source_tv","source_aux","source_bluetooth","menu","home","back","select","arrow_up","arrow_down","arrow_left","arrow_right"],cover:["open","close","stop","open_tilt","close_tilt","position_0","position_25","position_50","position_75","position_100"]},he=X(()=>{const W=r.device.entity_type||"switch";return de[W]||de.switch});re(()=>r.device,async(W,O)=>{if(W&&O&&W.id===O.id){const j=Object.keys(W.commands||{}).length,v=Object.keys(O.commands||{}).length;j!==v&&(console.log(`🔄 Device commands changed (${v} -> ${j}), reloading...`),await Te(!0))}},{deep:!0}),Ae(async()=>{await De();try{console.log("🔄 Syncing command types...");const O=await ne.post("/api/commands/sync");console.log("✅ Command types synced:",O.data)}catch(O){console.error("⚠️ Failed to sync command types:",O)}const W=!te.value;console.log(`📋 Will ${W?"FORCE RELOAD":"use cached"} commands`),await Te(W),L.value&&(L.value.setCustomValidity(""),L.value.oninvalid=()=>{L.value.setCustomValidity("Command name is required")}),r.device.broadlink_entity&&(s.value=r.device.broadlink_entity)}),re(c,async W=>{W==="__custom__"&&(await ot(),J.value&&(J.value.setCustomValidity(""),J.value.oninvalid=()=>{J.value.setCustomValidity("Custom command name is required")}))});const De=async()=>{try{const W=await ne.get("/api/broadlink/devices");k.value=W.data.devices||[]}catch(W){console.error("Error loading Broadlink devices:",W)}},Te=async(W=!1)=>{var O,j;I.value=!0;try{if(te.value){const v=await ne.get("/api/smartir/codes/code",{params:{entity_type:r.device.entity_type,code_id:r.device.device_code}});if(v.data.success&&v.data.code){const y=v.data.code.commands||{},B=v.data.code.commandType||"ir";if(r.device.entity_type==="climate"){const Y=[];for(const[T,i]of Object.entries(y))typeof i=="string"?Y.push({name:T,type:B}):typeof i=="object"&&i!==null&&Object.keys(i).sort((K,ae)=>parseInt(K)-parseInt(ae)).forEach(K=>{Y.push({name:`${T}_${K}`,type:B,label:`${T.charAt(0).toUpperCase()+T.slice(1)} ${K}°C`})});q.value=Y}else q.value=Object.keys(y).map(Y=>({name:Y,type:B}))}}else{if(console.log("📋 Loading commands for device:",r.device),console.log("📋 Device ID:",r.device.id),console.log("📋 Force reload:",W),W&&r.device.id){console.log("🔄 Force reloading commands from API after sync");try{const y=(await ne.get(`/api/commands/${r.device.id}`)).data.commands||{};console.log("📦 Raw commands from API:",y),q.value=Object.entries(y).map(([B,Y])=>{console.log(`  Command '${B}':`,Y,`(type: ${typeof Y})`);const T=typeof Y=="object"&&Y!==null&&(Y.command_type||Y.type)||"ir";return{name:B,type:T}}),console.log("📋 Reloaded commands:",q.value)}catch(v){if(console.error("❌ Error loading commands:",v),((O=v.response)==null?void 0:O.status)===404)console.log("ℹ️ No commands found for device"),q.value=[];else throw v}}else if(r.device.commands&&Object.keys(r.device.commands).length>0)console.log("✅ Using commands from device object"),q.value=Object.entries(r.device.commands).map(([v,y])=>({name:v,type:y.command_type||y.type||"ir"}));else if(r.device.commands!==void 0)console.log("ℹ️ Device has empty commands object - skipping API call"),q.value=[];else if(r.device.id){console.log("🌐 Fetching commands from API for device ID:",r.device.id);try{const y=(await ne.get(`/api/commands/${r.device.id}`)).data.commands||{};q.value=Object.entries(y).map(([B,Y])=>({name:B,type:Y.command_type||Y.type||"ir"}))}catch(v){if(((j=v.response)==null?void 0:j.status)===404)console.log("ℹ️ No commands found for device (this is normal for new devices)"),q.value=[];else throw v}}else console.log("⚠️ No commands found and no device ID");console.log("📋 Final learned commands:",q.value)}}catch(v){console.error("Error loading commands:",v)}finally{I.value=!1}},xe=async()=>{o.value="",R.value="",C.value="",$.value=!0,E.value="preparing";try{const W=c.value==="__custom__"?f.value:c.value,O=await fetch("/api/commands/learn/direct/stream",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({device_id:r.device.id,entity_id:s.value||r.device.broadlink_entity,command_name:W.trim(),command_type:S.value})});if(!O.ok)throw new Error("Failed to start learning");const j=O.body.getReader(),v=new TextDecoder;let y="";for(;;){const{done:B,value:Y}=await j.read();if(B)break;y+=v.decode(Y,{stream:!0});const T=y.split(`

`);y=T.pop();for(const i of T)if(!(!i.trim()||!i.startsWith("data: ")))try{const U=i.replace("data: ",""),K=JSON.parse(U);if(console.log("📡 SSE Status:",K.status,K.message),E.value=K.status,C.value=K.message,K.status==="complete"){o.value=`Command "${W}" learned successfully!`,R.value="success",q.value.find(se=>se.name===W)||q.value.push({name:W,type:S.value});const ie=V.value.indexOf(W);ie>-1&&V.value.splice(ie,1),Re(),c.value="",f.value="",w("learned",{deviceId:r.device.id,commandName:W,commandType:S.value}),$.value=!1,E.value="";return}else if(K.status==="error"){o.value=K.message||"Failed to learn command",R.value="error",$.value=!1,E.value="";return}}catch(U){console.error("Error parsing SSE message:",U)}}}catch(W){console.error("Learning error:",W),o.value=W.message||"Error learning command",R.value="error",$.value=!1,E.value=""}},D=async W=>{var O,j;try{H.value=W,Q.value="";let v=r.device.id.split(".")[1];r.device.device&&(v=r.device.device);const y=te.value?r.device.controller_device:s.value||r.device.broadlink_entity;if(!y){console.error("Missing entity_id for test command:",{isSmartIR:te.value,controller_device:r.device.controller_device,broadlink_entity:r.device.broadlink_entity,selectedBroadlink:s.value,device:r.device}),o.value="Missing Broadlink remote entity. Please select a Broadlink device.",R.value="error",H.value="";return}const B={device_id:r.device.id,entity_id:y,command_name:W};console.log("🧪 Testing command:",B),(await ne.post("/api/commands/test/direct",B)).data.success&&(Q.value=W,setTimeout(()=>{Q.value===W&&(Q.value="")},2e3))}catch(v){console.error("❌ Test command error:",v);const y=((j=(O=v.response)==null?void 0:O.data)==null?void 0:j.error)||v.message||"Unknown error";o.value=`Failed to send command: ${y}`,R.value="error"}finally{H.value=""}},u=W=>{b.value=W,a.value=!0},P=()=>{a.value=!1,b.value=""},ge=async()=>{const W=b.value;a.value=!1;try{console.log(`🗑️ Deleting command: ${W}`),await ne.delete(`/api/commands/${r.device.id}/${W}`),q.value=q.value.filter(O=>O.name!==W),await Re(),o.value=`Command "${W}" deleted`,R.value="success",w("learned",{deviceId:r.device.id,commandName:W,action:"deleted"})}catch(O){console.error("❌ Delete error:",O),o.value=`Failed to delete command: ${O.message}`,R.value="error",await Te()}finally{b.value=""}},Re=async()=>{try{let W=r.device.device;W||(W=r.device.id.includes(".")?r.device.id.split(".")[1]:r.device.id),console.log("🔍 Looking for untracked commands for device:",W);const j=(await ne.get("/api/commands/untracked")).data.untracked||{};console.log("📦 All untracked commands:",Object.keys(j)),console.log("📦 Untracked for this device:",j[W]),j[W]?V.value=Object.keys(j[W].commands):V.value=[]}catch(W){console.error("Error loading untracked commands:",W),V.value=[]}},ye=()=>{V.value.length!==0&&(p.value=!0)},we=async()=>{p.value=!1;try{const W=r.device.device||r.device.id.split(".")[1],O=await ne.post("/api/commands/import",{device_id:r.device.id,source_device:W,commands:V.value});O.data.success&&(o.value=`Imported ${O.data.imported_count} commands successfully!`,R.value="success",await Te(),await Re(),w("learned"))}catch(W){o.value=`Failed to import commands: ${W.message}`,R.value="error"}};return(W,O)=>(l(),n("div",{class:"modal-overlay",onClick:O[7]||(O[7]=ce(j=>W.$emit("cancel"),["self"]))},[e("div",ql,[e("div",zl,[e("h2",null,m(te.value?"Commands for":"Learn Commands for")+" "+m(t.device.name),1),e("button",{onClick:O[0]||(O[0]=j=>W.$emit("cancel")),class:"close-btn"},[...O[8]||(O[8]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Jl,[te.value?(l(),n("div",Wl,[O[13]||(O[13]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[O[12]||(O[12]=e("h3",null,"SmartIR Device",-1)),e("p",null,[O[9]||(O[9]=x("This device uses SmartIR code file ",-1)),e("strong",null,m(t.device.device_code),1),O[10]||(O[10]=x(". Commands are pre-configured and cannot be learned.",-1))]),t.device.entity_type==="climate"?(l(),n("p",Kl,[...O[11]||(O[11]=[e("i",{class:"mdi mdi-alert-circle-outline"},null,-1),e("strong",null,"Note:",-1),x(" Climate device commands are temperature-based. Testing individual modes may not work as expected. Use the Home Assistant climate card to control your device. ",-1)])])):M("",!0)])])):(l(),n("form",{key:1,onSubmit:ce(xe,["prevent"])},[e("div",Xl,[O[14]||(O[14]=e("label",{for:"broadlink-entity"},"Broadlink Device",-1)),e("input",{id:"broadlink-entity",value:le.value,type:"text",readonly:"",disabled:""},null,8,Gl),O[15]||(O[15]=e("small",null,"Commands will be learned using this device (set when device was created)",-1))]),e("div",Yl,[O[18]||(O[18]=e("label",{for:"command-name"},"Command Name *",-1)),G(e("select",{id:"command-name",ref_key:"commandSelect",ref:L,"onUpdate:modelValue":O[1]||(O[1]=j=>c.value=j),disabled:$.value,required:"",onChange:A},[O[16]||(O[16]=e("option",{value:""},"-- Select or type command --",-1)),e("optgroup",Ql,[(l(!0),n(me,null,$e(he.value,j=>(l(),n("option",{key:j,value:j},m(j),9,en))),128))]),O[17]||(O[17]=e("option",{value:"__custom__"},"Custom command...",-1))],40,Zl),[[Ie,c.value]]),c.value==="__custom__"?G((l(),n("input",{key:0,ref_key:"customCommandInput",ref:J,"onUpdate:modelValue":O[2]||(O[2]=j=>f.value=j),type:"text",placeholder:"Enter custom command name",disabled:$.value,required:"",class:"custom-command-input",onInput:N},null,40,tn)),[[Oe,f.value]]):M("",!0),e("small",null,"Select a suggested command for "+m(t.device.entity_type||"this device")+", or enter a custom one.",1)]),e("div",on,[O[21]||(O[21]=e("label",null,"Command Type",-1)),e("div",ln,[e("label",nn,[G(e("input",{type:"radio","onUpdate:modelValue":O[3]||(O[3]=j=>S.value=j),value:"ir",disabled:$.value},null,8,sn),[[ze,S.value]]),O[19]||(O[19]=e("span",null,"IR (Infrared)",-1))]),e("label",an,[G(e("input",{type:"radio","onUpdate:modelValue":O[4]||(O[4]=j=>S.value=j),value:"rf",disabled:$.value},null,8,rn),[[ze,S.value]]),O[20]||(O[20]=e("span",null,"RF (Radio Frequency)",-1))])])]),e("div",dn,[e("button",{type:"submit",class:"btn btn-primary btn-large",disabled:$.value},[$.value?(l(),n("i",cn)):(l(),n("i",mn)),x(" "+m($.value?"Learning...":"Learn Command"),1)],8,un)]),$.value?(l(),n("div",vn,[O[27]||(O[27]=e("i",{class:"mdi mdi-loading mdi-spin"},null,-1)),E.value==="preparing"?(l(),n("div",pn,[...O[22]||(O[22]=[e("p",null,[e("strong",null,"Preparing device...")],-1),e("small",null,"Connecting and authenticating with Broadlink device (this takes a few seconds)",-1)])])):S.value==="ir"?(l(),n("div",fn,[...O[23]||(O[23]=[e("p",null,[e("strong",null,"Ready!"),x(" Point your remote at the Broadlink device and press the button...")],-1),e("small",null,"This may take up to 30 seconds",-1)])])):S.value==="rf"?(l(),n("div",gn,[C.value?M("",!0):(l(),n("p",yn,[...O[24]||(O[24]=[e("strong",null,"RF Learning - Single Action:",-1)])])),C.value?M("",!0):(l(),n("div",bn,[...O[25]||(O[25]=[e("strong",null,"Press and HOLD the button for 2-3 seconds, then RELEASE",-1)])])),C.value?(l(),n("div",hn,[e("strong",null,m(C.value),1)])):M("",!0),E.value==="captured"?(l(),n("div",kn,[...O[26]||(O[26]=[e("i",{class:"mdi mdi-check-circle"},null,-1),e("span",null,"Signal captured! Saving...",-1)])])):M("",!0)])):M("",!0)])):M("",!0),o.value&&R.value==="success"&&!o.value.includes("sent successfully")?(l(),n("div",wn,[O[28]||(O[28]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("p",null,m(o.value),1)])):M("",!0)],32)),q.value.length>0||V.value.length>0?(l(),n("div",$n)):M("",!0),I.value?(l(),n("div",Cn,[...O[29]||(O[29]=[e("div",{class:"loading-spinner"},[e("i",{class:"mdi mdi-loading mdi-spin"}),e("p",null,"Loading commands...")],-1)])])):q.value.length>0?(l(),n("div",_n,[e("h3",null,"Tracked Commands ("+m(q.value.length)+")",1),e("div",Sn,[(l(!0),n(me,null,$e(q.value,j=>(l(),n("div",{key:j.name,class:"command-item"},[e("div",In,[e("span",Dn,m(j.label||j.name),1)]),e("div",Tn,[e("i",{class:"mdi mdi-check-circle learned-icon",title:`Learned (${(j.type||"ir").toUpperCase()})`},null,8,xn),e("span",{class:Z(["command-type-badge",j.type||"ir"])},m((j.type||"ir").toUpperCase()),3),e("div",Mn,[e("button",{type:"button",onClick:v=>D(j.name),class:"icon-btn",title:"Test command",disabled:H.value===j.name},[e("i",{class:Z(["mdi mdi-play",{"mdi-spin":H.value===j.name}])},null,2)],8,Rn),e("button",{type:"button",onClick:v=>u(j.name),class:"icon-btn danger",title:"Delete and re-learn"},[...O[30]||(O[30]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Ln)])])]))),128))])])):M("",!0),V.value.length>0?(l(),n("div",On,[e("h3",null,[O[31]||(O[31]=e("i",{class:"mdi mdi-alert"},null,-1)),x(" Untracked Commands ("+m(V.value.length)+") ",1)]),O[34]||(O[34]=e("p",{class:"untracked-info"}," These commands exist in Broadlink storage but are not tracked in this device. ",-1)),e("div",An,[(l(!0),n(me,null,$e(V.value,j=>(l(),n("div",{key:j,class:"command-item untracked"},[e("span",En,m(j),1),O[32]||(O[32]=e("span",{class:"untracked-badge"},"Not tracked",-1))]))),128))]),e("button",{type:"button",onClick:ye,class:"btn btn-secondary"},[...O[33]||(O[33]=[e("i",{class:"mdi mdi-import"},null,-1),x(" Import All Untracked Commands ",-1)])])])):M("",!0)]),e("div",Vn,[e("button",{type:"button",onClick:O[5]||(O[5]=j=>W.$emit("cancel")),class:"btn btn-secondary",disabled:$.value}," Close ",8,Pn)])]),be(Ue,{isOpen:a.value,title:"Delete Command?",message:`Delete command '${b.value}'? This will remove it from Broadlink storage.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:ge,onCancel:P},null,8,["isOpen","message"]),be(Ue,{isOpen:p.value,title:"Import Commands?",message:`Import ${V.value.length} untracked command${V.value.length>1?"s":""} into this device?`,confirmText:"Import",cancelText:"Cancel",onConfirm:we,onCancel:O[6]||(O[6]=j=>p.value=!1)},null,8,["isOpen","message"])]))}},Un=Ce(jn,[["__scopeId","data-v-f61cc1d0"]]),Fn={class:"modal-container error-dialog"},Nn={class:"modal-header"},Bn={class:"modal-body"},Hn={class:"error-message"},qn={key:0,class:"error-suggestion"},zn=["open"],Jn={class:"debug-content"},Wn={class:"debug-info"},Kn={key:0,class:"debug-section-title"},Xn={key:1},Gn={__name:"ErrorDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Error"},message:{type:String,required:!0},suggestion:{type:String,default:""},details:{type:String,default:""},error:{type:Object,default:null},context:{type:Object,default:()=>({})}},emits:["close"],setup(t,{emit:d}){const r=t,w=d,k=Me("toast"),s=g(!1),c=()=>{w("close")},f=X(()=>{var R,q,V,I,a,b,p,L,J,Q,H;const C=new Date().toISOString(),o=r.error||{};return{error:JSON.stringify({message:r.message,title:r.title,details:r.details,errorObject:o.message||o.toString(),timestamp:C},null,2),request:JSON.stringify({method:((q=(R=o.config)==null?void 0:R.method)==null?void 0:q.toUpperCase())||"N/A",url:((V=o.config)==null?void 0:V.url)||"N/A",baseURL:((I=o.config)==null?void 0:I.baseURL)||"N/A",headers:((a=o.config)==null?void 0:a.headers)||{},data:(b=o.config)!=null&&b.data?JSON.parse(o.config.data):"N/A",params:((p=o.config)==null?void 0:p.params)||{}},null,2),response:JSON.stringify({status:((L=o.response)==null?void 0:L.status)||"N/A",statusText:((J=o.response)==null?void 0:J.statusText)||"N/A",data:((Q=o.response)==null?void 0:Q.data)||"N/A",headers:((H=o.response)==null?void 0:H.headers)||{}},null,2),browser:JSON.stringify({userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,viewport:`${window.innerWidth}x${window.innerHeight}`,screenResolution:`${window.screen.width}x${window.screen.height}`,colorDepth:window.screen.colorDepth,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timestamp:C},null,2),appState:JSON.stringify({currentRoute:window.location.pathname,currentURL:window.location.href,referrer:document.referrer||"N/A",context:r.context||{},localStorage:{smartir_simulate:localStorage.getItem("smartir_simulate_not_installed"),theme:localStorage.getItem("theme")}},null,2),stackTrace:o.stack||null}}),S=async()=>{const C=E();try{await navigator.clipboard.writeText(C),k==null||k.success("Debug information copied to clipboard","✅ Copied")}catch(o){console.error("Failed to copy:",o),k==null||k.error("Failed to copy to clipboard","❌ Copy Failed")}},$=()=>{const C=E(),o=new Blob([C],{type:"text/plain"}),R=URL.createObjectURL(o),q=document.createElement("a");q.href=R;const V=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);q.download=`broadlink-manager-error-${V}.txt`,document.body.appendChild(q),q.click(),document.body.removeChild(q),URL.revokeObjectURL(R),k==null||k.success("Debug report downloaded","✅ Downloaded")},E=()=>`Broadlink Manager - Error Report
${"=".repeat(60)}

Generated: ${new Date().toISOString()}
Title: ${r.title}
Message: ${r.message}
${r.suggestion?`Suggestion: ${r.suggestion}
`:""}
${"=".repeat(60)}

ERROR DETAILS
${"-".repeat(60)}
${f.value.error}

REQUEST INFORMATION
${"-".repeat(60)}
${f.value.request}

RESPONSE INFORMATION
${"-".repeat(60)}
${f.value.response}

BROWSER INFORMATION
${"-".repeat(60)}
${f.value.browser}

APPLICATION STATE
${"-".repeat(60)}
${f.value.appState}

${f.value.stackTrace?`STACK TRACE
${"-".repeat(60)}
${f.value.stackTrace}

`:""}
${"=".repeat(60)}
End of Report
`;return re(()=>r.isOpen,C=>{if(C){const o=R=>{R.key==="Escape"&&c()};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)}}),(C,o)=>(l(),Pe(lt,{to:"body"},[be(tt,{name:"modal"},{default:Ge(()=>[t.isOpen?(l(),n("div",{key:0,class:"modal-overlay",onClick:ce(c,["self"])},[e("div",Fn,[e("div",Nn,[o[2]||(o[2]=e("div",{class:"header-icon error-icon"},[e("i",{class:"mdi mdi-alert-circle"})],-1)),e("h3",null,m(t.title),1),e("button",{onClick:c,class:"close-button"},[...o[1]||(o[1]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Bn,[e("p",Hn,m(t.message),1),t.suggestion?(l(),n("p",qn,[o[3]||(o[3]=e("i",{class:"mdi mdi-lightbulb-on"},null,-1)),x(" "+m(t.suggestion),1)])):M("",!0),e("details",{class:"debug-section",open:s.value},[e("summary",{onClick:o[0]||(o[0]=R=>s.value=!s.value)},[e("i",{class:Z(["mdi",s.value?"mdi-chevron-down":"mdi-chevron-right"])},null,2),o[4]||(o[4]=x(" Debug Information ",-1))]),e("div",Jn,[e("div",{class:"debug-actions"},[e("button",{onClick:S,class:"btn-debug btn-copy"},[...o[5]||(o[5]=[e("i",{class:"mdi mdi-content-copy"},null,-1),x(" Copy to Clipboard ",-1)])]),e("button",{onClick:$,class:"btn-debug btn-download"},[...o[6]||(o[6]=[e("i",{class:"mdi mdi-download"},null,-1),x(" Download Report ",-1)])])]),e("div",Wn,[o[7]||(o[7]=e("div",{class:"debug-section-title"},"Error Details",-1)),e("pre",null,m(f.value.error),1),o[8]||(o[8]=e("div",{class:"debug-section-title"},"Request Information",-1)),e("pre",null,m(f.value.request),1),o[9]||(o[9]=e("div",{class:"debug-section-title"},"Response Information",-1)),e("pre",null,m(f.value.response),1),o[10]||(o[10]=e("div",{class:"debug-section-title"},"Browser Information",-1)),e("pre",null,m(f.value.browser),1),o[11]||(o[11]=e("div",{class:"debug-section-title"},"Application State",-1)),e("pre",null,m(f.value.appState),1),f.value.stackTrace?(l(),n("div",Kn,"Stack Trace")):M("",!0),f.value.stackTrace?(l(),n("pre",Xn,m(f.value.stackTrace),1)):M("",!0)])])],8,zn)]),e("div",{class:"modal-footer"},[e("button",{onClick:c,class:"btn btn-primary"}," OK ")])])])):M("",!0)]),_:1})]))}},Yn=Ce(Gn,[["__scopeId","data-v-23858149"]]),Zn={key:0,class:"discovery-banner"},Qn={class:"banner-content"},es={class:"banner-text"},ts={class:"modal-dialog"},os={class:"modal-header"},ls={class:"modal-body"},ns={class:"device-list"},ss={class:"device-info"},as={class:"device-details"},is={class:"command-count"},rs={class:"device-actions"},ds=["onClick"],us=["onClick"],cs={class:"modal-footer"},ms={class:"modal-dialog modal-dialog-small"},vs={class:"modal-header"},ps={class:"modal-body"},fs={class:"warning-message"},gs={class:"modal-footer"},ys=["disabled"],bs=["disabled"],hs={__name:"DeviceDiscovery",emits:["adopt"],setup(t,{expose:d,emit:r}){const w=Be(),k=r,s=g([]),c=g(!1),f=g(!1),S=g(null),$=g(!1),E=X(()=>s.value.length>0);Ae(async()=>{await C()});const C=async()=>{try{const V=await ne.get("/api/devices/discover");s.value=V.data.untracked_devices||[]}catch(V){console.error("Error loading untracked devices:",V),s.value=[]}},o=V=>{c.value=!1,k("adopt",V)},R=V=>{S.value=V,f.value=!0},q=async()=>{if(!S.value)return;const V=S.value.device_name;$.value=!0;try{const I=await ne.delete(`/api/devices/untracked/${encodeURIComponent(V)}`);if(I.data.success)s.value=s.value.filter(a=>a.device_name!==V),f.value=!1,S.value=null,s.value.length===0&&(c.value=!1),w.success(`Deleted all commands for '${V}'`);else throw new Error(I.data.error||"Failed to delete device")}catch(I){console.error("Error deleting device:",I),w.error(`Failed to delete device: ${I.message}`)}finally{$.value=!1}};return d({refresh:C}),(V,I)=>{var a,b,p;return E.value?(l(),n("div",Zn,[e("div",Qn,[I[9]||(I[9]=e("div",{class:"banner-icon"},[e("i",{class:"mdi mdi-radar"})],-1)),e("div",es,[I[7]||(I[7]=e("h3",null,"Untracked Devices Found",-1)),e("p",null,m(s.value.length)+" device"+m(s.value.length>1?"s":"")+" with learned commands found in Broadlink storage",1)]),e("button",{onClick:I[0]||(I[0]=L=>c.value=!0),class:"btn btn-primary"},[...I[8]||(I[8]=[e("i",{class:"mdi mdi-eye"},null,-1),x(" View Devices ",-1)])])]),c.value?(l(),n("div",{key:0,class:"modal-overlay",onClick:I[3]||(I[3]=ce(L=>c.value=!1,["self"]))},[e("div",ts,[e("div",os,[I[11]||(I[11]=e("h2",null,"Discovered Devices",-1)),e("button",{onClick:I[1]||(I[1]=L=>c.value=!1),class:"close-btn"},[...I[10]||(I[10]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",ls,[I[16]||(I[16]=e("p",{class:"info-text"}," These devices have learned commands in Broadlink storage but are not being tracked. Adopt them to manage their commands and generate Home Assistant entities. ",-1)),e("div",ns,[(l(!0),n(me,null,$e(s.value,L=>(l(),n("div",{key:L.device_name,class:"discovered-device"},[e("div",ss,[I[13]||(I[13]=e("div",{class:"device-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),e("div",as,[e("h4",null,m(L.device_name),1),e("span",is,[I[12]||(I[12]=e("i",{class:"mdi mdi-remote"},null,-1)),x(" "+m(L.command_count)+" command"+m(L.command_count>1?"s":""),1)])])]),e("div",rs,[e("button",{onClick:J=>o(L),class:"btn btn-primary"},[...I[14]||(I[14]=[e("i",{class:"mdi mdi-plus"},null,-1),x(" Adopt ",-1)])],8,ds),e("button",{onClick:J=>R(L),class:"btn btn-danger",title:"Delete all commands"},[...I[15]||(I[15]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,us)])]))),128))])]),e("div",cs,[e("button",{onClick:I[2]||(I[2]=L=>c.value=!1),class:"btn btn-secondary"}," Close ")])])])):M("",!0),f.value?(l(),n("div",{key:1,class:"modal-overlay",onClick:I[6]||(I[6]=ce(L=>f.value=!1,["self"]))},[e("div",ms,[e("div",vs,[I[18]||(I[18]=e("h2",null,"Delete Untracked Device",-1)),e("button",{onClick:I[4]||(I[4]=L=>f.value=!1),class:"close-btn"},[...I[17]||(I[17]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",ps,[e("div",fs,[I[20]||(I[20]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[e("p",null,[e("strong",null,'Are you sure you want to delete "'+m((a=S.value)==null?void 0:a.device_name)+'"?',1)]),e("p",null,"This will permanently delete all "+m((b=S.value)==null?void 0:b.command_count)+" command"+m(((p=S.value)==null?void 0:p.command_count)>1?"s":"")+" from Broadlink storage.",1),I[19]||(I[19]=e("p",{class:"warning-text"},"This action cannot be undone.",-1))])])]),e("div",gs,[e("button",{onClick:I[5]||(I[5]=L=>f.value=!1),class:"btn btn-secondary",disabled:$.value}," Cancel ",8,ys),e("button",{onClick:q,class:"btn btn-danger",disabled:$.value},[e("i",{class:Z(["mdi",$.value?"mdi-loading mdi-spin":"mdi-delete"])},null,2),x(" "+m($.value?"Deleting...":"Delete"),1)],8,bs)])])])):M("",!0)])):M("",!0)}}},ks=Ce(hs,[["__scopeId","data-v-783e943f"]]),ws={class:"device-list-card"},$s={class:"card-header"},Cs={class:"header-badges"},_s={class:"header-info"},Ss={class:"header-right"},Is={key:0,class:"view-toggle-group header-view-toggle"},Ds={class:"settings-menu-container"},Ts=["disabled"],xs=["disabled"],Ms={class:"card-body"},Rs={key:0,class:"filter-bar"},Ls={class:"filter-search-row"},Os=["title"],As={key:0,class:"filter-badge"},Es={class:"search-input-wrapper"},Vs={class:"filter-content"},Ps={class:"filter-row filter-row-dropdowns"},js={class:"filter-group"},Us=["value"],Fs={class:"filter-group"},Ns=["value"],Bs={class:"filter-group"},Hs={key:0,class:"filter-group filter-toggle"},qs={class:"toggle-label"},zs={class:"filter-results"},Js={key:1,class:"loading-state"},Ws={key:2,class:"error-state"},Ks={key:3,class:"empty-state"},Xs={key:4,class:"device-grid"},Gs={key:6,class:"no-results"},Ys={__name:"DeviceList",setup(t){const d=ft(),r=Be(),{isMobile:w}=Ye(),k=g(!1),s=g(!1),c=g(null),f=g(!1),S=g(!1),$=g(null),E=g(null),C=g(!0),o=g(!1),R=g(!1),V=g(window.innerWidth<=767?"grid":localStorage.getItem("device_view_mode")||"grid");re(w,_=>{_&&V.value==="list"&&(V.value="grid")}),re(V,_=>{localStorage.setItem("device_view_mode",_)});const I=()=>{C.value=!C.value,C.value||(S.value=!1)},a=()=>{C.value||(C.value=!0),S.value=!S.value},b=g(!1),p=g({title:"Error",message:"",suggestion:"",details:"",error:null,context:{}}),L=g(!1),J=g({success:!1,title:"",message:""}),Q=g(!1),H=g({search:"",broadlinkDevice:"",area:"",entityType:"",showSmartIROnly:!1}),te=g([]),A=Me("smartirStatus"),N=Me("smartirEnabled"),le=X(()=>{var h;return localStorage.getItem("smartir_simulate_not_installed")==="true"?!1:((h=A==null?void 0:A.value)==null?void 0:h.installed)||!1}),de=X(()=>{const _=new Map;return d.devices.forEach(h=>{if(h.broadlink_entity){const F=te.value.find(oe=>oe.entity_id===h.broadlink_entity),z=F&&F.name||h.broadlink_entity;_.set(h.broadlink_entity,{entity_id:h.broadlink_entity,friendly_name:z})}}),Array.from(_.values()).sort((h,F)=>h.friendly_name.localeCompare(F.friendly_name))}),he=X(()=>{const _=new Set;return d.devices.forEach(h=>{h.area&&_.add(h.area)}),Array.from(_).sort()}),De=X(()=>{let _=d.devices;if(H.value.search){const F=H.value.search.toLowerCase();_=_.filter(z=>{var pe,ue,Se,Ee,je;if((pe=z.name)!=null&&pe.toLowerCase().includes(F)||(ue=z.entity_type)!=null&&ue.toLowerCase().includes(F)||(Se=z.area)!=null&&Se.toLowerCase().includes(F)||(Ee=z.id)!=null&&Ee.toLowerCase().includes(F)||Object.keys(z.commands||{}).some(Ve=>Ve.toLowerCase().includes(F)))return!0;const ke=te.value.find(Ve=>Ve.entity_id===z.broadlink_entity);return!!((je=ke==null?void 0:ke.name)!=null&&je.toLowerCase().includes(F))})}H.value.broadlinkDevice&&(_=_.filter(F=>F.broadlink_entity===H.value.broadlinkDevice||F.controller_device===H.value.broadlinkDevice)),H.value.area&&(_=_.filter(F=>F.area===H.value.area)),H.value.entityType&&(_=_.filter(F=>F.entity_type===H.value.entityType)),H.value.showSmartIROnly&&(_=_.filter(F=>F.device_type==="smartir"));const h=localStorage.getItem("smartir_simulate_not_installed")==="true";return(!(N!=null&&N.value)||h)&&(_=_.filter(F=>F.device_type!=="smartir")),_}),Te=X(()=>H.value.search||H.value.broadlinkDevice||H.value.area||H.value.entityType||H.value.showSmartIROnly),xe=X(()=>{let _=0;return H.value.search&&_++,H.value.broadlinkDevice&&_++,H.value.area&&_++,H.value.entityType&&_++,H.value.showSmartIROnly&&_++,_}),D=()=>{H.value.search="",H.value.broadlinkDevice="",H.value.area="",H.value.entityType="",H.value.showSmartIROnly=!1},u=async()=>{try{const _=await ne.get("/api/remote/devices");te.value=_.data.devices||[]}catch(_){console.error("Error loading remote devices:",_)}};re(V,_=>{localStorage.setItem("device_view_mode",_)}),Ae(async()=>{await Promise.all([d.loadDevices(),u()])});const P=_=>{c.value=_,k.value=!0},ge=X(()=>{if(!$.value)return"";const _=Object.keys($.value.commands||{}).length;return _===0?"This device has no commands. The device will be removed from tracking.":`This device has ${_} learned command${_>1?"s":""}. What would you like to do?`}),Re=X(()=>{if(!$.value)return"";const _=Object.keys($.value.commands||{}).length;return _===0?"":`Also delete all ${_} command${_>1?"s":""} from Broadlink storage`}),ye=_=>{$.value=_,f.value=!0},we=()=>{f.value=!1,$.value=null},W=async _=>{var F,z;const h=$.value;f.value=!1;try{await d.deleteDevice(h.id,_),E.value&&await E.value.refresh()}catch(oe){const ke=((z=(F=oe.response)==null?void 0:F.data)==null?void 0:z.error)||oe.message||"Unknown error";B("Failed to Delete Device",ke)}finally{$.value=null}},O=async _=>{var h,F,z,oe,ke;try{console.log("💾 Saving device data:",_),console.log("💾 Device commands:",_.commands),console.log("💾 Selected device:",c.value),(h=c.value)!=null&&h.id&&c.value.id!==null?await d.updateDevice(c.value.id,_):await d.createDevice(_),j(),E.value&&await E.value.refresh()}catch(pe){let ue="Failed to save device",Se="",Ee="";(z=(F=pe.response)==null?void 0:F.data)!=null&&z.error?(ue=pe.response.data.error,Se=pe.response.data.suggestion||""):pe.message&&(ue=pe.message),pe.response&&(Ee=`Status: ${pe.response.status}
URL: ${((oe=pe.config)==null?void 0:oe.url)||"N/A"}`),B("Failed to Save Device",ue,Se,Ee,pe,{action:"save_device",deviceData:_,isEdit:!!((ke=c.value)!=null&&ke.id)})}},j=()=>{k.value=!1,c.value=null},v=_=>{c.value=_,s.value=!0},y=()=>{s.value=!1,c.value=null},B=(_,h,F="",z="",oe=null,ke={})=>{p.value={title:_,message:h,suggestion:F,details:z,error:oe,context:ke},b.value=!0},Y=()=>{b.value=!1},T=()=>{L.value=!1},i=async _=>{if(console.log("📥 DeviceList: Command learned/deleted:",_),!_||!_.deviceId||!c.value){console.warn("⚠️ DeviceList: Missing required data in learned event");return}const h=c.value.commands||{};let F;_.action==="deleted"?(F={...h},delete F[_.commandName],console.log(`🗑️ DeviceList: Optimistically removing command '${_.commandName}'`),console.log(`🗑️ DeviceList: Command count: ${Object.keys(h).length} -> ${Object.keys(F).length}`)):(F={...h,[_.commandName]:{command_type:_.commandType,type:_.commandType}},console.log(`✅ DeviceList: Optimistically adding command '${_.commandName}'`),console.log(`✅ DeviceList: Command count: ${Object.keys(h).length} -> ${Object.keys(F).length}`)),c.value={...c.value,commands:F},console.log("🔄 DeviceList: Force reloading all devices from API"),await d.loadDevices(!0),E.value&&E.value.refresh()},U=_=>{const h=_.split("_"),F=[];for(let z=0;z<h.length;z++){const oe=h[z],ke=h[z+1];oe&&ke==="s"&&h[z+2]?(F.push(oe.charAt(0).toUpperCase()+oe.slice(1)+"'s"),z++):oe!=="s"&&F.push(oe.charAt(0).toUpperCase()+oe.slice(1))}return F.join(" ")},K=(_,h)=>{const F=_.toLowerCase(),z=h.map(ue=>ue.toLowerCase());return F.includes("lamp")||F.includes("light")?"light":F.includes("fan")?"fan":F.includes("tv")||F.includes("stereo")||F.includes("speaker")||F.includes("receiver")?"media_player":F.includes("blind")||F.includes("curtain")||F.includes("shade")||F.includes("garage")?"cover":z.some(ue=>ue.includes("volume")||ue.includes("channel")||ue.includes("play")||ue.includes("pause")||ue.includes("mute"))?"media_player":z.some(ue=>ue.includes("fan_speed")||ue.includes("fan_low")||ue.includes("fan_high"))?"fan":z.some(ue=>ue.includes("open")||ue.includes("close")||ue.includes("stop"))?"cover":"switch"},ae=(_,h)=>{const F=_.toLowerCase();return F.includes("tv")?"mdi:television":F.includes("stereo")||F.includes("receiver")||F.includes("speaker")?"mdi:speaker":F.includes("lamp")?"mdi:lamp":F.includes("light")?"mdi:lightbulb":F.includes("fan")?"mdi:fan":F.includes("blind")?"mdi:blinds":F.includes("curtain")?"mdi:curtains":F.includes("garage")?"mdi:garage":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:speaker",cover:"mdi:window-shutter"}[h]||"mdi:devices"},ie=_=>{const h=_.toLowerCase().split("_");for(let oe=0;oe<h.length-2;oe++)if(h[oe+1]==="s"){const ke=h.slice(oe,oe+3),pe=U(ke.join("_"));return console.log("Detected possessive area:",pe,"from",_),pe}const F=[["living","room"],["dining","room"],["master","bedroom"],["guest","bedroom"],["family","room"],["laundry","room"],["home","office"]];for(let oe=0;oe<h.length-1;oe++){const ke=[h[oe],h[oe+1]],pe=F.find(ue=>ue[0]===ke[0]&&ue[1]===ke[1]);if(pe)return U(pe.join("_"))}const z=["kitchen","bedroom","bathroom","garage","office","basement","attic","hallway","entryway","patio","deck","yard","garden"];for(const oe of h)if(z.includes(oe))return oe.charAt(0).toUpperCase()+oe.slice(1);return""},se=async _=>{var h,F;try{const z=U(_.device_name),oe=ie(_.device_name),ke=K(_.device_name,_.commands),pe=ae(_.device_name,ke);let ue="";try{console.log("Finding Broadlink owner for:",_.device_name);const Ve=await ne.post("/api/devices/find-broadlink-owner",{device_name:_.device_name});console.log("Broadlink owner response:",Ve.data),ue=Ve.data.broadlink_entity||"",console.log("Detected Broadlink entity:",ue)}catch(Ve){console.error("Error finding Broadlink owner:",Ve)}console.log("Fetching command data from Broadlink storage...");const Ee=(await ne.get(`/api/commands/broadlink/${_.device_name}`)).data.commands||{};console.log("Fetched command data:",Ee);const je={};for(const[Ve,Ke]of Object.entries(Ee)){const it=typeof Ke=="string"&&Ke.length>200;je[Ve]={data:Ke,type:it?"rf":"ir",name:Ve,learned_at:new Date().toISOString()}}console.log("Transformed commands:",je),c.value={id:null,device:_.device_name,name:z,entity_type:ke,commands:je,area:oe,icon:pe,broadlink_entity:ue,enabled:!0},k.value=!0,r.success(`Imported ${Object.keys(je).length} commands from Broadlink storage`)}catch(z){console.error("Error adopting device:",z),r.error("Failed to adopt device: "+(((F=(h=z.response)==null?void 0:h.data)==null?void 0:F.error)||z.message))}},ee=async()=>{R.value=!0;try{await d.syncAllAreas(),r.success("Areas synced from Home Assistant")}catch(_){console.error("Error syncing areas:",_),r.error("Failed to sync areas")}finally{R.value=!1}},ve=async()=>{var _,h;o.value=!0;try{const F=await ne.post("/api/entities/generate",{});if(F.data.success){const z=F.data.broadlink_count||0,oe=F.data.smartir_count||0,ke=F.data.total_count||0,pe=F.data.errors||[];let ue="✅ Entity Generation Successful",Se=[];const Ee=[];z>0&&Ee.push(`${z} Broadlink native`),oe>0&&Ee.push(`${oe} SmartIR`),Ee.length>0&&Se.push(`Generated ${Ee.join(" and ")} entity configuration${ke!==1?"s":""}.`),z>0&&(Se.push(`
📁 Broadlink entities created in:`),Se.push("  • broadlink_manager/entities.yaml"),Se.push("  • broadlink_manager/helpers.yaml")),oe>0&&(Se.push(`
📁 SmartIR entities created in:`),Se.push("  • smartir/climate.yaml"),Se.push("  • smartir/media_player.yaml"),Se.push("  • smartir/fan.yaml")),Se.push(`
📝 Next steps:`),Se.push("1. Check your configuration.yaml includes the generated files"),Se.push("2. Restart Home Assistant to load the new entities"),pe.length>0&&(ue="⚠️ Entity Generation Completed with Errors",Se.push(`
⚠️ ${pe.length} error${pe.length!==1?"s":""} occurred:`),pe.forEach(je=>{Se.push(`  • ${je}`)})),J.value={success:!0,title:ue,message:Se.join(`
`)},L.value=!0}else J.value={success:!1,title:"❌ Entity Generation Failed",message:F.data.message||`Failed to generate entities.

Please check that you have at least one device configured.`},L.value=!0}catch(F){console.error("Error generating entities:",F);const z=((h=(_=F.response)==null?void 0:_.data)==null?void 0:h.error)||F.message||"Unknown error occurred";J.value={success:!1,title:"❌ Entity Generation Error",message:`Failed to generate entities:

${z}

Please check the logs for more details.`},L.value=!0}finally{o.value=!1}},Le=async({device:_,command:h})=>{var F,z;try{const oe={device_id:_.id,command_name:h,entity_id:_.broadlink_entity||_.controller_device};await ne.post("/api/commands/test/direct",oe),r.success(`Sent ${h} to ${_.name}`)}catch(oe){console.error("Error sending command:",oe);const ke=((z=(F=oe.response)==null?void 0:F.data)==null?void 0:z.error)||oe.message||"Unknown error";r.error(`Failed to send ${h}: ${ke}`)}};return(_,h)=>{var F;return l(),n("div",ws,[e("div",$s,[e("button",{class:"icon-button chevron-button",onClick:I},[e("i",{class:Z(["mdi",C.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2)]),e("div",{class:"header-left",onClick:I},[h[14]||(h[14]=e("div",{class:"header-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),e("h3",null,m(_e(w)?"Devices":"Managed Devices"),1),e("div",Cs,[e("span",_s,m(_e(d).deviceCount)+" devices",1)])]),e("div",Ss,[_e(w)?M("",!0):(l(),n("div",Is,[e("button",{onClick:h[0]||(h[0]=ce(z=>V.value="grid",["stop"])),class:Z(["view-toggle-btn",{active:V.value==="grid"}]),title:"Grid View"},[...h[15]||(h[15]=[e("i",{class:"mdi mdi-view-grid"},null,-1)])],2),e("button",{onClick:h[1]||(h[1]=ce(z=>V.value="list",["stop"])),class:Z(["view-toggle-btn",{active:V.value==="list"}]),title:"List View"},[...h[16]||(h[16]=[e("i",{class:"mdi mdi-view-list"},null,-1)])],2)])),e("button",{onClick:h[2]||(h[2]=ce(z=>k.value=!0,["stop"])),class:"btn btn-primary new-button"},[...h[17]||(h[17]=[e("i",{class:"mdi mdi-plus"},null,-1),e("span",null,"New",-1)])]),e("div",Ds,[e("button",{onClick:ce(a,["stop"]),class:Z(["icon-button settings-button",{active:S.value}]),title:"Settings"},[...h[18]||(h[18]=[e("i",{class:"mdi mdi-cog"},null,-1)])],2),S.value?(l(),n("div",{key:0,class:"settings-dropdown",onClick:h[5]||(h[5]=ce(()=>{},["stop"]))},[e("button",{onClick:h[3]||(h[3]=z=>{ee(),S.value=!1}),class:"menu-item",disabled:R.value},[e("i",{class:Z(["mdi",R.value?"mdi-loading mdi-spin":"mdi-refresh"])},null,2),e("span",null,m(R.value?"Syncing Areas...":"Sync Areas"),1)],8,Ts),e("button",{onClick:h[4]||(h[4]=z=>{ve(),S.value=!1}),class:"menu-item",disabled:o.value},[e("i",{class:Z(["mdi",o.value?"mdi-loading mdi-spin":"mdi-file-code"])},null,2),e("span",null,m(o.value?"Generating...":"Generate Entities"),1)],8,xs)])):M("",!0)])])]),G(e("div",Ms,[be(ks,{ref_key:"discoveryRef",ref:E,onAdopt:se},null,512),_e(d).hasDevices?(l(),n("div",Rs,[e("div",Ls,[e("button",{class:Z(["filter-toggle-button",{active:Q.value||Te.value}]),onClick:h[6]||(h[6]=z=>Q.value=!Q.value),title:Q.value?"Hide filters":"Show filters"},[h[19]||(h[19]=e("i",{class:"mdi mdi-filter-variant"},null,-1)),Te.value?(l(),n("span",As,m(xe.value),1)):M("",!0)],10,Os),e("div",Es,[h[20]||(h[20]=e("i",{class:"mdi mdi-magnify search-icon"},null,-1)),G(e("input",{"onUpdate:modelValue":h[7]||(h[7]=z=>H.value.search=z),type:"text",placeholder:"Search devices, commands...",class:"search-input"},null,512),[[Oe,H.value.search]])])]),G(e("div",Vs,[e("div",Ps,[e("div",js,[e("label",null,[h[22]||(h[22]=e("i",{class:"mdi mdi-access-point"},null,-1)),G(e("select",{"onUpdate:modelValue":h[8]||(h[8]=z=>H.value.broadlinkDevice=z)},[h[21]||(h[21]=e("option",{value:""},"All Controller Devices",-1)),(l(!0),n(me,null,$e(de.value,z=>(l(),n("option",{key:z.entity_id,value:z.entity_id},m(z.friendly_name),9,Us))),128))],512),[[Ie,H.value.broadlinkDevice]])])]),e("div",Fs,[e("label",null,[h[24]||(h[24]=e("i",{class:"mdi mdi-home-map-marker"},null,-1)),G(e("select",{"onUpdate:modelValue":h[9]||(h[9]=z=>H.value.area=z)},[h[23]||(h[23]=e("option",{value:""},"All Areas",-1)),(l(!0),n(me,null,$e(he.value,z=>(l(),n("option",{key:z,value:z},m(z),9,Ns))),128))],512),[[Ie,H.value.area]])])]),e("div",Bs,[e("label",null,[h[26]||(h[26]=e("i",{class:"mdi mdi-shape"},null,-1)),G(e("select",{"onUpdate:modelValue":h[10]||(h[10]=z=>H.value.entityType=z)},[...h[25]||(h[25]=[Fe('<option value="" data-v-ad3858d1>All Types</option><option value="light" data-v-ad3858d1>Light</option><option value="fan" data-v-ad3858d1>Fan</option><option value="switch" data-v-ad3858d1>Switch</option><option value="media_player" data-v-ad3858d1>Media Player</option><option value="cover" data-v-ad3858d1>Cover</option><option value="climate" data-v-ad3858d1>Climate</option>',7)])],512),[[Ie,H.value.entityType]])])]),le.value?(l(),n("div",Hs,[e("label",qs,[h[27]||(h[27]=e("span",{class:"toggle-text"},[e("img",{src:Ze,alt:"SmartIR",class:"smartir-icon"}),x(" SmartIR Only ")],-1)),G(e("input",{type:"checkbox","onUpdate:modelValue":h[11]||(h[11]=z=>H.value.showSmartIROnly=z),class:"toggle-checkbox"},null,512),[[fe,H.value.showSmartIROnly]]),h[28]||(h[28]=e("span",{class:"toggle-slider"},null,-1))])])):M("",!0),Te.value?(l(),n("button",{key:1,onClick:D,class:"btn-clear-filters"},[...h[29]||(h[29]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),x(" Clear ",-1)])])):M("",!0),e("div",zs,m(De.value.length)+" of "+m(_e(d).deviceCount),1)])],512),[[Je,Q.value]])])):M("",!0),_e(d).loading?(l(),n("div",Js,[...h[30]||(h[30]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading devices...",-1)])])):_e(d).error?(l(),n("div",Ws,[h[31]||(h[31]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,m(_e(d).error),1),e("button",{onClick:h[12]||(h[12]=z=>_e(d).loadDevices()),class:"btn btn-secondary"}," Retry ")])):_e(d).hasDevices?M("",!0):(l(),n("div",Ks,[h[33]||(h[33]=e("i",{class:"mdi mdi-devices"},null,-1)),h[34]||(h[34]=e("h3",null,"No Devices Yet",-1)),h[35]||(h[35]=e("p",null,"Get started by adding your first managed device",-1)),e("button",{onClick:h[13]||(h[13]=z=>k.value=!0),class:"btn btn-primary"},[...h[32]||(h[32]=[e("i",{class:"mdi mdi-plus"},null,-1),x(" Add Your First Device ",-1)])])])),V.value==="grid"?(l(),n("div",Xs,[(l(!0),n(me,null,$e(De.value,z=>(l(),Pe(jt,{key:z.id,device:z,"broadlink-devices":te.value,onEdit:P,onDelete:ye,onLearn:v},null,8,["device","broadlink-devices"]))),128))])):V.value==="list"&&De.value.length>0?(l(),Pe(io,{key:5,devices:De.value,onSendCommand:Le,onOpenCommands:v,onEditDevice:P,onDeleteDevice:ye},null,8,["devices"])):M("",!0),_e(d).hasDevices&&De.value.length===0?(l(),n("div",Gs,[...h[36]||(h[36]=[e("i",{class:"mdi mdi-filter-off"},null,-1),e("h3",null,"No devices match your filters",-1),e("p",null,"Try adjusting your search or filter criteria",-1)])])):M("",!0)],512),[[Je,C.value]]),k.value?(l(),Pe(Vl,{key:0,device:c.value,onSave:O,onCancel:j},null,8,["device"])):M("",!0),s.value?(l(),Pe(Un,{key:1,device:c.value,onLearned:i,onCancel:y},null,8,["device"])):M("",!0),be(Ue,{isOpen:f.value,title:`Delete ${(F=$.value)==null?void 0:F.name}?`,message:ge.value,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,checkboxLabel:Re.value,onConfirm:W,onCancel:we},null,8,["isOpen","title","message","checkboxLabel"]),be(Yn,{isOpen:b.value,title:p.value.title,message:p.value.message,suggestion:p.value.suggestion,details:p.value.details,error:p.value.error,context:p.value.context,onClose:Y},null,8,["isOpen","title","message","suggestion","details","error","context"]),be(Ue,{isOpen:L.value,title:J.value.title,message:J.value.message,confirmText:"OK",showCancel:!1,dangerMode:!J.value.success,onConfirm:T,onCancel:T},null,8,["isOpen","title","message","dangerMode"])])}}},Zs=Ce(Ys,[["__scopeId","data-v-ad3858d1"]]),Qs={class:"banner-content"},ea={class:"banner-icon"},ta={class:"banner-message"},oa={class:"banner-actions"},la={__name:"SmartIRBanner",setup(t){const d=Me("smartirStatus"),r=g(!1),w=X(()=>!(!d.value||r.value||localStorage.getItem("smartir_banner_dismissed")==="true")),k=X(()=>{var E;return(E=d.value)!=null&&E.installed?"banner-success":"banner-info"}),s=X(()=>{var E;return(E=d.value)!=null&&E.installed?"mdi mdi-check-circle":"mdi mdi-information"}),c=X(()=>{var E;return(E=d.value)!=null&&E.installed?`SmartIR Detected (v${d.value.version})`:"Want Climate Device Support?"}),f=X(()=>{var E;return(E=d.value)!=null&&E.installed?"You can now create climate device profiles with full temperature and HVAC mode control.":"Install SmartIR to unlock AC/heater control with temperature settings, HVAC modes, and 120+ pre-configured device profiles."});function S(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function $(){var E;if(r.value=!0,(E=d.value)!=null&&E.installed)localStorage.setItem("smartir_banner_dismissed","true");else{const C=parseInt(localStorage.getItem("smartir_banner_dismiss_count")||"0");C>=2?localStorage.setItem("smartir_banner_dismissed","true"):localStorage.setItem("smartir_banner_dismiss_count",String(C+1))}}return Ae(()=>{var o;const E=localStorage.getItem("smartir_last_status"),C=(o=d.value)!=null&&o.installed?"installed":"not_installed";E!==C&&(localStorage.removeItem("smartir_banner_dismissed"),localStorage.removeItem("smartir_banner_dismiss_count"),localStorage.setItem("smartir_last_status",C))}),(E,C)=>{var o,R;return w.value?(l(),n("div",{key:0,class:Z(["smartir-banner",k.value])},[e("div",Qs,[e("div",ea,[e("i",{class:Z(s.value)},null,2)]),e("div",ta,[e("strong",null,m(c.value),1),e("p",null,m(f.value),1)]),e("div",oa,[(o=E.status)!=null&&o.installed?M("",!0):(l(),n("button",{key:0,onClick:S,class:"btn-primary"}," Learn More ")),e("button",{onClick:$,class:"btn-text"},m((R=E.status)!=null&&R.installed?"Got it":"Dismiss"),1)])])],2)):M("",!0)}}},na=Ce(la,[["__scopeId","data-v-7bbcbcd7"]]),Ne="api/smartir",st={async getStatus(){try{const t=await fetch(`${Ne}/status`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){return console.error("Error fetching SmartIR status:",t),{installed:!1,version:null,error:t.message}}},async getInstallInstructions(){try{const t=await fetch(`${Ne}/install-instructions`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw console.error("Error fetching install instructions:",t),t}},async getPlatforms(){try{const t=await fetch(`${Ne}/platforms`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){throw console.error("Error fetching platforms:",t),t}},async getPlatformCodes(t){try{const d=await fetch(`${Ne}/platforms/${t}/codes`);if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(d){throw console.error(`Error fetching codes for ${t}:`,d),d}},async getNextCode(t){try{const d=await fetch(`${Ne}/platforms/${t}/next-code`);if(!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(d){throw console.error(`Error fetching next code for ${t}:`,d),d}},async validateCode(t,d){try{const r=await fetch(`${Ne}/validate-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:t,code:d})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){throw console.error("Error validating code:",r),r}}},sa={class:"profile-card"},aa={class:"profile-card-header"},ia=["title"],ra={class:"profile-details"},da=["title"],ua={class:"profile-meta"},ca=["title"],ma=["title"],va=["title"],pa={class:"profile-card-footer"},fa=["title"],ga={key:0,class:"learned-indicator"},ya={class:"profile-actions"},ba={__name:"SmartIRProfileCard",props:{profile:{type:Object,required:!0}},emits:["edit","download","delete","commands"],setup(t){const d=t,r=nt(X(()=>d.profile.platform)),w=c=>c.replace(/_/g," ").replace(/\b\w/g,f=>f.toUpperCase()),k=c=>c&&c.startsWith("mdi:")?`mdi ${c.replace(":"," mdi-")}`:`mdi mdi-${c}`,s=c=>{if(!c)return"";const f=c.toLowerCase();return f.includes("broadlink")?"broadlink-tag":f.includes("not set")?"not-set-tag":"default-controller-tag"};return(c,f)=>(l(),n("div",sa,[e("div",aa,[e("div",{class:Z(["profile-icon",_e(r).colorClass.value]),title:w(t.profile.platform)},[e("i",{class:Z(k(_e(r).icon.value))},null,2)],10,ia),e("div",ra,[e("h4",{title:`${t.profile.manufacturer} ${t.profile.model}`},m(t.profile.manufacturer)+" "+m(t.profile.model),9,da),e("div",ua,[e("span",{class:"tag platform-tag",title:w(t.profile.platform)},m(w(t.profile.platform)),9,ca),t.profile.controllerBrand?(l(),n("span",{key:0,class:Z(["tag controller-tag",s(t.profile.controllerBrand)]),title:"Controller: "+t.profile.controllerBrand},[f[4]||(f[4]=e("i",{class:"mdi mdi-remote-tv"},null,-1)),x(" "+m(t.profile.controllerBrand),1)],10,ma)):M("",!0)])]),e("div",{class:"code-badge",title:"Device Code: "+t.profile.code},m(t.profile.code),9,va)]),e("div",pa,[e("div",{class:"profile-stats",title:t.profile.commandCount+" total commands"+(t.profile.learnedCount>0?", "+t.profile.learnedCount+" learned":"")},[f[5]||(f[5]=e("i",{class:"mdi mdi-remote"},null,-1)),e("span",null,m(t.profile.commandCount)+" command"+m(t.profile.commandCount!==1?"s":""),1),t.profile.learnedCount>0?(l(),n("span",ga,"( "+m(t.profile.learnedCount)+" learned )",1)):M("",!0)],8,fa),e("div",ya,[e("button",{onClick:f[0]||(f[0]=S=>c.$emit("commands")),class:"action-btn",title:"Commands"},[...f[6]||(f[6]=[e("i",{class:"mdi mdi-remote"},null,-1)])]),e("button",{onClick:f[1]||(f[1]=S=>c.$emit("edit")),class:"action-btn",title:"Edit Profile"},[...f[7]||(f[7]=[e("i",{class:"mdi mdi-pencil"},null,-1)])]),e("button",{onClick:f[2]||(f[2]=S=>c.$emit("download")),class:"action-btn",title:"Download JSON"},[...f[8]||(f[8]=[e("i",{class:"mdi mdi-download"},null,-1)])]),e("button",{onClick:f[3]||(f[3]=S=>c.$emit("delete")),class:"action-btn delete",title:"Delete Profile"},[...f[9]||(f[9]=[e("i",{class:"mdi mdi-delete"},null,-1)])])])])]))}},ha=Ce(ba,[["__scopeId","data-v-aad9720f"]]),ka={name:"SmartIRProfileListView",props:{profiles:{type:Array,required:!0}},methods:{getPlatformIcon(t){return{climate:"mdi-thermostat",media_player:"mdi-television",fan:"mdi-fan",light:"mdi-lightbulb"}[t]||"mdi-devices"},formatPlatform(t){return{climate:"Climate",media_player:"Media Player",fan:"Fan",light:"Light"}[t]||t},editProfile(t){this.$emit("edit",t)},viewCommands(t){this.$emit("commands",t)},downloadProfile(t){this.$emit("download",t)},deleteProfile(t){this.$emit("delete",t)}}},wa={class:"profile-list-view"},$a={class:"profile-table"},Ca={class:"profile-code"},_a={class:"code-badge"},Sa={class:"profile-manufacturer"},Ia={class:"profile-model"},Da={class:"model-info"},Ta={class:"model-name"},xa={key:0,class:"model-count"},Ma={class:"profile-platform"},Ra={class:"profile-controller"},La={class:"profile-commands"},Oa={class:"command-stats"},Aa={class:"stat-item"},Ea={key:0,class:"stat-item learned"},Va={class:"profile-actions"},Pa=["onClick"],ja=["onClick"],Ua=["onClick"],Fa=["onClick"];function Na(t,d,r,w,k,s){return l(),n("div",wa,[e("table",$a,[d[6]||(d[6]=e("thead",null,[e("tr",null,[e("th",null,"Code"),e("th",null,"Manufacturer"),e("th",null,"Model"),e("th",null,"Platform"),e("th",null,"Controller"),e("th",null,"Commands"),e("th",null,"Actions")])],-1)),e("tbody",null,[(l(!0),n(me,null,$e(r.profiles,c=>(l(),n("tr",{key:`${c.platform}-${c.code}`,class:"profile-row"},[e("td",Ca,[e("span",_a,m(c.code),1)]),e("td",Sa,m(c.manufacturer||"Unknown"),1),e("td",Ia,[e("div",Da,[e("div",Ta,m(c.model||"Unknown"),1),c.models&&c.models.length>1?(l(),n("div",xa," +"+m(c.models.length-1)+" more ",1)):M("",!0)])]),e("td",Ma,[e("span",{class:Z(["platform-badge",c.platform])},[e("i",{class:Z(["mdi",s.getPlatformIcon(c.platform)])},null,2),x(" "+m(s.formatPlatform(c.platform)),1)],2)]),e("td",Ra,m(c.controller_brand||"N/A"),1),e("td",La,[e("div",Oa,[e("span",Aa,[d[0]||(d[0]=e("i",{class:"mdi mdi-remote"},null,-1)),x(" "+m(c.command_count||0),1)]),c.learned_count>0?(l(),n("span",Ea,[d[1]||(d[1]=e("i",{class:"mdi mdi-school"},null,-1)),x(" "+m(c.learned_count),1)])):M("",!0)])]),e("td",Va,[e("button",{class:"action-btn edit",onClick:f=>s.editProfile(c),title:"Edit Profile"},[...d[2]||(d[2]=[e("i",{class:"mdi mdi-pencil"},null,-1)])],8,Pa),e("button",{class:"action-btn commands",onClick:f=>s.viewCommands(c),title:"View Commands"},[...d[3]||(d[3]=[e("i",{class:"mdi mdi-remote"},null,-1)])],8,ja),e("button",{class:"action-btn download",onClick:f=>s.downloadProfile(c),title:"Download"},[...d[4]||(d[4]=[e("i",{class:"mdi mdi-download"},null,-1)])],8,Ua),e("button",{class:"action-btn delete",onClick:f=>s.deleteProfile(c),title:"Delete"},[...d[5]||(d[5]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Fa)])]))),128))])])])}const Ba=Ce(ka,[["render",Na],["__scopeId","data-v-d3773038"]]),Ha={class:"modal-container"},qa={class:"modal-body"},za={key:0,class:"selection-section"},Ja={class:"form-group"},Wa={class:"form-group"},Ka={class:"form-group"},Xa={key:0,class:"code-info"},Ga={class:"form-actions"},Ya=["disabled"],Za={key:1,class:"testing-section"},Qa={class:"code-header"},ei={class:"code-details"},ti={class:"code-badge"},oi={class:"device-selector"},li=["value"],ni={key:0,class:"helper-text"},si={class:"commands-section"},ai={class:"commands-header"},ii={key:0,class:"tested-count"},ri={key:0,class:"filters-section"},di={class:"filter-row"},ui={class:"filter-row"},ci={key:1,class:"empty-state"},mi={key:2,class:"empty-state"},vi={key:3,class:"commands-list"},pi={class:"command-name"},fi={class:"command-actions"},gi={key:0,class:"status-badge success"},yi=["onClick","disabled","title"],bi={__name:"SmartIRCodeTester",props:{isOpen:{type:Boolean,default:!1}},emits:["close","clone"],setup(t,{emit:d}){const r=t,w=d,k=Me("toast"),s=g("climate"),c=g(""),f=g([]),S=g(!1),$=g(null),E=g(""),C=g([]),o=g(!1),R=X(()=>C.value.map(j=>({code:j.code,label:`${j.models.join(", ")} (Code: ${j.code})`,value:j.code}))),q=g(null),V=g(null),I=g(!1),a=g([]),b=g(""),p=g([]),L=g(new Set),J=g(null),Q=g(""),H=g(""),te=g(""),A=g(""),N=X(()=>{let j=p.value;if(Q.value){const v=Q.value.toLowerCase();j=j.filter(y=>(y.label||y.name).toLowerCase().includes(v))}return H.value&&(j=j.filter(v=>v.mode===H.value)),te.value&&(j=j.filter(v=>v.fanSpeed===te.value)),A.value&&(j=j.filter(v=>v.swingMode===A.value)),j}),le=X(()=>Q.value||H.value||te.value||A.value);re(()=>r.isOpen,j=>{j&&(de(),De())}),re(s,()=>{r.isOpen&&(c.value="",$.value=null,C.value=[],de())});async function de(){var j;S.value=!0;try{const v=await ne.get("/api/smartir/codes/manufacturers",{params:{entity_type:s.value}});f.value=v.data.manufacturers||[]}catch(v){console.error("Error loading manufacturers:",v),(j=k.value)==null||j.error("Failed to load manufacturers","❌ Error")}finally{S.value=!1}}async function he(){var j;if(c.value){o.value=!0;try{const v=await ne.get("/api/smartir/codes/models",{params:{entity_type:s.value,manufacturer:c.value}});C.value=v.data.models||[]}catch(v){console.error("Error loading models:",v),(j=k.value)==null||j.error("Failed to load models","❌ Error")}finally{o.value=!1}}}async function De(){try{const j=await ne.get("/api/remote/devices");a.value=j.data.devices||[]}catch(j){console.error("Error loading Broadlink devices:",j)}}async function Te(){var j,v;if($.value){I.value=!0;try{const y=await ne.get("/api/smartir/codes/code",{params:{entity_type:s.value,code_id:$.value.code}});V.value=y.data.code,q.value=$.value.code,xe(y.data.code),(j=k.value)==null||j.success(`Loaded ${p.value.length} commands`,"✅ Code Loaded")}catch(y){console.error("Error loading code:",y),(v=k.value)==null||v.error(y.message||"Failed to load code","❌ Error")}finally{I.value=!1}}}function xe(j){const v=[];if(!j.commands){p.value=v;return}if(s.value==="climate"){const B=j.commands;for(const[Y,T]of Object.entries(B)){if(Y==="off"){typeof T=="string"&&v.push({name:"off",label:"OFF",data:T,mode:"off"});continue}if(typeof T=="object"){for(const[i,U]of Object.entries(T))if(typeof U=="object")for(const[K,ae]of Object.entries(U)){if(typeof ae!="object")continue;const ie=Object.keys(ae),se=ie.includes("24")?"24":ie[0];if(se&&typeof ae[se]=="string"){const ee=`${Y}_${se}_${i}_${K}`,ve=`${Y.toUpperCase()} ${se}°C ${i} ${K}`;v.push({name:ee,label:ve,data:ae[se],mode:Y,temperature:se,fanSpeed:i,swingMode:K})}}}}}else for(const[B,Y]of Object.entries(j.commands))typeof Y=="string"&&v.push({name:B,label:B.toUpperCase().replace(/_/g," "),data:Y});p.value=v}async function D(j){var v,y,B;if(!b.value){(v=k.value)==null||v.warning("Please select a Broadlink device first","⚠️ No Device");return}J.value=j;try{const Y=p.value.find(T=>T.name===j);if(!Y||!Y.data)throw new Error(`Command "${j}" not found`);await ne.post("/api/commands/send-raw",{entity_id:b.value,command:Y.data,command_type:"ir"}),L.value.add(j),(y=k.value)==null||y.success(`Command sent: ${Y.label||j}`,"✅ Tested")}catch(Y){console.error("Error testing command:",Y),(B=k.value)==null||B.error("Failed to test command","❌ Error")}finally{J.value=null}}function u(){var j,v,y,B;if(!V.value){(j=k.value)==null||j.error("No profile data to download","❌ Error");return}try{const Y=V.value.manufacturer||"unknown",T=((v=V.value.supportedModels)==null?void 0:v[0])||q.value,i=`${Y.toLowerCase().replace(/\s+/g,"_")}_${T.toLowerCase().replace(/\s+/g,"_")}.json`,U=JSON.stringify(V.value,null,2),K=new Blob([U],{type:"application/json"}),ae=URL.createObjectURL(K),ie=document.createElement("a");ie.href=ae,ie.download=i,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(ae),(y=k.value)==null||y.success(`Downloaded ${i}`,"✅ Download Complete")}catch(Y){console.error("Error downloading JSON:",Y),(B=k.value)==null||B.error(Y.message||"Failed to download JSON","❌ Download Error")}}function P(){c.value="",$.value=null,E.value="",C.value=[]}function ge(){$.value=null,E.value="",he()}function Re(){E.value?$.value=C.value.find(j=>j.code===E.value):$.value=null}function ye(){Q.value="",H.value="",te.value="",A.value=""}function we(){q.value=null,V.value=null,p.value=[],L.value.clear(),J.value=null,ye()}function W(j){const v=j.toLowerCase();return v.includes("power")||v.includes("off")||v==="off"?"mdi-power":v.includes("cool")?"mdi-snowflake":v.includes("heat")?"mdi-fire":v.includes("fan")?"mdi-fan":v.includes("auto")?"mdi-auto-fix":v.includes("dry")?"mdi-water-percent":v.includes("temp")?"mdi-thermometer":v.includes("swing")?"mdi-swap-vertical":"mdi-remote"}function O(){we(),c.value="",$.value=null,w("close")}return(j,v)=>{var y;return t.isOpen?(l(),n("div",{key:0,class:"modal-overlay",onClick:ce(O,["self"])},[e("div",Ha,[e("div",{class:"modal-header"},[v[9]||(v[9]=e("h3",null,[e("i",{class:"mdi mdi-test-tube"}),x(" Test SmartIR Code ")],-1)),e("button",{onClick:O,class:"close-btn"},[...v[8]||(v[8]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",qa,[q.value?(l(),n("div",Za,[e("div",Qa,[e("div",ei,[e("h4",null,m(V.value.manufacturer)+" - "+m(((y=V.value.supportedModels)==null?void 0:y[0])||"Unknown"),1),e("span",ti,"Code: "+m(q.value),1)]),e("button",{onClick:we,class:"btn-secondary-small"},[...v[14]||(v[14]=[e("i",{class:"mdi mdi-arrow-left"},null,-1),x(" Change Code ",-1)])])]),e("div",oi,[v[17]||(v[17]=e("label",null,[e("i",{class:"mdi mdi-remote"}),x(" Broadlink Device ")],-1)),G(e("select",{"onUpdate:modelValue":v[3]||(v[3]=B=>b.value=B),class:"form-select"},[v[15]||(v[15]=e("option",{value:""},"Select device to test with...",-1)),(l(!0),n(me,null,$e(a.value,B=>(l(),n("option",{key:B.entity_id,value:B.entity_id},m(B.friendly_name||B.entity_id),9,li))),128))],512),[[Ie,b.value]]),b.value?M("",!0):(l(),n("p",ni,[...v[16]||(v[16]=[e("i",{class:"mdi mdi-information-outline"},null,-1),x(" Select a Broadlink device to enable command testing ",-1)])]))]),e("div",si,[e("div",ai,[e("h5",null,"Sample Commands ("+m(N.value.length)+" / "+m(p.value.length)+")",1),L.value.size>0?(l(),n("span",ii,m(L.value.size)+" tested ",1)):M("",!0)]),s.value==="climate"&&p.value.length>0?(l(),n("div",ri,[e("div",di,[G(e("input",{"onUpdate:modelValue":v[4]||(v[4]=B=>Q.value=B),type:"text",placeholder:"Search commands...",class:"search-input"},null,512),[[Oe,Q.value]])]),e("div",ui,[G(e("select",{"onUpdate:modelValue":v[5]||(v[5]=B=>H.value=B),class:"filter-select"},[...v[18]||(v[18]=[e("option",{value:""},"All Modes",-1),e("option",{value:"cool"},"Cool",-1),e("option",{value:"heat"},"Heat",-1),e("option",{value:"off"},"Off",-1)])],512),[[Ie,H.value]]),G(e("select",{"onUpdate:modelValue":v[6]||(v[6]=B=>te.value=B),class:"filter-select"},[...v[19]||(v[19]=[Fe('<option value="" data-v-66569200>All Fan Speeds</option><option value="low" data-v-66569200>Low</option><option value="mid" data-v-66569200>Mid</option><option value="high" data-v-66569200>High</option><option value="auto" data-v-66569200>Auto</option>',5)])],512),[[Ie,te.value]]),G(e("select",{"onUpdate:modelValue":v[7]||(v[7]=B=>A.value=B),class:"filter-select"},[...v[20]||(v[20]=[e("option",{value:""},"All Swing",-1),e("option",{value:"stop"},"Stop",-1),e("option",{value:"swing"},"Swing",-1)])],512),[[Ie,A.value]]),le.value?(l(),n("button",{key:0,onClick:ye,class:"btn-clear-filters"},[...v[21]||(v[21]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),x(" Clear ",-1)])])):M("",!0)])])):M("",!0),p.value.length===0?(l(),n("div",ci,[...v[22]||(v[22]=[e("i",{class:"mdi mdi-alert-circle"},null,-1),e("p",null,"No commands found in this code",-1)])])):N.value.length===0?(l(),n("div",mi,[v[23]||(v[23]=e("i",{class:"mdi mdi-filter-off"},null,-1)),v[24]||(v[24]=e("p",null,"No commands match your filters",-1)),e("button",{onClick:ye,class:"btn-secondary-small"}," Clear Filters ")])):(l(),n("div",vi,[(l(!0),n(me,null,$e(N.value,B=>(l(),n("div",{key:B.name,class:Z(["command-item",{tested:L.value.has(B.name),testing:J.value===B.name}])},[e("div",pi,[e("i",{class:Z(["mdi",W(B.mode||B.name)])},null,2),e("span",null,m(B.label||B.name),1)]),e("div",fi,[L.value.has(B.name)?(l(),n("span",gi,[...v[25]||(v[25]=[e("i",{class:"mdi mdi-check"},null,-1),x(" Tested ",-1)])])):M("",!0),e("button",{onClick:Y=>D(B.name),disabled:!b.value||J.value===B.name,title:b.value?"Test this command":"Select a Broadlink device first",class:"btn-test"},[e("i",{class:Z(["mdi",J.value===B.name?"mdi-loading mdi-spin":"mdi-play"])},null,2),v[26]||(v[26]=x(" Test ",-1))],8,yi)])],2))),128))]))]),e("div",{class:"modal-actions"},[e("button",{onClick:u,class:"btn-primary"},[...v[27]||(v[27]=[e("i",{class:"mdi mdi-download"},null,-1),x(" Download JSON ",-1)])]),e("button",{onClick:O,class:"btn-secondary"}," Close ")])])):(l(),n("div",za,[v[13]||(v[13]=e("div",{class:"info-banner"},[e("i",{class:"mdi mdi-information"}),e("p",null,"Select a SmartIR code from the index to test commands with your Broadlink device.")],-1)),e("div",Ja,[v[11]||(v[11]=e("label",null,[e("i",{class:"mdi mdi-shape"}),x(" Platform ")],-1)),G(e("select",{"onUpdate:modelValue":v[0]||(v[0]=B=>s.value=B),onChange:P,class:"form-select"},[...v[10]||(v[10]=[e("option",{value:"climate"},"Climate (AC/Heater)",-1),e("option",{value:"media_player"},"Media Player (TV/Audio)",-1),e("option",{value:"fan"},"Fan",-1),e("option",{value:"light"},"Light",-1)])],544),[[Ie,s.value]])]),e("div",Wa,[be(We,{modelValue:c.value,"onUpdate:modelValue":v[1]||(v[1]=B=>c.value=B),options:f.value,label:"Manufacturer",placeholder:"Search manufacturers...",loading:S.value,disabled:S.value,onChange:ge},null,8,["modelValue","options","loading","disabled"])]),e("div",Ka,[be(We,{modelValue:E.value,"onUpdate:modelValue":v[2]||(v[2]=B=>E.value=B),options:R.value,"option-label":"label","option-value":"code",label:"Model",placeholder:"Search models...",loading:o.value,disabled:!c.value||o.value,onChange:Re},null,8,["modelValue","options","loading","disabled"])]),$.value?(l(),n("div",Xa,[v[12]||(v[12]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[e("strong",null,m(c.value)+" - "+m($.value.models[0]),1),e("p",null,"Code: "+m($.value.code),1)])])):M("",!0),e("div",Ga,[e("button",{onClick:Te,disabled:!$.value||I.value,class:"btn-primary"},[e("i",{class:Z(["mdi",I.value?"mdi-loading mdi-spin":"mdi-download"])},null,2),x(" "+m(I.value?"Loading...":"Load Commands"),1)],8,Ya)])]))])])])):M("",!0)}}},hi=Ce(bi,[["__scopeId","data-v-66569200"]]),ki={class:"smartir-status-card"},wi={class:"card-header"},$i=["src"],Ci={class:"header-badges"},_i=["title"],Si={class:"header-info"},Ii={class:"header-info"},Di={class:"header-info"},Ti={class:"header-right"},xi={key:0,class:"view-toggle-group header-view-toggle"},Mi={key:2,class:"settings-menu-container"},Ri={key:0,class:"card-body loading-state"},Li={key:1,class:"card-body error-state"},Oi={key:2,class:"card-body installed-state"},Ai={key:0,class:"help-panel"},Ei={key:0,class:"recommendation"},Vi={key:0,class:"next-steps"},Pi={class:"help-actions"},ji={key:1,class:"filter-bar"},Ui={class:"filter-search-row"},Fi=["title"],Ni={key:0,class:"filter-badge"},Bi={class:"search-input-wrapper"},Hi={class:"filter-content"},qi={class:"filter-row"},zi={class:"filter-group"},Ji={class:"filter-results"},Wi={key:2,class:"loading-state"},Ki={key:3,class:"empty-state"},Xi={key:4,class:"profiles-grid"},Gi={key:6,class:"no-results"},Yi={key:3,class:"card-body not-installed-state"},Zi={class:"benefits-section"},Qi={class:"benefits-list"},er={class:"recommendation"},tr={__name:"SmartIRStatusCard",emits:["create-profile","edit-profile"],setup(t,{expose:d,emit:r}){const w=r,k=Me("smartirStatus");Me("smartirEnabled");const s=Me("refreshSmartIR"),{isMobile:c}=Ye(),f=g(!1),S=g(null),$=g((k==null?void 0:k.value)||null),E=g(localStorage.getItem("smartir_simulate_not_installed")==="true"),C=g(!1),o=g(!1),R=g(!0),q=g([]),V=g(!1),I=g(!1),a=g({search:"",platform:""}),b=g({show:!1,title:"",message:"",platform:null,profile:null}),p=g(!1),J=g(window.innerWidth<=767?"grid":localStorage.getItem("profile_view_mode")||"grid");re(c,v=>{v&&J.value==="list"&&(J.value="grid")}),re(J,v=>{localStorage.setItem("profile_view_mode",v)}),re(R,v=>{v||(o.value=!1)});const Q=["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"],H=["climate","media_player","fan","light"],te=X(()=>E.value?{installed:!1,recommendation:{message:"Install SmartIR to unlock climate device support!",benefits:["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"]}}:$.value),A=X(()=>{var v,y;return((y=(v=te.value)==null?void 0:v.platforms)==null?void 0:y.length)||0}),N=X(()=>{var v;return(v=te.value)!=null&&v.device_counts?Object.values(te.value.device_counts).reduce((y,B)=>y+B,0):0});function le(){var v;E.value=!E.value,localStorage.setItem("smartir_simulate_not_installed",E.value.toString()),!E.value&&((v=$.value)!=null&&v.installed)&&ye()}const de=X(()=>{let v=q.value;if(a.value.search){const y=a.value.search.toLowerCase();v=v.filter(B=>{var Y,T,i,U;return((Y=B.manufacturer)==null?void 0:Y.toLowerCase().includes(y))||((T=B.model)==null?void 0:T.toLowerCase().includes(y))||((i=B.code)==null?void 0:i.toString().includes(y))||((U=B.platform)==null?void 0:U.toLowerCase().includes(y))})}return a.value.platform&&(v=v.filter(y=>y.platform===a.value.platform)),v}),he=X(()=>a.value.search||a.value.platform),De=X(()=>{let v=0;return a.value.search&&v++,a.value.platform&&v++,v});function Te(){a.value.search="",a.value.platform=""}async function xe(){f.value=!0,S.value=null;try{if(s)await s();else{const v=await st.getStatus();$.value=v}}catch(v){S.value=v.message||"Failed to refresh SmartIR status",console.error("Error refreshing SmartIR status:",v)}finally{f.value=!1}}function D(){w("create-profile")}function u(){C.value=!C.value,o.value=!1}function P(){R.value||(R.value=!0),o.value=!o.value}function ge(){p.value=!0,o.value=!1}function Re(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}async function ye(){V.value=!0;const v=[];try{for(const y of H)try{const Y=((await ne.get(`/api/smartir/platforms/${y}/profiles`)).data.profiles||[]).map(T=>({...T,platform:y}));v.push(...Y)}catch(B){console.warn(`Network error loading ${y} profiles (using bundled index):`,B.message)}q.value=v}catch(y){console.error("Unexpected error loading profiles:",y)}finally{V.value=!1}}function we(v,y,B){w("edit-profile",{platform:v,profile:y,startStep:B})}async function W(v,y){var B,Y;try{const i=(await ne.get(`/api/smartir/platforms/${v}/profiles/${y.code}`)).data,U=JSON.stringify(i.profile,null,2),K=new Blob([U],{type:"application/json"}),ae=URL.createObjectURL(K),ie=document.createElement("a");ie.href=ae,ie.download=`smartir_${v}_${y.manufacturer}_${y.model}_${y.code}.json`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(ae),(B=Me("toast").value)==null||B.success(`Downloaded ${y.manufacturer} ${y.model}`,"✅ Profile Downloaded")}catch(T){console.error("Error downloading profile:",T),(Y=Me("toast").value)==null||Y.error("Failed to download profile","❌ Download Error")}}async function O(v,y){Me("toast");try{const Y=(await ne.post(`/api/smartir/profiles/${y.code}/check-usage`,{platform:v})).data;if(Y&&Y.in_use){b.value={show:!0,title:`Cannot Delete ${y.manufacturer} ${y.model}`,message:`This profile is currently in use by ${Y.device_count} device(s):

${Y.devices.join(`
`)}

Please remove or reassign these devices before deleting the profile.`,platform:v,profile:y,canDelete:!1,devices:Y.devices};return}}catch(B){console.error("Error checking profile usage:",B)}b.value={show:!0,title:`Delete ${y.manufacturer} ${y.model}?`,message:`Device Code: ${y.code}

This will remove the profile and update your configuration.`,platform:v,profile:y,canDelete:!0}}async function j(){var Y,T;const v=Me("toast"),{platform:y,profile:B}=b.value;b.value.show=!1;try{await ne.delete(`/api/smartir/profiles/${B.code}`,{data:{platform:y}}),await ye(),await ot(),await xe(),(Y=v.value)==null||Y.success(`${B.manufacturer} ${B.model} has been removed`,"✅ Profile Deleted")}catch(i){console.error("Error deleting profile:",i),(T=v.value)==null||T.error("Failed to delete profile","❌ Delete Error")}}return re(k,v=>{v&&($.value=v)},{immediate:!0}),re(J,v=>{localStorage.setItem("profile_view_mode",v)}),Ae(async()=>{var v;k!=null&&k.value&&($.value=k.value),$.value||await xe(),(v=$.value)!=null&&v.installed&&await ye()}),d({loadAllProfiles:ye,refreshStatus:xe}),(v,y)=>{var B,Y,T,i,U,K,ae,ie,se;return l(),n("div",ki,[e("div",wi,[e("button",{class:"icon-button chevron-button",onClick:y[0]||(y[0]=ee=>R.value=!R.value)},[e("i",{class:Z(["mdi",R.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2)]),e("div",{class:"header-left",onClick:y[1]||(y[1]=ee=>R.value=!R.value)},[e("img",{src:_e(Ze),alt:"SmartIR",class:"smartir-logo"},null,8,$i),e("h3",null,m(_e(c)?"SmartIR":"SmartIR Integration"),1),e("div",Ci,[e("div",{class:Z(["simulation-toggle-pill",{active:E.value}]),onClick:ce(le,["stop"]),title:E.value?"Click to show as installed":"Click to simulate not-installed"},[e("i",{class:Z(["mdi",E.value?"mdi-eye-off":"mdi-eye"])},null,2),e("span",null,m(E.value?"Simulating: Not Installed":"Simulation Mode"),1)],10,_i),(B=te.value)!=null&&B.installed?(l(),n(me,{key:0},[y[16]||(y[16]=e("div",{class:"status-badge-mini success"},[e("i",{class:"mdi mdi-check-circle"}),e("span",null,"Installed")],-1)),e("span",Si,"v"+m(te.value.version||"Unknown"),1),e("span",Ii,m(A.value)+" platform"+m(A.value!==1?"s":""),1),e("span",Di,m(N.value)+" device"+m(N.value!==1?"s":""),1)],64)):M("",!0)])]),e("div",Ti,[!_e(c)&&((Y=te.value)!=null&&Y.installed)?(l(),n("div",xi,[e("button",{onClick:y[2]||(y[2]=ce(ee=>J.value="grid",["stop"])),class:Z(["view-toggle-btn",{active:J.value==="grid"}]),title:"Grid View"},[...y[17]||(y[17]=[e("i",{class:"mdi mdi-view-grid"},null,-1)])],2),e("button",{onClick:y[3]||(y[3]=ce(ee=>J.value="list",["stop"])),class:Z(["view-toggle-btn",{active:J.value==="list"}]),title:"List View"},[...y[18]||(y[18]=[e("i",{class:"mdi mdi-view-list"},null,-1)])],2)])):M("",!0),(T=te.value)!=null&&T.installed?(l(),n("button",{key:1,onClick:ce(D,["stop"]),class:"btn btn-primary new-button"},[...y[19]||(y[19]=[e("i",{class:"mdi mdi-plus"},null,-1),e("span",null,"New",-1)])])):M("",!0),(i=te.value)!=null&&i.installed?(l(),n("div",Mi,[e("button",{onClick:ce(P,["stop"]),class:Z(["icon-button settings-button",{active:o.value}]),title:"Settings"},[...y[20]||(y[20]=[e("i",{class:"mdi mdi-cog"},null,-1)])],2),o.value?(l(),n("div",{key:0,class:"settings-dropdown",onClick:y[5]||(y[5]=ce(()=>{},["stop"]))},[e("button",{onClick:u,class:"menu-item"},[y[21]||(y[21]=e("i",{class:"mdi mdi-help-circle"},null,-1)),e("span",null,m(C.value?"Hide Help":"Show Help"),1)]),e("button",{onClick:y[4]||(y[4]=ee=>{o.value=!1,xe()}),class:"menu-item"},[...y[22]||(y[22]=[e("i",{class:"mdi mdi-refresh"},null,-1),e("span",null,"Refresh Status",-1)])]),e("button",{onClick:ge,class:"menu-item"},[...y[23]||(y[23]=[e("i",{class:"mdi mdi-test-tube"},null,-1),e("span",null,"Test Codes",-1)])])])):M("",!0)])):M("",!0)])]),G(e("div",null,[f.value?(l(),n("div",Ri,[...y[24]||(y[24]=[e("div",{class:"spinner"},null,-1),e("p",null,"Checking SmartIR installation...",-1)])])):S.value?(l(),n("div",Li,[y[25]||(y[25]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,m(S.value),1),e("button",{onClick:xe,class:"btn-secondary"}," Try Again ")])):(U=te.value)!=null&&U.installed?(l(),n("div",Oi,[C.value?(l(),n("div",Ai,[$.value.recommendation?(l(),n("div",Ei,[e("p",null,m($.value.recommendation.message),1),$.value.recommendation.next_steps?(l(),n("div",Vi,[y[26]||(y[26]=e("strong",null,"Next Steps:",-1)),e("ul",null,[(l(!0),n(me,null,$e($.value.recommendation.next_steps,(ee,ve)=>(l(),n("li",{key:ve},m(ee),1))),128))])])):M("",!0)])):M("",!0),e("div",Pi,[e("button",{onClick:y[6]||(y[6]=(...ee)=>v.viewDocumentation&&v.viewDocumentation(...ee)),class:"btn-secondary"},[...y[27]||(y[27]=[e("i",{class:"mdi mdi-book-open-variant"},null,-1),x(" View Documentation ",-1)])])])])):M("",!0),q.value.length>0&&!E.value?(l(),n("div",ji,[e("div",Ui,[e("button",{class:Z(["filter-toggle-button",{active:I.value||he.value}]),onClick:y[7]||(y[7]=ee=>I.value=!I.value),title:I.value?"Hide filters":"Show filters"},[y[28]||(y[28]=e("i",{class:"mdi mdi-filter-variant"},null,-1)),he.value?(l(),n("span",Ni,m(De.value),1)):M("",!0)],10,Fi),e("div",Bi,[y[29]||(y[29]=e("i",{class:"mdi mdi-magnify search-icon"},null,-1)),G(e("input",{"onUpdate:modelValue":y[8]||(y[8]=ee=>a.value.search=ee),type:"text",placeholder:"Search profiles...",class:"search-input"},null,512),[[Oe,a.value.search]])])]),G(e("div",Hi,[e("div",qi,[e("div",zi,[e("label",null,[y[31]||(y[31]=e("i",{class:"mdi mdi-shape"},null,-1)),G(e("select",{"onUpdate:modelValue":y[9]||(y[9]=ee=>a.value.platform=ee)},[...y[30]||(y[30]=[Fe('<option value="" data-v-4ef33ace>All Platforms</option><option value="climate" data-v-4ef33ace>Climate</option><option value="media_player" data-v-4ef33ace>Media Player</option><option value="fan" data-v-4ef33ace>Fan</option><option value="light" data-v-4ef33ace>Light</option>',5)])],512),[[Ie,a.value.platform]])])]),he.value?(l(),n("button",{key:0,onClick:Te,class:"btn-clear-filters"},[...y[32]||(y[32]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),x(" Clear ",-1)])])):M("",!0),e("div",Ji,m(de.value.length)+" of "+m(q.value.length),1)])],512),[[Je,I.value]])])):M("",!0),V.value?(l(),n("div",Wi,[...y[33]||(y[33]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading profiles...",-1)])])):q.value.length===0?(l(),n("div",Ki,[...y[34]||(y[34]=[e("i",{class:"mdi mdi-file-document-outline"},null,-1),e("h3",null,"No Profiles Yet",-1),e("p",null,"Create your first SmartIR profile to get started",-1)])])):M("",!0),J.value==="grid"&&!E.value?(l(),n("div",Xi,[(l(!0),n(me,null,$e(de.value,ee=>(l(),Pe(ha,{key:`${ee.platform}-${ee.code}`,profile:ee,onEdit:ve=>we(ee.platform,ee),onCommands:ve=>we(ee.platform,ee,2),onDownload:ve=>W(ee.platform,ee),onDelete:ve=>O(ee.platform,ee)},null,8,["profile","onEdit","onCommands","onDownload","onDelete"]))),128))])):J.value==="list"&&!E.value&&de.value.length>0?(l(),Pe(Ba,{key:5,profiles:de.value,onEdit:y[10]||(y[10]=ee=>we(ee.platform,ee)),onCommands:y[11]||(y[11]=ee=>we(ee.platform,ee,2)),onDownload:y[12]||(y[12]=ee=>W(ee.platform,ee)),onDelete:y[13]||(y[13]=ee=>O(ee.platform,ee))},null,8,["profiles"])):M("",!0),q.value.length>0&&de.value.length===0&&!E.value?(l(),n("div",Gi,[...y[35]||(y[35]=[e("i",{class:"mdi mdi-filter-off"},null,-1),e("h3",null,"No profiles match your filters",-1),e("p",null,"Try adjusting your search or filter criteria",-1)])])):M("",!0)])):(l(),n("div",Yi,[y[39]||(y[39]=e("div",{class:"status-badge warning"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Not Installed")],-1)),e("div",Zi,[y[37]||(y[37]=e("h4",null,"Why Install SmartIR?",-1)),e("ul",Qi,[(l(!0),n(me,null,$e(((ae=(K=$.value)==null?void 0:K.recommendation)==null?void 0:ae.benefits)||Q,(ee,ve)=>(l(),n("li",{key:ve},[y[36]||(y[36]=e("i",{class:"mdi mdi-check"},null,-1)),e("span",null,m(ee),1)]))),128))])]),e("div",er,[e("p",null,m(((se=(ie=$.value)==null?void 0:ie.recommendation)==null?void 0:se.message)||"Install SmartIR to unlock climate device support!"),1)]),e("div",{class:"card-actions"},[e("button",{onClick:Re,class:"btn-primary"},[...y[38]||(y[38]=[e("i",{class:"mdi mdi-github"},null,-1),x(" Install SmartIR ",-1)])])])]))],512),[[Je,R.value]]),be(Ue,{isOpen:b.value.show,title:b.value.title,message:b.value.message,confirmText:b.value.canDelete===!1?null:"Delete",cancelText:"Close",dangerMode:!0,confirmDisabled:b.value.canDelete===!1,onConfirm:j,onCancel:y[14]||(y[14]=ee=>b.value.show=!1)},null,8,["isOpen","title","message","confirmText","confirmDisabled"]),be(hi,{isOpen:p.value,onClose:y[15]||(y[15]=ee=>p.value=!1)},null,8,["isOpen"])])}}},or=Ce(tr,[["__scopeId","data-v-4ef33ace"]]),lr={class:"climate-form"},nr={class:"learning-mode-section"},sr={class:"mode-toggle"},ar={class:"mode-content"},ir={class:"mode-stats"},rr={class:"stat-badge"},dr={class:"stat-badge time"},ur={class:"mode-content"},cr={class:"mode-stats"},mr={class:"stat-badge"},vr={class:"stat-badge time warning"},pr={key:0,class:"command-breakdown"},fr={class:"warning-text"},gr={class:"form-section"},yr={key:0,class:"help-text"},br={key:1,class:"help-text"},hr={class:"form-row"},kr={class:"form-group"},wr={class:"form-group"},$r={class:"form-group"},Cr={key:2,class:"representative-temp-section"},_r={class:"form-group"},Sr=["value"],Ir={class:"form-section"},Dr={class:"checkbox-grid"},Tr={class:"checkbox-item"},xr={class:"checkbox-item"},Mr={class:"checkbox-item"},Rr={class:"checkbox-item"},Lr={class:"checkbox-item"},Or={class:"checkbox-item"},Ar={class:"form-section"},Er={class:"checkbox-grid"},Vr={class:"checkbox-item"},Pr={class:"checkbox-item"},jr={class:"checkbox-item"},Ur={class:"checkbox-item"},Fr={class:"form-section"},Nr={class:"checkbox-grid"},Br={class:"checkbox-item"},Hr={class:"checkbox-item"},qr={class:"checkbox-item"},zr={class:"checkbox-item"},Jr={class:"form-section"},Wr={class:"form-group"},Kr={class:"form-group"},Xr={class:"form-group"},Gr={key:0,class:"validation-summary"},Yr={__name:"ClimateProfileForm",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(t,{emit:d}){const r=t,w=d,k=g("quick"),s=g({minTemp:16,maxTemp:30,precision:1,representativeTemp:24,modes:["off","auto","cool","heat"],fanModes:["auto","low","medium","high"],swingModes:[],tempSensor:"",humiditySensor:"",powerSensor:"",learningMode:"quick",...r.modelValue}),c=X(()=>{const I=[],a=s.value.minTemp||16,b=s.value.maxTemp||30,p=s.value.precision||1;for(let L=a;L<=b;L+=p)I.push(L);return I}),f=X(()=>s.value.modes.filter(I=>I!=="off").length),S=X(()=>s.value.fanModes.length||1),$=X(()=>s.value.swingModes.length||1),E=X(()=>{const I=s.value.minTemp||16,a=s.value.maxTemp||30,b=s.value.precision||1;return Math.floor((a-I)/b)+1}),C=X(()=>{const I=s.value.modes.includes("off")?1:0;return f.value*S.value*$.value+I}),o=X(()=>Math.ceil(C.value*30/60)),R=X(()=>{const I=s.value.modes.includes("off")?1:0;return f.value*E.value*S.value*$.value+I}),q=X(()=>Math.ceil(R.value*30/60)),V=X(()=>{const I=[];return(!s.value.minTemp||s.value.minTemp<10||s.value.minTemp>35)&&I.push("Minimum temperature must be between 10°C and 35°C"),(!s.value.maxTemp||s.value.maxTemp<10||s.value.maxTemp>35)&&I.push("Maximum temperature must be between 10°C and 35°C"),s.value.minTemp>=s.value.maxTemp&&I.push("Minimum temperature must be less than maximum temperature"),(!s.value.modes||s.value.modes.length===0)&&I.push("At least one HVAC mode must be selected"),I});return re(k,I=>{s.value.learningMode=I}),re(s,I=>{w("update:modelValue",I)},{deep:!0,immediate:!0}),(I,a)=>(l(),n("div",lr,[a[63]||(a[63]=e("h3",null,"Climate Device Configuration",-1)),e("div",nr,[e("div",sr,[e("label",{class:Z(["mode-option",{active:k.value==="quick"}])},[G(e("input",{type:"radio",value:"quick","onUpdate:modelValue":a[0]||(a[0]=b=>k.value=b)},null,512),[[ze,k.value]]),e("div",ar,[a[23]||(a[23]=e("div",{class:"mode-header"},[e("i",{class:"mdi mdi-flash"}),e("strong",null,"Quick Mode (Recommended)")],-1)),a[24]||(a[24]=e("p",null,"Learn one temperature per mode combination",-1)),e("div",ir,[e("span",rr,m(C.value)+" commands",1),e("span",dr,"~"+m(o.value)+" min",1)])])],2),e("label",{class:Z(["mode-option",{active:k.value==="complete"}])},[G(e("input",{type:"radio",value:"complete","onUpdate:modelValue":a[1]||(a[1]=b=>k.value=b)},null,512),[[ze,k.value]]),e("div",ur,[a[25]||(a[25]=e("div",{class:"mode-header"},[e("i",{class:"mdi mdi-check-all"}),e("strong",null,"Complete Mode")],-1)),a[26]||(a[26]=e("p",null,"Learn all temperature combinations",-1)),e("div",cr,[e("span",mr,m(R.value)+" commands",1),e("span",vr,"~"+m(q.value)+" min",1)])])],2)]),k.value==="complete"?(l(),n("div",pr,[a[27]||(a[27]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[e("strong",null,"Complete mode will require learning "+m(R.value)+" commands",1),e("p",null,"This includes all combinations of modes ("+m(f.value)+"), temperatures ("+m(E.value)+"), fan speeds ("+m(S.value)+"), and swing modes ("+m($.value)+").",1),e("p",fr,"⏱️ Estimated time: "+m(q.value)+" minutes at ~30 seconds per command",1)])])):M("",!0)]),e("div",gr,[a[33]||(a[33]=e("h4",null,"Temperature Range",-1)),k.value==="quick"?(l(),n("p",yr," Define the full temperature range your device supports. You'll select one temperature to learn below. ")):(l(),n("p",br," Define the temperature range. All temperatures in this range will be learned. ")),e("div",hr,[e("div",kr,[a[28]||(a[28]=e("label",null,"Minimum Temperature (°C) *",-1)),G(e("input",{"onUpdate:modelValue":a[2]||(a[2]=b=>s.value.minTemp=b),type:"number",min:"10",max:"35",placeholder:"16"},null,512),[[Oe,s.value.minTemp,void 0,{number:!0}]])]),e("div",wr,[a[29]||(a[29]=e("label",null,"Maximum Temperature (°C) *",-1)),G(e("input",{"onUpdate:modelValue":a[3]||(a[3]=b=>s.value.maxTemp=b),type:"number",min:"10",max:"35",placeholder:"30"},null,512),[[Oe,s.value.maxTemp,void 0,{number:!0}]])]),e("div",$r,[a[31]||(a[31]=e("label",null,"Precision",-1)),G(e("select",{"onUpdate:modelValue":a[4]||(a[4]=b=>s.value.precision=b)},[...a[30]||(a[30]=[e("option",{value:1},"1°C (Whole degrees)",-1),e("option",{value:.5},"0.5°C (Half degrees)",-1)])],512),[[Ie,s.value.precision,void 0,{number:!0}]])])]),k.value==="quick"?(l(),n("div",Cr,[e("div",_r,[a[32]||(a[32]=e("label",null,"Representative Temperature to Learn *",-1)),G(e("select",{"onUpdate:modelValue":a[5]||(a[5]=b=>s.value.representativeTemp=b)},[(l(!0),n(me,null,$e(c.value,b=>(l(),n("option",{key:b,value:b},m(b)+"°C ",9,Sr))),128))],512),[[Ie,s.value.representativeTemp,void 0,{number:!0}]]),e("small",null,"This temperature will be learned for all mode combinations. The device profile will still show the full range ("+m(s.value.minTemp)+"°C - "+m(s.value.maxTemp)+"°C).",1)])])):M("",!0)]),e("div",Ir,[a[40]||(a[40]=e("h4",null,"Supported HVAC Modes *",-1)),a[41]||(a[41]=e("p",{class:"help-text"},"Select all modes your device supports",-1)),e("div",Dr,[e("label",Tr,[G(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":a[6]||(a[6]=b=>s.value.modes=b)},null,512),[[fe,s.value.modes]]),a[34]||(a[34]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),x(" Off ")],-1))]),e("label",xr,[G(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":a[7]||(a[7]=b=>s.value.modes=b)},null,512),[[fe,s.value.modes]]),a[35]||(a[35]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),x(" Auto ")],-1))]),e("label",Mr,[G(e("input",{type:"checkbox",value:"cool","onUpdate:modelValue":a[8]||(a[8]=b=>s.value.modes=b)},null,512),[[fe,s.value.modes]]),a[36]||(a[36]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-snowflake"}),x(" Cool ")],-1))]),e("label",Rr,[G(e("input",{type:"checkbox",value:"heat","onUpdate:modelValue":a[9]||(a[9]=b=>s.value.modes=b)},null,512),[[fe,s.value.modes]]),a[37]||(a[37]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fire"}),x(" Heat ")],-1))]),e("label",Lr,[G(e("input",{type:"checkbox",value:"dry","onUpdate:modelValue":a[10]||(a[10]=b=>s.value.modes=b)},null,512),[[fe,s.value.modes]]),a[38]||(a[38]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-water-percent"}),x(" Dry ")],-1))]),e("label",Or,[G(e("input",{type:"checkbox",value:"fan_only","onUpdate:modelValue":a[11]||(a[11]=b=>s.value.modes=b)},null,512),[[fe,s.value.modes]]),a[39]||(a[39]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan"}),x(" Fan Only ")],-1))])])]),e("div",Ar,[a[46]||(a[46]=e("h4",null,"Fan Modes",-1)),a[47]||(a[47]=e("p",{class:"help-text"},"Select all fan speeds your device supports",-1)),e("div",Er,[e("label",Vr,[G(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":a[12]||(a[12]=b=>s.value.fanModes=b)},null,512),[[fe,s.value.fanModes]]),a[42]||(a[42]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),x(" Auto ")],-1))]),e("label",Pr,[G(e("input",{type:"checkbox",value:"low","onUpdate:modelValue":a[13]||(a[13]=b=>s.value.fanModes=b)},null,512),[[fe,s.value.fanModes]]),a[43]||(a[43]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-1"}),x(" Low ")],-1))]),e("label",jr,[G(e("input",{type:"checkbox",value:"medium","onUpdate:modelValue":a[14]||(a[14]=b=>s.value.fanModes=b)},null,512),[[fe,s.value.fanModes]]),a[44]||(a[44]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-2"}),x(" Medium ")],-1))]),e("label",Ur,[G(e("input",{type:"checkbox",value:"high","onUpdate:modelValue":a[15]||(a[15]=b=>s.value.fanModes=b)},null,512),[[fe,s.value.fanModes]]),a[45]||(a[45]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-3"}),x(" High ")],-1))])])]),e("div",Fr,[a[52]||(a[52]=e("h4",null,"Swing Modes (Optional)",-1)),a[53]||(a[53]=e("p",{class:"help-text"},"Select if your device has swing/oscillation",-1)),e("div",Nr,[e("label",Br,[G(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":a[16]||(a[16]=b=>s.value.swingModes=b)},null,512),[[fe,s.value.swingModes]]),a[48]||(a[48]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),x(" Off ")],-1))]),e("label",Hr,[G(e("input",{type:"checkbox",value:"vertical","onUpdate:modelValue":a[17]||(a[17]=b=>s.value.swingModes=b)},null,512),[[fe,s.value.swingModes]]),a[49]||(a[49]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-vertical"}),x(" Vertical ")],-1))]),e("label",qr,[G(e("input",{type:"checkbox",value:"horizontal","onUpdate:modelValue":a[18]||(a[18]=b=>s.value.swingModes=b)},null,512),[[fe,s.value.swingModes]]),a[50]||(a[50]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),x(" Horizontal ")],-1))]),e("label",zr,[G(e("input",{type:"checkbox",value:"both","onUpdate:modelValue":a[19]||(a[19]=b=>s.value.swingModes=b)},null,512),[[fe,s.value.swingModes]]),a[51]||(a[51]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-arrow-all"}),x(" Both ")],-1))])])]),e("div",Jr,[a[60]||(a[60]=e("h4",null,"Sensors (Optional)",-1)),a[61]||(a[61]=e("p",{class:"help-text"},"Link external sensors for better climate control",-1)),e("div",Wr,[a[54]||(a[54]=e("label",null,"Temperature Sensor",-1)),G(e("input",{"onUpdate:modelValue":a[20]||(a[20]=b=>s.value.tempSensor=b),type:"text",placeholder:"sensor.living_room_temperature"},null,512),[[Oe,s.value.tempSensor]]),a[55]||(a[55]=e("small",null,"Entity ID of temperature sensor",-1))]),e("div",Kr,[a[56]||(a[56]=e("label",null,"Humidity Sensor",-1)),G(e("input",{"onUpdate:modelValue":a[21]||(a[21]=b=>s.value.humiditySensor=b),type:"text",placeholder:"sensor.living_room_humidity"},null,512),[[Oe,s.value.humiditySensor]]),a[57]||(a[57]=e("small",null,"Entity ID of humidity sensor",-1))]),e("div",Xr,[a[58]||(a[58]=e("label",null,"Power Sensor",-1)),G(e("input",{"onUpdate:modelValue":a[22]||(a[22]=b=>s.value.powerSensor=b),type:"text",placeholder:"binary_sensor.ac_power"},null,512),[[Oe,s.value.powerSensor]]),a[59]||(a[59]=e("small",null,"Entity ID of power sensor (to detect on/off state)",-1))])]),V.value.length>0?(l(),n("div",Gr,[a[62]||(a[62]=e("h4",null,[e("i",{class:"mdi mdi-alert-circle"}),x(" Please fix the following: ")],-1)),e("ul",null,[(l(!0),n(me,null,$e(V.value,(b,p)=>(l(),n("li",{key:p},m(b),1))),128))])])):M("",!0)]))}},Zr=Ce(Yr,[["__scopeId","data-v-c44d7198"]]),Qr={class:"command-wizard"},ed={class:"device-selection-section"},td={class:"input-wrapper"},od=["value"],ld={key:0,class:"validation-tooltip"},nd={class:"form-group"},sd=["disabled"],ad={key:0},id={key:1},rd={key:0,class:"edit-mode-banner"},dd={class:"wizard-info"},ud={key:0},cd={key:1},md={class:"progress-info"},vd={class:"progress-bar"},pd={class:"progress-text"},fd={class:"commands-grid"},gd={class:"command-header"},yd={class:"command-icon"},bd={class:"command-info"},hd={key:0,class:"learning-indicator"},kd={key:0,class:"ir-learning-steps"},wd={key:1,class:"rf-learning-steps"},$d={class:"command-actions"},Cd=["onClick","disabled"],_d={key:1,class:"learned-status"},Sd=["onClick","disabled"],Id=["onClick"],Dd={class:"quick-actions"},Td=["disabled"],xd=["disabled"],Md={__name:"CommandLearningWizard",props:{modelValue:{type:Object,default:()=>({})},platform:{type:String,required:!0},config:{type:Object,required:!0},broadlinkDevice:{type:String,default:""},manufacturer:{type:String,required:!0},model:{type:String,required:!0},commandType:{type:String,default:"ir"}},emits:["update:modelValue","update:broadlinkDevice","update:commandType"],setup(t,{emit:d}){const r=Be(),w=t,k=d,s=g({...w.modelValue}),c=g(null),f=g(null),S=g([]),$=g(w.broadlinkDevice),E=g(w.commandType),C=g(!1),o=g([]),R=g(!1),q=g(!1),V=g({show:!1,commandKey:null,commandLabel:""}),I=g(!1),a=X(()=>{const D=[];if(w.platform==="climate"){const u=w.config.modes||[],P=w.config.fanModes||[],ge=w.config.minTemp||16,Re=w.config.maxTemp||30;u.forEach(ye=>{if(ye==="off")D.push({key:"off",label:"Power Off",description:"Turn device off",icon:"mdi mdi-power",mode:"off"});else for(let we=ge;we<=Re;we++)P.forEach(W=>{const O=`${ye}_${we}_${W}`;D.push({key:O,label:`${ye.toUpperCase()} ${we}°C ${W}`,description:`Mode: ${ye}, Temp: ${we}°C, Fan: ${W}`,icon:J(ye),mode:ye,temp:we,fanMode:W})})})}else if(w.platform==="media_player"){const u=w.config.features||[];u.includes("turn_on")&&(D.push({key:"turn_on",label:"Power On",description:"Turn on the device",icon:"mdi mdi-power"}),D.push({key:"turn_off",label:"Power Off",description:"Turn off the device",icon:"mdi mdi-power-off"})),u.includes("volume")&&(D.push({key:"volume_up",label:"Volume Up",description:"Increase volume",icon:"mdi mdi-volume-plus"}),D.push({key:"volume_down",label:"Volume Down",description:"Decrease volume",icon:"mdi mdi-volume-minus"})),u.includes("mute")&&D.push({key:"mute",label:"Mute",description:"Toggle mute",icon:"mdi mdi-volume-mute"}),u.includes("source")&&(D.push({key:"source_hdmi1",label:"Source: HDMI 1",description:"Switch to HDMI 1",icon:"mdi mdi-import"}),D.push({key:"source_hdmi2",label:"Source: HDMI 2",description:"Switch to HDMI 2",icon:"mdi mdi-import"}),D.push({key:"source_hdmi3",label:"Source: HDMI 3",description:"Switch to HDMI 3",icon:"mdi mdi-import"})),u.includes("channel")&&(D.push({key:"channel_up",label:"Channel Up",description:"Next channel",icon:"mdi mdi-chevron-up"}),D.push({key:"channel_down",label:"Channel Down",description:"Previous channel",icon:"mdi mdi-chevron-down"}))}else if(w.platform==="fan"){const u=w.config.speedLevels||3,P=w.config.features||[];D.push({key:"turn_on",label:"Power On",description:"Turn on the fan",icon:"mdi mdi-power"}),D.push({key:"turn_off",label:"Power Off",description:"Turn off the fan",icon:"mdi mdi-power-off"});for(let ge=1;ge<=u;ge++){const Re=ge===1?"Low":ge===u?"High":ge===2&&u===3?"Medium":`Speed ${ge}`;D.push({key:`speed_${ge}`,label:`${Re}`,description:`Set fan to speed level ${ge}`,icon:"mdi mdi-fan"})}P.includes("oscillate")&&(D.push({key:"oscillate_on",label:"Oscillate On",description:"Enable oscillation",icon:"mdi mdi-sync"}),D.push({key:"oscillate_off",label:"Oscillate Off",description:"Disable oscillation",icon:"mdi mdi-sync-off"})),P.includes("direction")&&(D.push({key:"direction_forward",label:"Direction: Forward",description:"Set direction to forward",icon:"mdi mdi-rotate-right"}),D.push({key:"direction_reverse",label:"Direction: Reverse",description:"Set direction to reverse",icon:"mdi mdi-rotate-left"}))}else if(w.platform==="light"){const u=w.config.features||[];u.includes("turn_on")&&(D.push({key:"turn_on",label:"Power On",description:"Turn on the light",icon:"mdi mdi-lightbulb-on"}),D.push({key:"turn_off",label:"Power Off",description:"Turn off the light",icon:"mdi mdi-lightbulb-off"})),u.includes("brightness")&&(D.push({key:"brightness_up",label:"Brightness Up",description:"Increase brightness",icon:"mdi mdi-brightness-7"}),D.push({key:"brightness_down",label:"Brightness Down",description:"Decrease brightness",icon:"mdi mdi-brightness-5"})),u.includes("color_temp")&&(D.push({key:"color_temp_warm",label:"Warm White",description:"Set to warm white",icon:"mdi mdi-weather-sunset"}),D.push({key:"color_temp_cool",label:"Cool White",description:"Set to cool white",icon:"mdi mdi-weather-sunny"})),u.includes("rgb")&&(D.push({key:"color_red",label:"Color: Red",description:"Set color to red",icon:"mdi mdi-palette"}),D.push({key:"color_green",label:"Color: Green",description:"Set color to green",icon:"mdi mdi-palette"}),D.push({key:"color_blue",label:"Color: Blue",description:"Set color to blue",icon:"mdi mdi-palette"}))}return D}),b=X(()=>a.value.length),p=X(()=>Object.keys(s.value).length),L=X(()=>b.value===0?0:Math.round(p.value/b.value*100));function J(D){return{off:"mdi mdi-power",auto:"mdi mdi-autorenew",cool:"mdi mdi-snowflake",heat:"mdi mdi-fire",dry:"mdi mdi-water-percent",fan_only:"mdi mdi-fan"}[D]||"mdi mdi-remote"}async function Q(D){if(!c.value){if(!$.value){q.value=!0,window.scrollTo({top:0,behavior:"smooth"});return}q.value=!1,c.value=D.key;try{const u=w.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_"),P=w.model.toLowerCase().replace(/[^a-z0-9]+/g,"_"),ge=`${u}_${P}`,ye=(await ne.post("/api/commands/learn",{entity_id:$.value,device:ge,command:D.key,command_type:E.value})).data;if(ye.success&&ye.code)s.value[D.key]=ye.code,k("update:modelValue",s.value),R.value=!0,ye.code==="pending"&&console.log(`⏳ Command '${D.key}' learned, code will be fetched from storage when saving`),C.value&&o.value.length>0&&setTimeout(()=>{const we=o.value.shift();we?Q(we):C.value=!1},1e3);else throw new Error(ye.error||"Failed to learn command")}catch(u){console.error("Error learning command:",u),r.error(`Error learning command: ${u.message}`),C.value=!1,o.value=[]}finally{C.value||(c.value=null)}}}async function H(D){var u;if(!$.value){q.value=!0,window.scrollTo({top:0,behavior:"smooth"});return}if(!s.value[D]){(u=r.value)==null||u.error("Command not learned yet");return}f.value=D;try{const P=s.value[D];await ne.post("/api/commands/send-raw",{entity_id:$.value,command:P,command_type:E.value}),r.success("Command sent successfully")}catch(P){console.error("Error testing command:",P),r.error(`Error testing command: ${P.message}`)}finally{f.value=null}}function te(D){const u=a.value.find(P=>P.key===D);V.value={show:!0,commandKey:D,commandLabel:u?u.label:D}}function A(){const D=V.value.commandKey;delete s.value[D],k("update:modelValue",s.value),V.value.show=!1}function N(){const D=a.value.filter(P=>!s.value[P.key]);if(D.length===0)return;C.value=!0,o.value=[...D];const u=o.value.shift();u&&Q(u)}function le(){I.value=!0}function de(){s.value={},k("update:modelValue",s.value),I.value=!1}re(()=>w.modelValue,D=>{s.value={...D}},{deep:!0}),Ae(async()=>{await he()});async function he(){try{console.log("SmartIR device - commands will be loaded from SmartIR JSON file, not Broadlink storage")}catch(D){console.error("Error in loadExistingCommands:",D)}}function De(){k("update:broadlinkDevice",$.value)}function Te(){k("update:commandType",E.value)}async function xe(){try{console.log("🔍 Loading Broadlink devices from /api/remote/devices");const D=await ne.get("/api/remote/devices");console.log("📦 Response data:",D.data);const u=D.data.devices||[];console.log(`✅ Found ${u.length} devices:`,u),S.value=u}catch(D){console.error("❌ Error loading remote devices:",D),S.value=[]}}return re(()=>w.broadlinkDevice,D=>{$.value=D}),re($,D=>{D&&(q.value=!1)}),re(()=>w.commandType,D=>{E.value=D}),Ae(async()=>{await xe(),await he()}),(D,u)=>(l(),n("div",Qr,[u[22]||(u[22]=e("h3",null,"Learn IR Commands",-1)),e("div",ed,[e("div",{class:Z(["form-group",{"has-error":q.value}])},[u[6]||(u[6]=e("label",null,"Broadlink Device *",-1)),e("div",td,[G(e("select",{"onUpdate:modelValue":u[0]||(u[0]=P=>$.value=P),onChange:De},[u[4]||(u[4]=e("option",{value:""},"Select Broadlink device...",-1)),(l(!0),n(me,null,$e(S.value,P=>(l(),n("option",{key:P.entity_id,value:P.entity_id},m(P.name||P.entity_id),9,od))),128))],544),[[Ie,$.value]]),q.value?(l(),n("div",ld,[...u[5]||(u[5]=[e("i",{class:"mdi mdi-alert"},null,-1),x(" Device is required ",-1)])])):M("",!0)]),e("small",null,"This device will be used to learn commands ("+m(S.value.length)+" devices found)",1)],2),e("div",nd,[u[8]||(u[8]=e("label",null,"Command Type *",-1)),G(e("select",{"onUpdate:modelValue":u[1]||(u[1]=P=>E.value=P),onChange:Te,disabled:p.value>0},[...u[7]||(u[7]=[e("option",{value:"ir"},"📡 Infrared (IR) - Most common for AC, TV, etc.",-1),e("option",{value:"rf"},"📻 Radio Frequency (RF) - For RF remotes",-1)])],40,sd),[[Ie,E.value]]),p.value>0?(l(),n("small",ad,"Command type cannot be changed after learning commands")):(l(),n("small",id,"Select the type of commands your device uses"))])]),p.value>0&&!R.value?(l(),n("div",rd,[u[10]||(u[10]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[u[9]||(u[9]=e("strong",null,"Editing Existing Profile",-1)),e("p",null,m(p.value)+" command"+m(p.value!==1?"s":"")+' already learned. You can re-learn any command by clicking the delete icon and then "Learn Command".',1)])])):M("",!0),e("div",dd,[u[14]||(u[14]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[u[13]||(u[13]=e("p",null,[e("strong",null,"How it works:")],-1)),t.commandType==="ir"?(l(),n("ol",ud,[...u[11]||(u[11]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Point your IR remote directly at the Broadlink device")],-1),e("li",null,"Press the button on your remote",-1),e("li",null,"Wait for confirmation (up to 30 seconds)",-1)])])):(l(),n("ol",cd,[...u[12]||(u[12]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Step 1:"),x(" Hold button on remote - Broadlink scans for RF frequency")],-1),e("li",null,[e("strong",null,"Step 2:"),x(" Watch for Home Assistant notification, then press and release button")],-1),e("li",null,"Keep remote within 5cm of Broadlink (RF doesn't need line-of-sight)",-1),e("li",null,"Wait for confirmation (may take up to 30 seconds)",-1)])]))])]),e("div",md,[e("div",vd,[e("div",{class:"progress-fill",style:ut({width:L.value+"%"})},null,4)]),e("span",pd,m(p.value)+" / "+m(b.value)+" commands learned ("+m(L.value)+"%) ",1)]),e("div",fd,[(l(!0),n(me,null,$e(a.value,P=>(l(),n("div",{key:P.key,class:Z(["command-card",{learned:s.value[P.key],learning:c.value===P.key}])},[e("div",gd,[e("div",yd,[e("i",{class:Z(P.icon)},null,2)]),e("div",bd,[e("h4",null,m(P.label),1),e("p",null,m(P.description),1)])]),c.value===P.key?(l(),n("div",hd,[t.commandType==="ir"?(l(),n("div",kd,[...u[15]||(u[15]=[e("p",null,[e("strong",null,"Point your remote directly at the Broadlink device and press the button.")],-1),e("small",null,"Listening for up to 30 seconds...",-1)])])):(l(),n("div",wd,[...u[16]||(u[16]=[e("p",{class:"rf-title"},[e("strong",null,"Learning request sent to device.")],-1),e("p",{class:"rf-subtitle"},[x("RF learning is a "),e("strong",null,"two-step process"),x(":")],-1),e("ol",null,[e("li",null,[e("strong",null,"Step 1 - Frequency Sweep (~10-15 seconds):"),x(" Press and hold the button on your remote until the notification updates. ")]),e("li",null,[e("strong",null,"Step 2 - Learn Signal:"),x(" Press and release the button once. ")])],-1),e("p",{class:"rf-note"},"Follow the Home Assistant notifications (🔔) for real-time instructions.",-1)])]))])):M("",!0),e("div",$d,[s.value[P.key]?(l(),n("div",_d,[u[18]||(u[18]=e("i",{class:"mdi mdi-check-circle"},null,-1)),u[19]||(u[19]=e("span",null,"Learned",-1)),e("span",{class:Z(["command-type-badge",E.value])},m(E.value.toUpperCase()),3),e("button",{onClick:ge=>H(P.key),class:"icon-btn",title:"Test command",disabled:f.value===P.key,style:{"margin-left":"auto"}},[e("i",{class:Z(["mdi mdi-play",{"mdi-spin":f.value===P.key}])},null,2)],8,Sd),e("button",{onClick:ge=>te(P.key),class:"icon-btn danger",title:"Delete and re-learn"},[...u[17]||(u[17]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Id)])):(l(),n("button",{key:0,onClick:ge=>Q(P),class:Z(["btn-learn",{learning:c.value===P.key}]),disabled:c.value!==null},[e("i",{class:Z(["mdi mdi-radio-tower",{"mdi-spin":c.value===P.key}])},null,2),x(" "+m(c.value===P.key?"Listening...":"Learn Command"),1)],10,Cd))])],2))),128))]),e("div",Dd,[e("button",{onClick:N,class:"btn-secondary",disabled:c.value!==null||p.value===b.value},[...u[20]||(u[20]=[e("i",{class:"mdi mdi-play-circle"},null,-1),x(" Learn All Remaining ",-1)])],8,Td),e("button",{onClick:le,class:"btn-text",disabled:p.value===0},[...u[21]||(u[21]=[e("i",{class:"mdi mdi-delete-sweep"},null,-1),x(" Clear All ",-1)])],8,xd)]),be(Ue,{isOpen:V.value.show,title:"Delete Learned Command?",message:`Are you sure you want to delete the '${V.value.commandLabel}' command?

You will need to re-learn this command.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:A,onCancel:u[2]||(u[2]=P=>V.value.show=!1)},null,8,["isOpen","message"]),be(Ue,{isOpen:I.value,title:"Delete All Learned Commands?",message:"Are you sure you want to delete all learned commands? This cannot be undone.\\n\\nYou will need to re-learn all commands.",confirmText:"Delete All",cancelText:"Cancel",dangerMode:!0,onConfirm:de,onCancel:u[3]||(u[3]=P=>I.value=!1)},null,8,["isOpen"])]))}},Rd=Ce(Md,[["__scopeId","data-v-9a9e9e51"]]),Ld={class:"profile-preview"},Od={class:"preview-summary"},Ad={class:"summary-card"},Ed={class:"stats-grid"},Vd={class:"stat-item"},Pd={class:"stat-value"},jd={class:"stat-item"},Ud={class:"stat-value"},Fd={class:"stat-item"},Nd={class:"stat-value"},Bd={class:"preview-tabs"},Hd={class:"preview-content"},qd={key:0,class:"tab-content"},zd={class:"code-header"},Jd={class:"code-block"},Wd={key:1,class:"tab-content"},Kd={class:"code-header"},Xd={class:"code-block"},Gd={key:2,class:"tab-content"},Yd={class:"instructions"},Zd={class:"step-item"},Qd={class:"step-content"},eu={class:"code-path"},tu={__name:"ProfilePreview",props:{profile:{type:Object,required:!0},jsonData:{type:Object,required:!0},yamlConfig:{type:String,required:!0}},setup(t){const d=Be(),r=t,w=g("json"),k=g(!1),s=g(!1),c=X(()=>Object.keys(r.profile.commands||{}).length),f=X(()=>JSON.stringify(r.jsonData,null,2));async function S(){try{await navigator.clipboard.writeText(f.value),k.value=!0,setTimeout(()=>{k.value=!1},2e3)}catch(E){console.error("Failed to copy JSON:",E),d.error("Failed to copy to clipboard")}}async function $(){try{await navigator.clipboard.writeText(r.yamlConfig),s.value=!0,setTimeout(()=>{s.value=!1},2e3)}catch(E){console.error("Failed to copy YAML:",E),d.error("Failed to copy to clipboard")}}return(E,C)=>{var o;return l(),n("div",Ld,[C[22]||(C[22]=e("h3",null,"Preview & Save",-1)),e("div",Od,[e("div",Ad,[C[4]||(C[4]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("div",null,[C[3]||(C[3]=e("h4",null,"Profile Ready!",-1)),e("p",null,m(t.profile.manufacturer)+" "+m(t.profile.model),1)])]),e("div",Ed,[e("div",Vd,[e("span",Pd,m(c.value),1),C[5]||(C[5]=e("span",{class:"stat-label"},"Commands Learned",-1))]),e("div",jd,[e("span",Ud,m(t.profile.platform),1),C[6]||(C[6]=e("span",{class:"stat-label"},"Platform",-1))]),e("div",Fd,[e("span",Nd,m(((o=t.profile.config.modes)==null?void 0:o.length)||0),1),C[7]||(C[7]=e("span",{class:"stat-label"},"HVAC Modes",-1))])])]),e("div",Bd,[e("button",{onClick:C[0]||(C[0]=R=>w.value="json"),class:Z(["tab-button",{active:w.value==="json"}])},[...C[8]||(C[8]=[e("i",{class:"mdi mdi-code-json"},null,-1),x(" SmartIR JSON ",-1)])],2),e("button",{onClick:C[1]||(C[1]=R=>w.value="yaml"),class:Z(["tab-button",{active:w.value==="yaml"}])},[...C[9]||(C[9]=[e("i",{class:"mdi mdi-file-code"},null,-1),x(" YAML Config ",-1)])],2),e("button",{onClick:C[2]||(C[2]=R=>w.value="instructions"),class:Z(["tab-button",{active:w.value==="instructions"}])},[...C[10]||(C[10]=[e("i",{class:"mdi mdi-information"},null,-1),x(" Instructions ",-1)])],2)]),e("div",Hd,[w.value==="json"?(l(),n("div",qd,[e("div",zd,[C[12]||(C[12]=e("h4",null,"SmartIR Device Code JSON",-1)),e("button",{onClick:S,class:"btn-copy"},[C[11]||(C[11]=e("i",{class:"mdi mdi-content-copy"},null,-1)),x(" "+m(k.value?"Copied!":"Copy"),1)])]),e("pre",Jd,[e("code",null,m(f.value),1)]),C[13]||(C[13]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),x(" Save this as "),e("code",null,"10000.json"),x(" in your SmartIR codes directory ")],-1))])):M("",!0),w.value==="yaml"?(l(),n("div",Wd,[e("div",Kd,[C[15]||(C[15]=e("h4",null,"Home Assistant Configuration",-1)),e("button",{onClick:$,class:"btn-copy"},[C[14]||(C[14]=e("i",{class:"mdi mdi-content-copy"},null,-1)),x(" "+m(s.value?"Copied!":"Copy"),1)])]),e("pre",Xd,[e("code",null,m(t.yamlConfig),1)]),C[16]||(C[16]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),x(" Add this to your "),e("code",null,"configuration.yaml"),x(" file ")],-1))])):M("",!0),w.value==="instructions"?(l(),n("div",Gd,[e("div",Yd,[C[20]||(C[20]=e("h4",null,"Installation Steps",-1)),e("div",Zd,[C[19]||(C[19]=e("div",{class:"step-number"},"1",-1)),e("div",Qd,[C[17]||(C[17]=e("h5",null,"Get Next Code Number",-1)),C[18]||(C[18]=e("p",null,"Custom device codes start at 10000. Check your SmartIR codes directory to find the next available number.",-1)),e("div",eu,[e("code",null,"/config/custom_components/smartir/codes/"+m(t.profile.platform)+"/",1)])])]),C[21]||(C[21]=Fe('<div class="step-item" data-v-e7b997c8><div class="step-number" data-v-e7b997c8>2</div><div class="step-content" data-v-e7b997c8><h5 data-v-e7b997c8>Save JSON File</h5><p data-v-e7b997c8>Copy the JSON from the &quot;SmartIR JSON&quot; tab and save it as <code data-v-e7b997c8>10000.json</code> (or your next available number) in the codes directory.</p></div></div><div class="step-item" data-v-e7b997c8><div class="step-number" data-v-e7b997c8>3</div><div class="step-content" data-v-e7b997c8><h5 data-v-e7b997c8>Update Configuration</h5><p data-v-e7b997c8>Copy the YAML from the &quot;YAML Config&quot; tab and add it to your <code data-v-e7b997c8>configuration.yaml</code> file. Update the <code data-v-e7b997c8>device_code</code> to match your JSON filename.</p></div></div><div class="step-item" data-v-e7b997c8><div class="step-number" data-v-e7b997c8>4</div><div class="step-content" data-v-e7b997c8><h5 data-v-e7b997c8>Restart Home Assistant</h5><p data-v-e7b997c8>Restart Home Assistant to load the new configuration. Your climate entity will appear in the UI.</p></div></div><div class="step-item" data-v-e7b997c8><div class="step-number" data-v-e7b997c8>5</div><div class="step-content" data-v-e7b997c8><h5 data-v-e7b997c8>Test Your Device</h5><p data-v-e7b997c8>Go to your climate entity and test different modes, temperatures, and fan speeds to ensure everything works correctly.</p></div></div><div class="tips-section" data-v-e7b997c8><h4 data-v-e7b997c8><i class="mdi mdi-lightbulb" data-v-e7b997c8></i> Tips </h4><ul data-v-e7b997c8><li data-v-e7b997c8>Keep a backup of your JSON file in case you need to modify it</li><li data-v-e7b997c8>Test all commands to ensure they work as expected</li><li data-v-e7b997c8>You can share your profile with the SmartIR community on GitHub</li><li data-v-e7b997c8>If a command doesn&#39;t work, you can re-learn it and update the JSON</li></ul></div>',5))])])):M("",!0)])])}}},ou=Ce(tu,[["__scopeId","data-v-e7b997c8"]]),lu={class:"wizard-body"},nu={key:0,class:"warning-section"},su={class:"warning-box"},au={class:"instructions"},iu={class:"code-block"},ru={class:"steps"},du={key:0},uu={class:"help-section"},cu={key:0,class:"help-content"},mu={class:"help-step"},vu={key:0,class:"help-step"},pu={class:"help-step"},fu={class:"help-step"},gu={class:"checklist"},yu={class:"checkbox-label"},bu={key:0,class:"checkbox-label"},hu={class:"wizard-footer"},ku=["disabled"],wu={__name:"SmartIRSetupWizard",props:{show:{type:Boolean,default:!1},platform:{type:String,required:!0},warnings:{type:Array,default:()=>[]},configPath:{type:String,default:"/config"}},emits:["close","complete"],setup(t,{emit:d}){const r=t,w=d,k=Me("toast"),s=g(!1),c=g(!1),f=g(!1),S=X(()=>r.warnings.length>0?s.value&&c.value:s.value);function $(){const C=`${r.platform}: !include smartir/${r.platform}.yaml`;navigator.clipboard.writeText(C).then(()=>{var o;(o=k.value)==null||o.success("Include line copied to clipboard!","✅ Copied")}).catch(o=>{var R;console.error("Failed to copy:",o),(R=k.value)==null||R.error("Failed to copy to clipboard","❌ Copy Failed")})}function E(){w("complete")}return(C,o)=>t.show?(l(),n("div",{key:0,class:"modal-overlay",onClick:o[5]||(o[5]=ce(()=>{},["stop"]))},[e("div",{class:"setup-wizard",onClick:o[4]||(o[4]=ce(()=>{},["stop"]))},[o[31]||(o[31]=e("div",{class:"wizard-header"},[e("h2",null,[e("i",{class:"mdi mdi-cog"}),x(" SmartIR Configuration Setup ")])],-1)),e("div",lu,[t.warnings.length>0?(l(),n("div",nu,[e("div",su,[o[11]||(o[11]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[o[9]||(o[9]=e("h3",null,"⚠️ Configuration Migration Needed",-1)),o[10]||(o[10]=e("p",null,"We detected existing platform entries in your configuration.yaml:",-1)),e("ul",null,[(l(!0),n(me,null,$e(t.warnings,R=>(l(),n("li",{key:R.platform},[e("strong",null,m(R.platform)+":",1),x(" "+m(R.message),1)]))),128))]),e("p",null,[o[6]||(o[6]=e("strong",null,"Action Required:",-1)),o[7]||(o[7]=x(" Move these entries to ",-1)),e("code",null,"smartir/"+m(t.platform)+".yaml",1),o[8]||(o[8]=x(" before continuing.",-1))])])])])):M("",!0),e("div",au,[o[27]||(o[27]=e("h3",null,"📝 One-Time Setup",-1)),o[28]||(o[28]=e("p",null,[x("To enable SmartIR device management, add this line to your "),e("code",null,"configuration.yaml"),x(":")],-1)),e("div",iu,[e("code",null,m(t.platform)+": !include smartir/"+m(t.platform)+".yaml",1),e("button",{onClick:$,class:"copy-btn",title:"Copy to clipboard"},[...o[12]||(o[12]=[e("i",{class:"mdi mdi-content-copy"},null,-1)])])]),e("div",ru,[o[19]||(o[19]=e("h4",null,"Steps:",-1)),e("ol",null,[t.warnings.length>0?(l(),n("li",du,[o[13]||(o[13]=e("strong",null,"Move existing entries:",-1)),o[14]||(o[14]=x(" Copy any existing ",-1)),e("code",null,m(t.platform)+":",1),o[15]||(o[15]=x(" entries from configuration.yaml to ",-1)),e("code",null,"smartir/"+m(t.platform)+".yaml",1)])):M("",!0),o[16]||(o[16]=e("li",null,[e("strong",null,"Add include line:"),x(" Add the line above to your configuration.yaml ")],-1)),o[17]||(o[17]=e("li",null,[e("strong",null,"Save changes:"),x(" Save configuration.yaml ")],-1)),o[18]||(o[18]=e("li",null,[e("strong",null,"Continue here:"),x(` Click "I've Completed Setup" below `)],-1))])]),e("div",uu,[e("button",{onClick:o[0]||(o[0]=R=>f.value=!f.value),class:"help-toggle"},[e("i",{class:Z(["mdi",f.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2),x(" "+m(f.value?"Hide":"Show")+" Detailed Instructions ",1)]),f.value?(l(),n("div",cu,[o[26]||(o[26]=e("h4",null,"Detailed Setup Guide:",-1)),e("div",mu,[o[21]||(o[21]=e("h5",null,"1. Open configuration.yaml",-1)),e("p",null,[o[20]||(o[20]=x("Location: ",-1)),e("code",null,m(t.configPath)+"/configuration.yaml",1)])]),t.warnings.length>0?(l(),n("div",vu,[o[22]||(o[22]=e("h5",null,"2. Migrate Existing Entries (If Any)",-1)),e("p",null,"If you have existing "+m(t.platform)+" entries, cut them from configuration.yaml and paste into:",1),e("p",null,[e("code",null,m(t.configPath)+"/smartir/"+m(t.platform)+".yaml",1)]),o[23]||(o[23]=e("p",{class:"note"},"Broadlink Manager will create this file automatically.",-1))])):M("",!0),e("div",pu,[e("h5",null,m(t.warnings.length>0?"3":"2")+". Add Include Line",1),o[24]||(o[24]=e("p",null,"Add this to configuration.yaml:",-1)),e("pre",null,m(t.platform)+": !include smartir/"+m(t.platform)+".yaml",1)]),e("div",fu,[e("h5",null,m(t.warnings.length>0?"4":"3")+". Restart Home Assistant",1),o[25]||(o[25]=e("p",null,"After saving, you'll need to restart HA for changes to take effect.",-1))])])):M("",!0)])]),e("div",gu,[e("label",yu,[G(e("input",{type:"checkbox","onUpdate:modelValue":o[1]||(o[1]=R=>s.value=R)},null,512),[[fe,s.value]]),o[29]||(o[29]=e("span",null,"I've added the include line to configuration.yaml",-1))]),t.warnings.length>0?(l(),n("label",bu,[G(e("input",{type:"checkbox","onUpdate:modelValue":o[2]||(o[2]=R=>c.value=R)},null,512),[[fe,c.value]]),e("span",null,"I've migrated existing "+m(t.platform)+" entries (if any)",1)])):M("",!0)])]),e("div",hu,[e("button",{onClick:o[3]||(o[3]=R=>C.$emit("close")),class:"btn-secondary"}," Cancel "),e("button",{onClick:E,class:"btn-primary",disabled:!S.value},[...o[30]||(o[30]=[e("i",{class:"mdi mdi-check"},null,-1),x(" I've Completed Setup ",-1)])],8,ku)])])])):M("",!0)}},$u=Ce(wu,[["__scopeId","data-v-f6fe4c03"]]),Cu={class:"modal-header"},_u={class:"progress-steps"},Su={class:"step-number"},Iu={key:0,class:"mdi mdi-check"},Du={key:1},Tu={class:"step-label"},xu={class:"modal-body"},Mu={key:0,class:"step-content"},Ru={class:"form-group"},Lu={class:"form-group"},Ou={class:"form-group"},Au={key:1,class:"step-content"},Eu={key:1,class:"platform-form"},Vu={class:"form-section"},Pu={class:"checkbox-grid"},ju={class:"checkbox-item"},Uu={class:"checkbox-item"},Fu={class:"checkbox-item"},Nu={class:"checkbox-item"},Bu={class:"checkbox-item"},Hu={key:2,class:"platform-form"},qu={class:"form-section"},zu={class:"form-group"},Ju={class:"form-section"},Wu={class:"checkbox-grid"},Ku={class:"checkbox-item"},Xu={class:"checkbox-item"},Gu={key:3,class:"platform-form"},Yu={class:"form-section"},Zu={class:"checkbox-grid"},Qu={class:"checkbox-item"},ec={class:"checkbox-item"},tc={class:"checkbox-item"},oc={class:"checkbox-item"},lc={key:2,class:"step-content"},nc={key:3,class:"step-content"},sc={class:"modal-footer"},ac=["disabled"],ic={key:2,class:"save-buttons"},rc=["disabled"],dc=["disabled"],uc={__name:"SmartIRProfileBuilder",props:{show:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},editData:{type:Object,default:null},startStep:{type:Number,default:0}},emits:["close","save"],setup(t,{emit:d}){const r=t,w=d,k=Me("toast"),s=g(0),c=g(!1),f=g([]),S=g(!1),$=g([]),E=g("/config"),C=g(!1),o=g(null),R=g(!1),q=g(!1),V=g(""),I=g("ir"),a=g(!1),b=[{label:"Device Info",key:"info"},{label:"Configuration",key:"config"},{label:"Learn Commands",key:"commands"},{label:"Preview & Save",key:"preview"}],p=g({platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}}),L=g(["turn_on"]),J=g(3),Q=g([]),H=g(["turn_on"]);re(()=>p.value.platform,T=>{T==="media_player"?p.value.config={features:L.value}:T==="fan"?p.value.config={speedLevels:J.value,features:Q.value}:T==="light"&&(p.value.config={features:H.value})}),re(L,T=>{p.value.platform==="media_player"&&(p.value.config={features:T})},{deep:!0}),re(J,T=>{p.value.platform==="fan"&&(p.value.config={speedLevels:T,features:Q.value})}),re(Q,T=>{p.value.platform==="fan"&&(p.value.config={speedLevels:J.value,features:T})},{deep:!0}),re(H,T=>{p.value.platform==="light"&&(p.value.config={features:T})},{deep:!0});function te(T){const i=new Set,U=Object.keys(T);return U.some(K=>K==="off"||K.includes("_off"))&&i.add("off"),U.some(K=>K.includes("auto"))&&i.add("auto"),U.some(K=>K.includes("cool"))&&i.add("cool"),U.some(K=>K.includes("heat"))&&i.add("heat"),U.some(K=>K.includes("dry"))&&i.add("dry"),U.some(K=>K.includes("fan_only"))&&i.add("fan_only"),Array.from(i)}function A(T){const i=new Set,U=Object.keys(T);return U.some(K=>K.includes("auto"))&&i.add("auto"),U.some(K=>K.includes("low"))&&i.add("low"),U.some(K=>K.includes("medium")||K.includes("mid"))&&i.add("medium"),U.some(K=>K.includes("high"))&&i.add("high"),Array.from(i)}function N(T){const i=new Set,U=Object.keys(T);return U.some(K=>K.includes("swing_off")||K.includes("_off"))&&i.add("off"),U.some(K=>K.includes("vertical"))&&i.add("vertical"),U.some(K=>K.includes("horizontal"))&&i.add("horizontal"),U.some(K=>K.includes("both"))&&i.add("both"),Array.from(i)}function le(T){for(const i of Object.values(T))if(typeof i=="string"&&i.startsWith("sc")||Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0].startsWith("sc"))return"rf";return"ir"}re(()=>p.value.commandType,(T,i)=>{!i||R.value||a.value||(Object.keys(p.value.commands).length>0&&T!==i?(V.value=T,p.value.commandType=i,R.value=!0):T!==i&&(I.value=T))}),re(()=>r.editData,async T=>{var i,U,K;if(T&&r.editMode){console.log("🔧 Edit mode activated, loading profile data:",T),a.value=!0,f.value.length===0&&(console.log("📡 Loading Broadlink devices..."),await Y(),console.log("📡 Devices loaded:",f.value.length));const ae=T.profile,ie=ae.controller_data;console.log("🎮 Controller data from profile:",ie),console.log("🎮 Available devices:",f.value.map(_=>_.entity_id));const se=ae.commands||{},ee=ae.commandType||le(se);console.log("🔍 Command type (stored):",ae.commandType),console.log("🔍 Command type (final):",ee);let ve={};if(T.platform==="climate"){const _=ae.operationModes||te(se),h=ae.fanModes||A(se),F=ae.swingModes||N(se);console.log("🔍 Inferred modes:",_),console.log("🔍 Inferred fan modes:",h),console.log("🔍 Inferred swing modes:",F),ve={minTemp:ae.minTemperature,maxTemp:ae.maxTemperature,precision:ae.precision,modes:_,fanModes:h,swingModes:F}}else if(T.platform==="media_player"){const _=[];(se.on||se.off)&&_.push("turn_on"),(se.volumeUp||se.volumeDown)&&_.push("volume"),se.mute&&_.push("mute"),se.sources&&_.push("source"),(se.channelUp||se.channelDown)&&_.push("channel"),ve={features:_},L.value=_,console.log("🔍 Inferred media player features:",_)}else if(T.platform==="fan"){const _=((i=ae.speed)==null?void 0:i.length)||Object.keys(se.default||{}).length||3,h=[];(se.oscillate_on||se.oscillate_off)&&h.push("oscillate"),(se.direction_forward||se.direction_reverse)&&h.push("direction"),ve={speedLevels:_,features:h},J.value=_,Q.value=h,console.log("🔍 Inferred fan config:",ve)}else if(T.platform==="light"){const _=[];ve={features:_},H.value=_,console.log("🔍 Inferred light features:",_)}const Le=await v(ae.manufacturer,(U=ae.supportedModels)==null?void 0:U[0],se);p.value={platform:T.platform,manufacturer:ae.manufacturer||"",model:((K=ae.supportedModels)==null?void 0:K[0])||"",broadlinkDevice:ie||"",commandType:ee,config:ve,commands:Le},console.log("✅ Profile populated:",p.value),console.log("✅ Selected device:",p.value.broadlinkDevice),console.log("✅ Command type:",p.value.commandType),console.log("✅ Commands (with learned codes):",Le),I.value=ee,setTimeout(()=>{a.value=!1},100)}},{immediate:!0});const de=X(()=>{var T;switch(s.value){case 0:return p.value.platform&&p.value.manufacturer&&p.value.model;case 1:return p.value.platform==="climate"?p.value.config.minTemp&&p.value.config.maxTemp&&((T=p.value.config.modes)==null?void 0:T.length)>0:!0;case 2:return p.value.broadlinkDevice&&p.value.commandType&&Object.keys(p.value.commands).length>0;case 3:return!0;default:return!1}}),he=g(null);async function De(){if(s.value!==3){he.value=null;return}if(console.log("🔍 Generating JSON with commands:",p.value.commands),Object.values(p.value.commands).some(i=>typeof i=="string"?i==="pending":typeof i=="object"?Object.values(i).some(U=>typeof U=="string"?U==="pending":typeof U=="object"?Object.values(U).some(K=>K==="pending"):!1):!1)){console.warn('⚠️ Commands still contain "pending" placeholders!'),console.log("📦 Attempting to fetch from Broadlink storage...");const i=await v(p.value.manufacturer,p.value.model,p.value.commands);p.value.commands=i,console.log("✅ Updated commands:",i)}he.value=y(p.value),console.log("📄 Generated JSON:",he.value)}const Te=X(()=>s.value!==3?null:B(p.value));function xe(){p.value.config={},p.value.commands={}}function D(){R.value=!1,p.value.commandType=V.value,I.value=V.value,p.value.commands={},V.value=""}function u(){R.value=!1,V.value=""}async function P(){s.value<b.length-1&&(s.value++,s.value===3&&await De())}function ge(){s.value>0&&s.value--}function Re(){R.value||(q.value=!0)}function ye(){q.value=!1,we()}function we(){w("close"),setTimeout(()=>{s.value=0,p.value={platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}},I.value="ir"},300)}async function W(){var T,i,U,K,ae,ie;c.value=!0;try{if(!C.value){const h=(await ne.get("/api/smartir/config/check")).data;if(h&&!((T=h.platforms[p.value.platform])==null?void 0:T.file_exists)){$.value=h.configuration_warnings||[],E.value=h.config_path||"/config",o.value={platform:p.value.platform,json:he.value},S.value=!0,c.value=!1;return}}let se;r.editMode&&((i=r.editData)!=null&&i.code)?(se=parseInt(r.editData.code),console.log("📝 Edit mode: Using existing code",se)):(se=(await ne.get(`/api/smartir/platforms/${p.value.platform}/next-code`)).data.next_code,console.log("✨ New profile: Using next code",se));const ve=(await ne.post("/api/smartir/profiles",{platform:p.value.platform,json:he.value,code_number:se})).data,Le={platform:"smartir",name:`${p.value.manufacturer} ${p.value.model}`,unique_id:`${p.value.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_")}_${p.value.model.toLowerCase().replace(/[^a-z0-9]+/g,"_")}`,device_code:se,controller_data:p.value.broadlinkDevice};try{await ne.post("/api/smartir/config/add-device",{platform:p.value.platform,device_config:{platform:"smartir",name:Le.name,unique_id:Le.unique_id,device_code:Le.device_code,controller_data:Le.controller_data}})}catch(_){console.error("Failed to add device to config:",_);const h=((U=_.response)==null?void 0:U.data)||{};let F=h.error||"Unknown error";h.validation_errors&&h.validation_errors.length>0&&(F=`Device configuration validation failed:
`+h.validation_errors.map(z=>`  • ${z}`).join(`
`)),(K=k.value)==null||K.warning(`Profile saved but failed to add to config file:
${F}`,"⚠️ Partial Success")}w("save",{json:he.value,yaml:Te.value,profile:p.value,saved_to:ve.path}),(ae=k.value)==null||ae.success(`File: ${ve.filename}
Device Code: ${se}
Added to: smartir/${p.value.platform}.yaml

⚠️ Restart Home Assistant to activate`,"✅ Profile Saved Successfully!"),we()}catch(se){console.error("Error saving profile:",se),(ie=k.value)==null||ie.error(se.message,"❌ Error Saving Profile")}finally{c.value=!1}}async function O(){C.value=!0,S.value=!1,o.value&&(await W(),o.value=null)}function j(){var T,i;try{const U=JSON.stringify(he.value,null,2),K=new Blob([U],{type:"application/json"}),ae=URL.createObjectURL(K),ie=document.createElement("a");ie.href=ae;const se=p.value.manufacturer.toLowerCase().replace(/\s+/g,"_"),ee=p.value.model.toLowerCase().replace(/\s+/g,"_");ie.download=`smartir_${p.value.platform}_${se}_${ee}.json`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),URL.revokeObjectURL(ae),(T=k.value)==null||T.success("You can manually upload this file to your SmartIR codes directory.","✅ Profile Downloaded")}catch(U){console.error("Error downloading profile:",U),(i=k.value)==null||i.error(U.message,"❌ Error Downloading Profile")}}async function v(T,i,U){const K=T.toLowerCase().replace(/[^a-z0-9]+/g,"_"),ae=i.toLowerCase().replace(/[^a-z0-9]+/g,"_"),ie=`${K}_${ae}`;try{const ve=(await ne.get("/api/commands/all")).data[ie]||{};console.log(`🔍 Fetching learned commands for device: ${ie}`),console.log("📦 Device commands from storage:",ve);const Le={...U};for(const[_,h]of Object.entries(Le))if(h==="pending"&&ve[_])Le[_]=ve[_];else if(typeof h=="object"){for(const[F,z]of Object.entries(h))if(typeof z=="object")for(const[oe,ke]of Object.entries(z)){const pe=`${_}_${F}_${oe}`;ke==="pending"&&ve[pe]&&(Le[_][F][oe]=ve[pe])}else if(z==="pending"){const oe=`${_}_${F}`;ve[oe]&&(Le[_][F]=ve[oe])}}return console.log("✅ Merged commands:",Le),Le}catch(se){return console.error("Error fetching learned commands:",se),U}}function y(T){const i={manufacturer:T.manufacturer,supportedModels:[T.model],supportedController:"Broadlink",commandsEncoding:"Base64",commandType:T.commandType||"ir",commands:{}};return T.platform==="climate"&&(i.minTemperature=T.config.minTemp,i.maxTemperature=T.config.maxTemp,i.precision=T.config.precision||1,i.operationModes=T.config.modes||[],i.fanModes=T.config.fanModes&&T.config.fanModes.length>0?T.config.fanModes:["auto"],T.config.swingModes&&T.config.swingModes.length>0&&(i.swingModes=T.config.swingModes),i.commands=T.commands),i}function B(T){let i=`# SmartIR ${T.platform} configuration
`;return i+=`# Generated by Broadlink Manager v2

`,T.platform==="climate"&&(i+=`climate:
`,i+=`  - platform: smartir
`,i+=`    name: ${T.manufacturer} ${T.model}
`,i+=`    unique_id: ${T.manufacturer.toLowerCase()}_${T.model.toLowerCase().replace(/\s+/g,"_")}
`,i+=`    device_code: 10000  # Change this to your custom code number
`,i+=`    controller_data: ${T.broadlinkDevice}
`,T.config.tempSensor&&(i+=`    temperature_sensor: ${T.config.tempSensor}
`),T.config.humiditySensor&&(i+=`    humidity_sensor: ${T.config.humiditySensor}
`),T.config.powerSensor&&(i+=`    power_sensor: ${T.config.powerSensor}
`)),i}async function Y(){try{console.log("Fetching remote devices from /api/remote/devices...");const T=await ne.get("/api/remote/devices");console.log("Loaded remote devices response:",T.data);const i=T.data.devices||[];console.log("Extracted devices array:",i),console.log("Device count:",i.length),f.value=i,console.log("broadlinkDevices.value set to:",f.value),console.log("Final device count:",f.value.length)}catch(T){console.error("Error loading remote devices:",T),f.value=[]}}return re(()=>r.show,T=>{if(T){const i=Number.isInteger(r.startStep)?r.startStep:0;s.value=Math.min(Math.max(i,0),b.length-1)}}),re(()=>r.startStep,T=>{if(r.show){const i=Number.isInteger(T)?T:0;s.value=Math.min(Math.max(i,0),b.length-1)}}),Ae(()=>{r.show&&Y()}),(T,i)=>t.show?(l(),n("div",{key:0,class:"modal-overlay",onClick:Re},[e("div",{class:"modal-container",onClick:i[19]||(i[19]=ce(()=>{},["stop"]))},[e("div",Cu,[e("h2",null,[i[22]||(i[22]=e("i",{class:"mdi mdi-file-document-edit"},null,-1)),x(" "+m(t.editMode?"Edit SmartIR Profile":"Create SmartIR Profile"),1)]),e("button",{onClick:we,class:"close-button"},[...i[23]||(i[23]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",_u,[(l(),n(me,null,$e(b,(U,K)=>e("div",{key:K,class:Z(["step",{active:s.value===K,completed:s.value>K}])},[e("div",Su,[s.value>K?(l(),n("i",Iu)):(l(),n("span",Du,m(K+1),1))]),e("span",Tu,m(U.label),1)],2)),64))]),e("div",xu,[s.value===0?(l(),n("div",Mu,[i[29]||(i[29]=e("h3",null,"Device Information",-1)),e("div",Ru,[i[25]||(i[25]=e("label",null,"Platform Type *",-1)),G(e("select",{"onUpdate:modelValue":i[0]||(i[0]=U=>p.value.platform=U),onChange:xe},[...i[24]||(i[24]=[Fe('<option value="" data-v-2e218e9d>Select platform...</option><option value="climate" data-v-2e218e9d>🌡️ Climate (AC, Heater, Heat Pump)</option><option value="media_player" data-v-2e218e9d>📺 Media Player (TV, Receiver)</option><option value="fan" data-v-2e218e9d>🌀 Fan</option><option value="light" data-v-2e218e9d>💡 Light (LED Strip, IR Light)</option>',5)])],544),[[Ie,p.value.platform]])]),e("div",Lu,[i[26]||(i[26]=e("label",null,"Manufacturer *",-1)),G(e("input",{"onUpdate:modelValue":i[1]||(i[1]=U=>p.value.manufacturer=U),type:"text",placeholder:"e.g., Daikin, LG, Samsung"},null,512),[[Oe,p.value.manufacturer]])]),e("div",Ou,[i[27]||(i[27]=e("label",null,"Model(s) *",-1)),G(e("input",{"onUpdate:modelValue":i[2]||(i[2]=U=>p.value.model=U),type:"text",placeholder:"e.g., FTXS35K, Multiple models"},null,512),[[Oe,p.value.model]]),i[28]||(i[28]=e("small",null,'Enter model number or "Multiple" if it works with many models',-1))])])):M("",!0),s.value===1?(l(),n("div",Au,[p.value.platform==="climate"?(l(),Pe(Zr,{key:0,modelValue:p.value.config,"onUpdate:modelValue":i[3]||(i[3]=U=>p.value.config=U)},null,8,["modelValue"])):p.value.platform==="media_player"?(l(),n("div",Eu,[i[36]||(i[36]=e("h3",null,"Media Player Configuration",-1)),i[37]||(i[37]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),x(" Configure the features your media player supports. You'll learn the IR commands in the next step. ")],-1)),e("div",Vu,[i[35]||(i[35]=e("h4",null,"Supported Features",-1)),e("div",Pu,[e("label",ju,[G(e("input",{type:"checkbox",value:"turn_on","onUpdate:modelValue":i[4]||(i[4]=U=>L.value=U)},null,512),[[fe,L.value]]),i[30]||(i[30]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),x(" Power On/Off ")],-1))]),e("label",Uu,[G(e("input",{type:"checkbox",value:"volume","onUpdate:modelValue":i[5]||(i[5]=U=>L.value=U)},null,512),[[fe,L.value]]),i[31]||(i[31]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-volume-high"}),x(" Volume Control ")],-1))]),e("label",Fu,[G(e("input",{type:"checkbox",value:"mute","onUpdate:modelValue":i[6]||(i[6]=U=>L.value=U)},null,512),[[fe,L.value]]),i[32]||(i[32]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-volume-mute"}),x(" Mute ")],-1))]),e("label",Nu,[G(e("input",{type:"checkbox",value:"source","onUpdate:modelValue":i[7]||(i[7]=U=>L.value=U)},null,512),[[fe,L.value]]),i[33]||(i[33]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-import"}),x(" Source Selection ")],-1))]),e("label",Bu,[G(e("input",{type:"checkbox",value:"channel","onUpdate:modelValue":i[8]||(i[8]=U=>L.value=U)},null,512),[[fe,L.value]]),i[34]||(i[34]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-numeric"}),x(" Channel Control ")],-1))])])])])):p.value.platform==="fan"?(l(),n("div",Hu,[i[44]||(i[44]=e("h3",null,"Fan Configuration",-1)),i[45]||(i[45]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),x(" Configure the features your fan supports. You'll learn the IR commands in the next step. ")],-1)),e("div",qu,[i[40]||(i[40]=e("h4",null,"Fan Speed Levels",-1)),e("div",zu,[i[39]||(i[39]=e("label",null,"Number of Speed Levels *",-1)),G(e("select",{"onUpdate:modelValue":i[9]||(i[9]=U=>J.value=U)},[...i[38]||(i[38]=[e("option",{value:1},"1 Speed",-1),e("option",{value:2},"2 Speeds",-1),e("option",{value:3},"3 Speeds (Low/Med/High)",-1),e("option",{value:4},"4 Speeds",-1),e("option",{value:5},"5 Speeds",-1),e("option",{value:6},"6 Speeds",-1)])],512),[[Ie,J.value,void 0,{number:!0}]])])]),e("div",Ju,[i[43]||(i[43]=e("h4",null,"Additional Features",-1)),e("div",Wu,[e("label",Ku,[G(e("input",{type:"checkbox",value:"oscillate","onUpdate:modelValue":i[10]||(i[10]=U=>Q.value=U)},null,512),[[fe,Q.value]]),i[41]||(i[41]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-sync"}),x(" Oscillation ")],-1))]),e("label",Xu,[G(e("input",{type:"checkbox",value:"direction","onUpdate:modelValue":i[11]||(i[11]=U=>Q.value=U)},null,512),[[fe,Q.value]]),i[42]||(i[42]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-rotate-3d-variant"}),x(" Direction (Forward/Reverse) ")],-1))])])])])):p.value.platform==="light"?(l(),n("div",Gu,[i[51]||(i[51]=e("h3",null,"Light Configuration",-1)),i[52]||(i[52]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),x(" Configure the features your light supports. You'll learn the IR commands in the next step. ")],-1)),e("div",Yu,[i[50]||(i[50]=e("h4",null,"Supported Features",-1)),e("div",Zu,[e("label",Qu,[G(e("input",{type:"checkbox",value:"turn_on","onUpdate:modelValue":i[12]||(i[12]=U=>H.value=U)},null,512),[[fe,H.value]]),i[46]||(i[46]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),x(" Power On/Off ")],-1))]),e("label",ec,[G(e("input",{type:"checkbox",value:"brightness","onUpdate:modelValue":i[13]||(i[13]=U=>H.value=U)},null,512),[[fe,H.value]]),i[47]||(i[47]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-brightness-6"}),x(" Brightness Control ")],-1))]),e("label",tc,[G(e("input",{type:"checkbox",value:"color_temp","onUpdate:modelValue":i[14]||(i[14]=U=>H.value=U)},null,512),[[fe,H.value]]),i[48]||(i[48]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-thermometer"}),x(" Color Temperature ")],-1))]),e("label",oc,[G(e("input",{type:"checkbox",value:"rgb","onUpdate:modelValue":i[15]||(i[15]=U=>H.value=U)},null,512),[[fe,H.value]]),i[49]||(i[49]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-palette"}),x(" RGB Color ")],-1))])])])])):M("",!0)])):M("",!0),s.value===2?(l(),n("div",lc,[be(Rd,{modelValue:p.value.commands,"onUpdate:modelValue":i[16]||(i[16]=U=>p.value.commands=U),platform:p.value.platform,config:p.value.config,broadlinkDevice:p.value.broadlinkDevice,"onUpdate:broadlinkDevice":i[17]||(i[17]=U=>p.value.broadlinkDevice=U),manufacturer:p.value.manufacturer,model:p.value.model,commandType:p.value.commandType,"onUpdate:commandType":i[18]||(i[18]=U=>p.value.commandType=U)},null,8,["modelValue","platform","config","broadlinkDevice","manufacturer","model","commandType"])])):M("",!0),s.value===3?(l(),n("div",nc,[be(ou,{profile:p.value,"json-data":he.value,"yaml-config":Te.value},null,8,["profile","json-data","yaml-config"])])):M("",!0)]),e("div",sc,[s.value>0?(l(),n("button",{key:0,onClick:ge,class:"btn-secondary"},[...i[53]||(i[53]=[e("i",{class:"mdi mdi-arrow-left"},null,-1),x(" Back ",-1)])])):M("",!0),i[57]||(i[57]=e("div",{class:"spacer"},null,-1)),e("button",{onClick:we,class:"btn-text"}," Cancel "),s.value<b.length-1?(l(),n("button",{key:1,onClick:P,class:"btn-primary",disabled:!de.value},[...i[54]||(i[54]=[x(" Next ",-1),e("i",{class:"mdi mdi-arrow-right"},null,-1)])],8,ac)):(l(),n("div",ic,[e("button",{onClick:W,class:"btn-primary",disabled:c.value},[i[55]||(i[55]=e("i",{class:"mdi mdi-cloud-upload"},null,-1)),x(" "+m(c.value?"Saving...":"Save to SmartIR"),1)],8,rc),e("button",{onClick:j,class:"btn-secondary",disabled:c.value},[...i[56]||(i[56]=[e("i",{class:"mdi mdi-download"},null,-1),x(" Download JSON ",-1)])],8,dc)]))])]),be($u,{show:S.value,platform:p.value.platform,warnings:$.value,"config-path":E.value,onClose:i[20]||(i[20]=U=>S.value=!1),onComplete:O},null,8,["show","platform","warnings","config-path"]),be(Ue,{isOpen:R.value,title:"Change Command Type?",message:"Changing the command type will clear all learned commands. Continue?",confirmText:"Continue",cancelText:"Cancel",dangerMode:!0,onConfirm:D,onCancel:u},null,8,["isOpen"]),be(Ue,{isOpen:q.value,title:"Close Profile Builder?",message:"Are you sure you want to close? Your progress will be lost.",confirmText:"Close",cancelText:"Keep Editing",dangerMode:!0,onConfirm:ye,onCancel:i[21]||(i[21]=U=>q.value=!1)},null,8,["isOpen"])])):M("",!0)}},cc=Ce(uc,[["__scopeId","data-v-2e218e9d"]]),mc={class:"dashboard"},vc={key:1,class:"welcome-banner"},pc={__name:"Dashboard",setup(t){const d=Be(),r=Me("smartirEnabled"),{isMobile:w}=Ye(),k=g(!1),s=g(!1),c=g(null),f=g(0),S=g(null),$=g(localStorage.getItem("welcome_banner_dismissed")==="true");function E(){$.value=!0,localStorage.setItem("welcome_banner_dismissed","true")}function C(){s.value=!1,c.value=null,f.value=0,k.value=!0}async function o({platform:V,profile:I,startStep:a}){f.value=Number.isInteger(a)?a:0;try{const b=await fetch(`api/smartir/platforms/${V}/profiles/${I.code}`);if(!b.ok)throw new Error("Failed to load profile");const p=await b.json();let L="";try{const J=await fetch(`api/smartir/config/get-device?platform=${V}&code=${I.code}`);J.ok?(L=(await J.json()).controller_data||"",console.log("✅ Found controller_data from YAML:",L)):console.warn("⚠️ No YAML entry found for this profile (this is OK for profiles not yet added to config)")}catch(J){console.warn("⚠️ Could not fetch controller_data from config:",J)}s.value=!0,c.value={platform:V,code:I.code,profile:{...p.profile,controller_data:L}},k.value=!0}catch(b){console.error("Error loading profile for edit:",b),d.error("Failed to load profile for editing")}}function R(){k.value=!1,s.value=!1,c.value=null}async function q(V){console.log("Profile saved:",V),R(),S.value&&S.value.loadAllProfiles&&(await S.value.loadAllProfiles(),console.log("✅ Profiles list refreshed"))}return(V,I)=>(l(),n("div",mc,[_e(r)?(l(),Pe(na,{key:0})):M("",!0),!_e(w)&&!$.value?(l(),n("div",vc,[e("button",{class:"dismiss-button",onClick:E,title:"Dismiss"},[...I[0]||(I[0]=[e("i",{class:"mdi mdi-close"},null,-1)])]),I[1]||(I[1]=Fe('<div class="banner-content" data-v-12185d74><div class="banner-icon" data-v-12185d74><i class="mdi mdi-rocket-launch" data-v-12185d74></i></div><div class="banner-text" data-v-12185d74><h2 data-v-12185d74>Welcome to Broadlink Manager v2!</h2><p data-v-12185d74>Manage your IR/RF devices with a modern Vue 3 interface</p></div></div><div class="status-badges" data-v-12185d74><span class="badge success" data-v-12185d74><i class="mdi mdi-check-circle" data-v-12185d74></i> Vue 3 Ready </span><span class="badge warning" data-v-12185d74><i class="mdi mdi-beta" data-v-12185d74></i> Beta </span></div>',2))])):M("",!0),be(Zs),_e(r)?(l(),Pe(or,{key:2,ref_key:"smartirStatusCard",ref:S,onCreateProfile:C,onEditProfile:o},null,512)):M("",!0),be(cc,{show:k.value,editMode:s.value,editData:c.value,startStep:f.value,onClose:R,onSave:q},null,8,["show","editMode","editData","startStep"])]))}},fc=Ce(pc,[["__scopeId","data-v-12185d74"]]),gc={class:"toast-container"},yc={class:"toast-content"},bc={key:0,class:"toast-title"},hc={class:"toast-message"},kc={key:1,class:"toast-description"},wc=["onClick","title"],$c={__name:"Toast",setup(t,{expose:d}){const r=g([]);let w=0;function k(f){const S={success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information"};return S[f]||S.info}function s({message:f,title:S,description:$,type:E="info",duration:C=5e3}){const o=w++,R={id:o,message:f,title:S,description:$,type:E};return r.value.push(R),C>0&&setTimeout(()=>{c(o)},C),o}function c(f){const S=r.value.findIndex($=>$.id===f);S>-1&&r.value.splice(S,1)}return d({addToast:s,removeToast:c,show:s,success:(f,S)=>s({message:f,title:S,type:"success"}),error:(f,S)=>s({message:f,title:S,type:"error",duration:0}),warning:(f,S)=>s({message:f,title:S,type:"warning",duration:0}),info:(f,S)=>s({message:f,title:S,type:"info"})}),(f,S)=>(l(),Pe(lt,{to:"body"},[e("div",gc,[be(ct,{name:"toast"},{default:Ge(()=>[(l(!0),n(me,null,$e(r.value,$=>(l(),n("div",{key:$.id,class:Z(["toast",[`toast-${$.type}`,{"toast-persistent":$.type==="error"||$.type==="warning"}]])},[e("i",{class:Z(["mdi",k($.type)])},null,2),e("div",yc,[$.title?(l(),n("div",bc,m($.title),1)):M("",!0),e("div",hc,m($.message),1),$.description?(l(),n("div",kc,m($.description),1)):M("",!0)]),e("button",{onClick:E=>c($.id),class:Z(["toast-close",{"toast-close-prominent":$.type==="error"||$.type==="warning"}]),title:$.type==="error"||$.type==="warning"?"Click to dismiss":"Close"},[...S[0]||(S[0]=[e("i",{class:"mdi mdi-close"},null,-1)])],10,wc)],2))),128))]),_:1})])]))}},Cc=Ce($c,[["__scopeId","data-v-3948c088"]]),_c="0.3.0-alpha.2",Sc={version:_c},Ic={id:"app",class:"app-container"},Dc={class:"app-header"},Tc={class:"header-content"},xc={class:"header-right"},Mc=["title"],Rc={class:"settings-menu-container"},Lc={key:0,class:"settings-menu"},Oc=["title"],Ac={class:"toggle-content"},Ec={key:0,class:"not-installed-label"},Vc={key:0,href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"menu-item menu-link menu-subitem"},Pc=["disabled"],jc=["disabled"],Uc=["disabled"],Fc={class:"app-main"},Nc={class:"app-footer"},Bc={__name:"App",setup(t){const d=g(null),r=Sc.version,w=g("light"),k=g(null),s=g(!1),c=g(!1),f=g(!1),S=g(localStorage.getItem("smartir_enabled")!=="false"),$=X(()=>{var p;return((p=k.value)==null?void 0:p.installed)||!1}),E=X(()=>({light:"mdi mdi-weather-sunny",medium:"mdi mdi-weather-partly-cloudy",dark:"mdi mdi-weather-night"})[w.value]),C=X(()=>({light:"Switch to Medium Theme",medium:"Switch to Dark Theme",dark:"Switch to Light Theme"})[w.value]),o=()=>{const p=["light","medium","dark"],J=(p.indexOf(w.value)+1)%p.length;w.value=p[J],document.body.classList.remove("medium-mode","dark-mode"),w.value==="medium"?document.body.classList.add("medium-mode"):w.value==="dark"&&document.body.classList.add("dark-mode"),localStorage.setItem("theme",w.value)},R=async()=>{try{const p=await st.getStatus();k.value=p,p.installed?console.log("✅ SmartIR detected:",p.version):console.log("ℹ️ SmartIR not detected")}catch(p){console.error("Error checking SmartIR:",p),k.value={installed:!1,error:p.message}}},q=async()=>{var p,L,J;c.value=!0;try{const H=(await ne.get("/api/diagnostics/markdown")).data.markdown;if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(H),(p=d.value)==null||p.success("Diagnostic summary copied to clipboard!");else{const te=document.createElement("textarea");te.value=H,te.style.position="fixed",te.style.left="-999999px",te.style.top="-999999px",document.body.appendChild(te),te.focus(),te.select();try{if(document.execCommand("copy"))(L=d.value)==null||L.success("Diagnostic summary copied to clipboard!");else throw new Error("execCommand failed")}finally{document.body.removeChild(te)}}s.value=!1}catch(Q){console.error("Error copying diagnostics:",Q),(J=d.value)==null||J.error("Failed to copy diagnostics: "+Q.message)}finally{c.value=!1}},V=async()=>{var p,L;c.value=!0;try{const J=await ne.get("/api/diagnostics/download",{responseType:"blob"}),Q=window.URL.createObjectURL(new Blob([J.data])),H=document.createElement("a");H.href=Q;const te=J.headers["content-disposition"];let A="broadlink_manager_diagnostics.zip";if(te){const N=te.match(/filename="?(.+)"?/);N&&(A=N[1])}H.setAttribute("download",A),document.body.appendChild(H),H.click(),H.remove(),window.URL.revokeObjectURL(Q),(p=d.value)==null||p.success("Diagnostic bundle downloaded!"),s.value=!1}catch(J){console.error("Error downloading diagnostics:",J),(L=d.value)==null||L.error("Failed to download diagnostics")}finally{c.value=!1}},I=()=>{$.value&&(S.value=!S.value,localStorage.setItem("smartir_enabled",S.value.toString()),window.location.reload())},a=async()=>{var p,L,J;f.value=!0;try{const Q=await ne.post("/api/smartir/refresh-index");Q.data.success?(p=d.value)==null||p.success(`Updated to v${Q.data.version} (${Q.data.total_devices} devices)`,"✅ Index Updated"):(L=d.value)==null||L.error(Q.data.error||"Unknown error","❌ Update Failed")}catch(Q){console.error("Error updating SmartIR index:",Q),(J=d.value)==null||J.error("Failed to update device index","❌ Update Error")}finally{f.value=!1,s.value=!1}},b=p=>{p.target.closest(".settings-menu-container")||(s.value=!1)};return Ae(async()=>{const p=localStorage.getItem("theme");p&&["light","medium","dark"].includes(p)?(w.value=p,p==="medium"?document.body.classList.add("medium-mode"):p==="dark"&&document.body.classList.add("dark-mode")):localStorage.getItem("darkMode")==="true"&&(w.value="dark",document.body.classList.add("dark-mode"),localStorage.setItem("theme","dark")),await R();const L=et();L&&d.value&&(L.appContext.config.globalProperties.$toast=d.value),document.addEventListener("click",b)}),Xe(()=>{document.removeEventListener("click",b)}),qe("smartirStatus",k),qe("smartirEnabled",S),qe("refreshSmartIR",R),qe("toast",d),(p,L)=>(l(),n("div",Ic,[e("header",Dc,[e("div",Tc,[L[13]||(L[13]=e("div",{class:"header-left"},[e("i",{class:"mdi mdi-remote"}),e("h1",null,"Broadlink Manager v2"),e("span",{class:"beta-badge"},"BETA")],-1)),e("div",xc,[e("button",{onClick:o,class:"icon-button",title:C.value},[e("i",{class:Z(E.value)},null,2)],8,Mc),e("div",Rc,[e("button",{onClick:L[0]||(L[0]=J=>s.value=!s.value),class:"icon-button",title:"Settings"},[...L[2]||(L[2]=[e("i",{class:"mdi mdi-cog"},null,-1)])]),s.value?(l(),n("div",Lc,[L[9]||(L[9]=e("div",{class:"menu-section-title"},"Integration Settings",-1)),e("div",{class:Z(["menu-item toggle-item",{disabled:!$.value}]),onClick:L[1]||(L[1]=J=>$.value?I():null),title:$.value?"":"SmartIR is not installed"},[e("div",Ac,[L[3]||(L[3]=e("i",{class:"mdi mdi-air-conditioner"},null,-1)),L[4]||(L[4]=e("span",null,"SmartIR Integration",-1)),$.value?M("",!0):(l(),n("span",Ec,"(Not Installed)"))]),e("div",{class:Z(["toggle-switch",{active:S.value&&$.value,disabled:!$.value}])},[...L[5]||(L[5]=[e("div",{class:"toggle-slider"},null,-1)])],2)],10,Oc),S.value?(l(),n("a",Vc,[...L[6]||(L[6]=[e("i",{class:"mdi mdi-github"},null,-1),e("span",null,"SmartIR on GitHub",-1)])])):M("",!0),S.value?(l(),n("button",{key:1,onClick:a,class:"menu-item menu-subitem",disabled:f.value},[e("i",{class:Z(["mdi",f.value?"mdi-loading mdi-spin":"mdi-refresh"])},null,2),e("span",null,m(f.value?"Updating...":"Update Device Index"),1)],8,Pc)):M("",!0),L[10]||(L[10]=e("div",{class:"menu-divider"},null,-1)),L[11]||(L[11]=e("div",{class:"menu-section-title"},"Diagnostics",-1)),e("button",{onClick:q,class:"menu-item",disabled:c.value},[...L[7]||(L[7]=[e("i",{class:"mdi mdi-content-copy"},null,-1),e("span",null,"Copy Diagnostics",-1)])],8,jc),e("button",{onClick:V,class:"menu-item",disabled:c.value},[...L[8]||(L[8]=[e("i",{class:"mdi mdi-download"},null,-1),e("span",null,"Download Diagnostics",-1)])],8,Uc),L[12]||(L[12]=Fe('<div class="menu-divider" data-v-4bc2c39f></div><div class="menu-section-title" data-v-4bc2c39f>Help &amp; Support</div><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2#readme" target="_blank" class="menu-item menu-link" data-v-4bc2c39f><i class="mdi mdi-book-open-variant" data-v-4bc2c39f></i><span data-v-4bc2c39f>Documentation</span></a><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2/issues" target="_blank" class="menu-item menu-link" data-v-4bc2c39f><i class="mdi mdi-bug" data-v-4bc2c39f></i><span data-v-4bc2c39f>Report Issue</span></a><div class="menu-divider" data-v-4bc2c39f></div><div class="menu-section-title" data-v-4bc2c39f>Community</div><a href="https://community.home-assistant.io/t/broadlink-manager-modern-web-interface-for-broadlink-devices/938473" target="_blank" class="menu-item menu-link" data-v-4bc2c39f><i class="mdi mdi-forum" data-v-4bc2c39f></i><span data-v-4bc2c39f>HA Forum Discussion</span></a><a href="https://www.reddit.com/r/homeassistant/comments/1o1q3kf/release_broadlink_manager_addon_a_modern_web_ui/" target="_blank" class="menu-item menu-link" data-v-4bc2c39f><i class="mdi mdi-reddit" data-v-4bc2c39f></i><span data-v-4bc2c39f>Reddit Discussion</span></a><div class="menu-divider" data-v-4bc2c39f></div><div class="menu-section-title" data-v-4bc2c39f>Project</div><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2" target="_blank" class="menu-item menu-link" data-v-4bc2c39f><i class="mdi mdi-github" data-v-4bc2c39f></i><span data-v-4bc2c39f>GitHub Repository</span></a><a href="https://ko-fi.com/tonyperkins" target="_blank" class="menu-item menu-link menu-item-sponsor" data-v-4bc2c39f><i class="mdi mdi-coffee" data-v-4bc2c39f></i><span data-v-4bc2c39f>Support on Ko-fi</span></a>',12))])):M("",!0)])])])]),e("main",Fc,[be(fc)]),e("footer",Nc,[e("p",null,"Broadlink Manager v"+m(_e(r))+" | Built with Vue "+m(mt),1)]),be(Cc,{ref_key:"toastRef",ref:d},null,512)]))}},Hc=Ce(Bc,[["__scopeId","data-v-4bc2c39f"]]),at=vt(Hc),qc=pt();at.use(qc);at.mount("#app");
