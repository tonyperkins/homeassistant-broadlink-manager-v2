import{g as Pe,a as He,d as ze,c as N,r as k,o as be,b as r,e as n,f as e,h as O,n as Z,t as f,i as I,w as ie,j,v as pe,F as ne,k as de,l as ae,m as Je,p as le,q as Le,s as Oe,T as je,u as fe,x as we,y as Ie,z as Q,A as Fe,B as Ae,C as De,D as Ue,E as $e,G as Ne,H as We,I as Xe,J as Me,K as Ge,L as Ke}from"./vendor-n_AjE3YW.js";(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))$(u);new MutationObserver(u=>{for(const g of u)if(g.type==="childList")for(const b of g.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&$(b)}).observe(document,{childList:!0,subtree:!0});function a(u){const g={};return u.integrity&&(g.integrity=u.integrity),u.referrerPolicy&&(g.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?g.credentials="include":u.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function $(u){if(u.ep)return;u.ep=!0;const g=a(u);fetch(u.href,g)}})();function Te(){const s=Pe(),p=s==null?void 0:s.appContext.config.globalProperties.$toast;return p||(console.warn("Toast not available"),{success:a=>console.log("Success:",a),error:a=>console.error("Error:",a),warning:a=>console.warn("Warning:",a),info:a=>console.info("Info:",a)})}const Ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAHBUlEQVR4nOxZC1BTVxo+9+aNZI2LNsgjWR4hgoIiRVDBslKnIKPbx1jqTrtYoakat1a6dNsdd7t1X8XHyAbEhdUu1u2mXdbasqJbtsaMIqBBECiPBmqEICEBEx4xJLlJ7s6lw6rJDeQ2FzLM+M1kBs7/3+/83zn/Oee/51JRFAXzGbCvA/AWjwX4GvNeANWXnXffHQ4+K6/dYbHeD+IFhjRkb1wn9WPQbEQ4IF/tQlXX2p5+/8OyczY74j/VxuMG3Sh/Oz9jaQDb4CmPT1LIbLXBfzrz0cmHg8fQpx1Yc1Ra+TsiXD4R0PqtRmAyj/LxbJeaujKIcPlEAINOM7vLXBaTZibCRWgRq3WGJZWX63aoNDpB8BJOX/bGlIqwpUv6iXBgWBHG7eUF8urUWvU6Z9sLGxI/IsLl8SJu6u4XigqPXkVspiVTbTQqU1/6Vn7ammh+G5FOMZyqludIKqUVU/9jcaSuTCo/unfHbiad4iBdwMu/P1bV1tO1xbk9NDC0/vwHB1xGcjqYLAh16zsHW3R6XXTu1mfFdAqMrIoSKNbGhLcQ4QGeppDJ7ACtPcqNEI6tT9O3Vqm+tygqNMDjrU9Sef6tIYM2JjUuuXzfC5knCEXsBI8WMZUCAxiCrfhWyMZkMNzYXNHVpwmXXqp5j0Hz0/1m57a3PQ8VHx4JoNMASIl9shLPFsB5ooO7iDXhCY/dAcCvT/79LwC1s/K2bDnAXcQeJRqwMzzeRt/bua0gLChcDsCDNQNBkEU/qot7o6j0kzETQpuJ40ZnT6xSrUoNWhyseHVz2ikv4n4QA5FSArE5IFlTZ0r3XU1MWODib6NCl3a9dkhSYxgbjo4XLq8sL9j7Ip36YEwMRjMNQazMhf7+RgYNnuyo7bY6ArFaWKuXRX495wLwoLk39sO9RaVnM5OTP8zLSjtjsljpp6ovi6pqr706eE8XBwGUSqEy9Guihf/92TMZhetjI5rJCHwKpBRzZqsNYtKp6KD+Pvv1w5ILdzR3UvD8HA4YefOl7N25JKUPIKuUwIJH7A5of/GJf7oLfrIz2EH786fSss+uKFzOk+8L0mqh6rpbmR0q5YyFGAQBSuHHlcUWxEaZyXfMhFD0Rgt9Oh/SBMiam58HAO+oc4XZMsK/1taT6M6uHjJw8w6VSNfvemM8TbzPlFlwsP5KyzfJeL6kCejXDgo894aASqOZ9O/uHwzq6B3ijhitkzOC7XS7j0g+V3S0vQTDDhYEoZSBobvJ+yXFNZ29gy4lOGmvlDBMIfQqSKV8539EWvXHhvbGHBSFrAwGW+vvxzLoR7RxzrNpsyPs0xcv7/lg1/ZfPtKvuw7MVhulUakWdvRq+XY3tWFT90Bk+52BCOzvyOBgjytSFKAgms+b9F/2o+BbKwUrvgjhhjSjKLAPG4YE7lJxfEIf5dyGOwMXrren/eF0RYXRNMrHDt4QbmjDEbHop9F8rqpddZd3sV6R/aWiabtWr41PW534V8m+PFHW+qSPL9TX7oM8WAaBi4IbE4S8yYNs/7asIgBA0ZStRqFM/MXxIzcgHBEBP+C6DJKLgJvK3uXvniitBsDmNzkSEAD9uv5k0aFjXy1gMQ0DQ5p4CAIwNuXLwyL/ExcpqMWeS42NUmxKXFf8VWPdz6cLnkqhGd/Pe+U1Cow/+ekJUYr4qJgvbik7f/Jw+0J/tjpvS3qxs7/LQZZfcrrkUmOdGI/cgUKIkB8pz0xK+CQjKf6z4MWckYftZqsderfsTInsZt0evDRgMRYMHhaLnk+NW1Y/nchxk5lZ+I/Pf/vl9RvbLYiVlSBcJv/VK9sKBCHc3hkF7D12/NzVltZn8YhzNj/3ev6LGeXTdQ6+uzLZ+C+5XNza05Nsd1gXcNgBvekJK/+du3lTUSiXMzzT80TgkkK8wJAGgCMAE5ooFFz3hHTr+lgZ9iMryOngkoi5WZuOc9hPtDu3r4198nTqygjCr3wYmrvVkSerZXljJoT0m0DcYm5g2Mg5WV39zrVWZZofkzaRnhB/bufm9FI/JpXQXj8F8bHyitqWxhzJmwUJT60SNJER+P+BCZjt34lzNbvickRoWVWNmGzuObnYWhER3oAdX41dPbj1jDeYEwGrInltKKCNtatub6hRfJOEnfJkcc+JgE9ltS/DkINuNI3xCo4fbXgm/0CnouvOcjK4Z/16/ZKia+3+kqIrEIQ+sgNx2Jzb5wsPxrD9GBZv+Gd9BqSXr4icg8cwMj4SLmv6+mlv+WddgGlilOPOZkEmFnrLP+sCVgtXyPHaHShkiw0XXPWWf9YF5Gb9uGzp4sCbj7ai4LkNTx2O5nPV3vLPyTeye6P32X+7KNujVKtSYJg+viEu/mx2etJZCgnD57OPfGRh3n8nfizA15j3Av4XAAD//5k1S2w3zfwVAAAAAElFTkSuQmCC",se=He.create({baseURL:"./",timeout:3e4,headers:{"Content-Type":"application/json"}});se.interceptors.request.use(s=>s,s=>Promise.reject(s));se.interceptors.response.use(s=>s,s=>(console.error("API Error:",s),s.response?console.error("Response error:",s.response.data):s.request?console.error("No response received"):console.error("Request setup error:",s.message),Promise.reject(s)));const Ye=ze("devices",{state:()=>({devices:[],loading:!1,error:null,selectedDevice:null}),getters:{deviceById:s=>p=>s.devices.find(a=>a.id===p),devicesByType:s=>p=>s.devices.filter(a=>a.entity_type===p),deviceCount:s=>s.devices.length,hasDevices:s=>s.devices.length>0},actions:{async loadDevices(){this.loading=!0,this.error=null;try{const s=await se.get("/api/devices/managed");this.devices=s.data.devices||[],console.log("ğŸ“¥ Loaded devices:",this.devices),this.devices.forEach(p=>{console.log(`ğŸ“¥ Device "${p.name}":`,{id:p.id,device:p.device,commands:p.commands,commandCount:p.commands?Object.keys(p.commands).length:0})})}catch(s){this.error=s.message,console.error("Error loading devices:",s)}finally{this.loading=!1}},async createDevice(s){this.loading=!0,this.error=null;try{console.log("ğŸª Store: Creating device with data:",s),console.log("ğŸª Store: Device commands being sent:",s.commands);const p={device_name:s.name,device:s.device,area_id:s.area||"",area_name:s.area||"",entity_type:s.entity_type,icon:s.icon,broadlink_entity:s.broadlink_entity,device_type:s.device_type||"broadlink",commands:s.commands||{}};s.device_type==="smartir"&&s.smartir_config&&(p.smartir_config=s.smartir_config),console.log("ğŸª Store: Transformed data for backend:",p);const a=await se.post("/api/devices/managed",p);return console.log("ğŸª Store: Create response:",a.data),await this.loadDevices(),a.data}catch(p){throw console.error("Error creating device:",p),p}finally{this.loading=!1}},async updateDevice(s,p){this.loading=!0,this.error=null;try{const a=await se.put(`/api/devices/managed/${s}`,p);return await this.loadDevices(),a.data}catch(a){throw console.error("Error updating device:",a),a}finally{this.loading=!1}},async deleteDevice(s,p=!1){this.loading=!0,this.error=null;try{await se.delete(`/api/devices/managed/${s}`,{data:{delete_commands:p}}),this.devices=this.devices.filter(a=>a.id!==s)}catch(a){throw this.error=a.message,console.error("Error deleting device:",a),a}finally{this.loading=!1}},selectDevice(s){this.selectedDevice=s},clearSelection(){this.selectedDevice=null},clearError(){this.error=null}}}),Ze=""+new URL("broadlink-logo-BDjImjRY.png",import.meta.url).href,ue=(s,p)=>{const a=s.__vccOpts||s;for(const[$,u]of p)a[$]=u;return a},Qe={class:"device-header"},et={class:"device-icon"},tt={class:"device-info"},ot={class:"device-labels"},lt={class:"device-type"},st=["src","alt","title"],nt={class:"device-body"},at={class:"device-stats"},it={class:"stat"},rt={class:"stat"},dt={class:"device-meta"},ut={class:"device-id"},ct={key:0,class:"storage-name"},mt={key:1,class:"broadlink-entity"},vt={key:2,class:"controller-device"},pt={class:"device-actions"},ft=["disabled"],gt=["disabled"],yt=["disabled"],bt={key:0,class:"disabled-overlay"},ht={__name:"DeviceCard",props:{device:{type:Object,required:!0}},emits:["edit","delete","learn"],setup(s){const p=s,a=N(()=>localStorage.getItem("smartir_simulate_not_installed")==="true"),$=N(()=>p.device.device_type==="smartir"&&a.value),u=k([]),g=k(null),b=N(()=>p.device.icon?p.device.icon.replace("mdi:",""):{light:"lightbulb",fan:"fan",switch:"light-switch",media_player:"television",cover:"window-shutter"}[p.device.entity_type]||"devices"),o=N(()=>({light:"Light",fan:"Fan",switch:"Switch",media_player:"Media Player",cover:"Cover"})[p.device.entity_type]||p.device.entity_type),d=N(()=>(p.device.device_type||"broadlink")==="smartir"?"SmartIR":"Broadlink"),M=N(()=>(p.device.device_type||"broadlink")==="smartir"?Ve:Ze),L=N(()=>(p.device.device_type||"broadlink")==="smartir"?g.value!==null?g.value:0:Object.keys(p.device.commands||{}).length),i=h=>{if(!h)return"";const w=u.value.find(H=>H.entity_id===h);return w&&w.name||h},l=N(()=>{if(!p.device.device)return!1;const h=p.device.id.includes(".")?p.device.id.split(".")[1]:p.device.id;return p.device.device!==h}),R=N(()=>{if(!p.device.broadlink_entity)return"";const h=u.value.find(w=>w.entity_id===p.device.broadlink_entity);return h&&h.name||p.device.broadlink_entity}),P=async()=>{if(!(!p.device.device_code||!p.device.entity_type))try{const h=await se.get("/api/smartir/codes/code",{params:{entity_type:p.device.entity_type,code_id:p.device.device_code}});if(h.data.success&&h.data.code){const w=h.data.code;w.commands&&(g.value=Object.keys(w.commands).length)}}catch(h){console.error("Error fetching SmartIR command count:",h)}};return be(async()=>{try{const w=await se.get("/api/broadlink/devices");u.value=w.data.devices||[]}catch(w){console.error("Error loading Broadlink devices:",w)}(p.device.device_type||"broadlink")==="smartir"&&await P()}),(h,w)=>(n(),r("div",{class:Z(["device-card",{disabled:$.value}])},[e("div",Qe,[e("div",et,[e("i",{class:Z(`mdi mdi-${b.value}`)},null,2)]),e("div",tt,[e("h3",null,f(s.device.name),1),e("div",ot,[e("span",lt,f(o.value),1)])]),e("img",{src:M.value,alt:d.value,title:d.value,class:"device-source-logo"},null,8,st)]),e("div",nt,[e("div",at,[e("div",it,[w[3]||(w[3]=e("i",{class:"mdi mdi-remote"},null,-1)),e("span",null,f(L.value)+" commands",1)]),e("div",rt,[w[4]||(w[4]=e("i",{class:"mdi mdi-map-marker"},null,-1)),e("span",null,f(s.device.area||"No area"),1)])]),e("div",dt,[e("span",ut,[w[5]||(w[5]=e("i",{class:"mdi mdi-identifier"},null,-1)),I(" "+f(s.device.id),1)]),l.value?(n(),r("span",ct,[w[6]||(w[6]=e("i",{class:"mdi mdi-code-tags"},null,-1)),I(" "+f(s.device.device),1)])):O("",!0),s.device.broadlink_entity?(n(),r("span",mt,[w[7]||(w[7]=e("i",{class:"mdi mdi-access-point"},null,-1)),I(" "+f(R.value),1)])):O("",!0),s.device.controller_device?(n(),r("span",vt,[w[8]||(w[8]=e("i",{class:"mdi mdi-access-point"},null,-1)),I(" Controller: "+f(i(s.device.controller_device)),1)])):O("",!0)])]),e("div",pt,[e("button",{onClick:w[0]||(w[0]=H=>!$.value&&h.$emit("learn",s.device)),class:"action-btn",title:"Manage Commands",disabled:$.value},[...w[9]||(w[9]=[e("i",{class:"mdi mdi-remote-tv"},null,-1),e("span",null,"Commands",-1)])],8,ft),e("button",{onClick:w[1]||(w[1]=H=>!$.value&&h.$emit("edit",s.device)),class:"action-btn",title:"Edit",disabled:$.value},[...w[10]||(w[10]=[e("i",{class:"mdi mdi-pencil"},null,-1)])],8,gt),e("button",{onClick:w[2]||(w[2]=H=>!$.value&&h.$emit("delete",s.device)),class:"action-btn danger",title:"Delete",disabled:$.value},[...w[11]||(w[11]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,yt)]),$.value?(n(),r("div",bt,[...w[12]||(w[12]=[e("div",{class:"disabled-message"},[e("i",{class:"mdi mdi-eye-off"}),e("span",null,"SmartIR Not Installed")],-1)])])):O("",!0)],2))}},kt=ue(ht,[["__scopeId","data-v-d32f51f8"]]),wt={class:"icon-picker"},$t={class:"icon-input-wrapper"},Ct=["id","placeholder"],_t={key:0,class:"icon-preview"},St={key:0,class:"icon-dropdown"},It={class:"icon-grid"},xt=["onMousedown","title"],Dt={__name:"IconPicker",props:{modelValue:{type:String,default:""},inputId:{type:String,default:"icon-input"},placeholder:{type:String,default:"e.g., mdi:television"}},emits:["update:modelValue"],setup(s,{emit:p}){const a=s,$=p,u=k(a.modelValue),g=k(!1),b=["television","speaker","radio","music","video","movie","play","pause","stop","skip-next","skip-previous","volume-high","volume-medium","volume-low","volume-off","remote","remote-tv","cast","chromecast","spotify","netflix","youtube","lightbulb","lightbulb-on","lightbulb-off","lamp","floor-lamp","ceiling-light","light-switch","led-strip","led-strip-variant","wall-sconce","chandelier","spotlight","track-light","vanity-light","desk-lamp","fan","ceiling-fan","air-conditioner","thermometer","thermostat","heat-wave","snowflake","fire","radiator","water-boiler","hvac","blinds","blinds-open","window-shutter","window-shutter-open","curtains","curtains-closed","roller-shade","roller-shade-closed","garage","garage-open","gate","door","door-open","window-open","window-closed","washing-machine","tumble-dryer","dishwasher","refrigerator","stove","microwave","oven","toaster","kettle","coffee","coffee-maker","blender","robot-vacuum","robot-vacuum-variant","vacuum","broom","spray-bottle","lock","lock-open","lock-smart","key","shield","shield-check","alarm-light","bell","doorbell","camera","cctv","motion-sensor","smoke-detector","fire-extinguisher","water-alert","gas-cylinder","sofa","bed","bed-double","desk","chair","table","bookshelf","home","home-outline","home-assistant","floor-plan","room","weather-sunny","weather-night","weather-cloudy","weather-rainy","weather-snowy","weather-lightning","weather-windy","weather-fog","weather-partly-cloudy","umbrella","water","water-percent","phone","cellphone","tablet","laptop","desktop-tower","monitor","keyboard","mouse","printer","router","router-wireless","access-point","wifi","bluetooth","usb","hdmi-port","ethernet","power","power-plug","power-socket","battery","battery-charging","lightning-bolt","flash","solar-panel","solar-power","leaf","tree","flower","sprout","grass","watering-can","shovel","fence","pool","hot-tub","silverware","silverware-fork-knife","food","food-apple","glass-wine","glass-cocktail","bottle-wine","pot","pot-steam","shower","shower-head","bathtub","toilet","sink","faucet","hand-wash","car","car-side","garage-variant","tools","hammer","wrench","screwdriver","toolbox","ladder","heart","heart-pulse","run","walk","bike","dumbbell","yoga","scale-bathroom","thermometer-lines","clock","clock-outline","timer","alarm","calendar","calendar-today","calendar-clock","history","bell-ring","bell-alert","alert","alert-circle","information","help-circle","check","check-circle","close-circle","minus-circle","plus-circle","arrow-up","arrow-down","arrow-left","arrow-right","chevron-up","chevron-down","menu","dots-vertical","dots-horizontal","cog","tune","circle","square","triangle","hexagon","star","star-outline","heart-outline","plus","minus","close","check-bold","eye","eye-off","account","account-group","baby","dog","cat","paw","gift","balloon","party-popper","candle","book","book-open","newspaper","email","message","phone-classic"];ie(()=>a.modelValue,i=>{u.value=i});const o=N(()=>{if(!u.value)return b.slice(0,50);const i=u.value.toLowerCase().replace("mdi:","");return b.filter(l=>l.toLowerCase().includes(i)).slice(0,50)}),d=()=>{g.value=!0,$("update:modelValue",u.value)},M=()=>{setTimeout(()=>{g.value=!1},200)},L=i=>{u.value=`mdi:${i}`,$("update:modelValue",u.value),g.value=!1};return(i,l)=>(n(),r("div",wt,[e("div",$t,[j(e("input",{id:s.inputId,"onUpdate:modelValue":l[0]||(l[0]=R=>u.value=R),type:"text",placeholder:s.placeholder,onInput:d,onFocus:l[1]||(l[1]=R=>g.value=!0),onBlur:M},null,40,Ct),[[pe,u.value]]),u.value?(n(),r("div",_t,[e("i",{class:Z(`mdi mdi-${u.value.replace("mdi:","")}`)},null,2)])):O("",!0)]),g.value&&o.value.length>0?(n(),r("div",St,[e("div",It,[(n(!0),r(ne,null,de(o.value,R=>(n(),r("div",{key:R,class:"icon-option",onMousedown:ae(P=>L(R),["prevent"]),title:R},[e("i",{class:Z(`mdi mdi-${R}`)},null,2),e("span",null,f(R),1)],40,xt))),128))])])):O("",!0)]))}},Tt=ue(Dt,[["__scopeId","data-v-a64f5011"]]),Rt={key:0,class:"dropdown-label"},Lt={key:0,class:"required"},Mt=["placeholder","disabled","onKeydown"],Ot={class:"dropdown-icons"},Vt={key:0,class:"mdi mdi-loading mdi-spin"},At={key:2,class:"mdi mdi-chevron-down"},Et={key:1,class:"error-message"},Pt={key:2,class:"hint-message"},jt={key:0,class:"dropdown-menu"},Ft=["onMousedown","onMouseenter"],Ut={class:"option-content"},Nt={class:"option-label"},Bt={key:0,class:"option-description"},qt={key:0,class:"mdi mdi-check selected-icon"},Ht={key:3,class:"dropdown-menu"},zt={__name:"SearchableDropdown",props:{modelValue:{type:[String,Number,Object],default:null},options:{type:Array,required:!0,default:()=>[]},label:{type:String,default:""},placeholder:{type:String,default:"Search..."},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},error:{type:String,default:""},hint:{type:String,default:""},optionLabel:{type:String,default:"label"},optionValue:{type:String,default:"value"},optionDescription:{type:String,default:"description"},filterMethod:{type:Function,default:null}},emits:["update:modelValue","change","search"],setup(s,{emit:p}){const a=s,$=p,u=k(null),g=k(null),b=k(""),o=k(!1),d=k(0),M=k(!1),L=m=>typeof m=="string"||typeof m=="number"?m:m[a.optionLabel]||m.label||m.name||String(m),i=m=>typeof m=="string"||typeof m=="number"?m:m[a.optionValue]||m.value||m.id||m,l=m=>typeof m=="string"||typeof m=="number"?"":m[a.optionDescription]||m.description||"",R=m=>{const C=i(m);return typeof a.modelValue=="object"?i(a.modelValue)===C:a.modelValue===C},P=N(()=>{if(!b.value)return a.options;if(a.filterMethod)return a.options.filter(C=>a.filterMethod(C,b.value));const m=b.value.toLowerCase();return a.options.filter(C=>{const x=L(C).toLowerCase(),y=l(C).toLowerCase();return x.includes(m)||y.includes(m)})}),h=N(()=>{if(!a.modelValue)return"";const m=a.options.find(C=>{const x=i(C);return typeof a.modelValue=="object"?x===i(a.modelValue):x===a.modelValue});return m?L(m):""});ie(()=>a.modelValue,m=>{M.value||(b.value=h.value)}),ie(()=>a.options,()=>{!M.value&&a.modelValue&&(b.value=h.value)},{deep:!0}),ie(b,m=>{$("search",m),d.value=0}),be(()=>{b.value=h.value});const w=()=>{var m;M.value=!0,o.value=!0,(m=g.value)==null||m.select()},H=()=>{M.value=!1,setTimeout(()=>{o.value=!1,a.modelValue?b.value=h.value:b.value=""},200)},G=()=>{var m;o.value=!1,(m=g.value)==null||m.blur()},S=m=>{const C=i(m);$("update:modelValue",C),$("change",C,m),b.value=L(m),G()},z=()=>{var m;$("update:modelValue",null),$("change",null,null),b.value="",(m=g.value)==null||m.focus()},K=()=>{if(!o.value){o.value=!0;return}d.value<P.value.length-1&&d.value++},oe=()=>{d.value>0&&d.value--},Y=()=>{P.value.length>0&&d.value>=0&&S(P.value[d.value])},E=m=>{u.value&&!u.value.contains(m.target)&&(o.value=!1,a.modelValue?b.value=h.value:b.value="")};return be(()=>{document.addEventListener("click",E)}),Je(()=>{document.removeEventListener("click",E)}),(m,C)=>(n(),r("div",{class:"searchable-dropdown",ref_key:"dropdownRef",ref:u},[s.label?(n(),r("label",Rt,[I(f(s.label)+" ",1),s.required?(n(),r("span",Lt,"*")):O("",!0)])):O("",!0),e("div",{class:Z(["dropdown-input-wrapper",{"has-error":s.error,disabled:s.disabled}])},[j(e("input",{ref_key:"inputRef",ref:g,type:"text","onUpdate:modelValue":C[0]||(C[0]=x=>b.value=x),placeholder:s.placeholder,disabled:s.disabled||s.loading,onFocus:w,onBlur:H,onKeydown:[Le(ae(K,["prevent"]),["down"]),Le(ae(oe,["prevent"]),["up"]),Le(ae(Y,["prevent"]),["enter"]),Le(G,["escape"])],class:"dropdown-input"},null,40,Mt),[[pe,b.value]]),e("div",Ot,[s.loading?(n(),r("i",Vt)):s.modelValue&&!s.disabled?(n(),r("i",{key:1,class:"mdi mdi-close-circle clear-icon",onClick:z})):(n(),r("i",At))])],2),s.error?(n(),r("div",Et,f(s.error),1)):O("",!0),s.hint&&!s.error?(n(),r("div",Pt,f(s.hint),1)):O("",!0),le(je,{name:"dropdown"},{default:Oe(()=>[o.value&&P.value.length>0?(n(),r("div",jt,[(n(!0),r(ne,null,de(P.value,(x,y)=>(n(),r("div",{key:i(x),class:Z(["dropdown-item",{highlighted:y===d.value,selected:R(x)}]),onMousedown:ae(V=>S(x),["prevent"]),onMouseenter:V=>d.value=y},[e("div",Ut,[e("div",Nt,f(L(x)),1),l(x)?(n(),r("div",Bt,f(l(x)),1)):O("",!0)]),R(x)?(n(),r("i",qt)):O("",!0)],42,Ft))),128))])):O("",!0)]),_:1}),o.value&&P.value.length===0&&!s.loading?(n(),r("div",Ht,[...C[1]||(C[1]=[e("div",{class:"dropdown-item no-results"},[e("i",{class:"mdi mdi-magnify"}),I(" No results found ")],-1)])])):O("",!0)],512))}},Ee=ue(zt,[["__scopeId","data-v-679ce35f"]]),Jt={class:"smartir-selector"},Wt={class:"form-group"},Xt={class:"form-group"},Gt={class:"form-group"},Kt=["value"],Yt={key:0,class:"error-message"},Zt={class:"form-group"},Qt={class:"form-group"},eo={key:1,class:"code-info"},to={class:"info-content"},oo={class:"info-row"},lo={class:"info-value"},so={class:"info-row"},no={class:"info-value"},ao={key:0,class:"info-row"},io={class:"info-value"},ro={class:"info-row"},uo={class:"info-value"},co={__name:"SmartIRDeviceSelector",props:{entityType:{type:String,required:!0},modelValue:{type:Object,default:()=>({})},broadlinkDevices:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(s,{expose:p,emit:a}){const $=s,u=a,g=k([]),b=k([]),o=k(""),d=k(""),M=k(""),L=k(""),i=k(""),l=k(null),R=k(!1),P=k(!1),h=k({manufacturer:"",model:"",controller:""});be(async()=>{if(await w(),$.modelValue&&(o.value=$.modelValue.manufacturer||"",d.value=$.modelValue.device_code||"",M.value=$.modelValue.controller_device||"",L.value=$.modelValue.temperature_sensor||"",i.value=$.modelValue.humidity_sensor||"",o.value&&(await H(o.value),d.value&&b.value.length>0))){const m=b.value.find(C=>C.code_id===d.value);m&&(l.value={code_id:m.code_id,manufacturer:o.value,models:m.models,controller:m.controller})}}),ie(()=>$.entityType,async m=>{m&&(o.value="",d.value="",b.value=[],l.value=null,await w())});const w=async()=>{if($.entityType){R.value=!0,h.value.manufacturer="";try{const m=await se.get("/api/smartir/codes/manufacturers",{params:{entity_type:$.entityType}});if(m.data.success)g.value=m.data.manufacturers||[];else throw new Error(m.data.error||"Failed to load manufacturers")}catch(m){console.error("Error loading manufacturers:",m),h.value.manufacturer="Failed to load manufacturers. Please try again.",g.value=[]}finally{R.value=!1}}},H=async m=>{if(!(!m||!$.entityType)){P.value=!0,h.value.model="";try{const C=await se.get("/api/smartir/codes/models",{params:{entity_type:$.entityType,manufacturer:m}});if(C.data.success){const x=C.data.models||[];b.value=x.map(y=>{const V=y.models&&y.models.length>0?y.models.join(", "):`Code ${y.code_id}`;return{code_id:y.code_id,label:V,description:`Code: ${y.code_id}`,models:y.models,controller:y.controller}})}else throw new Error(C.data.error||"Failed to load models")}catch(C){console.error("Error loading models:",C),h.value.model="Failed to load models. Please try again.",b.value=[]}finally{P.value=!1}}},G=async m=>{o.value=m,d.value="",l.value=null,b.value=[],m&&await H(m),Y()},S=(m,C)=>{d.value=m,C&&(l.value={code_id:C.code_id,manufacturer:o.value,models:C.models,controller:C.controller}),Y()},z=()=>{Y()},K=()=>{Y()},oe=()=>{Y()},Y=()=>{var C,x;const m={manufacturer:o.value,model:((x=(C=l.value)==null?void 0:C.models)==null?void 0:x[0])||"",device_code:d.value,controller_device:M.value};$.entityType==="climate"&&(L.value&&(m.temperature_sensor=L.value),i.value&&(m.humidity_sensor=i.value)),u("update:modelValue",m),u("change",m)};return p({validate:()=>{let m=!0;return h.value={manufacturer:"",model:"",controller:""},o.value||(h.value.manufacturer="Manufacturer is required",m=!1),d.value||(h.value.model="Model is required",m=!1),M.value||(h.value.controller="Broadlink controller is required",m=!1),m}}),(m,C)=>(n(),r("div",Jt,[e("div",Wt,[le(Ee,{modelValue:o.value,"onUpdate:modelValue":C[0]||(C[0]=x=>o.value=x),options:g.value,label:"Manufacturer",placeholder:"Search manufacturers...",required:"",loading:R.value,error:h.value.manufacturer,hint:"Select the device manufacturer",onChange:G},null,8,["modelValue","options","loading","error"])]),e("div",Xt,[le(Ee,{modelValue:d.value,"onUpdate:modelValue":C[1]||(C[1]=x=>d.value=x),options:b.value,"option-label":"label","option-value":"code_id","option-description":"description",label:"Model",placeholder:"Search models...",required:"",disabled:!o.value,loading:P.value,error:h.value.model,hint:"Select the device model",onChange:S},null,8,["modelValue","options","disabled","loading","error"])]),e("div",Gt,[C[6]||(C[6]=e("label",{for:"controller-device"},[e("i",{class:"mdi mdi-remote"}),I(" Controller Device * ")],-1)),j(e("select",{id:"controller-device","onUpdate:modelValue":C[2]||(C[2]=x=>M.value=x),required:"",onChange:z},[C[5]||(C[5]=e("option",{value:""},"-- Select Controller Device --",-1)),(n(!0),r(ne,null,de(s.broadlinkDevices,x=>(n(),r("option",{key:x.entity_id,value:x.entity_id},[I(f(x.name||x.entity_id)+" ",1),x.area_name?(n(),r(ne,{key:0},[I(" - "+f(x.area_name),1)],64)):O("",!0)],8,Kt))),128))],544),[[fe,M.value]]),C[7]||(C[7]=e("small",null,"Which remote device will send the IR/RF commands",-1)),h.value.controller?(n(),r("div",Yt,f(h.value.controller),1)):O("",!0)]),s.entityType==="climate"?(n(),r(ne,{key:0},[e("div",Zt,[C[8]||(C[8]=e("label",{for:"temperature-sensor"},"Temperature Sensor",-1)),j(e("input",{id:"temperature-sensor","onUpdate:modelValue":C[3]||(C[3]=x=>L.value=x),type:"text",placeholder:"e.g., sensor.living_room_temperature",onInput:K},null,544),[[pe,L.value]]),C[9]||(C[9]=e("small",null,"Optional: Temperature sensor entity for current temperature",-1))]),e("div",Qt,[C[10]||(C[10]=e("label",{for:"humidity-sensor"},"Humidity Sensor",-1)),j(e("input",{id:"humidity-sensor","onUpdate:modelValue":C[4]||(C[4]=x=>i.value=x),type:"text",placeholder:"e.g., sensor.living_room_humidity",onInput:oe},null,544),[[pe,i.value]]),C[11]||(C[11]=e("small",null,"Optional: Humidity sensor entity for current humidity",-1))])],64)):O("",!0),l.value?(n(),r("div",eo,[C[16]||(C[16]=e("div",{class:"info-header"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Selected Device Code")],-1)),e("div",to,[e("div",oo,[C[12]||(C[12]=e("span",{class:"info-label"},"Code ID:",-1)),e("span",lo,f(l.value.code_id),1)]),e("div",so,[C[13]||(C[13]=e("span",{class:"info-label"},"Manufacturer:",-1)),e("span",no,f(l.value.manufacturer),1)]),l.value.models&&l.value.models.length>0?(n(),r("div",ao,[C[14]||(C[14]=e("span",{class:"info-label"},"Supported Models:",-1)),e("span",io,f(l.value.models.join(", ")),1)])):O("",!0),e("div",ro,[C[15]||(C[15]=e("span",{class:"info-label"},"Controller:",-1)),e("span",uo,f(l.value.controller||"Broadlink"),1)])])])):O("",!0)]))}},mo=ue(co,[["__scopeId","data-v-7c14dbf5"]]),vo={class:"modal-content"},po={class:"modal-header"},fo={class:"form-group"},go={class:"form-group"},yo=["disabled"],bo={key:0,class:"smartir-notice"},ho={key:0,class:"notice-success"},ko={key:1,class:"notice-warning"},wo={key:1,class:"smartir-notice"},$o={key:2},Co={class:"form-group"},_o=["disabled"],So=["disabled"],Io={key:0},xo={key:1},Do={key:2},To={key:3},Ro={class:"form-group"},Lo=["value"],Mo={class:"form-group"},Oo={key:0,class:"form-group"},Vo=["value"],Ao=["value"],Eo={key:2},Po={key:3},jo={key:1,class:"smartir-section"},Fo={class:"modal-footer"},Uo={type:"submit",form:"device-form",class:"btn btn-primary"},No={__name:"DeviceForm",props:{device:{type:Object,default:null}},emits:["save","cancel"],setup(s,{emit:p}){const a=s,$=p,u=we("smartirStatus"),g=N(()=>{var y;return localStorage.getItem("smartir_simulate_not_installed")==="true"?!1:((y=u==null?void 0:u.value)==null?void 0:y.installed)||!1}),b=N(()=>!!a.device),o=N(()=>["climate","media_player","fan","light"].includes(i.value.entity_type)),d=N(()=>g.value?!o.value&&i.value.entity_type?"(Not supported for this type)":"(Pre-configured Codes)":"(Requires SmartIR)"),M=N(()=>{var y;const x=((y=a.device)==null?void 0:y.commands)||{};return Object.keys(x).length>0}),L=N(()=>{if(!i.value.broadlink_entity)return"";const x=h.value.find(y=>y.entity_id===i.value.broadlink_entity);return x&&x.name||i.value.broadlink_entity}),i=k({name:"",entity_type:"",device_type:"broadlink",device:"",area:"",icon:"",broadlink_entity:"",enabled:!0,commands:{}}),l=k({}),R=k(null),P=k([]),h=k([]),w=k(null),H=k(null),G=k(null),S=k(!1);be(async()=>{a.device&&(i.value={...a.device,device_type:a.device.device_type||"broadlink"},i.value.device_type==="smartir"&&(l.value={manufacturer:a.device.manufacturer,model:a.device.model,device_code:a.device.device_code,controller_device:a.device.controller_device,temperature_sensor:a.device.temperature_sensor,humidity_sensor:a.device.humidity_sensor})),await Promise.all([z(),K()]),w.value&&(w.value.setCustomValidity(""),w.value.oninvalid=()=>{w.value.setCustomValidity("Device name is required")}),H.value&&(H.value.setCustomValidity(""),H.value.oninvalid=()=>{H.value.setCustomValidity("Entity type is required")}),G.value&&(G.value.setCustomValidity(""),G.value.oninvalid=()=>{G.value.setCustomValidity("Broadlink device is required")})});const z=async()=>{try{const x=await se.get("/api/areas");P.value=x.data.areas||[]}catch(x){console.error("Error loading areas:",x),P.value=[]}},K=async()=>{try{const y=(await se.get("/api/remote/devices")).data.devices||[];h.value=y,console.log("Loaded remote devices:",y)}catch(x){console.error("Error loading remote devices:",x),h.value=[]}},oe=x=>{const y=x==="nameInput"?w.value:x==="typeSelect"?H.value:x==="broadlinkSelect"?G.value:null;y&&y.setCustomValidity("")},Y=x=>{if(!x)return"";const y=x.toLowerCase();for(const V of P.value){const ee=V.toLowerCase();if(y.includes(ee))return V}return""},E=(x,y="")=>{const V=y.toLowerCase();return V.includes("tv")?"mdi:television":V.includes("lamp")?"mdi:lamp":V.includes("ceiling")?"mdi:ceiling-light":V.includes("floor")?"mdi:floor-lamp":V.includes("desk")?"mdi:desk-lamp":V.includes("fan")?"mdi:fan":V.includes("ac")||V.includes("air con")?"mdi:air-conditioner":V.includes("heater")?"mdi:radiator":V.includes("blind")?"mdi:blinds":V.includes("curtain")?"mdi:curtains":V.includes("garage")?"mdi:garage":V.includes("speaker")||V.includes("stereo")?"mdi:speaker":V.includes("receiver")?"mdi:audio-video":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:television",cover:"mdi:window-shutter",climate:"mdi:thermostat"}[x]||"mdi:devices"};ie(()=>i.value.name,x=>{if(!b.value&&x&&!i.value.area){const y=Y(x);y&&(i.value.area=y)}!b.value&&x&&i.value.entity_type&&(S.value||!i.value.icon)&&(i.value.icon=E(i.value.entity_type,x),S.value=!0)}),ie(()=>i.value.entity_type,x=>{!b.value&&x&&(S.value||!i.value.icon)&&(i.value.icon=E(x,i.value.name),S.value=!0)}),ie(()=>i.value.icon,(x,y)=>{y!==void 0&&x!==y&&!S.value&&(S.value=!1),x||(S.value=!1)});const m=async()=>{if(i.value.device_type==="smartir"){if(R.value&&!R.value.validate())return;const x={...i.value,smartir_config:{manufacturer:l.value.manufacturer,model:l.value.model,code_id:l.value.device_code,controller_device:l.value.controller_device}};$("save",x)}else $("save",{...i.value})},C=x=>{l.value=x};return(x,y)=>(n(),r("div",{class:"modal-overlay",onClick:y[12]||(y[12]=ae(V=>x.$emit("cancel"),["self"]))},[e("div",vo,[e("div",po,[e("h2",null,f(b.value?"Edit Device":"Add New Device"),1),e("button",{onClick:y[0]||(y[0]=V=>x.$emit("cancel")),class:"close-btn"},[...y[13]||(y[13]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("form",{id:"device-form",onSubmit:ae(m,["prevent"]),class:"modal-body"},[e("div",fo,[y[14]||(y[14]=e("label",{for:"device-name"},"Device Name *",-1)),j(e("input",{id:"device-name",ref_key:"nameInput",ref:w,"onUpdate:modelValue":y[1]||(y[1]=V=>i.value.name=V),type:"text",placeholder:"e.g., Living Room TV",required:"",onInput:y[2]||(y[2]=V=>oe("nameInput"))},null,544),[[pe,i.value.name]])]),e("div",go,[y[21]||(y[21]=e("label",{for:"entity-type"},"Entity Type *",-1)),j(e("select",{id:"entity-type",ref_key:"typeSelect",ref:H,"onUpdate:modelValue":y[3]||(y[3]=V=>i.value.entity_type=V),required:"",onChange:y[4]||(y[4]=V=>oe("typeSelect"))},[y[15]||(y[15]=Ie('<option value="" data-v-a5bcea78>-- Select Type --</option><option value="light" data-v-a5bcea78>ğŸ’¡ Light</option><option value="fan" data-v-a5bcea78>ğŸŒ€ Fan</option><option value="switch" data-v-a5bcea78>ğŸ”Œ Switch</option><option value="media_player" data-v-a5bcea78>ğŸ“º Media Player</option><option value="cover" data-v-a5bcea78>ğŸªŸ Cover (Blinds/Curtains)</option>',6)),e("option",{value:"climate",disabled:!g.value}," ğŸŒ¡ï¸ Climate "+f(g.value?"":"(Requires SmartIR)"),9,yo)],544),[[fe,i.value.entity_type]]),i.value.entity_type==="climate"?(n(),r("div",bo,[g.value?(n(),r("div",ho,[...y[16]||(y[16]=[e("i",{class:"mdi mdi-check-circle"},null,-1),e("span",null,"SmartIR detected! Climate entities will be created via SmartIR profiles.",-1)])])):(n(),r("div",ko,[...y[17]||(y[17]=[e("i",{class:"mdi mdi-alert"},null,-1),e("div",null,[e("strong",null,"SmartIR Required"),e("p",null,"Climate entities (AC, heaters) require SmartIR integration."),e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"smartir-link"}," Install SmartIR â†’ ")],-1)])]))])):g.value&&["media_player","fan","light"].includes(i.value.entity_type)?(n(),r("div",wo,[...y[18]||(y[18]=[e("div",{class:"notice-info"},[e("i",{class:"mdi mdi-information"}),e("span",null,"ğŸ’¡ SmartIR available! You can use pre-configured codes or learn your own.")],-1)])])):!g.value&&i.value.entity_type?(n(),r("small",$o,[y[19]||(y[19]=I(" ğŸ’¡ Tip: Install ",-1)),y[20]||(y[20]=e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"inline-link"},"SmartIR",-1)),I(" for pre-configured "+f(i.value.entity_type==="climate"?"climate":i.value.entity_type)+" device codes ",1)])):O("",!0)]),e("div",Co,[y[24]||(y[24]=e("label",{for:"device-type"},"Device Type *",-1)),j(e("select",{id:"device-type","onUpdate:modelValue":y[5]||(y[5]=V=>i.value.device_type=V),required:"",disabled:b.value},[y[22]||(y[22]=e("option",{value:""},"-- Select Device Type --",-1)),y[23]||(y[23]=e("option",{value:"broadlink"},"ğŸ“¡ Broadlink Device (Learn IR Codes)",-1)),e("option",{value:"smartir",disabled:!g.value||!o.value}," ğŸŒ SmartIR Device "+f(d.value),9,So)],8,_o),[[fe,i.value.device_type]]),b.value?(n(),r("small",Io,"Cannot change device type after creation")):i.value.device_type==="smartir"?(n(),r("small",xo,"Using pre-configured codes from SmartIR repository")):i.value.device_type==="broadlink"?(n(),r("small",Do,"Learn and store your own IR codes")):(n(),r("small",To,"Choose how to configure this device"))]),e("div",Ro,[y[26]||(y[26]=e("label",{for:"device-area"},"Area",-1)),j(e("select",{id:"device-area","onUpdate:modelValue":y[6]||(y[6]=V=>i.value.area=V)},[y[25]||(y[25]=e("option",{value:""},"-- No Area --",-1)),(n(!0),r(ne,null,de(P.value,V=>(n(),r("option",{key:V,value:V},f(V),9,Lo))),128))],512),[[fe,i.value.area]]),y[27]||(y[27]=e("small",null,"Optional: Assign to a Home Assistant area",-1))]),e("div",Mo,[y[28]||(y[28]=e("label",{for:"device-icon"},"Icon",-1)),le(Tt,{modelValue:i.value.icon,"onUpdate:modelValue":y[7]||(y[7]=V=>i.value.icon=V),inputId:"device-icon",placeholder:"e.g., mdi:television"},null,8,["modelValue"]),y[29]||(y[29]=e("small",null,"Optional: Material Design Icon name",-1))]),i.value.device_type==="broadlink"?(n(),r("div",Oo,[y[31]||(y[31]=e("label",{for:"broadlink-entity"},"Remote Device *",-1)),!b.value||!M.value?j((n(),r("select",{key:0,id:"broadlink-entity",ref_key:"broadlinkSelect",ref:G,"onUpdate:modelValue":y[8]||(y[8]=V=>i.value.broadlink_entity=V),required:"",onChange:y[9]||(y[9]=V=>oe("broadlinkSelect"))},[y[30]||(y[30]=e("option",{value:""},"-- Select Remote Device --",-1)),(n(!0),r(ne,null,de(h.value,V=>(n(),r("option",{key:V.entity_id,value:V.entity_id},[I(f(V.name||V.entity_id)+" ",1),V.area_name?(n(),r(ne,{key:0},[I(" - "+f(V.area_name),1)],64)):O("",!0)],8,Vo))),128))],544)),[[fe,i.value.broadlink_entity]]):(n(),r("input",{key:1,id:"broadlink-entity",value:L.value,type:"text",readonly:"",disabled:""},null,8,Ao)),!b.value||!M.value?(n(),r("small",Eo,"Required: Select which remote device to use for sending commands")):(n(),r("small",Po,"Cannot change remote device after commands are learned"))])):O("",!0),i.value.device_type==="smartir"?(n(),r("div",jo,[y[32]||(y[32]=e("div",{class:"section-header"},[e("i",{class:"mdi mdi-cloud-download"}),e("span",null,"SmartIR Device Configuration")],-1)),le(mo,{ref_key:"smartirSelector",ref:R,"entity-type":i.value.entity_type,modelValue:l.value,"onUpdate:modelValue":y[10]||(y[10]=V=>l.value=V),"broadlink-devices":h.value,onChange:C},null,8,["entity-type","modelValue","broadlink-devices"])])):O("",!0)],32),e("div",Fo,[e("button",{type:"button",onClick:y[11]||(y[11]=V=>x.$emit("cancel")),class:"btn btn-secondary"}," Cancel "),e("button",Uo,[y[33]||(y[33]=e("i",{class:"mdi mdi-check"},null,-1)),I(" "+f(b.value?"Update":"Create"),1)])])])]))}},Bo=ue(No,[["__scopeId","data-v-a5bcea78"]]),qo={class:"modal-header"},Ho={class:"modal-body"},zo={class:"message-text"},Jo={key:0,class:"checkbox-option"},Wo={class:"modal-footer"},Xo={__name:"ConfirmDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},showCancel:{type:Boolean,default:!0},dangerMode:{type:Boolean,default:!1},checkboxLabel:{type:String,default:""}},emits:["confirm","cancel"],setup(s,{emit:p}){const a=s,$=p,u=k(!1);ie(()=>a.isOpen,o=>{o&&(u.value=!1)});const g=()=>{$("confirm",u.value)},b=()=>{$("cancel")};return(o,d)=>s.isOpen?(n(),r("div",{key:0,class:"modal-overlay",onClick:ae(b,["self","stop"])},[e("div",{class:"modal-dialog confirm-dialog",onClick:d[1]||(d[1]=ae(()=>{},["stop"]))},[e("div",qo,[e("h2",null,f(s.title),1)]),e("div",Ho,[e("p",zo,f(s.message),1),s.checkboxLabel?(n(),r("div",Jo,[e("label",null,[j(e("input",{type:"checkbox","onUpdate:modelValue":d[0]||(d[0]=M=>u.value=M)},null,512),[[Q,u.value]]),e("span",null,f(s.checkboxLabel),1)])])):O("",!0)]),e("div",Wo,[s.showCancel?(n(),r("button",{key:0,onClick:ae(b,["stop"]),class:"btn btn-secondary"},f(s.cancelText),1)):O("",!0),e("button",{onClick:ae(g,["stop"]),class:Z(["btn",s.dangerMode?"btn-danger":"btn-primary"])},f(s.confirmText),3)])])])):O("",!0)}},_e=ue(Xo,[["__scopeId","data-v-6404e72a"]]),Go={class:"modal-content"},Ko={class:"modal-header"},Yo={class:"modal-body"},Zo={key:0,class:"smartir-info"},Qo={class:"form-group"},el=["value"],tl={class:"form-group"},ol=["disabled"],ll={label:"Suggested Commands"},sl=["value"],nl=["disabled"],al={class:"form-group"},il={class:"radio-group"},rl={class:"radio-label"},dl=["disabled"],ul={class:"radio-label"},cl=["disabled"],ml={class:"learn-action"},vl=["disabled"],pl={key:0,class:"mdi mdi-loading mdi-spin"},fl={key:1,class:"mdi mdi-remote-tv"},gl={key:0,class:"learning-status"},yl={key:1,class:"result-message success"},bl={key:2,class:"section-divider"},hl={key:3,class:"learned-commands"},kl={class:"command-list"},wl={class:"command-name"},$l={key:0,class:"command-status testing"},Cl={key:1,class:"command-status success"},_l={class:"command-actions"},Sl=["onClick","disabled"],Il=["onClick","disabled"],xl={key:4,class:"untracked-commands"},Dl={class:"command-list"},Tl={class:"command-name"},Rl={class:"modal-footer"},Ll=["disabled"],Ml={__name:"CommandLearner",props:{device:{type:Object,required:!0}},emits:["cancel","learned"],setup(s,{emit:p}){const a=s,$=p,u=k([]),g=k(""),b=k(""),o=k(""),d=k("ir"),M=k(!1),L=k(""),i=k("success"),l=k([]),R=k([]),P=k(!1),h=k(""),w=k(!1),H=k(null),G=k(null),S=k(""),z=k(""),K=N(()=>a.device.device_type==="smartir");N(()=>{if(K.value)return!1;const A=b.value==="__custom__"?o.value:b.value;return g.value&&A.trim()});const oe=()=>{H.value&&H.value.setCustomValidity("")},Y=()=>{G.value&&G.value.setCustomValidity("")},E=N(()=>{const A=u.value.find(T=>T.entity_id===g.value);return A?A.name||A.entity_id:g.value}),m={light:["turn_on","turn_off","toggle","brightness_up","brightness_down","dim","bright"],fan:["turn_on","turn_off","toggle","speed_low","speed_medium","speed_high","speed_1","speed_2","speed_3","speed_4","speed_5","oscillate_on","oscillate_off","direction_forward","direction_reverse"],switch:["turn_on","turn_off","toggle"],media_player:["turn_on","turn_off","toggle","volume_up","volume_down","volume_mute","play","pause","stop","play_pause","next_track","previous_track","channel_up","channel_down","source_hdmi1","source_hdmi2","source_hdmi3","source_tv","source_aux","source_bluetooth","menu","home","back","select","arrow_up","arrow_down","arrow_left","arrow_right"],cover:["open","close","stop","open_tilt","close_tilt","position_0","position_25","position_50","position_75","position_100"]},C=N(()=>{const A=a.device.entity_type||"switch";return m[A]||m.switch});be(async()=>{await x(),await y(),await Ce(),H.value&&(H.value.setCustomValidity(""),H.value.oninvalid=()=>{H.value.setCustomValidity("Command name is required")}),a.device.broadlink_entity&&(g.value=a.device.broadlink_entity)}),ie(b,async A=>{A==="__custom__"&&(await Fe(),G.value&&(G.value.setCustomValidity(""),G.value.oninvalid=()=>{G.value.setCustomValidity("Custom command name is required")}))});const x=async()=>{try{const A=await se.get("/api/broadlink/devices");u.value=A.data.devices||[]}catch(A){console.error("Error loading Broadlink devices:",A)}},y=async()=>{try{if(K.value){const A=await se.get("/api/smartir/codes/code",{params:{entity_type:a.device.entity_type,code_id:a.device.device_code}});if(A.data.success&&A.data.code){const T=A.data.code.commands||{};l.value=Object.keys(T)}}else{if(console.log("ğŸ“‹ Loading commands for device:",a.device),console.log("ğŸ“‹ Device commands:",a.device.commands),console.log("ğŸ“‹ Device ID:",a.device.id),a.device.commands&&Object.keys(a.device.commands).length>0)console.log("âœ… Using commands from device object"),l.value=Object.keys(a.device.commands);else if(a.device.id){console.log("ğŸŒ Fetching commands from API for device ID:",a.device.id);const T=(await se.get(`/api/commands/${a.device.id}`)).data.commands||{};l.value=Object.keys(T)}else console.log("âš ï¸ No commands found and no device ID");console.log("ğŸ“‹ Final learned commands:",l.value)}}catch(A){console.error("Error loading commands:",A)}},V=async()=>{var A,T;L.value="",i.value="",M.value=!0;try{let F=a.device.id.split(".")[1];a.device.device&&(F=a.device.device);const te=b.value==="__custom__"?o.value:b.value,ce=await se.post("/api/commands/learn",{entity_id:g.value,device:F,device_id:a.device.id,command:te.trim(),command_type:d.value});if(ce.data.success){L.value=`Command "${te}" learned successfully!`,i.value="success",l.value.includes(te)||l.value.push(te);const ye=R.value.indexOf(te);ye>-1&&R.value.splice(ye,1);const ke={...a.device.commands};ke[te]=!0,b.value="",o.value="",$("learned",{commands:ke,commandName:te})}else L.value=ce.data.error||"Failed to learn command",i.value="error"}catch(F){L.value=((T=(A=F.response)==null?void 0:A.data)==null?void 0:T.error)||"Error learning command",i.value="error"}finally{M.value=!1}},ee=async A=>{try{z.value=A,S.value="";let T=a.device.id.split(".")[1];a.device.device&&(T=a.device.device);const F=K.value?a.device.controller_device:g.value||a.device.broadlink_entity;(await se.post("/api/commands/test",{entity_id:F,device:T,command:A,device_id:a.device.id})).data.success&&(S.value=A,setTimeout(()=>{S.value===A&&(S.value="")},2e3))}catch(T){L.value=`Failed to send command: ${T.message}`,i.value="error"}finally{z.value=""}},ve=A=>{h.value=A,P.value=!0},he=()=>{P.value=!1,h.value=""},Se=async()=>{const A=h.value;P.value=!1;try{await se.delete(`/api/commands/${a.device.id}/${A}`),await y(),await Ce(),L.value=`Command "${A}" deleted`,i.value="success",$("learned")}catch(T){L.value=`Failed to delete command: ${T.message}`,i.value="error"}finally{h.value=""}},Ce=async()=>{try{const A=a.device.device||a.device.id.split(".")[1],F=(await se.get("/api/commands/untracked")).data.untracked||{};F[A]?R.value=Object.keys(F[A].commands):R.value=[]}catch(A){console.error("Error loading untracked commands:",A),R.value=[]}},B=()=>{R.value.length!==0&&(w.value=!0)},D=async()=>{w.value=!1;try{const A=a.device.device||a.device.id.split(".")[1],T=await se.post("/api/commands/import",{device_id:a.device.id,source_device:A,commands:R.value});T.data.success&&(L.value=`Imported ${T.data.imported_count} commands successfully!`,i.value="success",await y(),await Ce(),$("learned"))}catch(A){L.value=`Failed to import commands: ${A.message}`,i.value="error"}};return(A,T)=>(n(),r("div",{class:"modal-overlay",onClick:T[7]||(T[7]=ae(F=>A.$emit("cancel"),["self"]))},[e("div",Go,[e("div",Ko,[e("h2",null,f(K.value?"Commands for":"Learn Commands for")+" "+f(s.device.name),1),e("button",{onClick:T[0]||(T[0]=F=>A.$emit("cancel")),class:"close-btn"},[...T[8]||(T[8]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Yo,[K.value?(n(),r("div",Zo,[T[12]||(T[12]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[T[11]||(T[11]=e("h3",null,"SmartIR Device",-1)),e("p",null,[T[9]||(T[9]=I("This device uses SmartIR code file ",-1)),e("strong",null,f(s.device.device_code),1),T[10]||(T[10]=I(". Commands are pre-configured and cannot be learned. View the commands below.",-1))])])])):(n(),r("form",{key:1,onSubmit:ae(V,["prevent"])},[e("div",Qo,[T[13]||(T[13]=e("label",{for:"broadlink-entity"},"Broadlink Device",-1)),e("input",{id:"broadlink-entity",value:E.value,type:"text",readonly:"",disabled:""},null,8,el),T[14]||(T[14]=e("small",null,"Commands will be learned using this device (set when device was created)",-1))]),e("div",tl,[T[17]||(T[17]=e("label",{for:"command-name"},"Command Name *",-1)),j(e("select",{id:"command-name",ref_key:"commandSelect",ref:H,"onUpdate:modelValue":T[1]||(T[1]=F=>b.value=F),disabled:M.value,required:"",onChange:oe},[T[15]||(T[15]=e("option",{value:""},"-- Select or type command --",-1)),e("optgroup",ll,[(n(!0),r(ne,null,de(C.value,F=>(n(),r("option",{key:F,value:F},f(F),9,sl))),128))]),T[16]||(T[16]=e("option",{value:"__custom__"},"Custom command...",-1))],40,ol),[[fe,b.value]]),b.value==="__custom__"?j((n(),r("input",{key:0,ref_key:"customCommandInput",ref:G,"onUpdate:modelValue":T[2]||(T[2]=F=>o.value=F),type:"text",placeholder:"Enter custom command name",disabled:M.value,required:"",class:"custom-command-input",onInput:Y},null,40,nl)),[[pe,o.value]]):O("",!0),e("small",null,"Select a suggested command for "+f(s.device.entity_type||"this device")+", or enter a custom one.",1)]),e("div",al,[T[20]||(T[20]=e("label",null,"Command Type",-1)),e("div",il,[e("label",rl,[j(e("input",{type:"radio","onUpdate:modelValue":T[3]||(T[3]=F=>d.value=F),value:"ir",disabled:M.value},null,8,dl),[[Ae,d.value]]),T[18]||(T[18]=e("span",null,"IR (Infrared)",-1))]),e("label",ul,[j(e("input",{type:"radio","onUpdate:modelValue":T[4]||(T[4]=F=>d.value=F),value:"rf",disabled:M.value},null,8,cl),[[Ae,d.value]]),T[19]||(T[19]=e("span",null,"RF (Radio Frequency)",-1))])])]),e("div",ml,[e("button",{type:"submit",class:"btn btn-primary btn-large",disabled:M.value},[M.value?(n(),r("i",pl)):(n(),r("i",fl)),I(" "+f(M.value?"Learning...":"Learn Command"),1)],8,vl)]),M.value?(n(),r("div",gl,[...T[21]||(T[21]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Point your remote at the Broadlink device and press the button...",-1),e("small",null,"This may take up to 30 seconds",-1)])])):O("",!0),L.value&&i.value==="success"&&!L.value.includes("sent successfully")?(n(),r("div",yl,[T[22]||(T[22]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("p",null,f(L.value),1)])):O("",!0)],32)),l.value.length>0||R.value.length>0?(n(),r("div",bl)):O("",!0),l.value.length>0?(n(),r("div",hl,[e("h3",null,"Tracked Commands ("+f(l.value.length)+")",1),e("div",kl,[(n(!0),r(ne,null,de(l.value,F=>(n(),r("div",{key:F,class:Z(["command-item",{testing:z.value===F,tested:S.value===F}])},[e("span",wl,f(F),1),z.value===F?(n(),r("span",$l,[...T[23]||(T[23]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),I(" Sending... ",-1)])])):S.value===F?(n(),r("span",Cl,[...T[24]||(T[24]=[e("i",{class:"mdi mdi-check-circle"},null,-1),I(" Sent! ",-1)])])):O("",!0),e("div",_l,[e("button",{type:"button",onClick:te=>ee(F),class:"icon-btn",title:"Test",disabled:z.value!==""},[...T[25]||(T[25]=[e("i",{class:"mdi mdi-play"},null,-1)])],8,Sl),e("button",{type:"button",onClick:te=>ve(F),class:"icon-btn danger",title:"Delete",disabled:z.value!==""},[...T[26]||(T[26]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Il)])],2))),128))])])):O("",!0),R.value.length>0?(n(),r("div",xl,[e("h3",null,[T[27]||(T[27]=e("i",{class:"mdi mdi-alert"},null,-1)),I(" Untracked Commands ("+f(R.value.length)+") ",1)]),T[30]||(T[30]=e("p",{class:"untracked-info"}," These commands exist in Broadlink storage but are not tracked in this device. ",-1)),e("div",Dl,[(n(!0),r(ne,null,de(R.value,F=>(n(),r("div",{key:F,class:"command-item untracked"},[e("span",Tl,f(F),1),T[28]||(T[28]=e("span",{class:"untracked-badge"},"Not tracked",-1))]))),128))]),e("button",{type:"button",onClick:B,class:"btn btn-secondary"},[...T[29]||(T[29]=[e("i",{class:"mdi mdi-import"},null,-1),I(" Import All Untracked Commands ",-1)])])])):O("",!0)]),e("div",Rl,[e("button",{type:"button",onClick:T[5]||(T[5]=F=>A.$emit("cancel")),class:"btn btn-secondary",disabled:M.value}," Close ",8,Ll)])]),le(_e,{isOpen:P.value,title:"Delete Command?",message:`Delete command '${h.value}'? This will remove it from Broadlink storage.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:Se,onCancel:he},null,8,["isOpen","message"]),le(_e,{isOpen:w.value,title:"Import Commands?",message:`Import ${R.value.length} untracked command${R.value.length>1?"s":""} into this device?`,confirmText:"Import",cancelText:"Cancel",onConfirm:D,onCancel:T[6]||(T[6]=F=>w.value=!1)},null,8,["isOpen","message"])]))}},Ol=ue(Ml,[["__scopeId","data-v-0538bbe7"]]),Vl={class:"modal-container error-dialog"},Al={class:"modal-header"},El={class:"modal-body"},Pl={class:"error-message"},jl={key:0,class:"error-suggestion"},Fl=["open"],Ul={class:"debug-content"},Nl={class:"debug-info"},Bl={key:0,class:"debug-section-title"},ql={key:1},Hl={__name:"ErrorDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Error"},message:{type:String,required:!0},suggestion:{type:String,default:""},details:{type:String,default:""},error:{type:Object,default:null},context:{type:Object,default:()=>({})}},emits:["close"],setup(s,{emit:p}){const a=s,$=p,u=we("toast"),g=k(!1),b=()=>{$("close")},o=N(()=>{var R,P,h,w,H,G,S,z,K,oe,Y;const i=new Date().toISOString(),l=a.error||{};return{error:JSON.stringify({message:a.message,title:a.title,details:a.details,errorObject:l.message||l.toString(),timestamp:i},null,2),request:JSON.stringify({method:((P=(R=l.config)==null?void 0:R.method)==null?void 0:P.toUpperCase())||"N/A",url:((h=l.config)==null?void 0:h.url)||"N/A",baseURL:((w=l.config)==null?void 0:w.baseURL)||"N/A",headers:((H=l.config)==null?void 0:H.headers)||{},data:(G=l.config)!=null&&G.data?JSON.parse(l.config.data):"N/A",params:((S=l.config)==null?void 0:S.params)||{}},null,2),response:JSON.stringify({status:((z=l.response)==null?void 0:z.status)||"N/A",statusText:((K=l.response)==null?void 0:K.statusText)||"N/A",data:((oe=l.response)==null?void 0:oe.data)||"N/A",headers:((Y=l.response)==null?void 0:Y.headers)||{}},null,2),browser:JSON.stringify({userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,viewport:`${window.innerWidth}x${window.innerHeight}`,screenResolution:`${window.screen.width}x${window.screen.height}`,colorDepth:window.screen.colorDepth,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,timestamp:i},null,2),appState:JSON.stringify({currentRoute:window.location.pathname,currentURL:window.location.href,referrer:document.referrer||"N/A",context:a.context||{},localStorage:{smartir_simulate:localStorage.getItem("smartir_simulate_not_installed"),theme:localStorage.getItem("theme")}},null,2),stackTrace:l.stack||null}}),d=async()=>{const i=L();try{await navigator.clipboard.writeText(i),u==null||u.success("Debug information copied to clipboard","âœ… Copied")}catch(l){console.error("Failed to copy:",l),u==null||u.error("Failed to copy to clipboard","âŒ Copy Failed")}},M=()=>{const i=L(),l=new Blob([i],{type:"text/plain"}),R=URL.createObjectURL(l),P=document.createElement("a");P.href=R;const h=new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5);P.download=`broadlink-manager-error-${h}.txt`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(R),u==null||u.success("Debug report downloaded","âœ… Downloaded")},L=()=>`Broadlink Manager - Error Report
${"=".repeat(60)}

Generated: ${new Date().toISOString()}
Title: ${a.title}
Message: ${a.message}
${a.suggestion?`Suggestion: ${a.suggestion}
`:""}
${"=".repeat(60)}

ERROR DETAILS
${"-".repeat(60)}
${o.value.error}

REQUEST INFORMATION
${"-".repeat(60)}
${o.value.request}

RESPONSE INFORMATION
${"-".repeat(60)}
${o.value.response}

BROWSER INFORMATION
${"-".repeat(60)}
${o.value.browser}

APPLICATION STATE
${"-".repeat(60)}
${o.value.appState}

${o.value.stackTrace?`STACK TRACE
${"-".repeat(60)}
${o.value.stackTrace}

`:""}
${"=".repeat(60)}
End of Report
`;return ie(()=>a.isOpen,i=>{if(i){const l=R=>{R.key==="Escape"&&b()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)}}),(i,l)=>(n(),De(Ue,{to:"body"},[le(je,{name:"modal"},{default:Oe(()=>[s.isOpen?(n(),r("div",{key:0,class:"modal-overlay",onClick:ae(b,["self"])},[e("div",Vl,[e("div",Al,[l[2]||(l[2]=e("div",{class:"header-icon error-icon"},[e("i",{class:"mdi mdi-alert-circle"})],-1)),e("h3",null,f(s.title),1),e("button",{onClick:b,class:"close-button"},[...l[1]||(l[1]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",El,[e("p",Pl,f(s.message),1),s.suggestion?(n(),r("p",jl,[l[3]||(l[3]=e("i",{class:"mdi mdi-lightbulb-on"},null,-1)),I(" "+f(s.suggestion),1)])):O("",!0),e("details",{class:"debug-section",open:g.value},[e("summary",{onClick:l[0]||(l[0]=R=>g.value=!g.value)},[e("i",{class:Z(["mdi",g.value?"mdi-chevron-down":"mdi-chevron-right"])},null,2),l[4]||(l[4]=I(" Debug Information ",-1))]),e("div",Ul,[e("div",{class:"debug-actions"},[e("button",{onClick:d,class:"btn-debug btn-copy"},[...l[5]||(l[5]=[e("i",{class:"mdi mdi-content-copy"},null,-1),I(" Copy to Clipboard ",-1)])]),e("button",{onClick:M,class:"btn-debug btn-download"},[...l[6]||(l[6]=[e("i",{class:"mdi mdi-download"},null,-1),I(" Download Report ",-1)])])]),e("div",Nl,[l[7]||(l[7]=e("div",{class:"debug-section-title"},"Error Details",-1)),e("pre",null,f(o.value.error),1),l[8]||(l[8]=e("div",{class:"debug-section-title"},"Request Information",-1)),e("pre",null,f(o.value.request),1),l[9]||(l[9]=e("div",{class:"debug-section-title"},"Response Information",-1)),e("pre",null,f(o.value.response),1),l[10]||(l[10]=e("div",{class:"debug-section-title"},"Browser Information",-1)),e("pre",null,f(o.value.browser),1),l[11]||(l[11]=e("div",{class:"debug-section-title"},"Application State",-1)),e("pre",null,f(o.value.appState),1),o.value.stackTrace?(n(),r("div",Bl,"Stack Trace")):O("",!0),o.value.stackTrace?(n(),r("pre",ql,f(o.value.stackTrace),1)):O("",!0)])])],8,Fl)]),e("div",{class:"modal-footer"},[e("button",{onClick:b,class:"btn btn-primary"}," OK ")])])])):O("",!0)]),_:1})]))}},zl=ue(Hl,[["__scopeId","data-v-23858149"]]),Jl={key:0,class:"discovery-banner"},Wl={class:"banner-content"},Xl={class:"banner-text"},Gl={class:"modal-dialog"},Kl={class:"modal-header"},Yl={class:"modal-body"},Zl={class:"device-list"},Ql={class:"device-info"},es={class:"device-details"},ts={class:"command-count"},os={class:"device-actions"},ls=["onClick"],ss=["onClick"],ns={class:"modal-footer"},as={class:"modal-dialog modal-dialog-small"},is={class:"modal-header"},rs={class:"modal-body"},ds={class:"warning-message"},us={class:"modal-footer"},cs=["disabled"],ms=["disabled"],vs={__name:"DeviceDiscovery",emits:["adopt"],setup(s,{expose:p,emit:a}){const $=Te(),u=a,g=k([]),b=k(!1),o=k(!1),d=k(null),M=k(!1),L=N(()=>g.value.length>0);be(async()=>{await i()});const i=async()=>{try{const h=await se.get("/api/devices/discover");g.value=h.data.untracked_devices||[]}catch(h){console.error("Error loading untracked devices:",h),g.value=[]}},l=h=>{b.value=!1,u("adopt",h)},R=h=>{d.value=h,o.value=!0},P=async()=>{if(d.value){M.value=!0;try{const h=await se.delete(`/api/devices/untracked/${encodeURIComponent(d.value.device_name)}`);if(h.data.success)g.value=g.value.filter(w=>w.device_name!==d.value.device_name),o.value=!1,d.value=null,console.log("Device deleted successfully");else throw new Error(h.data.error||"Failed to delete device")}catch(h){console.error("Error deleting device:",h),$.error(`Failed to delete device: ${h.message}`)}finally{M.value=!1}}};return p({refresh:i}),(h,w)=>{var H,G,S;return L.value?(n(),r("div",Jl,[e("div",Wl,[w[9]||(w[9]=e("div",{class:"banner-icon"},[e("i",{class:"mdi mdi-radar"})],-1)),e("div",Xl,[w[7]||(w[7]=e("h3",null,"Untracked Devices Found",-1)),e("p",null,f(g.value.length)+" device"+f(g.value.length>1?"s":"")+" with learned commands found in Broadlink storage",1)]),e("button",{onClick:w[0]||(w[0]=z=>b.value=!0),class:"btn btn-primary"},[...w[8]||(w[8]=[e("i",{class:"mdi mdi-eye"},null,-1),I(" View Devices ",-1)])])]),b.value?(n(),r("div",{key:0,class:"modal-overlay",onClick:w[3]||(w[3]=ae(z=>b.value=!1,["self"]))},[e("div",Gl,[e("div",Kl,[w[11]||(w[11]=e("h2",null,"Discovered Devices",-1)),e("button",{onClick:w[1]||(w[1]=z=>b.value=!1),class:"close-btn"},[...w[10]||(w[10]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Yl,[w[16]||(w[16]=e("p",{class:"info-text"}," These devices have learned commands in Broadlink storage but are not being tracked. Adopt them to manage their commands and generate Home Assistant entities. ",-1)),e("div",Zl,[(n(!0),r(ne,null,de(g.value,z=>(n(),r("div",{key:z.device_name,class:"discovered-device"},[e("div",Ql,[w[13]||(w[13]=e("div",{class:"device-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),e("div",es,[e("h4",null,f(z.device_name),1),e("span",ts,[w[12]||(w[12]=e("i",{class:"mdi mdi-remote"},null,-1)),I(" "+f(z.command_count)+" command"+f(z.command_count>1?"s":""),1)])])]),e("div",os,[e("button",{onClick:K=>l(z),class:"btn btn-primary"},[...w[14]||(w[14]=[e("i",{class:"mdi mdi-plus"},null,-1),I(" Adopt ",-1)])],8,ls),e("button",{onClick:K=>R(z),class:"btn btn-danger",title:"Delete all commands"},[...w[15]||(w[15]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,ss)])]))),128))])]),e("div",ns,[e("button",{onClick:w[2]||(w[2]=z=>b.value=!1),class:"btn btn-secondary"}," Close ")])])])):O("",!0),o.value?(n(),r("div",{key:1,class:"modal-overlay",onClick:w[6]||(w[6]=ae(z=>o.value=!1,["self"]))},[e("div",as,[e("div",is,[w[18]||(w[18]=e("h2",null,"Delete Untracked Device",-1)),e("button",{onClick:w[4]||(w[4]=z=>o.value=!1),class:"close-btn"},[...w[17]||(w[17]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",rs,[e("div",ds,[w[20]||(w[20]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[e("p",null,[e("strong",null,'Are you sure you want to delete "'+f((H=d.value)==null?void 0:H.device_name)+'"?',1)]),e("p",null,"This will permanently delete all "+f((G=d.value)==null?void 0:G.command_count)+" command"+f(((S=d.value)==null?void 0:S.command_count)>1?"s":"")+" from Broadlink storage.",1),w[19]||(w[19]=e("p",{class:"warning-text"},"This action cannot be undone.",-1))])])]),e("div",us,[e("button",{onClick:w[5]||(w[5]=z=>o.value=!1),class:"btn btn-secondary",disabled:M.value}," Cancel ",8,cs),e("button",{onClick:P,class:"btn btn-danger",disabled:M.value},[e("i",{class:Z(["mdi",M.value?"mdi-loading mdi-spin":"mdi-delete"])},null,2),I(" "+f(M.value?"Deleting...":"Delete"),1)],8,ms)])])])):O("",!0)])):O("",!0)}}},ps=ue(vs,[["__scopeId","data-v-24463050"]]),fs={class:"device-list-card"},gs={class:"card-header"},ys={class:"header-badges"},bs={class:"header-info"},hs={class:"header-right"},ks=["disabled"],ws={class:"card-body"},$s={key:0,class:"filter-bar"},Cs={class:"filter-row filter-row-search"},_s={class:"filter-group filter-search"},Ss={class:"filter-row filter-row-dropdowns"},Is={class:"filter-group"},xs=["value"],Ds={class:"filter-group"},Ts=["value"],Rs={class:"filter-group"},Ls={key:0,class:"filter-group filter-toggle"},Ms={class:"toggle-label"},Os={class:"filter-results"},Vs={key:1,class:"loading-state"},As={key:2,class:"error-state"},Es={key:3,class:"empty-state"},Ps={key:4,class:"device-grid"},js={key:5,class:"no-results"},Fs={__name:"DeviceList",setup(s){const p=Ye();Te();const a=k(!1),$=k(!1),u=k(null),g=k(!1),b=k(null),o=k(null),d=k(!0),M=k(!1),L=()=>{d.value=!d.value},i=k(!1),l=k({title:"Error",message:"",suggestion:"",details:"",error:null,context:{}}),R=k(!1),P=k({success:!1,title:"",message:""}),h=k({search:"",broadlinkDevice:"",area:"",entityType:"",showSmartIROnly:!1}),w=k([]),H=we("smartirStatus"),G=N(()=>{var t;return localStorage.getItem("smartir_simulate_not_installed")==="true"?!1:((t=H==null?void 0:H.value)==null?void 0:t.installed)||!1}),S=N(()=>{const c=new Map;return p.devices.forEach(t=>{if(t.broadlink_entity){const v=w.value.find(q=>q.entity_id===t.broadlink_entity),_=v&&v.name||t.broadlink_entity;c.set(t.broadlink_entity,{entity_id:t.broadlink_entity,friendly_name:_})}}),Array.from(c.values()).sort((t,v)=>t.friendly_name.localeCompare(v.friendly_name))}),z=N(()=>{const c=new Set;return p.devices.forEach(t=>{t.area&&c.add(t.area)}),Array.from(c).sort()}),K=N(()=>{let c=p.devices;if(h.value.search){const t=h.value.search.toLowerCase();c=c.filter(v=>{var U,X,J,W,re;if((U=v.name)!=null&&U.toLowerCase().includes(t)||(X=v.entity_type)!=null&&X.toLowerCase().includes(t)||(J=v.area)!=null&&J.toLowerCase().includes(t)||(W=v.id)!=null&&W.toLowerCase().includes(t)||Object.keys(v.commands||{}).some(me=>me.toLowerCase().includes(t)))return!0;const q=w.value.find(me=>me.entity_id===v.broadlink_entity);return!!((re=q==null?void 0:q.name)!=null&&re.toLowerCase().includes(t))})}return h.value.broadlinkDevice&&(c=c.filter(t=>t.broadlink_entity===h.value.broadlinkDevice||t.controller_device===h.value.broadlinkDevice)),h.value.area&&(c=c.filter(t=>t.area===h.value.area)),h.value.entityType&&(c=c.filter(t=>t.entity_type===h.value.entityType)),h.value.showSmartIROnly&&(c=c.filter(t=>t.device_type==="smartir")),c}),oe=N(()=>h.value.search||h.value.broadlinkDevice||h.value.area||h.value.entityType||h.value.showSmartIROnly),Y=()=>{h.value.search="",h.value.broadlinkDevice="",h.value.area="",h.value.entityType="",h.value.showSmartIROnly=!1},E=async()=>{try{const c=await se.get("/api/remote/devices");w.value=c.data.devices||[]}catch(c){console.error("Error loading remote devices:",c)}};be(async()=>{await Promise.all([p.loadDevices(),E()])});const m=c=>{u.value=c,a.value=!0},C=N(()=>{if(!b.value)return"";const c=Object.keys(b.value.commands||{}).length;return c===0?"This device has no commands. The device will be removed from tracking.":`This device has ${c} learned command${c>1?"s":""}. What would you like to do?`}),x=N(()=>{if(!b.value)return"";const c=Object.keys(b.value.commands||{}).length;return c===0?"":`Also delete all ${c} command${c>1?"s":""} from Broadlink storage`}),y=c=>{b.value=c,g.value=!0},V=()=>{g.value=!1,b.value=null},ee=async c=>{var v,_;const t=b.value;g.value=!1;try{await p.deleteDevice(t.id,c),o.value&&await o.value.refresh()}catch(q){const U=((_=(v=q.response)==null?void 0:v.data)==null?void 0:_.error)||q.message||"Unknown error";B("Failed to Delete Device",U)}finally{b.value=null}},ve=async c=>{var t,v,_,q,U;try{console.log("ğŸ’¾ Saving device data:",c),console.log("ğŸ’¾ Device commands:",c.commands),console.log("ğŸ’¾ Selected device:",u.value),(t=u.value)!=null&&t.id&&u.value.id!==null?await p.updateDevice(u.value.id,c):await p.createDevice(c),he(),o.value&&await o.value.refresh()}catch(X){let J="Failed to save device",W="",re="";(_=(v=X.response)==null?void 0:v.data)!=null&&_.error?(J=X.response.data.error,W=X.response.data.suggestion||""):X.message&&(J=X.message),X.response&&(re=`Status: ${X.response.status}
URL: ${((q=X.config)==null?void 0:q.url)||"N/A"}`),B("Failed to Save Device",J,W,re,X,{action:"save_device",deviceData:c,isEdit:!!((U=u.value)!=null&&U.id)})}},he=()=>{a.value=!1,u.value=null},Se=c=>{u.value=c,$.value=!0},Ce=()=>{$.value=!1,u.value=null},B=(c,t,v="",_="",q=null,U={})=>{l.value={title:c,message:t,suggestion:v,details:_,error:q,context:U},i.value=!0},D=()=>{i.value=!1},A=()=>{R.value=!1},T=async c=>{if(c&&c.commands&&u.value){const t=p.devices.findIndex(v=>v.id===u.value.id);t!==-1&&(p.devices[t].commands=c.commands,console.log(`Optimistically updated device ${u.value.id} with new command: ${c.commandName}`))}p.loadDevices(),o.value&&o.value.refresh()},F=c=>{const t=c.split("_"),v=[];for(let _=0;_<t.length;_++){const q=t[_],U=t[_+1];q&&U==="s"&&t[_+2]?(v.push(q.charAt(0).toUpperCase()+q.slice(1)+"'s"),_++):q!=="s"&&v.push(q.charAt(0).toUpperCase()+q.slice(1))}return v.join(" ")},te=(c,t)=>{const v=c.toLowerCase(),_=t.map(J=>J.toLowerCase());return v.includes("lamp")||v.includes("light")?"light":v.includes("fan")?"fan":v.includes("tv")||v.includes("stereo")||v.includes("speaker")||v.includes("receiver")?"media_player":v.includes("blind")||v.includes("curtain")||v.includes("shade")||v.includes("garage")?"cover":_.some(J=>J.includes("volume")||J.includes("channel")||J.includes("play")||J.includes("pause")||J.includes("mute"))?"media_player":_.some(J=>J.includes("fan_speed")||J.includes("fan_low")||J.includes("fan_high"))?"fan":_.some(J=>J.includes("open")||J.includes("close")||J.includes("stop"))?"cover":"switch"},ce=(c,t)=>{const v=c.toLowerCase();return v.includes("tv")?"mdi:television":v.includes("stereo")||v.includes("receiver")||v.includes("speaker")?"mdi:speaker":v.includes("lamp")?"mdi:lamp":v.includes("light")?"mdi:lightbulb":v.includes("fan")?"mdi:fan":v.includes("blind")?"mdi:blinds":v.includes("curtain")?"mdi:curtains":v.includes("garage")?"mdi:garage":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:speaker",cover:"mdi:window-shutter"}[t]||"mdi:devices"},ye=c=>{const t=c.toLowerCase().split("_");for(let q=0;q<t.length-2;q++)if(t[q+1]==="s"){const U=t.slice(q,q+3),X=F(U.join("_"));return console.log("Detected possessive area:",X,"from",c),X}const v=[["living","room"],["dining","room"],["master","bedroom"],["guest","bedroom"],["family","room"],["laundry","room"],["home","office"]];for(let q=0;q<t.length-1;q++){const U=[t[q],t[q+1]],X=v.find(J=>J[0]===U[0]&&J[1]===U[1]);if(X)return F(X.join("_"))}const _=["kitchen","bedroom","bathroom","garage","office","basement","attic","hallway","entryway","patio","deck","yard","garden"];for(const q of t)if(_.includes(q))return q.charAt(0).toUpperCase()+q.slice(1);return""},ke=async c=>{const t=F(c.device_name),v=ye(c.device_name),_=te(c.device_name,c.commands),q=ce(c.device_name,_);let U="";try{console.log("Finding Broadlink owner for:",c.device_name);const J=await se.post("/api/devices/find-broadlink-owner",{device_name:c.device_name});console.log("Broadlink owner response:",J.data),U=J.data.broadlink_entity||"",console.log("Detected Broadlink entity:",U)}catch(J){console.error("Error finding Broadlink owner:",J)}u.value={id:null,device:c.device_name,name:t,entity_type:_,commands:{},area:v,icon:q,broadlink_entity:U,enabled:!0};const X={};c.commands.forEach(J=>{X[J]=J}),u.value.commands=X,a.value=!0},ge=async()=>{var c,t;M.value=!0;try{const v=await se.post("/api/entities/generate",{});if(v.data.success){const _=v.data.broadlink_count||0,q=v.data.smartir_count||0,U=v.data.total_count||0,X=v.data.errors||[];let J="âœ… Entity Generation Successful",W=[];const re=[];_>0&&re.push(`${_} Broadlink native`),q>0&&re.push(`${q} SmartIR`),re.length>0&&W.push(`Generated ${re.join(" and ")} entity configuration${U!==1?"s":""}.`),_>0&&(W.push(`
ğŸ“ Broadlink entities created in:`),W.push("  â€¢ broadlink_manager/entities.yaml"),W.push("  â€¢ broadlink_manager/helpers.yaml")),q>0&&(W.push(`
ğŸ“ SmartIR entities created in:`),W.push("  â€¢ smartir/climate.yaml"),W.push("  â€¢ smartir/media_player.yaml"),W.push("  â€¢ smartir/fan.yaml")),W.push(`
ğŸ“ Next steps:`),W.push("1. Check your configuration.yaml includes the generated files"),W.push("2. Restart Home Assistant to load the new entities"),X.length>0&&(J="âš ï¸ Entity Generation Completed with Errors",W.push(`
âš ï¸ ${X.length} error${X.length!==1?"s":""} occurred:`),X.forEach(me=>{W.push(`  â€¢ ${me}`)})),P.value={success:!0,title:J,message:W.join(`
`)},R.value=!0}else P.value={success:!1,title:"âŒ Entity Generation Failed",message:v.data.message||`Failed to generate entities.

Please check that you have at least one device configured.`},R.value=!0}catch(v){console.error("Error generating entities:",v);const _=((t=(c=v.response)==null?void 0:c.data)==null?void 0:t.error)||v.message||"Unknown error occurred";P.value={success:!1,title:"âŒ Entity Generation Error",message:`Failed to generate entities:

${_}

Please check the logs for more details.`},R.value=!0}finally{M.value=!1}};return(c,t)=>{var v;return n(),r("div",fs,[e("div",gs,[e("button",{class:"icon-button chevron-button",onClick:L},[e("i",{class:Z(["mdi",d.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2)]),e("div",{class:"header-left",onClick:L},[t[8]||(t[8]=e("div",{class:"header-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),t[9]||(t[9]=e("h3",null,"Managed Devices",-1)),e("div",ys,[e("span",bs,f($e(p).deviceCount)+" devices",1)])]),e("div",hs,[d.value?(n(),r("button",{key:0,onClick:ae(ge,["stop"]),class:"btn btn-secondary",disabled:M.value},[e("i",{class:Z(["mdi",M.value?"mdi-loading mdi-spin":"mdi-file-code"])},null,2),I(" "+f(M.value?"Generating...":"Generate Entities"),1)],8,ks)):O("",!0),d.value?(n(),r("button",{key:1,onClick:t[0]||(t[0]=ae(_=>a.value=!0,["stop"])),class:"btn btn-primary"},[...t[10]||(t[10]=[e("i",{class:"mdi mdi-plus"},null,-1),I(" Add Device ",-1)])])):O("",!0)])]),j(e("div",ws,[le(ps,{ref_key:"discoveryRef",ref:o,onAdopt:ke},null,512),$e(p).hasDevices?(n(),r("div",$s,[e("div",Cs,[e("div",_s,[e("label",null,[t[11]||(t[11]=e("i",{class:"mdi mdi-magnify"},null,-1)),j(e("input",{"onUpdate:modelValue":t[1]||(t[1]=_=>h.value.search=_),type:"text",placeholder:"Search devices, commands...",class:"search-input"},null,512),[[pe,h.value.search]])])])]),e("div",Ss,[e("div",Is,[e("label",null,[t[13]||(t[13]=e("i",{class:"mdi mdi-access-point"},null,-1)),j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=_=>h.value.broadlinkDevice=_)},[t[12]||(t[12]=e("option",{value:""},"All Controller Devices",-1)),(n(!0),r(ne,null,de(S.value,_=>(n(),r("option",{key:_.entity_id,value:_.entity_id},f(_.friendly_name),9,xs))),128))],512),[[fe,h.value.broadlinkDevice]])])]),e("div",Ds,[e("label",null,[t[15]||(t[15]=e("i",{class:"mdi mdi-home-map-marker"},null,-1)),j(e("select",{"onUpdate:modelValue":t[3]||(t[3]=_=>h.value.area=_)},[t[14]||(t[14]=e("option",{value:""},"All Areas",-1)),(n(!0),r(ne,null,de(z.value,_=>(n(),r("option",{key:_,value:_},f(_),9,Ts))),128))],512),[[fe,h.value.area]])])]),e("div",Rs,[e("label",null,[t[17]||(t[17]=e("i",{class:"mdi mdi-shape"},null,-1)),j(e("select",{"onUpdate:modelValue":t[4]||(t[4]=_=>h.value.entityType=_)},[...t[16]||(t[16]=[Ie('<option value="" data-v-3791b269>All Types</option><option value="light" data-v-3791b269>Light</option><option value="fan" data-v-3791b269>Fan</option><option value="switch" data-v-3791b269>Switch</option><option value="media_player" data-v-3791b269>Media Player</option><option value="cover" data-v-3791b269>Cover</option><option value="climate" data-v-3791b269>Climate</option>',7)])],512),[[fe,h.value.entityType]])])]),G.value?(n(),r("div",Ls,[e("label",Ms,[t[18]||(t[18]=e("span",{class:"toggle-text"},[e("img",{src:Ve,alt:"SmartIR",class:"smartir-icon"}),I(" SmartIR Only ")],-1)),j(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=_=>h.value.showSmartIROnly=_),class:"toggle-checkbox"},null,512),[[Q,h.value.showSmartIROnly]]),t[19]||(t[19]=e("span",{class:"toggle-slider"},null,-1))])])):O("",!0),oe.value?(n(),r("button",{key:1,onClick:Y,class:"btn-clear-filters"},[...t[20]||(t[20]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),I(" Clear ",-1)])])):O("",!0),e("div",Os,f(K.value.length)+" of "+f($e(p).deviceCount),1)])])):O("",!0),$e(p).loading?(n(),r("div",Vs,[...t[21]||(t[21]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading devices...",-1)])])):$e(p).error?(n(),r("div",As,[t[22]||(t[22]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,f($e(p).error),1),e("button",{onClick:t[6]||(t[6]=_=>$e(p).loadDevices()),class:"btn btn-secondary"}," Retry ")])):$e(p).hasDevices?(n(),r("div",Ps,[(n(!0),r(ne,null,de(K.value,_=>(n(),De(kt,{key:_.id,device:_,onEdit:m,onDelete:y,onLearn:Se},null,8,["device"]))),128))])):(n(),r("div",Es,[t[24]||(t[24]=e("i",{class:"mdi mdi-devices"},null,-1)),t[25]||(t[25]=e("h3",null,"No Devices Yet",-1)),t[26]||(t[26]=e("p",null,"Get started by adding your first managed device",-1)),e("button",{onClick:t[7]||(t[7]=_=>a.value=!0),class:"btn btn-primary"},[...t[23]||(t[23]=[e("i",{class:"mdi mdi-plus"},null,-1),I(" Add Your First Device ",-1)])])])),$e(p).hasDevices&&K.value.length===0?(n(),r("div",js,[...t[27]||(t[27]=[e("i",{class:"mdi mdi-filter-off"},null,-1),e("h3",null,"No devices match your filters",-1),e("p",null,"Try adjusting your search or filter criteria",-1)])])):O("",!0)],512),[[Ne,d.value]]),a.value?(n(),De(Bo,{key:0,device:u.value,onSave:ve,onCancel:he},null,8,["device"])):O("",!0),$.value?(n(),De(Ol,{key:1,device:u.value,onLearned:T,onCancel:Ce},null,8,["device"])):O("",!0),le(_e,{isOpen:g.value,title:`Delete ${(v=b.value)==null?void 0:v.name}?`,message:C.value,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,checkboxLabel:x.value,onConfirm:ee,onCancel:V},null,8,["isOpen","title","message","checkboxLabel"]),le(zl,{isOpen:i.value,title:l.value.title,message:l.value.message,suggestion:l.value.suggestion,details:l.value.details,error:l.value.error,context:l.value.context,onClose:D},null,8,["isOpen","title","message","suggestion","details","error","context"]),le(_e,{isOpen:R.value,title:P.value.title,message:P.value.message,confirmText:"OK",showCancel:!1,dangerMode:!P.value.success,onConfirm:A,onCancel:A},null,8,["isOpen","title","message","dangerMode"])])}}},Us=ue(Fs,[["__scopeId","data-v-3791b269"]]),Ns={class:"banner-content"},Bs={class:"banner-icon"},qs={class:"banner-message"},Hs={class:"banner-actions"},zs={__name:"SmartIRBanner",setup(s){const p=we("smartirStatus"),a=k(!1),$=N(()=>!(!p.value||a.value||localStorage.getItem("smartir_banner_dismissed")==="true")),u=N(()=>{var L;return(L=p.value)!=null&&L.installed?"banner-success":"banner-info"}),g=N(()=>{var L;return(L=p.value)!=null&&L.installed?"mdi mdi-check-circle":"mdi mdi-information"}),b=N(()=>{var L;return(L=p.value)!=null&&L.installed?`SmartIR Detected (v${p.value.version})`:"Want Climate Device Support?"}),o=N(()=>{var L;return(L=p.value)!=null&&L.installed?"You can now create climate device profiles with full temperature and HVAC mode control.":"Install SmartIR to unlock AC/heater control with temperature settings, HVAC modes, and 120+ pre-configured device profiles."});function d(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function M(){var L;if(a.value=!0,(L=p.value)!=null&&L.installed)localStorage.setItem("smartir_banner_dismissed","true");else{const i=parseInt(localStorage.getItem("smartir_banner_dismiss_count")||"0");i>=2?localStorage.setItem("smartir_banner_dismissed","true"):localStorage.setItem("smartir_banner_dismiss_count",String(i+1))}}return be(()=>{var l;const L=localStorage.getItem("smartir_last_status"),i=(l=p.value)!=null&&l.installed?"installed":"not_installed";L!==i&&(localStorage.removeItem("smartir_banner_dismissed"),localStorage.removeItem("smartir_banner_dismiss_count"),localStorage.setItem("smartir_last_status",i))}),(L,i)=>{var l,R;return $.value?(n(),r("div",{key:0,class:Z(["smartir-banner",u.value])},[e("div",Ns,[e("div",Bs,[e("i",{class:Z(g.value)},null,2)]),e("div",qs,[e("strong",null,f(b.value),1),e("p",null,f(o.value),1)]),e("div",Hs,[(l=L.status)!=null&&l.installed?O("",!0):(n(),r("button",{key:0,onClick:d,class:"btn-primary"}," Learn More ")),e("button",{onClick:M,class:"btn-text"},f((R=L.status)!=null&&R.installed?"Got it":"Dismiss"),1)])])],2)):O("",!0)}}},Js=ue(zs,[["__scopeId","data-v-2fd571d2"]]),xe="api/smartir",Be={async getStatus(){try{const s=await fetch(`${xe}/status`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){return console.error("Error fetching SmartIR status:",s),{installed:!1,version:null,error:s.message}}},async getInstallInstructions(){try{const s=await fetch(`${xe}/install-instructions`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){throw console.error("Error fetching install instructions:",s),s}},async getPlatforms(){try{const s=await fetch(`${xe}/platforms`);if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(s){throw console.error("Error fetching platforms:",s),s}},async getPlatformCodes(s){try{const p=await fetch(`${xe}/platforms/${s}/codes`);if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);return await p.json()}catch(p){throw console.error(`Error fetching codes for ${s}:`,p),p}},async getNextCode(s){try{const p=await fetch(`${xe}/platforms/${s}/next-code`);if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);return await p.json()}catch(p){throw console.error(`Error fetching next code for ${s}:`,p),p}},async validateCode(s,p){try{const a=await fetch(`${xe}/validate-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:s,code:p})});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return await a.json()}catch(a){throw console.error("Error validating code:",a),a}}},Ws={class:"smartir-status-card"},Xs={class:"card-header"},Gs=["src"],Ks={class:"header-badges"},Ys=["title"],Zs={class:"header-info"},Qs={class:"header-info"},en={class:"header-info"},tn={class:"header-right"},on={key:0,class:"card-body loading-state"},ln={key:1,class:"card-body error-state"},sn={key:2,class:"card-body installed-state"},nn={key:0,class:"help-panel"},an={key:0,class:"recommendation"},rn={key:0,class:"next-steps"},dn={key:1,class:"filter-bar"},un={class:"filter-row"},cn={class:"filter-group filter-search"},mn={class:"filter-group"},vn={class:"filter-results"},pn={key:2,class:"loading-state"},fn={key:3,class:"empty-state"},gn={key:4,class:"profiles-grid"},yn={class:"profile-card-header"},bn={class:"profile-icon"},hn={class:"profile-details"},kn={class:"profile-meta"},wn={class:"platform-badge"},$n={class:"code-badge"},Cn={key:0,class:"command-count"},_n={class:"profile-card-actions"},Sn=["onClick"],In=["onClick"],xn=["onClick"],Dn={key:5,class:"no-results"},Tn={key:3,class:"card-body not-installed-state"},Rn={class:"benefits-section"},Ln={class:"benefits-list"},Mn={class:"recommendation"},On={__name:"SmartIRStatusCard",emits:["create-profile","show-install-guide","edit-profile"],setup(s,{emit:p}){const a=p,$=we("smartirStatus"),u=we("refreshSmartIR"),g=k(!1),b=k(null),o=k(($==null?void 0:$.value)||null),d=k(localStorage.getItem("smartir_simulate_not_installed")==="true"),M=k(!1),L=k(!0),i=k([]),l=k(!1),R=k({search:"",platform:""}),P=k({show:!1,title:"",message:"",platform:null,profile:null}),h=["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"],w=["climate","media_player","fan","light"],H=N(()=>d.value?{installed:!1,recommendation:{message:"Install SmartIR to unlock climate device support!",benefits:["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"]}}:o.value),G=N(()=>{var B,D;return((D=(B=H.value)==null?void 0:B.platforms)==null?void 0:D.length)||0}),S=N(()=>{var B;return(B=H.value)!=null&&B.device_counts?Object.values(H.value.device_counts).reduce((D,A)=>D+A,0):0});function z(){var B;d.value=!d.value,localStorage.setItem("smartir_simulate_not_installed",d.value.toString()),!d.value&&((B=o.value)!=null&&B.installed)&&ee()}const K=N(()=>{let B=i.value;if(R.value.search){const D=R.value.search.toLowerCase();B=B.filter(A=>{var T,F,te,ce;return((T=A.manufacturer)==null?void 0:T.toLowerCase().includes(D))||((F=A.model)==null?void 0:F.toLowerCase().includes(D))||((te=A.code)==null?void 0:te.toString().includes(D))||((ce=A.platform)==null?void 0:ce.toLowerCase().includes(D))})}return R.value.platform&&(B=B.filter(D=>D.platform===R.value.platform)),B}),oe=N(()=>R.value.search||R.value.platform);function Y(){R.value.search="",R.value.platform=""}function E(B){return{climate:"mdi mdi-air-conditioner",media_player:"mdi mdi-television",fan:"mdi mdi-fan",light:"mdi mdi-lightbulb"}[B]||"mdi mdi-devices"}function m(B){return B.split("_").map(D=>D.charAt(0).toUpperCase()+D.slice(1)).join(" ")}async function C(){g.value=!0,b.value=null;try{if(u)await u();else{const B=await Be.getStatus();o.value=B}}catch(B){b.value=B.message||"Failed to refresh SmartIR status",console.error("Error refreshing SmartIR status:",B)}finally{g.value=!1}}function x(){a("create-profile")}function y(){a("show-install-guide")}function V(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}async function ee(){l.value=!0;const B=[];try{for(const D of w)try{const A=await fetch(`api/smartir/platforms/${D}/profiles`);if(A.ok){const F=((await A.json()).profiles||[]).map(te=>({...te,platform:D}));B.push(...F)}}catch(A){console.error(`Error loading ${D} profiles:`,A)}i.value=B}finally{l.value=!1}}function ve(B,D){a("edit-profile",{platform:B,profile:D})}async function he(B,D){var A,T;try{const F=await fetch(`api/smartir/platforms/${B}/profiles/${D.code}`);if(!F.ok)throw new Error("Failed to fetch profile");const te=await F.json(),ce=JSON.stringify(te.profile,null,2),ye=new Blob([ce],{type:"application/json"}),ke=URL.createObjectURL(ye),ge=document.createElement("a");ge.href=ke,ge.download=`smartir_${B}_${D.manufacturer}_${D.model}_${D.code}.json`,document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(ke),(A=we("toast").value)==null||A.success(`Downloaded ${D.manufacturer} ${D.model}`,"âœ… Profile Downloaded")}catch(F){console.error("Error downloading profile:",F),(T=we("toast").value)==null||T.error("Failed to download profile","âŒ Download Error")}}function Se(B,D){P.value={show:!0,title:`Delete ${D.manufacturer} ${D.model}?`,message:`Device Code: ${D.code}

This will remove the profile and update your configuration.`,platform:B,profile:D}}async function Ce(){var T,F,te;const B=we("toast"),{platform:D,profile:A}=P.value;P.value.show=!1;try{const ce=await fetch(`api/smartir/profiles/${A.code}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:D})});if(ce.ok)await ee(),await Fe(),await C(),(T=B.value)==null||T.success(`${A.manufacturer} ${A.model} has been removed`,"âœ… Profile Deleted");else{const ye=await ce.json();(F=B.value)==null||F.error(ye.error||"Unknown error","âŒ Delete Failed")}}catch(ce){console.error("Error deleting profile:",ce),(te=B.value)==null||te.error("Failed to delete profile","âŒ Delete Error")}}return ie($,B=>{B&&(o.value=B)},{immediate:!0}),be(async()=>{var B;$!=null&&$.value&&(o.value=$.value),o.value||await C(),(B=o.value)!=null&&B.installed&&await ee()}),(B,D)=>{var A,T,F,te,ce,ye,ke,ge,c;return n(),r("div",Ws,[e("div",Xs,[e("button",{class:"icon-button chevron-button",onClick:D[0]||(D[0]=t=>L.value=!L.value)},[e("i",{class:Z(["mdi",L.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2)]),e("div",{class:"header-left",onClick:D[1]||(D[1]=t=>L.value=!L.value)},[e("img",{src:$e(Ve),alt:"SmartIR",class:"smartir-logo"},null,8,Gs),D[7]||(D[7]=e("h3",null,"SmartIR Integration",-1)),e("div",Ks,[e("div",{class:Z(["simulation-toggle-pill",{active:d.value}]),onClick:ae(z,["stop"]),title:d.value?"Click to show as installed":"Click to simulate not-installed"},[e("i",{class:Z(["mdi",d.value?"mdi-eye-off":"mdi-eye"])},null,2),e("span",null,f(d.value?"Simulating: Not Installed":"Simulation Mode"),1)],10,Ys),(A=H.value)!=null&&A.installed?(n(),r(ne,{key:0},[D[6]||(D[6]=e("div",{class:"status-badge-mini success"},[e("i",{class:"mdi mdi-check-circle"}),e("span",null,"Installed")],-1)),e("span",Zs,"v"+f(H.value.version||"Unknown"),1),e("span",Qs,f(G.value)+" platform"+f(G.value!==1?"s":""),1),e("span",en,f(S.value)+" device"+f(S.value!==1?"s":""),1)],64)):O("",!0)])]),e("div",tn,[(T=o.value)!=null&&T.installed&&L.value?(n(),r("button",{key:0,onClick:D[2]||(D[2]=ae(t=>M.value=!M.value,["stop"])),class:Z(["icon-button",{active:M.value}]),title:"Show help"},[...D[8]||(D[8]=[e("i",{class:"mdi mdi-help-circle"},null,-1)])],2)):O("",!0),(F=o.value)!=null&&F.installed&&L.value?(n(),r("button",{key:1,onClick:ae(C,["stop"]),class:"icon-button",title:"Refresh status"},[...D[9]||(D[9]=[e("i",{class:"mdi mdi-refresh"},null,-1)])])):O("",!0),(te=o.value)!=null&&te.installed&&L.value?(n(),r("button",{key:2,onClick:ae(x,["stop"]),class:"btn btn-primary"},[...D[10]||(D[10]=[e("i",{class:"mdi mdi-plus"},null,-1),I(" Create SmartIR Profile ",-1)])])):O("",!0)])]),j(e("div",null,[g.value?(n(),r("div",on,[...D[11]||(D[11]=[e("div",{class:"spinner"},null,-1),e("p",null,"Checking SmartIR installation...",-1)])])):b.value?(n(),r("div",ln,[D[12]||(D[12]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,f(b.value),1),e("button",{onClick:C,class:"btn-secondary"}," Try Again ")])):(ce=H.value)!=null&&ce.installed?(n(),r("div",sn,[M.value?(n(),r("div",nn,[o.value.recommendation?(n(),r("div",an,[e("p",null,f(o.value.recommendation.message),1),o.value.recommendation.next_steps?(n(),r("div",rn,[D[13]||(D[13]=e("strong",null,"Next Steps:",-1)),e("ul",null,[(n(!0),r(ne,null,de(o.value.recommendation.next_steps,(t,v)=>(n(),r("li",{key:v},f(t),1))),128))])])):O("",!0)])):O("",!0),e("div",{class:"help-actions"},[e("button",{onClick:V,class:"btn-secondary"},[...D[14]||(D[14]=[e("i",{class:"mdi mdi-book-open-variant"},null,-1),I(" View Documentation ",-1)])])])])):O("",!0),i.value.length>0&&!d.value?(n(),r("div",dn,[e("div",un,[e("div",cn,[e("label",null,[D[15]||(D[15]=e("i",{class:"mdi mdi-magnify"},null,-1)),j(e("input",{"onUpdate:modelValue":D[3]||(D[3]=t=>R.value.search=t),type:"text",placeholder:"Search profiles...",class:"search-input"},null,512),[[pe,R.value.search]])])]),e("div",mn,[e("label",null,[D[17]||(D[17]=e("i",{class:"mdi mdi-shape"},null,-1)),j(e("select",{"onUpdate:modelValue":D[4]||(D[4]=t=>R.value.platform=t)},[...D[16]||(D[16]=[Ie('<option value="" data-v-266d8a3b>All Platforms</option><option value="climate" data-v-266d8a3b>Climate</option><option value="media_player" data-v-266d8a3b>Media Player</option><option value="fan" data-v-266d8a3b>Fan</option><option value="light" data-v-266d8a3b>Light</option>',5)])],512),[[fe,R.value.platform]])])]),oe.value?(n(),r("button",{key:0,onClick:Y,class:"btn-clear-filters"},[...D[18]||(D[18]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),I(" Clear ",-1)])])):O("",!0),e("div",vn,f(K.value.length)+" of "+f(i.value.length),1)])])):O("",!0),l.value?(n(),r("div",pn,[...D[19]||(D[19]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading profiles...",-1)])])):i.value.length===0?(n(),r("div",fn,[...D[20]||(D[20]=[e("i",{class:"mdi mdi-file-document-outline"},null,-1),e("h3",null,"No Profiles Yet",-1),e("p",null,"Create your first SmartIR profile to get started",-1)])])):d.value?O("",!0):(n(),r("div",gn,[(n(!0),r(ne,null,de(K.value,t=>(n(),r("div",{key:`${t.platform}-${t.code}`,class:"profile-card"},[e("div",yn,[e("div",bn,[e("i",{class:Z(E(t.platform))},null,2)]),e("div",hn,[e("h4",null,f(t.manufacturer)+" "+f(t.model),1),e("div",kn,[e("span",wn,[e("i",{class:Z(E(t.platform))},null,2),I(" "+f(m(t.platform)),1)]),e("span",$n,"Code: "+f(t.code),1),t.commandCount?(n(),r("span",Cn,[D[21]||(D[21]=e("i",{class:"mdi mdi-remote"},null,-1)),I(" "+f(t.commandCount)+" command"+f(t.commandCount!==1?"s":""),1)])):O("",!0)])])]),e("div",_n,[e("button",{onClick:v=>ve(t.platform,t),class:"action-btn",title:"Edit"},[...D[22]||(D[22]=[e("i",{class:"mdi mdi-pencil"},null,-1)])],8,Sn),e("button",{onClick:v=>he(t.platform,t),class:"action-btn",title:"Download"},[...D[23]||(D[23]=[e("i",{class:"mdi mdi-download"},null,-1)])],8,In),e("button",{onClick:v=>Se(t.platform,t),class:"action-btn delete",title:"Delete"},[...D[24]||(D[24]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,xn)])]))),128))])),i.value.length>0&&K.value.length===0&&!d.value?(n(),r("div",Dn,[...D[25]||(D[25]=[e("i",{class:"mdi mdi-filter-off"},null,-1),e("h3",null,"No profiles match your filters",-1),e("p",null,"Try adjusting your search or filter criteria",-1)])])):O("",!0)])):(n(),r("div",Tn,[D[30]||(D[30]=e("div",{class:"status-badge warning"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Not Installed")],-1)),e("div",Rn,[D[27]||(D[27]=e("h4",null,"Why Install SmartIR?",-1)),e("ul",Ln,[(n(!0),r(ne,null,de(((ke=(ye=o.value)==null?void 0:ye.recommendation)==null?void 0:ke.benefits)||h,(t,v)=>(n(),r("li",{key:v},[D[26]||(D[26]=e("i",{class:"mdi mdi-check"},null,-1)),e("span",null,f(t),1)]))),128))])]),e("div",Mn,[e("p",null,f(((c=(ge=o.value)==null?void 0:ge.recommendation)==null?void 0:c.message)||"Install SmartIR to unlock climate device support!"),1)]),e("div",{class:"card-actions"},[e("button",{onClick:y,class:"btn-primary"},[...D[28]||(D[28]=[e("i",{class:"mdi mdi-download"},null,-1),I(" Install SmartIR ",-1)])]),e("button",{onClick:V,class:"btn-secondary"},[...D[29]||(D[29]=[e("i",{class:"mdi mdi-help-circle"},null,-1),I(" Learn More ",-1)])])])]))],512),[[Ne,L.value]]),le(_e,{isOpen:P.value.show,title:P.value.title,message:P.value.message,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:Ce,onCancel:D[5]||(D[5]=t=>P.value.show=!1)},null,8,["isOpen","title","message"])])}}},Vn=ue(On,[["__scopeId","data-v-266d8a3b"]]),An={class:"climate-form"},En={class:"form-section"},Pn={class:"form-row"},jn={class:"form-group"},Fn={class:"form-group"},Un={class:"form-group"},Nn={class:"form-section"},Bn={class:"checkbox-grid"},qn={class:"checkbox-item"},Hn={class:"checkbox-item"},zn={class:"checkbox-item"},Jn={class:"checkbox-item"},Wn={class:"checkbox-item"},Xn={class:"checkbox-item"},Gn={class:"form-section"},Kn={class:"checkbox-grid"},Yn={class:"checkbox-item"},Zn={class:"checkbox-item"},Qn={class:"checkbox-item"},ea={class:"checkbox-item"},ta={class:"form-section"},oa={class:"checkbox-grid"},la={class:"checkbox-item"},sa={class:"checkbox-item"},na={class:"checkbox-item"},aa={class:"checkbox-item"},ia={class:"form-section"},ra={class:"form-group"},da={class:"form-group"},ua={class:"form-group"},ca={key:0,class:"validation-summary"},ma={__name:"ClimateProfileForm",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(s,{emit:p}){const a=s,$=p,u=k({minTemp:16,maxTemp:30,precision:1,modes:["off","auto","cool","heat"],fanModes:["auto","low","medium","high"],swingModes:[],tempSensor:"",humiditySensor:"",powerSensor:"",...a.modelValue}),g=N(()=>{const b=[];return(!u.value.minTemp||u.value.minTemp<10||u.value.minTemp>35)&&b.push("Minimum temperature must be between 10Â°C and 35Â°C"),(!u.value.maxTemp||u.value.maxTemp<10||u.value.maxTemp>35)&&b.push("Maximum temperature must be between 10Â°C and 35Â°C"),u.value.minTemp>=u.value.maxTemp&&b.push("Minimum temperature must be less than maximum temperature"),(!u.value.modes||u.value.modes.length===0)&&b.push("At least one HVAC mode must be selected"),b});return ie(u,b=>{$("update:modelValue",b)},{deep:!0}),(b,o)=>(n(),r("div",An,[o[54]||(o[54]=e("h3",null,"Climate Device Configuration",-1)),e("div",En,[o[24]||(o[24]=e("h4",null,"Temperature Range",-1)),e("div",Pn,[e("div",jn,[o[20]||(o[20]=e("label",null,"Minimum Temperature (Â°C) *",-1)),j(e("input",{"onUpdate:modelValue":o[0]||(o[0]=d=>u.value.minTemp=d),type:"number",min:"10",max:"35",placeholder:"16"},null,512),[[pe,u.value.minTemp,void 0,{number:!0}]])]),e("div",Fn,[o[21]||(o[21]=e("label",null,"Maximum Temperature (Â°C) *",-1)),j(e("input",{"onUpdate:modelValue":o[1]||(o[1]=d=>u.value.maxTemp=d),type:"number",min:"10",max:"35",placeholder:"30"},null,512),[[pe,u.value.maxTemp,void 0,{number:!0}]])]),e("div",Un,[o[23]||(o[23]=e("label",null,"Precision",-1)),j(e("select",{"onUpdate:modelValue":o[2]||(o[2]=d=>u.value.precision=d)},[...o[22]||(o[22]=[e("option",{value:1},"1Â°C (Whole degrees)",-1),e("option",{value:.5},"0.5Â°C (Half degrees)",-1)])],512),[[fe,u.value.precision,void 0,{number:!0}]])])])]),e("div",Nn,[o[31]||(o[31]=e("h4",null,"Supported HVAC Modes *",-1)),o[32]||(o[32]=e("p",{class:"help-text"},"Select all modes your device supports",-1)),e("div",Bn,[e("label",qn,[j(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":o[3]||(o[3]=d=>u.value.modes=d)},null,512),[[Q,u.value.modes]]),o[25]||(o[25]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),I(" Off ")],-1))]),e("label",Hn,[j(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":o[4]||(o[4]=d=>u.value.modes=d)},null,512),[[Q,u.value.modes]]),o[26]||(o[26]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),I(" Auto ")],-1))]),e("label",zn,[j(e("input",{type:"checkbox",value:"cool","onUpdate:modelValue":o[5]||(o[5]=d=>u.value.modes=d)},null,512),[[Q,u.value.modes]]),o[27]||(o[27]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-snowflake"}),I(" Cool ")],-1))]),e("label",Jn,[j(e("input",{type:"checkbox",value:"heat","onUpdate:modelValue":o[6]||(o[6]=d=>u.value.modes=d)},null,512),[[Q,u.value.modes]]),o[28]||(o[28]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fire"}),I(" Heat ")],-1))]),e("label",Wn,[j(e("input",{type:"checkbox",value:"dry","onUpdate:modelValue":o[7]||(o[7]=d=>u.value.modes=d)},null,512),[[Q,u.value.modes]]),o[29]||(o[29]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-water-percent"}),I(" Dry ")],-1))]),e("label",Xn,[j(e("input",{type:"checkbox",value:"fan_only","onUpdate:modelValue":o[8]||(o[8]=d=>u.value.modes=d)},null,512),[[Q,u.value.modes]]),o[30]||(o[30]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan"}),I(" Fan Only ")],-1))])])]),e("div",Gn,[o[37]||(o[37]=e("h4",null,"Fan Modes",-1)),o[38]||(o[38]=e("p",{class:"help-text"},"Select all fan speeds your device supports",-1)),e("div",Kn,[e("label",Yn,[j(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":o[9]||(o[9]=d=>u.value.fanModes=d)},null,512),[[Q,u.value.fanModes]]),o[33]||(o[33]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),I(" Auto ")],-1))]),e("label",Zn,[j(e("input",{type:"checkbox",value:"low","onUpdate:modelValue":o[10]||(o[10]=d=>u.value.fanModes=d)},null,512),[[Q,u.value.fanModes]]),o[34]||(o[34]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-1"}),I(" Low ")],-1))]),e("label",Qn,[j(e("input",{type:"checkbox",value:"medium","onUpdate:modelValue":o[11]||(o[11]=d=>u.value.fanModes=d)},null,512),[[Q,u.value.fanModes]]),o[35]||(o[35]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-2"}),I(" Medium ")],-1))]),e("label",ea,[j(e("input",{type:"checkbox",value:"high","onUpdate:modelValue":o[12]||(o[12]=d=>u.value.fanModes=d)},null,512),[[Q,u.value.fanModes]]),o[36]||(o[36]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-3"}),I(" High ")],-1))])])]),e("div",ta,[o[43]||(o[43]=e("h4",null,"Swing Modes (Optional)",-1)),o[44]||(o[44]=e("p",{class:"help-text"},"Select if your device has swing/oscillation",-1)),e("div",oa,[e("label",la,[j(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":o[13]||(o[13]=d=>u.value.swingModes=d)},null,512),[[Q,u.value.swingModes]]),o[39]||(o[39]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),I(" Off ")],-1))]),e("label",sa,[j(e("input",{type:"checkbox",value:"vertical","onUpdate:modelValue":o[14]||(o[14]=d=>u.value.swingModes=d)},null,512),[[Q,u.value.swingModes]]),o[40]||(o[40]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-vertical"}),I(" Vertical ")],-1))]),e("label",na,[j(e("input",{type:"checkbox",value:"horizontal","onUpdate:modelValue":o[15]||(o[15]=d=>u.value.swingModes=d)},null,512),[[Q,u.value.swingModes]]),o[41]||(o[41]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),I(" Horizontal ")],-1))]),e("label",aa,[j(e("input",{type:"checkbox",value:"both","onUpdate:modelValue":o[16]||(o[16]=d=>u.value.swingModes=d)},null,512),[[Q,u.value.swingModes]]),o[42]||(o[42]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-arrow-all"}),I(" Both ")],-1))])])]),e("div",ia,[o[51]||(o[51]=e("h4",null,"Sensors (Optional)",-1)),o[52]||(o[52]=e("p",{class:"help-text"},"Link external sensors for better climate control",-1)),e("div",ra,[o[45]||(o[45]=e("label",null,"Temperature Sensor",-1)),j(e("input",{"onUpdate:modelValue":o[17]||(o[17]=d=>u.value.tempSensor=d),type:"text",placeholder:"sensor.living_room_temperature"},null,512),[[pe,u.value.tempSensor]]),o[46]||(o[46]=e("small",null,"Entity ID of temperature sensor",-1))]),e("div",da,[o[47]||(o[47]=e("label",null,"Humidity Sensor",-1)),j(e("input",{"onUpdate:modelValue":o[18]||(o[18]=d=>u.value.humiditySensor=d),type:"text",placeholder:"sensor.living_room_humidity"},null,512),[[pe,u.value.humiditySensor]]),o[48]||(o[48]=e("small",null,"Entity ID of humidity sensor",-1))]),e("div",ua,[o[49]||(o[49]=e("label",null,"Power Sensor",-1)),j(e("input",{"onUpdate:modelValue":o[19]||(o[19]=d=>u.value.powerSensor=d),type:"text",placeholder:"binary_sensor.ac_power"},null,512),[[pe,u.value.powerSensor]]),o[50]||(o[50]=e("small",null,"Entity ID of power sensor (to detect on/off state)",-1))])]),g.value.length>0?(n(),r("div",ca,[o[53]||(o[53]=e("h4",null,[e("i",{class:"mdi mdi-alert-circle"}),I(" Please fix the following: ")],-1)),e("ul",null,[(n(!0),r(ne,null,de(g.value,(d,M)=>(n(),r("li",{key:M},f(d),1))),128))])])):O("",!0)]))}},va=ue(ma,[["__scopeId","data-v-691429a1"]]),pa={class:"command-wizard"},fa={key:0,class:"edit-mode-banner"},ga={class:"wizard-info"},ya={key:0},ba={key:1},ha={class:"progress-info"},ka={class:"progress-bar"},wa={class:"progress-text"},$a={class:"commands-grid"},Ca={class:"command-header"},_a={class:"command-icon"},Sa={class:"command-info"},Ia={key:0,class:"learning-indicator"},xa={key:0,class:"ir-learning-steps"},Da={key:1,class:"rf-learning-steps"},Ta={class:"command-actions"},Ra=["onClick","disabled"],La={key:1,class:"learned-status"},Ma=["onClick"],Oa={class:"quick-actions"},Va=["disabled"],Aa=["disabled"],Ea={__name:"CommandLearningWizard",props:{modelValue:{type:Object,default:()=>({})},platform:{type:String,required:!0},config:{type:Object,required:!0},broadlinkDevice:{type:String,required:!0},manufacturer:{type:String,required:!0},model:{type:String,required:!0},commandType:{type:String,default:"ir"}},emits:["update:modelValue"],setup(s,{emit:p}){const a=Te(),$=s,u=p,g=k({...$.modelValue}),b=k(null),o=k(!1),d=k([]),M=k(!1),L=k({show:!1,commandKey:null,commandLabel:""}),i=k(!1),l=N(()=>{const E=[];if($.platform==="climate"){const m=$.config.modes||[],C=$.config.fanModes||[],x=$.config.minTemp||16,y=$.config.maxTemp||30;m.forEach(V=>{if(V==="off")E.push({key:"off",label:"Power Off",description:"Turn device off",icon:"mdi mdi-power",mode:"off"});else for(let ee=x;ee<=y;ee++)C.forEach(ve=>{const he=`${V}_${ee}_${ve}`;E.push({key:he,label:`${V.toUpperCase()} ${ee}Â°C ${ve}`,description:`Mode: ${V}, Temp: ${ee}Â°C, Fan: ${ve}`,icon:w(V),mode:V,temp:ee,fanMode:ve})})})}else if($.platform==="media_player"){const m=$.config.features||[];m.includes("turn_on")&&(E.push({key:"turn_on",label:"Power On",description:"Turn on the device",icon:"mdi mdi-power"}),E.push({key:"turn_off",label:"Power Off",description:"Turn off the device",icon:"mdi mdi-power-off"})),m.includes("volume")&&(E.push({key:"volume_up",label:"Volume Up",description:"Increase volume",icon:"mdi mdi-volume-plus"}),E.push({key:"volume_down",label:"Volume Down",description:"Decrease volume",icon:"mdi mdi-volume-minus"})),m.includes("mute")&&E.push({key:"mute",label:"Mute",description:"Toggle mute",icon:"mdi mdi-volume-mute"}),m.includes("source")&&(E.push({key:"source_hdmi1",label:"Source: HDMI 1",description:"Switch to HDMI 1",icon:"mdi mdi-import"}),E.push({key:"source_hdmi2",label:"Source: HDMI 2",description:"Switch to HDMI 2",icon:"mdi mdi-import"}),E.push({key:"source_hdmi3",label:"Source: HDMI 3",description:"Switch to HDMI 3",icon:"mdi mdi-import"})),m.includes("channel")&&(E.push({key:"channel_up",label:"Channel Up",description:"Next channel",icon:"mdi mdi-chevron-up"}),E.push({key:"channel_down",label:"Channel Down",description:"Previous channel",icon:"mdi mdi-chevron-down"}))}else if($.platform==="fan"){const m=$.config.speedLevels||3,C=$.config.features||[];E.push({key:"turn_on",label:"Power On",description:"Turn on the fan",icon:"mdi mdi-power"}),E.push({key:"turn_off",label:"Power Off",description:"Turn off the fan",icon:"mdi mdi-power-off"});for(let x=1;x<=m;x++){const y=x===1?"Low":x===m?"High":x===2&&m===3?"Medium":`Speed ${x}`;E.push({key:`speed_${x}`,label:`${y}`,description:`Set fan to speed level ${x}`,icon:"mdi mdi-fan"})}C.includes("oscillate")&&(E.push({key:"oscillate_on",label:"Oscillate On",description:"Enable oscillation",icon:"mdi mdi-sync"}),E.push({key:"oscillate_off",label:"Oscillate Off",description:"Disable oscillation",icon:"mdi mdi-sync-off"})),C.includes("direction")&&(E.push({key:"direction_forward",label:"Direction: Forward",description:"Set direction to forward",icon:"mdi mdi-rotate-right"}),E.push({key:"direction_reverse",label:"Direction: Reverse",description:"Set direction to reverse",icon:"mdi mdi-rotate-left"}))}else if($.platform==="light"){const m=$.config.features||[];m.includes("turn_on")&&(E.push({key:"turn_on",label:"Power On",description:"Turn on the light",icon:"mdi mdi-lightbulb-on"}),E.push({key:"turn_off",label:"Power Off",description:"Turn off the light",icon:"mdi mdi-lightbulb-off"})),m.includes("brightness")&&(E.push({key:"brightness_up",label:"Brightness Up",description:"Increase brightness",icon:"mdi mdi-brightness-7"}),E.push({key:"brightness_down",label:"Brightness Down",description:"Decrease brightness",icon:"mdi mdi-brightness-5"})),m.includes("color_temp")&&(E.push({key:"color_temp_warm",label:"Warm White",description:"Set to warm white",icon:"mdi mdi-weather-sunset"}),E.push({key:"color_temp_cool",label:"Cool White",description:"Set to cool white",icon:"mdi mdi-weather-sunny"})),m.includes("rgb")&&(E.push({key:"color_red",label:"Color: Red",description:"Set color to red",icon:"mdi mdi-palette"}),E.push({key:"color_green",label:"Color: Green",description:"Set color to green",icon:"mdi mdi-palette"}),E.push({key:"color_blue",label:"Color: Blue",description:"Set color to blue",icon:"mdi mdi-palette"}))}return E}),R=N(()=>l.value.length),P=N(()=>Object.keys(g.value).length),h=N(()=>R.value===0?0:Math.round(P.value/R.value*100));function w(E){return{off:"mdi mdi-power",auto:"mdi mdi-autorenew",cool:"mdi mdi-snowflake",heat:"mdi mdi-fire",dry:"mdi mdi-water-percent",fan_only:"mdi mdi-fan"}[E]||"mdi mdi-remote"}async function H(E){if(!b.value){b.value=E.key;try{const m=$.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_"),C=$.model.toLowerCase().replace(/[^a-z0-9]+/g,"_"),x=`${m}_${C}`,y=await fetch("/api/commands/learn",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_id:$.broadlinkDevice,device:x,command:E.key,command_type:$.commandType})});if(!y.ok)throw new Error(`Failed to learn command: ${y.statusText}`);const V=await y.json();if(V.success&&V.code)g.value[E.key]=V.code,u("update:modelValue",g.value),M.value=!0,o.value&&d.value.length>0&&setTimeout(()=>{const ee=d.value.shift();ee?H(ee):o.value=!1},1e3);else throw new Error(V.error||"Failed to learn command")}catch(m){console.error("Error learning command:",m),a.error(`Error learning command: ${m.message}`),o.value=!1,d.value=[]}finally{o.value||(b.value=null)}}}function G(E){const m=l.value.find(C=>C.key===E);L.value={show:!0,commandKey:E,commandLabel:m?m.label:E}}function S(){const E=L.value.commandKey;delete g.value[E],u("update:modelValue",g.value),L.value.show=!1}function z(){const E=l.value.filter(C=>!g.value[C.key]);if(E.length===0)return;o.value=!0,d.value=[...E];const m=d.value.shift();m&&H(m)}function K(){i.value=!0}function oe(){g.value={},u("update:modelValue",g.value),i.value=!1}ie(()=>$.modelValue,E=>{g.value={...E}},{deep:!0}),be(async()=>{await Y()});async function Y(){try{const E=$.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_"),m=$.model.toLowerCase().replace(/[^a-z0-9]+/g,"_"),C=`${E}_${m}`,x=await fetch(`/api/commands/broadlink/${C}`);if(!x.ok)return;const y=await x.json();if(y.commands){const V=l.value.map(ve=>ve.key),ee={};for(const[ve,he]of Object.entries(y.commands))V.includes(ve)&&(ee[ve]=he);Object.keys(ee).length>0&&(g.value={...g.value,...ee},u("update:modelValue",g.value),console.log(`Loaded ${Object.keys(ee).length} existing commands for ${C}`))}}catch(E){console.error("Error loading existing commands:",E)}}return(E,m)=>(n(),r("div",pa,[m[15]||(m[15]=e("h3",null,"Learn IR Commands",-1)),P.value>0&&!M.value?(n(),r("div",fa,[m[3]||(m[3]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[m[2]||(m[2]=e("strong",null,"Editing Existing Profile",-1)),e("p",null,f(P.value)+" command"+f(P.value!==1?"s":"")+' already learned. You can re-learn any command by clicking the delete icon and then "Learn Command".',1)])])):O("",!0),e("div",ga,[m[7]||(m[7]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[m[6]||(m[6]=e("p",null,[e("strong",null,"How it works:")],-1)),s.commandType==="ir"?(n(),r("ol",ya,[...m[4]||(m[4]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Point your IR remote directly at the Broadlink device")],-1),e("li",null,"Press the button on your remote",-1),e("li",null,"Wait for confirmation (up to 30 seconds)",-1)])])):(n(),r("ol",ba,[...m[5]||(m[5]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Step 1:"),I(" Hold button on remote - Broadlink scans for RF frequency")],-1),e("li",null,[e("strong",null,"Step 2:"),I(" Watch for Home Assistant notification, then press and release button")],-1),e("li",null,"Keep remote within 5cm of Broadlink (RF doesn't need line-of-sight)",-1),e("li",null,"Wait for confirmation (may take up to 30 seconds)",-1)])]))])]),e("div",ha,[e("div",ka,[e("div",{class:"progress-fill",style:We({width:h.value+"%"})},null,4)]),e("span",wa,f(P.value)+" / "+f(R.value)+" commands learned ("+f(h.value)+"%) ",1)]),e("div",$a,[(n(!0),r(ne,null,de(l.value,C=>(n(),r("div",{key:C.key,class:Z(["command-card",{learned:g.value[C.key],learning:b.value===C.key}])},[e("div",Ca,[e("div",_a,[e("i",{class:Z(C.icon)},null,2)]),e("div",Sa,[e("h4",null,f(C.label),1),e("p",null,f(C.description),1)])]),b.value===C.key?(n(),r("div",Ia,[s.commandType==="ir"?(n(),r("div",xa,[...m[8]||(m[8]=[e("p",null,[e("strong",null,"Point your remote directly at the Broadlink device and press the button.")],-1),e("small",null,"Listening for up to 30 seconds...",-1)])])):(n(),r("div",Da,[...m[9]||(m[9]=[e("p",{class:"rf-title"},[e("strong",null,"Learning request sent to device.")],-1),e("p",{class:"rf-subtitle"},[I("RF learning is a "),e("strong",null,"two-step process"),I(":")],-1),e("ol",null,[e("li",null,[e("strong",null,"Step 1 - Frequency Sweep (~10-15 seconds):"),I(" Press and hold the button on your remote until the notification updates. ")]),e("li",null,[e("strong",null,"Step 2 - Learn Signal:"),I(" Press and release the button once. ")])],-1),e("p",{class:"rf-note"},"Follow the Home Assistant notifications (ğŸ””) for real-time instructions.",-1)])]))])):O("",!0),e("div",Ta,[g.value[C.key]?(n(),r("div",La,[m[11]||(m[11]=e("i",{class:"mdi mdi-check-circle"},null,-1)),m[12]||(m[12]=e("span",null,"Learned",-1)),e("button",{onClick:x=>G(C.key),class:"btn-delete",title:"Delete and re-learn"},[...m[10]||(m[10]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Ma)])):(n(),r("button",{key:0,onClick:x=>H(C),class:Z(["btn-learn",{learning:b.value===C.key}]),disabled:b.value!==null},[e("i",{class:Z(["mdi mdi-radio-tower",{"mdi-spin":b.value===C.key}])},null,2),I(" "+f(b.value===C.key?"Listening...":"Learn Command"),1)],10,Ra))])],2))),128))]),e("div",Oa,[e("button",{onClick:z,class:"btn-secondary",disabled:b.value!==null||P.value===R.value},[...m[13]||(m[13]=[e("i",{class:"mdi mdi-play-circle"},null,-1),I(" Learn All Remaining ",-1)])],8,Va),e("button",{onClick:K,class:"btn-text",disabled:P.value===0},[...m[14]||(m[14]=[e("i",{class:"mdi mdi-delete-sweep"},null,-1),I(" Clear All ",-1)])],8,Aa)]),le(_e,{isOpen:L.value.show,title:"Delete Learned Command?",message:`Are you sure you want to delete the '${L.value.commandLabel}' command?

You will need to re-learn this command.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:S,onCancel:m[0]||(m[0]=C=>L.value.show=!1)},null,8,["isOpen","message"]),le(_e,{isOpen:i.value,title:"Delete All Learned Commands?",message:"Are you sure you want to delete all learned commands? This cannot be undone.\\n\\nYou will need to re-learn all commands.",confirmText:"Delete All",cancelText:"Cancel",dangerMode:!0,onConfirm:oe,onCancel:m[1]||(m[1]=C=>i.value=!1)},null,8,["isOpen"])]))}},Pa=ue(Ea,[["__scopeId","data-v-11632f88"]]),ja={class:"profile-preview"},Fa={class:"preview-summary"},Ua={class:"summary-card"},Na={class:"stats-grid"},Ba={class:"stat-item"},qa={class:"stat-value"},Ha={class:"stat-item"},za={class:"stat-value"},Ja={class:"stat-item"},Wa={class:"stat-value"},Xa={class:"preview-tabs"},Ga={class:"preview-content"},Ka={key:0,class:"tab-content"},Ya={class:"code-header"},Za={class:"code-block"},Qa={key:1,class:"tab-content"},ei={class:"code-header"},ti={class:"code-block"},oi={key:2,class:"tab-content"},li={class:"instructions"},si={class:"step-item"},ni={class:"step-content"},ai={class:"code-path"},ii={__name:"ProfilePreview",props:{profile:{type:Object,required:!0},jsonData:{type:Object,required:!0},yamlConfig:{type:String,required:!0}},setup(s){const p=Te(),a=s,$=k("json"),u=k(!1),g=k(!1),b=N(()=>Object.keys(a.profile.commands||{}).length),o=N(()=>JSON.stringify(a.jsonData,null,2));async function d(){try{await navigator.clipboard.writeText(o.value),u.value=!0,setTimeout(()=>{u.value=!1},2e3)}catch(L){console.error("Failed to copy JSON:",L),p.error("Failed to copy to clipboard")}}async function M(){try{await navigator.clipboard.writeText(a.yamlConfig),g.value=!0,setTimeout(()=>{g.value=!1},2e3)}catch(L){console.error("Failed to copy YAML:",L),p.error("Failed to copy to clipboard")}}return(L,i)=>{var l;return n(),r("div",ja,[i[22]||(i[22]=e("h3",null,"Preview & Save",-1)),e("div",Fa,[e("div",Ua,[i[4]||(i[4]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("div",null,[i[3]||(i[3]=e("h4",null,"Profile Ready!",-1)),e("p",null,f(s.profile.manufacturer)+" "+f(s.profile.model),1)])]),e("div",Na,[e("div",Ba,[e("span",qa,f(b.value),1),i[5]||(i[5]=e("span",{class:"stat-label"},"Commands Learned",-1))]),e("div",Ha,[e("span",za,f(s.profile.platform),1),i[6]||(i[6]=e("span",{class:"stat-label"},"Platform",-1))]),e("div",Ja,[e("span",Wa,f(((l=s.profile.config.modes)==null?void 0:l.length)||0),1),i[7]||(i[7]=e("span",{class:"stat-label"},"HVAC Modes",-1))])])]),e("div",Xa,[e("button",{onClick:i[0]||(i[0]=R=>$.value="json"),class:Z(["tab-button",{active:$.value==="json"}])},[...i[8]||(i[8]=[e("i",{class:"mdi mdi-code-json"},null,-1),I(" SmartIR JSON ",-1)])],2),e("button",{onClick:i[1]||(i[1]=R=>$.value="yaml"),class:Z(["tab-button",{active:$.value==="yaml"}])},[...i[9]||(i[9]=[e("i",{class:"mdi mdi-file-code"},null,-1),I(" YAML Config ",-1)])],2),e("button",{onClick:i[2]||(i[2]=R=>$.value="instructions"),class:Z(["tab-button",{active:$.value==="instructions"}])},[...i[10]||(i[10]=[e("i",{class:"mdi mdi-information"},null,-1),I(" Instructions ",-1)])],2)]),e("div",Ga,[$.value==="json"?(n(),r("div",Ka,[e("div",Ya,[i[12]||(i[12]=e("h4",null,"SmartIR Device Code JSON",-1)),e("button",{onClick:d,class:"btn-copy"},[i[11]||(i[11]=e("i",{class:"mdi mdi-content-copy"},null,-1)),I(" "+f(u.value?"Copied!":"Copy"),1)])]),e("pre",Za,[e("code",null,f(o.value),1)]),i[13]||(i[13]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),I(" Save this as "),e("code",null,"10000.json"),I(" in your SmartIR codes directory ")],-1))])):O("",!0),$.value==="yaml"?(n(),r("div",Qa,[e("div",ei,[i[15]||(i[15]=e("h4",null,"Home Assistant Configuration",-1)),e("button",{onClick:M,class:"btn-copy"},[i[14]||(i[14]=e("i",{class:"mdi mdi-content-copy"},null,-1)),I(" "+f(g.value?"Copied!":"Copy"),1)])]),e("pre",ti,[e("code",null,f(s.yamlConfig),1)]),i[16]||(i[16]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),I(" Add this to your "),e("code",null,"configuration.yaml"),I(" file ")],-1))])):O("",!0),$.value==="instructions"?(n(),r("div",oi,[e("div",li,[i[20]||(i[20]=e("h4",null,"Installation Steps",-1)),e("div",si,[i[19]||(i[19]=e("div",{class:"step-number"},"1",-1)),e("div",ni,[i[17]||(i[17]=e("h5",null,"Get Next Code Number",-1)),i[18]||(i[18]=e("p",null,"Custom device codes start at 10000. Check your SmartIR codes directory to find the next available number.",-1)),e("div",ai,[e("code",null,"/config/custom_components/smartir/codes/"+f(s.profile.platform)+"/",1)])])]),i[21]||(i[21]=Ie('<div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>2</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Save JSON File</h5><p data-v-cbf0874d>Copy the JSON from the &quot;SmartIR JSON&quot; tab and save it as <code data-v-cbf0874d>10000.json</code> (or your next available number) in the codes directory.</p></div></div><div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>3</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Update Configuration</h5><p data-v-cbf0874d>Copy the YAML from the &quot;YAML Config&quot; tab and add it to your <code data-v-cbf0874d>configuration.yaml</code> file. Update the <code data-v-cbf0874d>device_code</code> to match your JSON filename.</p></div></div><div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>4</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Restart Home Assistant</h5><p data-v-cbf0874d>Restart Home Assistant to load the new configuration. Your climate entity will appear in the UI.</p></div></div><div class="step-item" data-v-cbf0874d><div class="step-number" data-v-cbf0874d>5</div><div class="step-content" data-v-cbf0874d><h5 data-v-cbf0874d>Test Your Device</h5><p data-v-cbf0874d>Go to your climate entity and test different modes, temperatures, and fan speeds to ensure everything works correctly.</p></div></div><div class="tips-section" data-v-cbf0874d><h4 data-v-cbf0874d><i class="mdi mdi-lightbulb" data-v-cbf0874d></i> Tips </h4><ul data-v-cbf0874d><li data-v-cbf0874d>Keep a backup of your JSON file in case you need to modify it</li><li data-v-cbf0874d>Test all commands to ensure they work as expected</li><li data-v-cbf0874d>You can share your profile with the SmartIR community on GitHub</li><li data-v-cbf0874d>If a command doesn&#39;t work, you can re-learn it and update the JSON</li></ul></div>',5))])])):O("",!0)])])}}},ri=ue(ii,[["__scopeId","data-v-cbf0874d"]]),di={class:"wizard-body"},ui={key:0,class:"warning-section"},ci={class:"warning-box"},mi={class:"instructions"},vi={class:"code-block"},pi={class:"steps"},fi={key:0},gi={class:"help-section"},yi={key:0,class:"help-content"},bi={class:"help-step"},hi={key:0,class:"help-step"},ki={class:"help-step"},wi={class:"help-step"},$i={class:"checklist"},Ci={class:"checkbox-label"},_i={key:0,class:"checkbox-label"},Si={class:"wizard-footer"},Ii=["disabled"],xi={__name:"SmartIRSetupWizard",props:{show:{type:Boolean,default:!1},platform:{type:String,required:!0},warnings:{type:Array,default:()=>[]},configPath:{type:String,default:"/config"}},emits:["close","complete"],setup(s,{emit:p}){const a=s,$=p,u=we("toast"),g=k(!1),b=k(!1),o=k(!1),d=N(()=>a.warnings.length>0?g.value&&b.value:g.value);function M(){const i=`${a.platform}: !include smartir/${a.platform}.yaml`;navigator.clipboard.writeText(i).then(()=>{var l;(l=u.value)==null||l.success("Include line copied to clipboard!","âœ… Copied")}).catch(l=>{var R;console.error("Failed to copy:",l),(R=u.value)==null||R.error("Failed to copy to clipboard","âŒ Copy Failed")})}function L(){$("complete")}return(i,l)=>s.show?(n(),r("div",{key:0,class:"modal-overlay",onClick:l[5]||(l[5]=ae(()=>{},["stop"]))},[e("div",{class:"setup-wizard",onClick:l[4]||(l[4]=ae(()=>{},["stop"]))},[l[31]||(l[31]=e("div",{class:"wizard-header"},[e("h2",null,[e("i",{class:"mdi mdi-cog"}),I(" SmartIR Configuration Setup ")])],-1)),e("div",di,[s.warnings.length>0?(n(),r("div",ui,[e("div",ci,[l[11]||(l[11]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[l[9]||(l[9]=e("h3",null,"âš ï¸ Configuration Migration Needed",-1)),l[10]||(l[10]=e("p",null,"We detected existing platform entries in your configuration.yaml:",-1)),e("ul",null,[(n(!0),r(ne,null,de(s.warnings,R=>(n(),r("li",{key:R.platform},[e("strong",null,f(R.platform)+":",1),I(" "+f(R.message),1)]))),128))]),e("p",null,[l[6]||(l[6]=e("strong",null,"Action Required:",-1)),l[7]||(l[7]=I(" Move these entries to ",-1)),e("code",null,"smartir/"+f(s.platform)+".yaml",1),l[8]||(l[8]=I(" before continuing.",-1))])])])])):O("",!0),e("div",mi,[l[27]||(l[27]=e("h3",null,"ğŸ“ One-Time Setup",-1)),l[28]||(l[28]=e("p",null,[I("To enable SmartIR device management, add this line to your "),e("code",null,"configuration.yaml"),I(":")],-1)),e("div",vi,[e("code",null,f(s.platform)+": !include smartir/"+f(s.platform)+".yaml",1),e("button",{onClick:M,class:"copy-btn",title:"Copy to clipboard"},[...l[12]||(l[12]=[e("i",{class:"mdi mdi-content-copy"},null,-1)])])]),e("div",pi,[l[19]||(l[19]=e("h4",null,"Steps:",-1)),e("ol",null,[s.warnings.length>0?(n(),r("li",fi,[l[13]||(l[13]=e("strong",null,"Move existing entries:",-1)),l[14]||(l[14]=I(" Copy any existing ",-1)),e("code",null,f(s.platform)+":",1),l[15]||(l[15]=I(" entries from configuration.yaml to ",-1)),e("code",null,"smartir/"+f(s.platform)+".yaml",1)])):O("",!0),l[16]||(l[16]=e("li",null,[e("strong",null,"Add include line:"),I(" Add the line above to your configuration.yaml ")],-1)),l[17]||(l[17]=e("li",null,[e("strong",null,"Save changes:"),I(" Save configuration.yaml ")],-1)),l[18]||(l[18]=e("li",null,[e("strong",null,"Continue here:"),I(` Click "I've Completed Setup" below `)],-1))])]),e("div",gi,[e("button",{onClick:l[0]||(l[0]=R=>o.value=!o.value),class:"help-toggle"},[e("i",{class:Z(["mdi",o.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2),I(" "+f(o.value?"Hide":"Show")+" Detailed Instructions ",1)]),o.value?(n(),r("div",yi,[l[26]||(l[26]=e("h4",null,"Detailed Setup Guide:",-1)),e("div",bi,[l[21]||(l[21]=e("h5",null,"1. Open configuration.yaml",-1)),e("p",null,[l[20]||(l[20]=I("Location: ",-1)),e("code",null,f(s.configPath)+"/configuration.yaml",1)])]),s.warnings.length>0?(n(),r("div",hi,[l[22]||(l[22]=e("h5",null,"2. Migrate Existing Entries (If Any)",-1)),e("p",null,"If you have existing "+f(s.platform)+" entries, cut them from configuration.yaml and paste into:",1),e("p",null,[e("code",null,f(s.configPath)+"/smartir/"+f(s.platform)+".yaml",1)]),l[23]||(l[23]=e("p",{class:"note"},"Broadlink Manager will create this file automatically.",-1))])):O("",!0),e("div",ki,[e("h5",null,f(s.warnings.length>0?"3":"2")+". Add Include Line",1),l[24]||(l[24]=e("p",null,"Add this to configuration.yaml:",-1)),e("pre",null,f(s.platform)+": !include smartir/"+f(s.platform)+".yaml",1)]),e("div",wi,[e("h5",null,f(s.warnings.length>0?"4":"3")+". Restart Home Assistant",1),l[25]||(l[25]=e("p",null,"After saving, you'll need to restart HA for changes to take effect.",-1))])])):O("",!0)])]),e("div",$i,[e("label",Ci,[j(e("input",{type:"checkbox","onUpdate:modelValue":l[1]||(l[1]=R=>g.value=R)},null,512),[[Q,g.value]]),l[29]||(l[29]=e("span",null,"I've added the include line to configuration.yaml",-1))]),s.warnings.length>0?(n(),r("label",_i,[j(e("input",{type:"checkbox","onUpdate:modelValue":l[2]||(l[2]=R=>b.value=R)},null,512),[[Q,b.value]]),e("span",null,"I've migrated existing "+f(s.platform)+" entries (if any)",1)])):O("",!0)])]),e("div",Si,[e("button",{onClick:l[3]||(l[3]=R=>i.$emit("close")),class:"btn-secondary"}," Cancel "),e("button",{onClick:L,class:"btn-primary",disabled:!d.value},[...l[30]||(l[30]=[e("i",{class:"mdi mdi-check"},null,-1),I(" I've Completed Setup ",-1)])],8,Ii)])])])):O("",!0)}},Di=ue(xi,[["__scopeId","data-v-f6fe4c03"]]),Ti={class:"modal-header"},Ri={class:"progress-steps"},Li={class:"step-number"},Mi={key:0,class:"mdi mdi-check"},Oi={key:1},Vi={class:"step-label"},Ai={class:"modal-body"},Ei={key:0,class:"step-content"},Pi={class:"form-group"},ji={class:"form-group"},Fi={class:"form-group"},Ui={class:"form-group"},Ni=["value"],Bi={class:"form-group"},qi={key:1,class:"step-content"},Hi={key:1,class:"platform-form"},zi={class:"form-section"},Ji={class:"checkbox-grid"},Wi={class:"checkbox-item"},Xi={class:"checkbox-item"},Gi={class:"checkbox-item"},Ki={class:"checkbox-item"},Yi={class:"checkbox-item"},Zi={key:2,class:"platform-form"},Qi={class:"form-section"},er={class:"form-group"},tr={class:"form-section"},or={class:"checkbox-grid"},lr={class:"checkbox-item"},sr={class:"checkbox-item"},nr={key:3,class:"platform-form"},ar={class:"form-section"},ir={class:"checkbox-grid"},rr={class:"checkbox-item"},dr={class:"checkbox-item"},ur={class:"checkbox-item"},cr={class:"checkbox-item"},mr={key:2,class:"step-content"},vr={key:3,class:"step-content"},pr={class:"modal-footer"},fr=["disabled"],gr={key:2,class:"save-buttons"},yr=["disabled"],br=["disabled"],hr={__name:"SmartIRProfileBuilder",props:{show:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},editData:{type:Object,default:null}},emits:["close","save"],setup(s,{emit:p}){const a=s,$=p,u=we("toast"),g=k(0),b=k(!1),o=k([]),d=k(!1),M=k([]),L=k("/config"),i=k(!1),l=k(null),R=k(!1),P=k(!1),h=k(""),w=k("ir"),H=k(!1),G=[{label:"Device Info",key:"info"},{label:"Configuration",key:"config"},{label:"Learn Commands",key:"commands"},{label:"Preview & Save",key:"preview"}],S=k({platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}}),z=k(["turn_on"]),K=k(3),oe=k([]),Y=k(["turn_on"]);ie(()=>S.value.platform,c=>{c==="media_player"?S.value.config={features:z.value}:c==="fan"?S.value.config={speedLevels:K.value,features:oe.value}:c==="light"&&(S.value.config={features:Y.value})}),ie(z,c=>{S.value.platform==="media_player"&&(S.value.config={features:c})},{deep:!0}),ie(K,c=>{S.value.platform==="fan"&&(S.value.config={speedLevels:c,features:oe.value})}),ie(oe,c=>{S.value.platform==="fan"&&(S.value.config={speedLevels:K.value,features:c})},{deep:!0}),ie(Y,c=>{S.value.platform==="light"&&(S.value.config={features:c})},{deep:!0});function E(c){const t=new Set,v=Object.keys(c);return v.some(_=>_==="off"||_.includes("_off"))&&t.add("off"),v.some(_=>_.includes("auto"))&&t.add("auto"),v.some(_=>_.includes("cool"))&&t.add("cool"),v.some(_=>_.includes("heat"))&&t.add("heat"),v.some(_=>_.includes("dry"))&&t.add("dry"),v.some(_=>_.includes("fan_only"))&&t.add("fan_only"),Array.from(t)}function m(c){const t=new Set,v=Object.keys(c);return v.some(_=>_.includes("auto"))&&t.add("auto"),v.some(_=>_.includes("low"))&&t.add("low"),v.some(_=>_.includes("medium")||_.includes("mid"))&&t.add("medium"),v.some(_=>_.includes("high"))&&t.add("high"),Array.from(t)}function C(c){const t=new Set,v=Object.keys(c);return v.some(_=>_.includes("swing_off")||_.includes("_off"))&&t.add("off"),v.some(_=>_.includes("vertical"))&&t.add("vertical"),v.some(_=>_.includes("horizontal"))&&t.add("horizontal"),v.some(_=>_.includes("both"))&&t.add("both"),Array.from(t)}function x(c){for(const t of Object.values(c))if(typeof t=="string"&&t.startsWith("sc")||Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0].startsWith("sc"))return"rf";return"ir"}ie(()=>S.value.commandType,(c,t)=>{!t||R.value||H.value||(Object.keys(S.value.commands).length>0&&c!==t?(h.value=c,S.value.commandType=t,R.value=!0):c!==t&&(w.value=c))}),ie(()=>a.editData,async c=>{var t,v;if(c&&a.editMode){console.log("ğŸ”§ Edit mode activated, loading profile data:",c),H.value=!0,o.value.length===0&&(console.log("ğŸ“¡ Loading Broadlink devices..."),await ge(),console.log("ğŸ“¡ Devices loaded:",o.value.length));const _=c.profile,q=_.controller_data;console.log("ğŸ® Controller data from profile:",q),console.log("ğŸ® Available devices:",o.value.map(W=>W.entity_id));const U=_.commands||{},X=x(U);console.log("ğŸ” Inferred command type:",X);let J={};if(c.platform==="climate"){const W=_.operationModes||E(U),re=_.fanModes||m(U),me=_.swingModes||C(U);console.log("ğŸ” Inferred modes:",W),console.log("ğŸ” Inferred fan modes:",re),console.log("ğŸ” Inferred swing modes:",me),J={minTemp:_.minTemperature,maxTemp:_.maxTemperature,precision:_.precision,modes:W,fanModes:re,swingModes:me}}else if(c.platform==="media_player"){const W=[];(U.on||U.off)&&W.push("turn_on"),(U.volumeUp||U.volumeDown)&&W.push("volume"),U.mute&&W.push("mute"),U.sources&&W.push("source"),(U.channelUp||U.channelDown)&&W.push("channel"),J={features:W},z.value=W,console.log("ğŸ” Inferred media player features:",W)}else if(c.platform==="fan"){const W=((t=_.speed)==null?void 0:t.length)||Object.keys(U.default||{}).length||3,re=[];(U.oscillate_on||U.oscillate_off)&&re.push("oscillate"),(U.direction_forward||U.direction_reverse)&&re.push("direction"),J={speedLevels:W,features:re},K.value=W,oe.value=re,console.log("ğŸ” Inferred fan config:",J)}else if(c.platform==="light"){const W=[];J={features:W},Y.value=W,console.log("ğŸ” Inferred light features:",W)}S.value={platform:c.platform,manufacturer:_.manufacturer||"",model:((v=_.supportedModels)==null?void 0:v[0])||"",broadlinkDevice:q||"",commandType:X,config:J,commands:U},console.log("âœ… Profile populated:",S.value),console.log("âœ… Selected device:",S.value.broadlinkDevice),console.log("âœ… Command type:",S.value.commandType),w.value=X,setTimeout(()=>{H.value=!1},100)}},{immediate:!0});const y=N(()=>{var c;switch(g.value){case 0:return S.value.platform&&S.value.manufacturer&&S.value.model&&S.value.broadlinkDevice&&S.value.commandType;case 1:return S.value.platform==="climate"?S.value.config.minTemp&&S.value.config.maxTemp&&((c=S.value.config.modes)==null?void 0:c.length)>0:!0;case 2:return Object.keys(S.value.commands).length>0;case 3:return!0;default:return!1}}),V=N(()=>g.value!==3?null:ye(S.value)),ee=N(()=>g.value!==3?null:ke(S.value));function ve(){S.value.config={},S.value.commands={}}function he(){R.value=!1,S.value.commandType=h.value,w.value=h.value,S.value.commands={},h.value=""}function Se(){R.value=!1,h.value=""}function Ce(){y.value&&g.value<G.length-1&&g.value++}function B(){g.value>0&&g.value--}function D(){R.value||(P.value=!0)}function A(){P.value=!1,T()}function T(){$("close"),setTimeout(()=>{g.value=0,S.value={platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}},w.value="ir"},300)}async function F(){var c,t,v,_,q;b.value=!0;try{if(!i.value){const me=await fetch("api/smartir/config/check");if(me.ok){const Re=await me.json();if(!((c=Re.platforms[S.value.platform])==null?void 0:c.file_exists)){M.value=Re.configuration_warnings||[],L.value=Re.config_path||"/config",l.value={platform:S.value.platform,json:V.value},d.value=!0,b.value=!1;return}}}let U;if(a.editMode&&((t=a.editData)!=null&&t.code))U=parseInt(a.editData.code),console.log("ğŸ“ Edit mode: Using existing code",U);else{const me=await fetch(`api/smartir/platforms/${S.value.platform}/next-code`);if(!me.ok)throw new Error("Failed to get next code number");U=(await me.json()).next_code,console.log("âœ¨ New profile: Using next code",U)}const X=await fetch("api/smartir/profiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:S.value.platform,json:V.value,code_number:U})});if(!X.ok){const me=await X.json();throw new Error(me.error||"Failed to save profile")}const J=await X.json(),W={name:`${S.value.manufacturer} ${S.value.model}`,unique_id:`${S.value.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_")}_${S.value.model.toLowerCase().replace(/[^a-z0-9]+/g,"_")}`,device_code:U,controller_data:S.value.broadlinkDevice},re=await fetch("api/smartir/config/add-device",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:S.value.platform,device_config:W})});if(!re.ok){const me=await re.json();console.error("Failed to add device to config:",me),(v=u.value)==null||v.warning(`Profile saved but failed to add to config file: ${me.error}`,"âš ï¸ Partial Success")}$("save",{json:V.value,yaml:ee.value,profile:S.value,saved_to:J.path}),(_=u.value)==null||_.success(`File: ${J.filename}
Device Code: ${U}
Added to: smartir/${S.value.platform}.yaml

âš ï¸ Restart Home Assistant to activate`,"âœ… Profile Saved Successfully!"),T()}catch(U){console.error("Error saving profile:",U),(q=u.value)==null||q.error(U.message,"âŒ Error Saving Profile")}finally{b.value=!1}}async function te(){i.value=!0,d.value=!1,l.value&&(await F(),l.value=null)}function ce(){var c,t;try{const v=JSON.stringify(V.value,null,2),_=new Blob([v],{type:"application/json"}),q=URL.createObjectURL(_),U=document.createElement("a");U.href=q;const X=S.value.manufacturer.toLowerCase().replace(/\s+/g,"_"),J=S.value.model.toLowerCase().replace(/\s+/g,"_");U.download=`smartir_${S.value.platform}_${X}_${J}.json`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(q),(c=u.value)==null||c.success("You can manually upload this file to your SmartIR codes directory.","âœ… Profile Downloaded")}catch(v){console.error("Error downloading profile:",v),(t=u.value)==null||t.error(v.message,"âŒ Error Downloading Profile")}}function ye(c){const t={manufacturer:c.manufacturer,supportedModels:[c.model],supportedController:"Broadlink",commandsEncoding:"Base64",commands:{}};return c.platform==="climate"&&(t.minTemperature=c.config.minTemp,t.maxTemperature=c.config.maxTemp,t.precision=c.config.precision||1,t.operationModes=c.config.modes||[],t.fanModes=c.config.fanModes&&c.config.fanModes.length>0?c.config.fanModes:["auto"],c.config.swingModes&&c.config.swingModes.length>0&&(t.swingModes=c.config.swingModes),t.commands=c.commands),t}function ke(c){let t=`# SmartIR ${c.platform} configuration
`;return t+=`# Generated by Broadlink Manager v2

`,c.platform==="climate"&&(t+=`climate:
`,t+=`  - platform: smartir
`,t+=`    name: ${c.manufacturer} ${c.model}
`,t+=`    unique_id: ${c.manufacturer.toLowerCase()}_${c.model.toLowerCase().replace(/\s+/g,"_")}
`,t+=`    device_code: 10000  # Change this to your custom code number
`,t+=`    controller_data: ${c.broadlinkDevice}
`,c.config.tempSensor&&(t+=`    temperature_sensor: ${c.config.tempSensor}
`),c.config.humiditySensor&&(t+=`    humidity_sensor: ${c.config.humiditySensor}
`),c.config.powerSensor&&(t+=`    power_sensor: ${c.config.powerSensor}
`)),t}async function ge(){try{console.log("Fetching remote devices from api/remote/devices...");const c=await fetch("api/remote/devices");if(console.log("Response status:",c.status,c.ok),c.ok){const t=await c.json();console.log("Loaded remote devices response:",t);const v=t.devices||[];console.log("Extracted devices array:",v),console.log("Device count:",v.length),o.value=v,console.log("broadlinkDevices.value set to:",o.value),console.log("Final device count:",o.value.length)}else console.error("Response not OK:",c.status,c.statusText),o.value=[]}catch(c){console.error("Error loading remote devices:",c),o.value=[]}}return ie(()=>a.show,c=>{c&&ge()}),be(()=>{a.show&&ge()}),(c,t)=>s.show?(n(),r("div",{key:0,class:"modal-overlay",onClick:D},[e("div",{class:"modal-container",onClick:t[19]||(t[19]=ae(()=>{},["stop"]))},[e("div",Ti,[e("h2",null,[t[22]||(t[22]=e("i",{class:"mdi mdi-file-document-edit"},null,-1)),I(" "+f(s.editMode?"Edit SmartIR Profile":"Create SmartIR Profile"),1)]),e("button",{onClick:T,class:"close-button"},[...t[23]||(t[23]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",Ri,[(n(),r(ne,null,de(G,(v,_)=>e("div",{key:_,class:Z(["step",{active:g.value===_,completed:g.value>_}])},[e("div",Li,[g.value>_?(n(),r("i",Mi)):(n(),r("span",Oi,f(_+1),1))]),e("span",Vi,f(v.label),1)],2)),64))]),e("div",Ai,[g.value===0?(n(),r("div",Ei,[t[34]||(t[34]=e("h3",null,"Device Information",-1)),e("div",Pi,[t[25]||(t[25]=e("label",null,"Platform Type *",-1)),j(e("select",{"onUpdate:modelValue":t[0]||(t[0]=v=>S.value.platform=v),onChange:ve},[...t[24]||(t[24]=[Ie('<option value="" data-v-686070b1>Select platform...</option><option value="climate" data-v-686070b1>ğŸŒ¡ï¸ Climate (AC, Heater, Heat Pump)</option><option value="media_player" data-v-686070b1>ğŸ“º Media Player (TV, Receiver)</option><option value="fan" data-v-686070b1>ğŸŒ€ Fan</option><option value="light" data-v-686070b1>ğŸ’¡ Light (LED Strip, IR Light)</option>',5)])],544),[[fe,S.value.platform]])]),e("div",ji,[t[26]||(t[26]=e("label",null,"Manufacturer *",-1)),j(e("input",{"onUpdate:modelValue":t[1]||(t[1]=v=>S.value.manufacturer=v),type:"text",placeholder:"e.g., Daikin, LG, Samsung"},null,512),[[pe,S.value.manufacturer]])]),e("div",Fi,[t[27]||(t[27]=e("label",null,"Model(s) *",-1)),j(e("input",{"onUpdate:modelValue":t[2]||(t[2]=v=>S.value.model=v),type:"text",placeholder:"e.g., FTXS35K, Multiple models"},null,512),[[pe,S.value.model]]),t[28]||(t[28]=e("small",null,'Enter model number or "Multiple" if it works with many models',-1))]),e("div",Ui,[t[30]||(t[30]=e("label",null,"Broadlink Device *",-1)),j(e("select",{"onUpdate:modelValue":t[3]||(t[3]=v=>S.value.broadlinkDevice=v)},[t[29]||(t[29]=e("option",{value:""},"Select Broadlink device...",-1)),(n(!0),r(ne,null,de(o.value,v=>(n(),r("option",{key:v.entity_id,value:v.entity_id},f(v.name)+" ("+f(v.area_name)+") ",9,Ni))),128))],512),[[fe,S.value.broadlinkDevice]]),e("small",null,"This device will be used to learn commands ("+f(o.value.length)+" devices found)",1)]),e("div",Bi,[t[32]||(t[32]=e("label",null,"Command Type *",-1)),j(e("select",{"onUpdate:modelValue":t[4]||(t[4]=v=>S.value.commandType=v)},[...t[31]||(t[31]=[e("option",{value:"ir"},"ğŸ“¡ Infrared (IR) - Most common for AC, TV, etc.",-1),e("option",{value:"rf"},"ğŸ“» Radio Frequency (RF) - For RF remotes",-1)])],512),[[fe,S.value.commandType]]),t[33]||(t[33]=e("small",null,"Select the type of commands your device uses",-1))])])):O("",!0),g.value===1?(n(),r("div",qi,[S.value.platform==="climate"?(n(),De(va,{key:0,modelValue:S.value.config,"onUpdate:modelValue":t[5]||(t[5]=v=>S.value.config=v)},null,8,["modelValue"])):S.value.platform==="media_player"?(n(),r("div",Hi,[t[41]||(t[41]=e("h3",null,"Media Player Configuration",-1)),t[42]||(t[42]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),I(" Configure the features your media player supports. You'll learn the IR commands in the next step. ")],-1)),e("div",zi,[t[40]||(t[40]=e("h4",null,"Supported Features",-1)),e("div",Ji,[e("label",Wi,[j(e("input",{type:"checkbox",value:"turn_on","onUpdate:modelValue":t[6]||(t[6]=v=>z.value=v)},null,512),[[Q,z.value]]),t[35]||(t[35]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),I(" Power On/Off ")],-1))]),e("label",Xi,[j(e("input",{type:"checkbox",value:"volume","onUpdate:modelValue":t[7]||(t[7]=v=>z.value=v)},null,512),[[Q,z.value]]),t[36]||(t[36]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-volume-high"}),I(" Volume Control ")],-1))]),e("label",Gi,[j(e("input",{type:"checkbox",value:"mute","onUpdate:modelValue":t[8]||(t[8]=v=>z.value=v)},null,512),[[Q,z.value]]),t[37]||(t[37]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-volume-mute"}),I(" Mute ")],-1))]),e("label",Ki,[j(e("input",{type:"checkbox",value:"source","onUpdate:modelValue":t[9]||(t[9]=v=>z.value=v)},null,512),[[Q,z.value]]),t[38]||(t[38]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-import"}),I(" Source Selection ")],-1))]),e("label",Yi,[j(e("input",{type:"checkbox",value:"channel","onUpdate:modelValue":t[10]||(t[10]=v=>z.value=v)},null,512),[[Q,z.value]]),t[39]||(t[39]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-numeric"}),I(" Channel Control ")],-1))])])])])):S.value.platform==="fan"?(n(),r("div",Zi,[t[49]||(t[49]=e("h3",null,"Fan Configuration",-1)),t[50]||(t[50]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),I(" Configure the features your fan supports. You'll learn the IR commands in the next step. ")],-1)),e("div",Qi,[t[45]||(t[45]=e("h4",null,"Fan Speed Levels",-1)),e("div",er,[t[44]||(t[44]=e("label",null,"Number of Speed Levels *",-1)),j(e("select",{"onUpdate:modelValue":t[11]||(t[11]=v=>K.value=v)},[...t[43]||(t[43]=[e("option",{value:1},"1 Speed",-1),e("option",{value:2},"2 Speeds",-1),e("option",{value:3},"3 Speeds (Low/Med/High)",-1),e("option",{value:4},"4 Speeds",-1),e("option",{value:5},"5 Speeds",-1),e("option",{value:6},"6 Speeds",-1)])],512),[[fe,K.value,void 0,{number:!0}]])])]),e("div",tr,[t[48]||(t[48]=e("h4",null,"Additional Features",-1)),e("div",or,[e("label",lr,[j(e("input",{type:"checkbox",value:"oscillate","onUpdate:modelValue":t[12]||(t[12]=v=>oe.value=v)},null,512),[[Q,oe.value]]),t[46]||(t[46]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-sync"}),I(" Oscillation ")],-1))]),e("label",sr,[j(e("input",{type:"checkbox",value:"direction","onUpdate:modelValue":t[13]||(t[13]=v=>oe.value=v)},null,512),[[Q,oe.value]]),t[47]||(t[47]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-rotate-3d-variant"}),I(" Direction (Forward/Reverse) ")],-1))])])])])):S.value.platform==="light"?(n(),r("div",nr,[t[56]||(t[56]=e("h3",null,"Light Configuration",-1)),t[57]||(t[57]=e("p",{class:"help-text"},[e("i",{class:"mdi mdi-information"}),I(" Configure the features your light supports. You'll learn the IR commands in the next step. ")],-1)),e("div",ar,[t[55]||(t[55]=e("h4",null,"Supported Features",-1)),e("div",ir,[e("label",rr,[j(e("input",{type:"checkbox",value:"turn_on","onUpdate:modelValue":t[14]||(t[14]=v=>Y.value=v)},null,512),[[Q,Y.value]]),t[51]||(t[51]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),I(" Power On/Off ")],-1))]),e("label",dr,[j(e("input",{type:"checkbox",value:"brightness","onUpdate:modelValue":t[15]||(t[15]=v=>Y.value=v)},null,512),[[Q,Y.value]]),t[52]||(t[52]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-brightness-6"}),I(" Brightness Control ")],-1))]),e("label",ur,[j(e("input",{type:"checkbox",value:"color_temp","onUpdate:modelValue":t[16]||(t[16]=v=>Y.value=v)},null,512),[[Q,Y.value]]),t[53]||(t[53]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-thermometer"}),I(" Color Temperature ")],-1))]),e("label",cr,[j(e("input",{type:"checkbox",value:"rgb","onUpdate:modelValue":t[17]||(t[17]=v=>Y.value=v)},null,512),[[Q,Y.value]]),t[54]||(t[54]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-palette"}),I(" RGB Color ")],-1))])])])])):O("",!0)])):O("",!0),g.value===2?(n(),r("div",mr,[le(Pa,{modelValue:S.value.commands,"onUpdate:modelValue":t[18]||(t[18]=v=>S.value.commands=v),platform:S.value.platform,config:S.value.config,broadlinkDevice:S.value.broadlinkDevice,manufacturer:S.value.manufacturer,model:S.value.model,commandType:S.value.commandType},null,8,["modelValue","platform","config","broadlinkDevice","manufacturer","model","commandType"])])):O("",!0),g.value===3?(n(),r("div",vr,[le(ri,{profile:S.value,"json-data":V.value,"yaml-config":ee.value},null,8,["profile","json-data","yaml-config"])])):O("",!0)]),e("div",pr,[g.value>0?(n(),r("button",{key:0,onClick:B,class:"btn-secondary"},[...t[58]||(t[58]=[e("i",{class:"mdi mdi-arrow-left"},null,-1),I(" Back ",-1)])])):O("",!0),t[62]||(t[62]=e("div",{class:"spacer"},null,-1)),e("button",{onClick:T,class:"btn-text"}," Cancel "),g.value<G.length-1?(n(),r("button",{key:1,onClick:Ce,class:"btn-primary",disabled:!y.value},[...t[59]||(t[59]=[I(" Next ",-1),e("i",{class:"mdi mdi-arrow-right"},null,-1)])],8,fr)):(n(),r("div",gr,[e("button",{onClick:F,class:"btn-primary",disabled:b.value},[t[60]||(t[60]=e("i",{class:"mdi mdi-cloud-upload"},null,-1)),I(" "+f(b.value?"Saving...":"Save to SmartIR"),1)],8,yr),e("button",{onClick:ce,class:"btn-secondary",disabled:b.value},[...t[61]||(t[61]=[e("i",{class:"mdi mdi-download"},null,-1),I(" Download JSON ",-1)])],8,br)]))])]),le(Di,{show:d.value,platform:S.value.platform,warnings:M.value,"config-path":L.value,onClose:t[20]||(t[20]=v=>d.value=!1),onComplete:te},null,8,["show","platform","warnings","config-path"]),le(_e,{isOpen:R.value,title:"Change Command Type?",message:"Changing the command type will clear all learned commands. Continue?",confirmText:"Continue",cancelText:"Cancel",dangerMode:!0,onConfirm:he,onCancel:Se},null,8,["isOpen"]),le(_e,{isOpen:P.value,title:"Close Profile Builder?",message:"Are you sure you want to close? Your progress will be lost.",confirmText:"Close",cancelText:"Keep Editing",dangerMode:!0,onConfirm:A,onCancel:t[21]||(t[21]=v=>P.value=!1)},null,8,["isOpen"])])):O("",!0)}},kr=ue(hr,[["__scopeId","data-v-686070b1"]]),wr={class:"dashboard"},$r={__name:"Dashboard",setup(s){const p=Te(),a=k(!1),$=k(!1),u=k(null);function g(){$.value=!1,u.value=null,a.value=!0}async function b({platform:L,profile:i}){try{const l=await fetch(`api/smartir/platforms/${L}/profiles/${i.code}`);if(!l.ok)throw new Error("Failed to load profile");const R=await l.json();let P="";try{const h=await fetch(`api/smartir/config/get-device?platform=${L}&code=${i.code}`);h.ok?(P=(await h.json()).controller_data||"",console.log("âœ… Found controller_data from YAML:",P)):console.warn("âš ï¸ No YAML entry found for this profile (this is OK for profiles not yet added to config)")}catch(h){console.warn("âš ï¸ Could not fetch controller_data from config:",h)}$.value=!0,u.value={platform:L,code:i.code,profile:{...R.profile,controller_data:P}},a.value=!0}catch(l){console.error("Error loading profile for edit:",l),p.error("Failed to load profile for editing")}}function o(){a.value=!1,$.value=!1,u.value=null}function d(){console.log("Show install guide clicked"),window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function M(L){console.log("Profile saved:",L),o()}return(L,i)=>(n(),r("div",wr,[le(Js),i[0]||(i[0]=Ie('<div class="welcome-banner" data-v-e8424d36><div class="banner-content" data-v-e8424d36><div class="banner-icon" data-v-e8424d36><i class="mdi mdi-rocket-launch" data-v-e8424d36></i></div><div class="banner-text" data-v-e8424d36><h2 data-v-e8424d36>Welcome to Broadlink Manager v2!</h2><p data-v-e8424d36>Manage your IR/RF devices with a modern Vue 3 interface</p></div></div><div class="status-badges" data-v-e8424d36><span class="badge success" data-v-e8424d36><i class="mdi mdi-check-circle" data-v-e8424d36></i> Vue 3 Ready </span><span class="badge warning" data-v-e8424d36><i class="mdi mdi-beta" data-v-e8424d36></i> Beta </span></div></div>',1)),le(Us),le(Vn,{onCreateProfile:g,onEditProfile:b,onShowInstallGuide:d}),i[1]||(i[1]=Ie('<div class="info-cards" data-v-e8424d36><div class="info-card compact" data-v-e8424d36><i class="mdi mdi-information" data-v-e8424d36></i><p data-v-e8424d36>Beta version under development</p></div><div class="info-card compact" data-v-e8424d36><i class="mdi mdi-github" data-v-e8424d36></i><p data-v-e8424d36><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2" target="_blank" data-v-e8424d36> View on GitHub </a></p></div><div class="info-card compact" data-v-e8424d36><i class="mdi mdi-bug" data-v-e8424d36></i><p data-v-e8424d36><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2/issues" target="_blank" data-v-e8424d36> Report it on GitHub Issues </a></p></div><div class="info-card compact" data-v-e8424d36><i class="mdi mdi-reddit" data-v-e8424d36></i><p data-v-e8424d36><a href="https://www.reddit.com/r/homeassistant/comments/1o1q3kf/release_broadlink_manager_addon_a_modern_web_ui/" target="_blank" data-v-e8424d36> Join the discussion on Reddit </a></p></div><div class="info-card compact" data-v-e8424d36><i class="mdi mdi-forum" data-v-e8424d36></i><p data-v-e8424d36><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2/discussions/1" target="_blank" data-v-e8424d36> Chat on GitHub Discussions </a></p></div></div>',1)),le(kr,{show:a.value,editMode:$.value,editData:u.value,onClose:o,onSave:M},null,8,["show","editMode","editData"])]))}},Cr=ue($r,[["__scopeId","data-v-e8424d36"]]),_r={class:"toast-container"},Sr={class:"toast-content"},Ir={key:0,class:"toast-title"},xr={class:"toast-message"},Dr={key:1,class:"toast-description"},Tr=["onClick"],Rr={__name:"Toast",setup(s,{expose:p}){const a=k([]);let $=0;function u(o){const d={success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information"};return d[o]||d.info}function g({message:o,title:d,description:M,type:L="info",duration:i=5e3}){const l=$++,R={id:l,message:o,title:d,description:M,type:L};return a.value.push(R),i>0&&setTimeout(()=>{b(l)},i),l}function b(o){const d=a.value.findIndex(M=>M.id===o);d>-1&&a.value.splice(d,1)}return p({addToast:g,removeToast:b,show:g,success:(o,d)=>g({message:o,title:d,type:"success"}),error:(o,d)=>g({message:o,title:d,type:"error",duration:8e3}),warning:(o,d)=>g({message:o,title:d,type:"warning",duration:6e3}),info:(o,d)=>g({message:o,title:d,type:"info"})}),(o,d)=>(n(),De(Ue,{to:"body"},[e("div",_r,[le(Xe,{name:"toast"},{default:Oe(()=>[(n(!0),r(ne,null,de(a.value,M=>(n(),r("div",{key:M.id,class:Z(["toast",[`toast-${M.type}`]])},[e("i",{class:Z(["mdi",u(M.type)])},null,2),e("div",Sr,[M.title?(n(),r("div",Ir,f(M.title),1)):O("",!0),e("div",xr,f(M.message),1),M.description?(n(),r("div",Dr,f(M.description),1)):O("",!0)]),e("button",{onClick:L=>b(M.id),class:"toast-close"},[...d[0]||(d[0]=[e("i",{class:"mdi mdi-close"},null,-1)])],8,Tr)],2))),128))]),_:1})])]))}},Lr=ue(Rr,[["__scopeId","data-v-bf1fd466"]]),Mr={id:"app",class:"app-container"},Or={class:"app-header"},Vr={class:"header-content"},Ar={class:"header-right"},Er=["title"],Pr={class:"app-main"},jr={__name:"App",setup(s){const p=k(null),a=k("light"),$=k(null),u=N(()=>({light:"mdi mdi-weather-sunny",medium:"mdi mdi-weather-partly-cloudy",dark:"mdi mdi-weather-night"})[a.value]),g=N(()=>({light:"Switch to Medium Theme",medium:"Switch to Dark Theme",dark:"Switch to Light Theme"})[a.value]),b=()=>{const d=["light","medium","dark"],L=(d.indexOf(a.value)+1)%d.length;a.value=d[L],document.body.classList.remove("medium-mode","dark-mode"),a.value==="medium"?document.body.classList.add("medium-mode"):a.value==="dark"&&document.body.classList.add("dark-mode"),localStorage.setItem("theme",a.value)},o=async()=>{try{const d=await Be.getStatus();$.value=d,d.installed?console.log("âœ… SmartIR detected:",d.version):console.log("â„¹ï¸ SmartIR not detected")}catch(d){console.error("Error checking SmartIR:",d),$.value={installed:!1,error:d.message}}};return be(async()=>{const d=localStorage.getItem("theme");d&&["light","medium","dark"].includes(d)?(a.value=d,d==="medium"?document.body.classList.add("medium-mode"):d==="dark"&&document.body.classList.add("dark-mode")):localStorage.getItem("darkMode")==="true"&&(a.value="dark",document.body.classList.add("dark-mode"),localStorage.setItem("theme","dark")),await o();const M=Pe();M&&p.value&&(M.appContext.config.globalProperties.$toast=p.value)}),Me("smartirStatus",$),Me("refreshSmartIR",o),Me("toast",p),(d,M)=>(n(),r("div",Mr,[e("header",Or,[e("div",Vr,[M[0]||(M[0]=e("div",{class:"header-left"},[e("i",{class:"mdi mdi-remote"}),e("h1",null,"Broadlink Manager v2"),e("span",{class:"beta-badge"},"BETA")],-1)),e("div",Ar,[e("button",{onClick:b,class:"icon-button",title:g.value},[e("i",{class:Z(u.value)},null,2)],8,Er)])])]),e("main",Pr,[le(Cr)]),M[1]||(M[1]=e("footer",{class:"app-footer"},[e("p",null,"Broadlink Manager v2.0.0-beta.1 | Built with Vue 3")],-1)),le(Lr,{ref_key:"toastRef",ref:p},null,512)]))}},Fr=ue(jr,[["__scopeId","data-v-f9d3d455"]]),qe=Ge(Fr),Ur=Ke();qe.use(Ur);qe.mount("#app");
