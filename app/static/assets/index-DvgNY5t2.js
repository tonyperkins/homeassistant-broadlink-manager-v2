import{a as $e,d as Ce,r as S,c as P,o as ce,b as d,e as r,f as e,n as N,t as g,g as A,h as x,w as ae,i as E,v as le,F as q,j as J,k as re,l as ue,m as ie,p as ye,q as G,s as Q,u as ke,x as be,y as fe,z as de,A as _e,B as Se,T as xe,C as De,D as Ie,E as ge,G as Te,H as Me}from"./vendor-D65q317r.js";(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))L(n);new MutationObserver(n=>{for(const b of n)if(b.type==="childList")for(const h of b.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&L(h)}).observe(document,{childList:!0,subtree:!0});function p(n){const b={};return n.integrity&&(b.integrity=n.integrity),n.referrerPolicy&&(b.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?b.credentials="include":n.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function L(n){if(n.ep)return;n.ep=!0;const b=p(n);fetch(n.href,b)}})();const z=$e.create({baseURL:"./",timeout:3e4,headers:{"Content-Type":"application/json"}});z.interceptors.request.use(l=>l,l=>Promise.reject(l));z.interceptors.response.use(l=>l,l=>(console.error("API Error:",l),l.response?console.error("Response error:",l.response.data):l.request?console.error("No response received"):console.error("Request setup error:",l.message),Promise.reject(l)));const Re=Ce("devices",{state:()=>({devices:[],loading:!1,error:null,selectedDevice:null}),getters:{deviceById:l=>f=>l.devices.find(p=>p.id===f),devicesByType:l=>f=>l.devices.filter(p=>p.entity_type===f),deviceCount:l=>l.devices.length,hasDevices:l=>l.devices.length>0},actions:{async loadDevices(){this.loading=!0,this.error=null;try{const l=await z.get("/api/devices");this.devices=l.data.devices||[],console.log("Loaded devices:",this.devices)}catch(l){this.error=l.message,console.error("Error loading devices:",l)}finally{this.loading=!1}},async createDevice(l){this.loading=!0,this.error=null;try{const f=await z.post("/api/devices",l);return await this.loadDevices(),f.data}catch(f){throw this.error=f.message,console.error("Error creating device:",f),f}finally{this.loading=!1}},async updateDevice(l,f){this.loading=!0,this.error=null;try{const p=await z.put(`/api/devices/${l}`,f);return await this.loadDevices(),p.data}catch(p){throw this.error=p.message,console.error("Error updating device:",p),p}finally{this.loading=!1}},async deleteDevice(l){this.loading=!0,this.error=null;try{await z.delete(`/api/devices/${l}`),this.devices=this.devices.filter(f=>f.id!==l)}catch(f){throw this.error=f.message,console.error("Error deleting device:",f),f}finally{this.loading=!1}},selectDevice(l){this.selectedDevice=l},clearSelection(){this.selectedDevice=null},clearError(){this.error=null}}}),X=(l,f)=>{const p=l.__vccOpts||l;for(const[L,n]of f)p[L]=n;return p},Le={class:"device-card"},Ve={class:"device-header"},Ae={class:"device-icon"},Ee={class:"device-info"},Pe={class:"device-type"},Oe={class:"device-body"},Fe={class:"device-stats"},je={class:"stat"},Be={class:"stat"},Ue={class:"device-meta"},Ne={class:"device-id"},qe={key:0,class:"storage-name"},He={key:1,class:"broadlink-entity"},ze={class:"device-actions"},Je={__name:"DeviceCard",props:{device:{type:Object,required:!0}},emits:["edit","delete","learn"],setup(l){const f=l,p=S([]),L=P(()=>f.device.icon?f.device.icon.replace("mdi:",""):{light:"lightbulb",fan:"fan",switch:"light-switch",media_player:"television",cover:"window-shutter"}[f.device.entity_type]||"devices"),n=P(()=>({light:"Light",fan:"Fan",switch:"Switch",media_player:"Media Player",cover:"Cover"})[f.device.entity_type]||f.device.entity_type),b=P(()=>Object.keys(f.device.commands||{}).length),h=P(()=>{if(!f.device.device)return!1;const i=f.device.id.includes(".")?f.device.id.split(".")[1]:f.device.id;return f.device.device!==i}),o=P(()=>{if(!f.device.broadlink_entity)return"";const i=p.value.find(u=>u.entity_id===f.device.broadlink_entity);return i&&i.name||f.device.broadlink_entity});return ce(async()=>{try{const i=await z.get("/api/broadlink/devices");p.value=i.data.devices||[]}catch(i){console.error("Error loading Broadlink devices:",i)}}),(i,u)=>(r(),d("div",Le,[e("div",Ve,[e("div",Ae,[e("i",{class:N(`mdi mdi-${L.value}`)},null,2)]),e("div",Ee,[e("h3",null,g(l.device.name),1),e("span",Pe,g(n.value),1)])]),e("div",Oe,[e("div",Fe,[e("div",je,[u[3]||(u[3]=e("i",{class:"mdi mdi-remote"},null,-1)),e("span",null,g(b.value)+" commands",1)]),e("div",Be,[u[4]||(u[4]=e("i",{class:"mdi mdi-map-marker"},null,-1)),e("span",null,g(l.device.area||"No area"),1)])]),e("div",Ue,[e("span",Ne,[u[5]||(u[5]=e("i",{class:"mdi mdi-identifier"},null,-1)),x(" "+g(l.device.id),1)]),h.value?(r(),d("span",qe,[u[6]||(u[6]=e("i",{class:"mdi mdi-code-tags"},null,-1)),x(" "+g(l.device.device),1)])):A("",!0),l.device.broadlink_entity?(r(),d("span",He,[u[7]||(u[7]=e("i",{class:"mdi mdi-access-point"},null,-1)),x(" "+g(o.value),1)])):A("",!0)])]),e("div",ze,[e("button",{onClick:u[0]||(u[0]=s=>i.$emit("learn",l.device)),class:"action-btn primary",title:"Manage Commands"},[...u[8]||(u[8]=[e("i",{class:"mdi mdi-remote-tv"},null,-1),e("span",null,"Commands",-1)])]),e("button",{onClick:u[1]||(u[1]=s=>i.$emit("edit",l.device)),class:"action-btn",title:"Edit"},[...u[9]||(u[9]=[e("i",{class:"mdi mdi-pencil"},null,-1)])]),e("button",{onClick:u[2]||(u[2]=s=>i.$emit("delete",l.device)),class:"action-btn danger",title:"Delete"},[...u[10]||(u[10]=[e("i",{class:"mdi mdi-delete"},null,-1)])])])]))}},Ye=X(Je,[["__scopeId","data-v-5b92f4a3"]]),We={class:"icon-picker"},Ge={class:"icon-input-wrapper"},Ke=["id","placeholder"],Qe={key:0,class:"icon-preview"},Xe={key:0,class:"icon-dropdown"},Ze={class:"icon-grid"},et=["onMousedown","title"],tt={__name:"IconPicker",props:{modelValue:{type:String,default:""},inputId:{type:String,default:"icon-input"},placeholder:{type:String,default:"e.g., mdi:television"}},emits:["update:modelValue"],setup(l,{emit:f}){const p=l,L=f,n=S(p.modelValue),b=S(!1),h=["television","speaker","radio","music","video","movie","play","pause","stop","skip-next","skip-previous","volume-high","volume-medium","volume-low","volume-off","remote","remote-tv","cast","chromecast","spotify","netflix","youtube","lightbulb","lightbulb-on","lightbulb-off","lamp","floor-lamp","ceiling-light","light-switch","led-strip","led-strip-variant","wall-sconce","chandelier","spotlight","track-light","vanity-light","desk-lamp","fan","ceiling-fan","air-conditioner","thermometer","thermostat","heat-wave","snowflake","fire","radiator","water-boiler","hvac","blinds","blinds-open","window-shutter","window-shutter-open","curtains","curtains-closed","roller-shade","roller-shade-closed","garage","garage-open","gate","door","door-open","window-open","window-closed","washing-machine","tumble-dryer","dishwasher","refrigerator","stove","microwave","oven","toaster","kettle","coffee","coffee-maker","blender","robot-vacuum","robot-vacuum-variant","vacuum","broom","spray-bottle","lock","lock-open","lock-smart","key","shield","shield-check","alarm-light","bell","doorbell","camera","cctv","motion-sensor","smoke-detector","fire-extinguisher","water-alert","gas-cylinder","sofa","bed","bed-double","desk","chair","table","bookshelf","home","home-outline","home-assistant","floor-plan","room","weather-sunny","weather-night","weather-cloudy","weather-rainy","weather-snowy","weather-lightning","weather-windy","weather-fog","weather-partly-cloudy","umbrella","water","water-percent","phone","cellphone","tablet","laptop","desktop-tower","monitor","keyboard","mouse","printer","router","router-wireless","access-point","wifi","bluetooth","usb","hdmi-port","ethernet","power","power-plug","power-socket","battery","battery-charging","lightning-bolt","flash","solar-panel","solar-power","leaf","tree","flower","sprout","grass","watering-can","shovel","fence","pool","hot-tub","silverware","silverware-fork-knife","food","food-apple","glass-wine","glass-cocktail","bottle-wine","pot","pot-steam","shower","shower-head","bathtub","toilet","sink","faucet","hand-wash","car","car-side","garage-variant","tools","hammer","wrench","screwdriver","toolbox","ladder","heart","heart-pulse","run","walk","bike","dumbbell","yoga","scale-bathroom","thermometer-lines","clock","clock-outline","timer","alarm","calendar","calendar-today","calendar-clock","history","bell-ring","bell-alert","alert","alert-circle","information","help-circle","check","check-circle","close-circle","minus-circle","plus-circle","arrow-up","arrow-down","arrow-left","arrow-right","chevron-up","chevron-down","menu","dots-vertical","dots-horizontal","cog","tune","circle","square","triangle","hexagon","star","star-outline","heart-outline","plus","minus","close","check-bold","eye","eye-off","account","account-group","baby","dog","cat","paw","gift","balloon","party-popper","candle","book","book-open","newspaper","email","message","phone-classic"];ae(()=>p.modelValue,D=>{n.value=D});const o=P(()=>{if(!n.value)return h.slice(0,50);const D=n.value.toLowerCase().replace("mdi:","");return h.filter(v=>v.toLowerCase().includes(D)).slice(0,50)}),i=()=>{b.value=!0,L("update:modelValue",n.value)},u=()=>{setTimeout(()=>{b.value=!1},200)},s=D=>{n.value=`mdi:${D}`,L("update:modelValue",n.value),b.value=!1};return(D,v)=>(r(),d("div",We,[e("div",Ge,[E(e("input",{id:l.inputId,"onUpdate:modelValue":v[0]||(v[0]=M=>n.value=M),type:"text",placeholder:l.placeholder,onInput:i,onFocus:v[1]||(v[1]=M=>b.value=!0),onBlur:u},null,40,Ke),[[le,n.value]]),n.value?(r(),d("div",Qe,[e("i",{class:N(`mdi mdi-${n.value.replace("mdi:","")}`)},null,2)])):A("",!0)]),b.value&&o.value.length>0?(r(),d("div",Xe,[e("div",Ze,[(r(!0),d(q,null,J(o.value,M=>(r(),d("div",{key:M,class:"icon-option",onMousedown:re(C=>s(M),["prevent"]),title:M},[e("i",{class:N(`mdi mdi-${M}`)},null,2),e("span",null,g(M),1)],40,et))),128))])])):A("",!0)]))}},ot=X(tt,[["__scopeId","data-v-a64f5011"]]),nt={class:"modal-content"},st={class:"modal-header"},lt={class:"form-group"},at={class:"form-group"},it=["disabled"],rt={key:0,class:"smartir-notice"},dt={key:0,class:"notice-success"},ut={key:1,class:"notice-warning"},ct={key:1},mt={class:"form-group"},vt=["value"],pt={class:"form-group"},ft={class:"form-group"},yt=["value"],gt=["value"],bt={key:2},kt={key:3},ht={class:"modal-footer"},wt={type:"submit",class:"btn btn-primary"},$t={__name:"DeviceForm",props:{device:{type:Object,default:null}},emits:["save","cancel"],setup(l,{emit:f}){const p=l,L=f,n=ue("smartirStatus"),b=P(()=>{var T;return((T=n==null?void 0:n.value)==null?void 0:T.installed)||!1}),h=P(()=>!!p.device),o=P(()=>{var c;const T=((c=p.device)==null?void 0:c.commands)||{};return Object.keys(T).length>0}),i=P(()=>{if(!u.value.broadlink_entity)return"";const T=D.value.find(c=>c.entity_id===u.value.broadlink_entity);return T&&T.name||u.value.broadlink_entity}),u=S({name:"",entity_type:"",area:"",icon:"",broadlink_entity:"",commands:{}}),s=S([]),D=S([]),v=S(null),M=S(null),C=S(null),F=S(!1);ce(async()=>{p.device&&(u.value={...p.device}),await Promise.all([Z(),K()]),v.value&&(v.value.setCustomValidity(""),v.value.oninvalid=()=>{v.value.setCustomValidity("Device name is required")}),M.value&&(M.value.setCustomValidity(""),M.value.oninvalid=()=>{M.value.setCustomValidity("Entity type is required")}),C.value&&(C.value.setCustomValidity(""),C.value.oninvalid=()=>{C.value.setCustomValidity("Broadlink device is required")})});const Z=async()=>{try{const T=await z.get("/api/areas");s.value=T.data.areas||[]}catch(T){console.error("Error loading areas:",T),s.value=[]}},K=async()=>{try{const c=(await z.get("/api/broadlink/devices")).data.devices||[];D.value=c,console.log("Loaded Broadlink devices:",c)}catch(T){console.error("Error loading Broadlink devices:",T),D.value=[]}},j=T=>{const c=T==="nameInput"?v.value:T==="typeSelect"?M.value:T==="broadlinkSelect"?C.value:null;c&&c.setCustomValidity("")},H=T=>{if(!T)return"";const c=T.toLowerCase();for(const _ of s.value){const Y=_.toLowerCase();if(c.includes(Y))return _}return""},W=(T,c="")=>{const _=c.toLowerCase();return _.includes("tv")?"mdi:television":_.includes("lamp")?"mdi:lamp":_.includes("ceiling")?"mdi:ceiling-light":_.includes("floor")?"mdi:floor-lamp":_.includes("desk")?"mdi:desk-lamp":_.includes("fan")?"mdi:fan":_.includes("ac")||_.includes("air con")?"mdi:air-conditioner":_.includes("heater")?"mdi:radiator":_.includes("blind")?"mdi:blinds":_.includes("curtain")?"mdi:curtains":_.includes("garage")?"mdi:garage":_.includes("speaker")||_.includes("stereo")?"mdi:speaker":_.includes("receiver")?"mdi:audio-video":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:television",cover:"mdi:window-shutter",climate:"mdi:thermostat"}[T]||"mdi:devices"};ae(()=>u.value.name,T=>{if(!h.value&&T&&!u.value.area){const c=H(T);c&&(u.value.area=c)}!h.value&&T&&u.value.entity_type&&(F.value||!u.value.icon)&&(u.value.icon=W(u.value.entity_type,T),F.value=!0)}),ae(()=>u.value.entity_type,T=>{!h.value&&T&&(F.value||!u.value.icon)&&(u.value.icon=W(T,u.value.name),F.value=!0)}),ae(()=>u.value.icon,(T,c)=>{c!==void 0&&T!==c&&!F.value&&(F.value=!1),T||(F.value=!1)});const ne=()=>{L("save",{...u.value})};return(T,c)=>(r(),d("div",{class:"modal-overlay",onClick:c[10]||(c[10]=re(_=>T.$emit("cancel"),["self"]))},[e("div",nt,[e("div",st,[e("h2",null,g(h.value?"Edit Device":"Add New Device"),1),e("button",{onClick:c[0]||(c[0]=_=>T.$emit("cancel")),class:"close-btn"},[...c[11]||(c[11]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("form",{onSubmit:re(ne,["prevent"]),class:"modal-body"},[e("div",lt,[c[12]||(c[12]=e("label",{for:"device-name"},"Device Name *",-1)),E(e("input",{id:"device-name",ref_key:"nameInput",ref:v,"onUpdate:modelValue":c[1]||(c[1]=_=>u.value.name=_),type:"text",placeholder:"e.g., Living Room TV",required:"",onInput:c[2]||(c[2]=_=>j("nameInput"))},null,544),[[le,u.value.name]])]),e("div",at,[c[17]||(c[17]=e("label",{for:"entity-type"},"Entity Type *",-1)),E(e("select",{id:"entity-type",ref_key:"typeSelect",ref:M,"onUpdate:modelValue":c[3]||(c[3]=_=>u.value.entity_type=_),required:"",onChange:c[4]||(c[4]=_=>j("typeSelect"))},[c[13]||(c[13]=ye('<option value="" data-v-e1a68c5b>-- Select Type --</option><option value="light" data-v-e1a68c5b>ðŸ’¡ Light</option><option value="fan" data-v-e1a68c5b>ðŸŒ€ Fan</option><option value="switch" data-v-e1a68c5b>ðŸ”Œ Switch</option><option value="media_player" data-v-e1a68c5b>ðŸ“º Media Player</option><option value="cover" data-v-e1a68c5b>ðŸªŸ Cover (Blinds/Curtains)</option>',6)),e("option",{value:"climate",disabled:!b.value}," ðŸŒ¡ï¸ Climate "+g(b.value?"":"(Requires SmartIR)"),9,it)],544),[[ie,u.value.entity_type]]),u.value.entity_type==="climate"?(r(),d("div",rt,[b.value?(r(),d("div",dt,[...c[14]||(c[14]=[e("i",{class:"mdi mdi-check-circle"},null,-1),e("span",null,"SmartIR detected! Climate entities will be created via SmartIR profiles.",-1)])])):(r(),d("div",ut,[...c[15]||(c[15]=[e("i",{class:"mdi mdi-alert"},null,-1),e("div",null,[e("strong",null,"SmartIR Required"),e("p",null,"Climate entities (AC, heaters) require SmartIR integration."),e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"smartir-link"}," Install SmartIR â†’ ")],-1)])]))])):b.value?A("",!0):(r(),d("small",ct,[...c[16]||(c[16]=[x(" ðŸ’¡ Tip: Install ",-1),e("a",{href:"https://github.com/smartHomeHub/SmartIR",target:"_blank",class:"inline-link"},"SmartIR",-1),x(" for climate device support ",-1)])]))]),e("div",mt,[c[19]||(c[19]=e("label",{for:"device-area"},"Area",-1)),E(e("select",{id:"device-area","onUpdate:modelValue":c[5]||(c[5]=_=>u.value.area=_)},[c[18]||(c[18]=e("option",{value:""},"-- No Area --",-1)),(r(!0),d(q,null,J(s.value,_=>(r(),d("option",{key:_,value:_},g(_),9,vt))),128))],512),[[ie,u.value.area]]),c[20]||(c[20]=e("small",null,"Optional: Assign to a Home Assistant area",-1))]),e("div",pt,[c[21]||(c[21]=e("label",{for:"device-icon"},"Icon",-1)),G(ot,{modelValue:u.value.icon,"onUpdate:modelValue":c[6]||(c[6]=_=>u.value.icon=_),inputId:"device-icon",placeholder:"e.g., mdi:television"},null,8,["modelValue"]),c[22]||(c[22]=e("small",null,"Optional: Material Design Icon name",-1))]),e("div",ft,[c[24]||(c[24]=e("label",{for:"broadlink-entity"},"Broadlink Device",-1)),!h.value||!o.value?E((r(),d("select",{key:0,id:"broadlink-entity",ref_key:"broadlinkSelect",ref:C,"onUpdate:modelValue":c[7]||(c[7]=_=>u.value.broadlink_entity=_),required:"",onChange:c[8]||(c[8]=_=>j("broadlinkSelect"))},[c[23]||(c[23]=e("option",{value:""},"-- Select Broadlink Device --",-1)),(r(!0),d(q,null,J(D.value,_=>(r(),d("option",{key:_.entity_id,value:_.entity_id},[x(g(_.name||_.entity_id)+" ",1),_.area_name?(r(),d(q,{key:0},[x(" - "+g(_.area_name),1)],64)):A("",!0)],8,yt))),128))],544)),[[ie,u.value.broadlink_entity]]):(r(),d("input",{key:1,id:"broadlink-entity",value:i.value,type:"text",readonly:"",disabled:""},null,8,gt)),!h.value||!o.value?(r(),d("small",bt,"Required: Select which Broadlink device to use")):(r(),d("small",kt,"Cannot change Broadlink device after commands are learned"))]),e("div",ht,[e("button",{type:"button",onClick:c[9]||(c[9]=_=>T.$emit("cancel")),class:"btn btn-secondary"}," Cancel "),e("button",wt,[c[25]||(c[25]=e("i",{class:"mdi mdi-check"},null,-1)),x(" "+g(h.value?"Update":"Create"),1)])])],32)])]))}},Ct=X($t,[["__scopeId","data-v-e1a68c5b"]]),_t={class:"modal-dialog confirm-dialog"},St={class:"modal-header"},xt={class:"modal-body"},Dt={key:0,class:"checkbox-option"},It={class:"modal-footer"},Tt={__name:"ConfirmDialog",props:{isOpen:{type:Boolean,default:!1},title:{type:String,default:"Confirm"},message:{type:String,required:!0},confirmText:{type:String,default:"OK"},cancelText:{type:String,default:"Cancel"},dangerMode:{type:Boolean,default:!1},checkboxLabel:{type:String,default:""}},emits:["confirm","cancel"],setup(l,{emit:f}){const p=l,L=f,n=S(!1);ae(()=>p.isOpen,o=>{o&&(n.value=!1)});const b=()=>{L("confirm",n.value)},h=()=>{L("cancel")};return(o,i)=>l.isOpen?(r(),d("div",{key:0,class:"modal-overlay",onClick:re(h,["self"])},[e("div",_t,[e("div",St,[e("h2",null,g(l.title),1)]),e("div",xt,[e("p",null,g(l.message),1),l.checkboxLabel?(r(),d("div",Dt,[e("label",null,[E(e("input",{type:"checkbox","onUpdate:modelValue":i[0]||(i[0]=u=>n.value=u)},null,512),[[Q,n.value]]),e("span",null,g(l.checkboxLabel),1)])])):A("",!0)]),e("div",It,[e("button",{onClick:h,class:"btn btn-secondary"},g(l.cancelText),1),e("button",{onClick:b,class:N(["btn",l.dangerMode?"btn-danger":"btn-primary"])},g(l.confirmText),3)])])])):A("",!0)}},pe=X(Tt,[["__scopeId","data-v-089110d1"]]),Mt={class:"modal-content"},Rt={class:"modal-header"},Lt={class:"form-group"},Vt=["value"],At={class:"form-group"},Et=["disabled"],Pt={label:"Suggested Commands"},Ot=["value"],Ft=["disabled"],jt={class:"form-group"},Bt={class:"radio-group"},Ut={class:"radio-label"},Nt=["disabled"],qt={class:"radio-label"},Ht=["disabled"],zt={class:"learn-action"},Jt=["disabled"],Yt={key:0,class:"mdi mdi-loading mdi-spin"},Wt={key:1,class:"mdi mdi-remote-tv"},Gt={key:0,class:"learning-status"},Kt={key:1,class:"result-message success"},Qt={key:2,class:"section-divider"},Xt={key:3,class:"learned-commands"},Zt={class:"command-list"},eo={class:"command-name"},to={key:0,class:"command-status testing"},oo={key:1,class:"command-status success"},no={class:"command-actions"},so=["onClick","disabled"],lo=["onClick","disabled"],ao={key:4,class:"untracked-commands"},io={class:"command-list"},ro={class:"command-name"},uo={class:"modal-footer"},co=["disabled"],mo={__name:"CommandLearner",props:{device:{type:Object,required:!0}},emits:["cancel","learned"],setup(l,{emit:f}){const p=l,L=f,n=S([]),b=S(""),h=S(""),o=S(""),i=S("ir"),u=S(!1),s=S(""),D=S("success"),v=S([]),M=S([]),C=S(!1),F=S(""),Z=S(!1),K=S(null),j=S(null),H=S(""),W=S("");P(()=>{const w=h.value==="__custom__"?o.value:h.value;return b.value&&w.trim()});const ne=()=>{K.value&&K.value.setCustomValidity("")},T=()=>{j.value&&j.value.setCustomValidity("")},c=P(()=>{const w=n.value.find(y=>y.entity_id===b.value);return w?w.name||w.entity_id:b.value}),_={light:["turn_on","turn_off","toggle","brightness_up","brightness_down","dim","bright"],fan:["turn_on","turn_off","toggle","speed_low","speed_medium","speed_high","speed_1","speed_2","speed_3","speed_4","speed_5","oscillate_on","oscillate_off","direction_forward","direction_reverse"],switch:["turn_on","turn_off","toggle"],media_player:["turn_on","turn_off","toggle","volume_up","volume_down","volume_mute","play","pause","stop","play_pause","next_track","previous_track","channel_up","channel_down","source_hdmi1","source_hdmi2","source_hdmi3","source_tv","source_aux","source_bluetooth","menu","home","back","select","arrow_up","arrow_down","arrow_left","arrow_right"],cover:["open","close","stop","open_tilt","close_tilt","position_0","position_25","position_50","position_75","position_100"]},Y=P(()=>{const w=p.device.entity_type||"switch";return _[w]||_.switch});ce(async()=>{await oe(),await B(),await t(),K.value&&(K.value.setCustomValidity(""),K.value.oninvalid=()=>{K.value.setCustomValidity("Command name is required")}),p.device.broadlink_entity&&(b.value=p.device.broadlink_entity)}),ae(h,async w=>{w==="__custom__"&&(await ke(),j.value&&(j.value.setCustomValidity(""),j.value.oninvalid=()=>{j.value.setCustomValidity("Custom command name is required")}))});const oe=async()=>{try{const w=await z.get("/api/broadlink/devices");n.value=w.data.devices||[]}catch(w){console.error("Error loading Broadlink devices:",w)}},B=async()=>{try{const y=(await z.get(`/api/commands/${p.device.id}`)).data.commands||{};v.value=Object.keys(y)}catch(w){console.error("Error loading commands:",w)}},V=async()=>{var w,y;s.value="",D.value="",u.value=!0;try{let R=p.device.id.split(".")[1];p.device.device&&(R=p.device.device);const I=h.value==="__custom__"?o.value:h.value,te=await z.post("/api/commands/learn",{entity_id:b.value,device:R,command:I.trim(),command_type:i.value});if(te.data.success){s.value=`Command "${I}" learned successfully!`,D.value="success",v.value.includes(I)||v.value.push(I);const se=M.value.indexOf(I);se>-1&&M.value.splice(se,1);const O={...p.device.commands};O[I]=!0,h.value="",o.value="",L("learned",{commands:O,commandName:I})}else s.value=te.data.error||"Failed to learn command",D.value="error"}catch(R){s.value=((y=(w=R.response)==null?void 0:w.data)==null?void 0:y.error)||"Error learning command",D.value="error"}finally{u.value=!1}},$=async w=>{try{W.value=w,H.value="";let y=p.device.id.split(".")[1];p.device.device&&(y=p.device.device),(await z.post("/api/commands/test",{entity_id:b.value,device:y,command:w,device_id:p.device.id})).data.success&&(H.value=w,setTimeout(()=>{H.value===w&&(H.value="")},2e3))}catch(y){s.value=`Failed to send command: ${y.message}`,D.value="error"}finally{W.value=""}},U=w=>{F.value=w,C.value=!0},ee=()=>{C.value=!1,F.value=""},a=async()=>{const w=F.value;C.value=!1;try{await z.delete(`/api/commands/${p.device.id}/${w}`),await B(),await t(),s.value=`Command "${w}" deleted`,D.value="success",L("learned")}catch(y){s.value=`Failed to delete command: ${y.message}`,D.value="error"}finally{F.value=""}},t=async()=>{try{const w=p.device.device||p.device.id.split(".")[1],R=(await z.get("/api/commands/untracked")).data.untracked||{};R[w]?M.value=Object.keys(R[w].commands):M.value=[]}catch(w){console.error("Error loading untracked commands:",w),M.value=[]}},m=()=>{M.value.length!==0&&(Z.value=!0)},k=async()=>{Z.value=!1;try{const w=p.device.device||p.device.id.split(".")[1],y=await z.post("/api/commands/import",{device_id:p.device.id,source_device:w,commands:M.value});y.data.success&&(s.value=`Imported ${y.data.imported_count} commands successfully!`,D.value="success",await B(),await t(),L("learned"))}catch(w){s.value=`Failed to import commands: ${w.message}`,D.value="error"}};return(w,y)=>(r(),d("div",{class:"modal-overlay",onClick:y[7]||(y[7]=re(R=>w.$emit("cancel"),["self"]))},[e("div",Mt,[e("div",Rt,[e("h2",null,"Learn Commands for "+g(l.device.name),1),e("button",{onClick:y[0]||(y[0]=R=>w.$emit("cancel")),class:"close-btn"},[...y[8]||(y[8]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("form",{onSubmit:re(V,["prevent"]),class:"modal-body"},[e("div",Lt,[y[9]||(y[9]=e("label",{for:"broadlink-entity"},"Broadlink Device",-1)),e("input",{id:"broadlink-entity",value:c.value,type:"text",readonly:"",disabled:""},null,8,Vt),y[10]||(y[10]=e("small",null,"Commands will be learned using this device (set when device was created)",-1))]),e("div",At,[y[13]||(y[13]=e("label",{for:"command-name"},"Command Name *",-1)),E(e("select",{id:"command-name",ref_key:"commandSelect",ref:K,"onUpdate:modelValue":y[1]||(y[1]=R=>h.value=R),disabled:u.value,required:"",onChange:ne},[y[11]||(y[11]=e("option",{value:""},"-- Select or type command --",-1)),e("optgroup",Pt,[(r(!0),d(q,null,J(Y.value,R=>(r(),d("option",{key:R,value:R},g(R),9,Ot))),128))]),y[12]||(y[12]=e("option",{value:"__custom__"},"Custom command...",-1))],40,Et),[[ie,h.value]]),h.value==="__custom__"?E((r(),d("input",{key:0,ref_key:"customCommandInput",ref:j,"onUpdate:modelValue":y[2]||(y[2]=R=>o.value=R),type:"text",placeholder:"Enter custom command name",disabled:u.value,required:"",class:"custom-command-input",onInput:T},null,40,Ft)),[[le,o.value]]):A("",!0),e("small",null,"Select a suggested command for "+g(l.device.entity_type||"this device")+", or enter a custom one.",1)]),e("div",jt,[y[16]||(y[16]=e("label",null,"Command Type",-1)),e("div",Bt,[e("label",Ut,[E(e("input",{type:"radio","onUpdate:modelValue":y[3]||(y[3]=R=>i.value=R),value:"ir",disabled:u.value},null,8,Nt),[[be,i.value]]),y[14]||(y[14]=e("span",null,"IR (Infrared)",-1))]),e("label",qt,[E(e("input",{type:"radio","onUpdate:modelValue":y[4]||(y[4]=R=>i.value=R),value:"rf",disabled:u.value},null,8,Ht),[[be,i.value]]),y[15]||(y[15]=e("span",null,"RF (Radio Frequency)",-1))])])]),e("div",zt,[e("button",{type:"submit",class:"btn btn-primary btn-large",disabled:u.value},[u.value?(r(),d("i",Yt)):(r(),d("i",Wt)),x(" "+g(u.value?"Learning...":"Learn Command"),1)],8,Jt)]),u.value?(r(),d("div",Gt,[...y[17]||(y[17]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Point your remote at the Broadlink device and press the button...",-1),e("small",null,"This may take up to 30 seconds",-1)])])):A("",!0),s.value&&D.value==="success"&&!s.value.includes("sent successfully")?(r(),d("div",Kt,[y[18]||(y[18]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("p",null,g(s.value),1)])):A("",!0),v.value.length>0||M.value.length>0?(r(),d("div",Qt)):A("",!0),v.value.length>0?(r(),d("div",Xt,[e("h3",null,"Tracked Commands ("+g(v.value.length)+")",1),e("div",Zt,[(r(!0),d(q,null,J(v.value,R=>(r(),d("div",{key:R,class:N(["command-item",{testing:W.value===R,tested:H.value===R}])},[e("span",eo,g(R),1),W.value===R?(r(),d("span",to,[...y[19]||(y[19]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),x(" Sending... ",-1)])])):H.value===R?(r(),d("span",oo,[...y[20]||(y[20]=[e("i",{class:"mdi mdi-check-circle"},null,-1),x(" Sent! ",-1)])])):A("",!0),e("div",no,[e("button",{type:"button",onClick:I=>$(R),class:"icon-btn",title:"Test",disabled:W.value!==""},[...y[21]||(y[21]=[e("i",{class:"mdi mdi-play"},null,-1)])],8,so),e("button",{type:"button",onClick:I=>U(R),class:"icon-btn danger",title:"Delete",disabled:W.value!==""},[...y[22]||(y[22]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,lo)])],2))),128))])])):A("",!0),M.value.length>0?(r(),d("div",ao,[e("h3",null,[y[23]||(y[23]=e("i",{class:"mdi mdi-alert"},null,-1)),x(" Untracked Commands ("+g(M.value.length)+") ",1)]),y[26]||(y[26]=e("p",{class:"untracked-info"}," These commands exist in Broadlink storage but are not tracked in this device. ",-1)),e("div",io,[(r(!0),d(q,null,J(M.value,R=>(r(),d("div",{key:R,class:"command-item untracked"},[e("span",ro,g(R),1),y[24]||(y[24]=e("span",{class:"untracked-badge"},"Not tracked",-1))]))),128))]),e("button",{type:"button",onClick:m,class:"btn btn-secondary"},[...y[25]||(y[25]=[e("i",{class:"mdi mdi-import"},null,-1),x(" Import All Untracked Commands ",-1)])])])):A("",!0)],32),e("div",uo,[e("button",{type:"button",onClick:y[5]||(y[5]=R=>w.$emit("cancel")),class:"btn btn-secondary",disabled:u.value}," Close ",8,co)])]),G(pe,{isOpen:C.value,title:"Delete Command?",message:`Delete command '${F.value}'? This will remove it from Broadlink storage.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:a,onCancel:ee},null,8,["isOpen","message"]),G(pe,{isOpen:Z.value,title:"Import Commands?",message:`Import ${M.value.length} untracked command${M.value.length>1?"s":""} into this device?`,confirmText:"Import",cancelText:"Cancel",onConfirm:k,onCancel:y[6]||(y[6]=R=>Z.value=!1)},null,8,["isOpen","message"])]))}},vo=X(mo,[["__scopeId","data-v-ca43bb92"]]),po={key:0,class:"discovery-banner"},fo={class:"banner-content"},yo={class:"banner-text"},go={class:"modal-dialog"},bo={class:"modal-header"},ko={class:"modal-body"},ho={class:"device-list"},wo={class:"device-info"},$o={class:"device-details"},Co={class:"command-count"},_o=["onClick"],So={class:"modal-footer"},xo={__name:"DeviceDiscovery",emits:["adopt"],setup(l,{expose:f,emit:p}){const L=p,n=S([]),b=S(!1),h=P(()=>n.value.length>0);ce(async()=>{await o()});const o=async()=>{try{const u=await z.get("/api/devices/discover");n.value=u.data.untracked_devices||[]}catch(u){console.error("Error loading untracked devices:",u),n.value=[]}},i=u=>{b.value=!1,L("adopt",u)};return f({refresh:o}),(u,s)=>h.value?(r(),d("div",po,[e("div",fo,[s[6]||(s[6]=e("div",{class:"banner-icon"},[e("i",{class:"mdi mdi-radar"})],-1)),e("div",yo,[s[4]||(s[4]=e("h3",null,"Untracked Devices Found",-1)),e("p",null,g(n.value.length)+" device"+g(n.value.length>1?"s":"")+" with learned commands found in Broadlink storage",1)]),e("button",{onClick:s[0]||(s[0]=D=>b.value=!0),class:"btn btn-primary"},[...s[5]||(s[5]=[e("i",{class:"mdi mdi-eye"},null,-1),x(" View Devices ",-1)])])]),b.value?(r(),d("div",{key:0,class:"modal-overlay",onClick:s[3]||(s[3]=re(D=>b.value=!1,["self"]))},[e("div",go,[e("div",bo,[s[8]||(s[8]=e("h2",null,"Discovered Devices",-1)),e("button",{onClick:s[1]||(s[1]=D=>b.value=!1),class:"close-btn"},[...s[7]||(s[7]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",ko,[s[12]||(s[12]=e("p",{class:"info-text"}," These devices have learned commands in Broadlink storage but are not being tracked. Adopt them to manage their commands and generate Home Assistant entities. ",-1)),e("div",ho,[(r(!0),d(q,null,J(n.value,D=>(r(),d("div",{key:D.device_name,class:"discovered-device"},[e("div",wo,[s[10]||(s[10]=e("div",{class:"device-icon"},[e("i",{class:"mdi mdi-devices"})],-1)),e("div",$o,[e("h4",null,g(D.device_name),1),e("span",Co,[s[9]||(s[9]=e("i",{class:"mdi mdi-remote"},null,-1)),x(" "+g(D.command_count)+" command"+g(D.command_count>1?"s":""),1)])])]),e("button",{onClick:v=>i(D),class:"btn btn-primary"},[...s[11]||(s[11]=[e("i",{class:"mdi mdi-plus"},null,-1),x(" Adopt ",-1)])],8,_o)]))),128))])]),e("div",So,[e("button",{onClick:s[2]||(s[2]=D=>b.value=!1),class:"btn btn-secondary"}," Close ")])])])):A("",!0)])):A("",!0)}},Do=X(xo,[["__scopeId","data-v-a00a6586"]]),Io={class:"device-list"},To={class:"device-list-header"},Mo={class:"header-left"},Ro={class:"device-count"},Lo={key:0,class:"filter-bar"},Vo={class:"filter-row filter-row-search"},Ao={class:"filter-group filter-search"},Eo={class:"filter-row filter-row-dropdowns"},Po={class:"filter-group"},Oo=["value"],Fo={class:"filter-group"},jo=["value"],Bo={class:"filter-group"},Uo={class:"filter-results"},No={key:1,class:"loading-state"},qo={key:2,class:"error-state"},Ho={key:3,class:"empty-state"},zo={key:4,class:"device-grid"},Jo={key:5,class:"no-results"},Yo={__name:"DeviceList",setup(l){const f=Re(),p=S(!1),L=S(!1),n=S(null),b=S(!1),h=S(null),o=S(null),i=S({search:"",broadlinkDevice:"",area:"",entityType:""}),u=S([]),s=P(()=>{const a=new Map;return f.devices.forEach(t=>{if(t.broadlink_entity){const m=u.value.find(w=>w.entity_id===t.broadlink_entity),k=m&&m.name||t.broadlink_entity;a.set(t.broadlink_entity,{entity_id:t.broadlink_entity,friendly_name:k})}}),Array.from(a.values()).sort((t,m)=>t.friendly_name.localeCompare(m.friendly_name))}),D=P(()=>{const a=new Set;return f.devices.forEach(t=>{t.area&&a.add(t.area)}),Array.from(a).sort()}),v=P(()=>{let a=f.devices;if(i.value.search){const t=i.value.search.toLowerCase();a=a.filter(m=>{var y,R,I,te,se;if((y=m.name)!=null&&y.toLowerCase().includes(t)||(R=m.entity_type)!=null&&R.toLowerCase().includes(t)||(I=m.area)!=null&&I.toLowerCase().includes(t)||(te=m.id)!=null&&te.toLowerCase().includes(t)||Object.keys(m.commands||{}).some(O=>O.toLowerCase().includes(t)))return!0;const w=u.value.find(O=>O.entity_id===m.broadlink_entity);return!!((se=w==null?void 0:w.name)!=null&&se.toLowerCase().includes(t))})}return i.value.broadlinkDevice&&(a=a.filter(t=>t.broadlink_entity===i.value.broadlinkDevice)),i.value.area&&(a=a.filter(t=>t.area===i.value.area)),i.value.entityType&&(a=a.filter(t=>t.entity_type===i.value.entityType)),a}),M=P(()=>i.value.search||i.value.broadlinkDevice||i.value.area||i.value.entityType),C=()=>{i.value.search="",i.value.broadlinkDevice="",i.value.area="",i.value.entityType=""},F=async()=>{try{const a=await z.get("/api/broadlink/devices");u.value=a.data.devices||[]}catch(a){console.error("Error loading Broadlink devices:",a)}};ce(async()=>{await Promise.all([f.loadDevices(),F()])});const Z=a=>{n.value=a,p.value=!0},K=P(()=>{if(!h.value)return"";const a=Object.keys(h.value.commands||{}).length;return a===0?"This device has no commands. The device will be removed from tracking.":`This device has ${a} learned command${a>1?"s":""}. What would you like to do?`}),j=P(()=>{if(!h.value)return"";const a=Object.keys(h.value.commands||{}).length;return a===0?"":`Also delete all ${a} command${a>1?"s":""} from Broadlink storage`}),H=a=>{h.value=a,b.value=!0},W=()=>{b.value=!1,h.value=null},ne=async a=>{const t=h.value;b.value=!1;try{if(a&&t.commands){const m=Object.values(t.commands),k=t.device||t.id.split(".")[1];for(const w of m)try{await z.delete(`/api/commands/${t.id}/${Object.keys(t.commands).find(y=>t.commands[y]===w)}`)}catch(y){console.error(`Failed to delete command ${w}:`,y)}}await f.deleteDevice(t.id),o.value&&await o.value.refresh()}catch(m){alert("Failed to delete device: "+m.message)}finally{h.value=null}},T=async a=>{var t;try{(t=n.value)!=null&&t.id&&n.value.id!==null?await f.updateDevice(n.value.id,a):await f.createDevice(a),c(),o.value&&await o.value.refresh()}catch(m){alert("Failed to save device: "+m.message)}},c=()=>{p.value=!1,n.value=null},_=a=>{n.value=a,L.value=!0},Y=()=>{L.value=!1,n.value=null},oe=async a=>{if(a&&a.commands&&n.value){const t=f.devices.findIndex(m=>m.id===n.value.id);t!==-1&&(f.devices[t].commands=a.commands,console.log(`Optimistically updated device ${n.value.id} with new command: ${a.commandName}`))}f.loadDevices(),o.value&&o.value.refresh()},B=a=>{const t=a.split("_"),m=[];for(let k=0;k<t.length;k++){const w=t[k],y=t[k+1];w&&y==="s"&&t[k+2]?(m.push(w.charAt(0).toUpperCase()+w.slice(1)+"'s"),k++):w!=="s"&&m.push(w.charAt(0).toUpperCase()+w.slice(1))}return m.join(" ")},V=(a,t)=>{const m=a.toLowerCase(),k=t.map(I=>I.toLowerCase());return m.includes("lamp")||m.includes("light")?"light":m.includes("fan")?"fan":m.includes("tv")||m.includes("stereo")||m.includes("speaker")||m.includes("receiver")?"media_player":m.includes("blind")||m.includes("curtain")||m.includes("shade")||m.includes("garage")?"cover":k.some(I=>I.includes("volume")||I.includes("channel")||I.includes("play")||I.includes("pause")||I.includes("mute"))?"media_player":k.some(I=>I.includes("fan_speed")||I.includes("fan_low")||I.includes("fan_high"))?"fan":k.some(I=>I.includes("open")||I.includes("close")||I.includes("stop"))?"cover":"switch"},$=(a,t)=>{const m=a.toLowerCase();return m.includes("tv")?"mdi:television":m.includes("stereo")||m.includes("receiver")||m.includes("speaker")?"mdi:speaker":m.includes("lamp")?"mdi:lamp":m.includes("light")?"mdi:lightbulb":m.includes("fan")?"mdi:fan":m.includes("blind")?"mdi:blinds":m.includes("curtain")?"mdi:curtains":m.includes("garage")?"mdi:garage":{light:"mdi:lightbulb",fan:"mdi:fan",switch:"mdi:light-switch",media_player:"mdi:speaker",cover:"mdi:window-shutter"}[t]||"mdi:devices"},U=a=>{const t=a.toLowerCase().split("_");for(let w=0;w<t.length-2;w++)if(t[w+1]==="s"){const y=t.slice(w,w+3),R=B(y.join("_"));return console.log("Detected possessive area:",R,"from",a),R}const m=[["living","room"],["dining","room"],["master","bedroom"],["guest","bedroom"],["family","room"],["laundry","room"],["home","office"]];for(let w=0;w<t.length-1;w++){const y=[t[w],t[w+1]],R=m.find(I=>I[0]===y[0]&&I[1]===y[1]);if(R)return B(R.join("_"))}const k=["kitchen","bedroom","bathroom","garage","office","basement","attic","hallway","entryway","patio","deck","yard","garden"];for(const w of t)if(k.includes(w))return w.charAt(0).toUpperCase()+w.slice(1);return""},ee=async a=>{const t=B(a.device_name),m=U(a.device_name),k=V(a.device_name,a.commands),w=$(a.device_name,k);let y="";try{console.log("Finding Broadlink owner for:",a.device_name);const I=await z.post("/api/devices/find-broadlink-owner",{device_name:a.device_name});console.log("Broadlink owner response:",I.data),y=I.data.broadlink_entity||"",console.log("Detected Broadlink entity:",y)}catch(I){console.error("Error finding Broadlink owner:",I)}n.value={id:null,device:a.device_name,name:t,entity_type:k,commands:{},area:m,icon:w,broadlink_entity:y,enabled:!0};const R={};a.commands.forEach(I=>{R[I]=I}),n.value.commands=R,p.value=!0};return(a,t)=>{var m;return r(),d("div",Io,[e("div",To,[e("div",Mo,[t[7]||(t[7]=e("h2",null,"Managed Devices",-1)),e("span",Ro,g(de(f).deviceCount)+" devices",1)]),e("button",{onClick:t[0]||(t[0]=k=>p.value=!0),class:"btn btn-primary"},[...t[8]||(t[8]=[e("i",{class:"mdi mdi-plus"},null,-1),x(" Add Device ",-1)])])]),G(Do,{ref_key:"discoveryRef",ref:o,onAdopt:ee},null,512),de(f).hasDevices?(r(),d("div",Lo,[e("div",Vo,[e("div",Ao,[e("label",null,[t[9]||(t[9]=e("i",{class:"mdi mdi-magnify"},null,-1)),E(e("input",{"onUpdate:modelValue":t[1]||(t[1]=k=>i.value.search=k),type:"text",placeholder:"Search devices, commands...",class:"search-input"},null,512),[[le,i.value.search]])])])]),e("div",Eo,[e("div",Po,[e("label",null,[t[11]||(t[11]=e("i",{class:"mdi mdi-access-point"},null,-1)),E(e("select",{"onUpdate:modelValue":t[2]||(t[2]=k=>i.value.broadlinkDevice=k)},[t[10]||(t[10]=e("option",{value:""},"All Broadlink Devices",-1)),(r(!0),d(q,null,J(s.value,k=>(r(),d("option",{key:k.entity_id,value:k.entity_id},g(k.friendly_name),9,Oo))),128))],512),[[ie,i.value.broadlinkDevice]])])]),e("div",Fo,[e("label",null,[t[13]||(t[13]=e("i",{class:"mdi mdi-home-map-marker"},null,-1)),E(e("select",{"onUpdate:modelValue":t[3]||(t[3]=k=>i.value.area=k)},[t[12]||(t[12]=e("option",{value:""},"All Areas",-1)),(r(!0),d(q,null,J(D.value,k=>(r(),d("option",{key:k,value:k},g(k),9,jo))),128))],512),[[ie,i.value.area]])])]),e("div",Bo,[e("label",null,[t[15]||(t[15]=e("i",{class:"mdi mdi-shape"},null,-1)),E(e("select",{"onUpdate:modelValue":t[4]||(t[4]=k=>i.value.entityType=k)},[...t[14]||(t[14]=[ye('<option value="" data-v-6d51b81e>All Types</option><option value="light" data-v-6d51b81e>Light</option><option value="fan" data-v-6d51b81e>Fan</option><option value="switch" data-v-6d51b81e>Switch</option><option value="media_player" data-v-6d51b81e>Media Player</option><option value="cover" data-v-6d51b81e>Cover</option>',6)])],512),[[ie,i.value.entityType]])])]),M.value?(r(),d("button",{key:0,onClick:C,class:"btn-clear-filters"},[...t[16]||(t[16]=[e("i",{class:"mdi mdi-filter-remove"},null,-1),x(" Clear ",-1)])])):A("",!0),e("div",Uo,g(v.value.length)+" of "+g(de(f).deviceCount),1)])])):A("",!0),de(f).loading?(r(),d("div",No,[...t[17]||(t[17]=[e("i",{class:"mdi mdi-loading mdi-spin"},null,-1),e("p",null,"Loading devices...",-1)])])):de(f).error?(r(),d("div",qo,[t[18]||(t[18]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,g(de(f).error),1),e("button",{onClick:t[5]||(t[5]=k=>de(f).loadDevices()),class:"btn btn-secondary"}," Retry ")])):de(f).hasDevices?(r(),d("div",zo,[(r(!0),d(q,null,J(v.value,k=>(r(),fe(Ye,{key:k.id,device:k,onEdit:Z,onDelete:H,onLearn:_},null,8,["device"]))),128))])):(r(),d("div",Ho,[t[20]||(t[20]=e("i",{class:"mdi mdi-devices"},null,-1)),t[21]||(t[21]=e("h3",null,"No Devices Yet",-1)),t[22]||(t[22]=e("p",null,"Get started by adding your first managed device",-1)),e("button",{onClick:t[6]||(t[6]=k=>p.value=!0),class:"btn btn-primary"},[...t[19]||(t[19]=[e("i",{class:"mdi mdi-plus"},null,-1),x(" Add Your First Device ",-1)])])])),de(f).hasDevices&&v.value.length===0?(r(),d("div",Jo,[t[23]||(t[23]=e("i",{class:"mdi mdi-filter-off"},null,-1)),t[24]||(t[24]=e("h3",null,"No devices match your filters",-1)),e("button",{onClick:C,class:"btn btn-secondary"}," Clear Filters ")])):A("",!0),p.value?(r(),fe(Ct,{key:6,device:n.value,onSave:T,onCancel:c},null,8,["device"])):A("",!0),L.value?(r(),fe(vo,{key:7,device:n.value,onLearned:oe,onCancel:Y},null,8,["device"])):A("",!0),G(pe,{isOpen:b.value,title:`Delete ${(m=h.value)==null?void 0:m.name}?`,message:K.value,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,checkboxLabel:j.value,onConfirm:ne,onCancel:W},null,8,["isOpen","title","message","checkboxLabel"])])}}},Wo=X(Yo,[["__scopeId","data-v-6d51b81e"]]),Go={class:"banner-content"},Ko={class:"banner-icon"},Qo={class:"banner-message"},Xo={class:"banner-actions"},Zo={__name:"SmartIRBanner",setup(l){const f=ue("smartirStatus"),p=S(!1),L=P(()=>!(!f.value||p.value||localStorage.getItem("smartir_banner_dismissed")==="true")),n=P(()=>{var s;return(s=f.value)!=null&&s.installed?"banner-success":"banner-info"}),b=P(()=>{var s;return(s=f.value)!=null&&s.installed?"mdi mdi-check-circle":"mdi mdi-information"}),h=P(()=>{var s;return(s=f.value)!=null&&s.installed?`SmartIR Detected (v${f.value.version})`:"Want Climate Device Support?"}),o=P(()=>{var s;return(s=f.value)!=null&&s.installed?"You can now create climate device profiles with full temperature and HVAC mode control.":"Install SmartIR to unlock AC/heater control with temperature settings, HVAC modes, and 120+ pre-configured device profiles."});function i(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function u(){var s;if(p.value=!0,(s=f.value)!=null&&s.installed)localStorage.setItem("smartir_banner_dismissed","true");else{const D=parseInt(localStorage.getItem("smartir_banner_dismiss_count")||"0");D>=2?localStorage.setItem("smartir_banner_dismissed","true"):localStorage.setItem("smartir_banner_dismiss_count",String(D+1))}}return ce(()=>{var v;const s=localStorage.getItem("smartir_last_status"),D=(v=f.value)!=null&&v.installed?"installed":"not_installed";s!==D&&(localStorage.removeItem("smartir_banner_dismissed"),localStorage.removeItem("smartir_banner_dismiss_count"),localStorage.setItem("smartir_last_status",D))}),(s,D)=>{var v,M;return L.value?(r(),d("div",{key:0,class:N(["smartir-banner",n.value])},[e("div",Go,[e("div",Ko,[e("i",{class:N(b.value)},null,2)]),e("div",Qo,[e("strong",null,g(h.value),1),e("p",null,g(o.value),1)]),e("div",Xo,[(v=s.status)!=null&&v.installed?A("",!0):(r(),d("button",{key:0,onClick:i,class:"btn-primary"}," Learn More ")),e("button",{onClick:u,class:"btn-text"},g((M=s.status)!=null&&M.installed?"Got it":"Dismiss"),1)])])],2)):A("",!0)}}},en=X(Zo,[["__scopeId","data-v-2fd571d2"]]),ve="api/smartir",he={async getStatus(){try{const l=await fetch(`${ve}/status`);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){return console.error("Error fetching SmartIR status:",l),{installed:!1,version:null,error:l.message}}},async getInstallInstructions(){try{const l=await fetch(`${ve}/install-instructions`);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){throw console.error("Error fetching install instructions:",l),l}},async getPlatforms(){try{const l=await fetch(`${ve}/platforms`);if(!l.ok)throw new Error(`HTTP error! status: ${l.status}`);return await l.json()}catch(l){throw console.error("Error fetching platforms:",l),l}},async getPlatformCodes(l){try{const f=await fetch(`${ve}/platforms/${l}/codes`);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);return await f.json()}catch(f){throw console.error(`Error fetching codes for ${l}:`,f),f}},async getNextCode(l){try{const f=await fetch(`${ve}/platforms/${l}/next-code`);if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);return await f.json()}catch(f){throw console.error(`Error fetching next code for ${l}:`,f),f}},async validateCode(l,f){try{const p=await fetch(`${ve}/validate-code`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:l,code:f})});if(!p.ok)throw new Error(`HTTP error! status: ${p.status}`);return await p.json()}catch(p){throw console.error("Error validating code:",p),p}}},tn={class:"smartir-status-card"},on={class:"card-header"},nn={class:"header-left"},sn={key:0,class:"header-badges"},ln={class:"header-info"},an={class:"header-info"},rn={class:"header-info"},dn={class:"header-right"},un={key:0,class:"card-body loading-state"},cn={key:1,class:"card-body error-state"},mn={key:2,class:"card-body installed-state"},vn={key:0,class:"help-panel"},pn={key:0,class:"recommendation"},fn={key:0,class:"next-steps"},yn={key:1,class:"platforms-section"},gn={class:"platform-list"},bn=["onClick"],kn={class:"platform-icon"},hn={class:"platform-info"},wn={class:"platform-name"},$n={class:"device-count"},Cn={key:0,class:"platform-profiles"},_n={key:0,class:"profiles-loading"},Sn={key:1,class:"profile-list"},xn={class:"profile-info"},Dn={class:"profile-name"},In={class:"profile-code"},Tn={class:"profile-actions"},Mn=["onClick"],Rn=["onClick"],Ln=["onClick"],Vn={key:2,class:"no-profiles"},An={key:3,class:"card-body not-installed-state"},En={class:"benefits-section"},Pn={class:"benefits-list"},On={class:"recommendation"},Fn={__name:"SmartIRStatusCard",emits:["create-profile","show-install-guide","edit-profile"],setup(l,{emit:f}){const p=f,L=ue("smartirStatus"),n=ue("refreshSmartIR"),b=S(!1),h=S(null),o=S((L==null?void 0:L.value)||null),i=S(!1),u=S({}),s=S({}),D=S({}),v=S({show:!1,title:"",message:"",platform:null,profile:null}),M=["Full climate entity support (AC, heaters)","120+ pre-configured device profiles","Temperature and humidity sensor integration","HVAC mode control (heat, cool, auto, dry, fan)"],C=P(()=>{var V,$;return(($=(V=o.value)==null?void 0:V.platforms)==null?void 0:$.length)||0}),F=P(()=>{var V;return(V=o.value)!=null&&V.device_counts?Object.values(o.value.device_counts).reduce(($,U)=>$+U,0):0});function Z(V){return{climate:"mdi mdi-air-conditioner",media_player:"mdi mdi-television",fan:"mdi mdi-fan",light:"mdi mdi-lightbulb"}[V]||"mdi mdi-devices"}function K(V){return V.split("_").map($=>$.charAt(0).toUpperCase()+$.slice(1)).join(" ")}async function j(){b.value=!0,h.value=null;try{if(n)await n();else{const V=await he.getStatus();o.value=V}}catch(V){h.value=V.message||"Failed to refresh SmartIR status",console.error("Error refreshing SmartIR status:",V)}finally{b.value=!1}}function H(){p("create-profile")}function W(){p("show-install-guide")}function ne(){window.open("https://github.com/smartHomeHub/SmartIR","_blank")}async function T(V){const $=u.value[V];Object.keys(u.value).forEach(U=>{u.value[U]=!1}),u.value[V]=!$,u.value[V]&&!s.value[V]&&await c(V)}async function c(V){D.value[V]=!0;try{const $=await fetch(`/api/smartir/platforms/${V}/profiles`);if($.ok){const U=await $.json();s.value={...s.value,[V]:U.profiles||[]}}}catch($){console.error(`Error loading ${V} profiles:`,$),s.value={...s.value,[V]:[]}}finally{D.value[V]=!1}}function _(V,$){p("edit-profile",{platform:V,profile:$})}async function Y(V,$){var U,ee;try{const a=await fetch(`/api/smartir/platforms/${V}/profiles/${$.code}`);if(!a.ok)throw new Error("Failed to fetch profile");const t=await a.json(),m=JSON.stringify(t.profile,null,2),k=new Blob([m],{type:"application/json"}),w=URL.createObjectURL(k),y=document.createElement("a");y.href=w,y.download=`smartir_${V}_${$.manufacturer}_${$.model}_${$.code}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(w),(U=ue("toast").value)==null||U.success(`Downloaded ${$.manufacturer} ${$.model}`,"âœ… Profile Downloaded")}catch(a){console.error("Error downloading profile:",a),(ee=ue("toast").value)==null||ee.error("Failed to download profile","âŒ Download Error")}}function oe(V,$){v.value={show:!0,title:`Delete ${$.manufacturer} ${$.model}?`,message:`Device Code: ${$.code}

This will remove the profile and update your configuration.`,platform:V,profile:$}}async function B(){var ee,a,t;const V=ue("toast"),{platform:$,profile:U}=v.value;v.value.show=!1;try{const m=await fetch(`/api/smartir/profiles/${U.code}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:$})});if(m.ok)console.log("ðŸ”„ Reloading profiles for platform:",$),await c($),console.log("ðŸ”„ Updated profiles:",s.value[$]),await ke(),await j(),console.log("ðŸ”„ Status refreshed"),(ee=V.value)==null||ee.success(`${U.manufacturer} ${U.model} has been removed`,"âœ… Profile Deleted");else{const k=await m.json();(a=V.value)==null||a.error(k.error||"Unknown error","âŒ Delete Failed")}}catch(m){console.error("Error deleting profile:",m),(t=V.value)==null||t.error("Failed to delete profile","âŒ Delete Error")}}return ae(L,V=>{V&&(o.value=V)},{immediate:!0}),ce(async()=>{L!=null&&L.value&&(o.value=L.value),o.value||await j()}),(V,$)=>{var U,ee,a,t,m,k,w,y,R;return r(),d("div",tn,[e("div",on,[e("div",nn,[$[3]||($[3]=e("i",{class:"mdi mdi-air-conditioner"},null,-1)),$[4]||($[4]=e("h3",null,"SmartIR Integration",-1)),(U=o.value)!=null&&U.installed?(r(),d("div",sn,[$[2]||($[2]=e("div",{class:"status-badge-mini success"},[e("i",{class:"mdi mdi-check-circle"}),e("span",null,"Installed")],-1)),e("span",ln,"v"+g(o.value.version||"Unknown"),1),e("span",an,g(C.value)+" platform"+g(C.value!==1?"s":""),1),e("span",rn,g(F.value)+" device"+g(F.value!==1?"s":""),1)])):A("",!0)]),e("div",dn,[(ee=o.value)!=null&&ee.installed?(r(),d("button",{key:0,onClick:$[0]||($[0]=I=>i.value=!i.value),class:N(["icon-button",{active:i.value}]),title:"Show help"},[...$[5]||($[5]=[e("i",{class:"mdi mdi-help-circle"},null,-1)])],2)):A("",!0),(a=o.value)!=null&&a.installed?(r(),d("button",{key:1,onClick:j,class:"icon-button",title:"Refresh status"},[...$[6]||($[6]=[e("i",{class:"mdi mdi-refresh"},null,-1)])])):A("",!0)])]),b.value?(r(),d("div",un,[...$[7]||($[7]=[e("div",{class:"spinner"},null,-1),e("p",null,"Checking SmartIR installation...",-1)])])):h.value?(r(),d("div",cn,[$[8]||($[8]=e("i",{class:"mdi mdi-alert-circle"},null,-1)),e("p",null,g(h.value),1),e("button",{onClick:j,class:"btn-secondary"}," Try Again ")])):(t=o.value)!=null&&t.installed?(r(),d("div",mn,[i.value?(r(),d("div",vn,[o.value.recommendation?(r(),d("div",pn,[e("p",null,g(o.value.recommendation.message),1),o.value.recommendation.next_steps?(r(),d("div",fn,[$[9]||($[9]=e("strong",null,"Next Steps:",-1)),e("ul",null,[(r(!0),d(q,null,J(o.value.recommendation.next_steps,(I,te)=>(r(),d("li",{key:te},g(I),1))),128))])])):A("",!0)])):A("",!0)])):A("",!0),(m=o.value.platforms)!=null&&m.length?(r(),d("div",yn,[$[15]||($[15]=e("h4",null,"Available Platforms",-1)),e("div",gn,[(r(!0),d(q,null,J(o.value.platforms,I=>{var te,se;return r(),d("div",{key:I,class:N(["platform-card",{expanded:u.value[I]}])},[e("div",{class:"platform-header",onClick:O=>T(I)},[e("div",kn,[e("i",{class:N(Z(I))},null,2)]),e("div",hn,[e("span",wn,g(K(I)),1),e("span",$n,g(((te=o.value.device_counts)==null?void 0:te[I])||0)+" devices ",1)]),e("i",{class:N(["mdi",u.value[I]?"mdi-chevron-up":"mdi-chevron-down"])},null,2)],8,bn),u.value[I]?(r(),d("div",Cn,[D.value[I]?(r(),d("div",_n,[...$[10]||($[10]=[e("div",{class:"spinner-small"},null,-1),e("span",null,"Loading profiles...",-1)])])):(se=s.value[I])!=null&&se.length?(r(),d("div",Sn,[(r(!0),d(q,null,J(s.value[I],O=>(r(),d("div",{key:`${I}-${O.code}`,class:"profile-item"},[e("div",xn,[e("span",Dn,g(O.manufacturer)+" "+g(O.model),1),e("span",In,"Code: "+g(O.code),1)]),e("div",Tn,[e("button",{onClick:me=>_(I,O),class:"action-btn",title:"Edit"},[...$[11]||($[11]=[e("i",{class:"mdi mdi-pencil"},null,-1)])],8,Mn),e("button",{onClick:me=>Y(I,O),class:"action-btn",title:"Download"},[...$[12]||($[12]=[e("i",{class:"mdi mdi-download"},null,-1)])],8,Rn),e("button",{onClick:me=>oe(I,O),class:"action-btn delete",title:"Delete"},[...$[13]||($[13]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Ln)])]))),128))])):(r(),d("div",Vn,[...$[14]||($[14]=[e("i",{class:"mdi mdi-information-outline"},null,-1),e("p",null,"No profiles created yet",-1)])]))])):A("",!0)],2)}),128))])])):A("",!0),e("div",{class:"card-actions"},[e("button",{onClick:H,class:"btn-primary"},[...$[16]||($[16]=[e("i",{class:"mdi mdi-plus-circle"},null,-1),x(" Create SmartIR Profile ",-1)])]),e("button",{onClick:ne,class:"btn-secondary"},[...$[17]||($[17]=[e("i",{class:"mdi mdi-book-open-variant"},null,-1),x(" Documentation ",-1)])])])])):(r(),d("div",An,[$[22]||($[22]=e("div",{class:"status-badge warning"},[e("i",{class:"mdi mdi-information"}),e("span",null,"Not Installed")],-1)),e("div",En,[$[19]||($[19]=e("h4",null,"Why Install SmartIR?",-1)),e("ul",Pn,[(r(!0),d(q,null,J(((w=(k=o.value)==null?void 0:k.recommendation)==null?void 0:w.benefits)||M,(I,te)=>(r(),d("li",{key:te},[$[18]||($[18]=e("i",{class:"mdi mdi-check"},null,-1)),e("span",null,g(I),1)]))),128))])]),e("div",On,[e("p",null,g(((R=(y=o.value)==null?void 0:y.recommendation)==null?void 0:R.message)||"Install SmartIR to unlock climate device support!"),1)]),e("div",{class:"card-actions"},[e("button",{onClick:W,class:"btn-primary"},[...$[20]||($[20]=[e("i",{class:"mdi mdi-download"},null,-1),x(" Install SmartIR ",-1)])]),e("button",{onClick:ne,class:"btn-secondary"},[...$[21]||($[21]=[e("i",{class:"mdi mdi-help-circle"},null,-1),x(" Learn More ",-1)])])])])),G(pe,{isOpen:v.value.show,title:v.value.title,message:v.value.message,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:B,onCancel:$[1]||($[1]=I=>v.value.show=!1)},null,8,["isOpen","title","message"])])}}},jn=X(Fn,[["__scopeId","data-v-9df65575"]]),Bn={class:"climate-form"},Un={class:"form-section"},Nn={class:"form-row"},qn={class:"form-group"},Hn={class:"form-group"},zn={class:"form-group"},Jn={class:"form-section"},Yn={class:"checkbox-grid"},Wn={class:"checkbox-item"},Gn={class:"checkbox-item"},Kn={class:"checkbox-item"},Qn={class:"checkbox-item"},Xn={class:"checkbox-item"},Zn={class:"checkbox-item"},es={class:"form-section"},ts={class:"checkbox-grid"},os={class:"checkbox-item"},ns={class:"checkbox-item"},ss={class:"checkbox-item"},ls={class:"checkbox-item"},as={class:"form-section"},is={class:"checkbox-grid"},rs={class:"checkbox-item"},ds={class:"checkbox-item"},us={class:"checkbox-item"},cs={class:"checkbox-item"},ms={class:"form-section"},vs={class:"form-group"},ps={class:"form-group"},fs={class:"form-group"},ys={key:0,class:"validation-summary"},gs={__name:"ClimateProfileForm",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(l,{emit:f}){const p=l,L=f,n=S({minTemp:16,maxTemp:30,precision:1,modes:["off","auto","cool","heat"],fanModes:["auto","low","medium","high"],swingModes:[],tempSensor:"",humiditySensor:"",powerSensor:"",...p.modelValue}),b=P(()=>{const h=[];return(!n.value.minTemp||n.value.minTemp<10||n.value.minTemp>35)&&h.push("Minimum temperature must be between 10Â°C and 35Â°C"),(!n.value.maxTemp||n.value.maxTemp<10||n.value.maxTemp>35)&&h.push("Maximum temperature must be between 10Â°C and 35Â°C"),n.value.minTemp>=n.value.maxTemp&&h.push("Minimum temperature must be less than maximum temperature"),(!n.value.modes||n.value.modes.length===0)&&h.push("At least one HVAC mode must be selected"),h});return ae(n,h=>{L("update:modelValue",h)},{deep:!0}),(h,o)=>(r(),d("div",Bn,[o[54]||(o[54]=e("h3",null,"Climate Device Configuration",-1)),e("div",Un,[o[24]||(o[24]=e("h4",null,"Temperature Range",-1)),e("div",Nn,[e("div",qn,[o[20]||(o[20]=e("label",null,"Minimum Temperature (Â°C) *",-1)),E(e("input",{"onUpdate:modelValue":o[0]||(o[0]=i=>n.value.minTemp=i),type:"number",min:"10",max:"35",placeholder:"16"},null,512),[[le,n.value.minTemp,void 0,{number:!0}]])]),e("div",Hn,[o[21]||(o[21]=e("label",null,"Maximum Temperature (Â°C) *",-1)),E(e("input",{"onUpdate:modelValue":o[1]||(o[1]=i=>n.value.maxTemp=i),type:"number",min:"10",max:"35",placeholder:"30"},null,512),[[le,n.value.maxTemp,void 0,{number:!0}]])]),e("div",zn,[o[23]||(o[23]=e("label",null,"Precision",-1)),E(e("select",{"onUpdate:modelValue":o[2]||(o[2]=i=>n.value.precision=i)},[...o[22]||(o[22]=[e("option",{value:1},"1Â°C (Whole degrees)",-1),e("option",{value:.5},"0.5Â°C (Half degrees)",-1)])],512),[[ie,n.value.precision,void 0,{number:!0}]])])])]),e("div",Jn,[o[31]||(o[31]=e("h4",null,"Supported HVAC Modes *",-1)),o[32]||(o[32]=e("p",{class:"help-text"},"Select all modes your device supports",-1)),e("div",Yn,[e("label",Wn,[E(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":o[3]||(o[3]=i=>n.value.modes=i)},null,512),[[Q,n.value.modes]]),o[25]||(o[25]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-power"}),x(" Off ")],-1))]),e("label",Gn,[E(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":o[4]||(o[4]=i=>n.value.modes=i)},null,512),[[Q,n.value.modes]]),o[26]||(o[26]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),x(" Auto ")],-1))]),e("label",Kn,[E(e("input",{type:"checkbox",value:"cool","onUpdate:modelValue":o[5]||(o[5]=i=>n.value.modes=i)},null,512),[[Q,n.value.modes]]),o[27]||(o[27]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-snowflake"}),x(" Cool ")],-1))]),e("label",Qn,[E(e("input",{type:"checkbox",value:"heat","onUpdate:modelValue":o[6]||(o[6]=i=>n.value.modes=i)},null,512),[[Q,n.value.modes]]),o[28]||(o[28]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fire"}),x(" Heat ")],-1))]),e("label",Xn,[E(e("input",{type:"checkbox",value:"dry","onUpdate:modelValue":o[7]||(o[7]=i=>n.value.modes=i)},null,512),[[Q,n.value.modes]]),o[29]||(o[29]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-water-percent"}),x(" Dry ")],-1))]),e("label",Zn,[E(e("input",{type:"checkbox",value:"fan_only","onUpdate:modelValue":o[8]||(o[8]=i=>n.value.modes=i)},null,512),[[Q,n.value.modes]]),o[30]||(o[30]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan"}),x(" Fan Only ")],-1))])])]),e("div",es,[o[37]||(o[37]=e("h4",null,"Fan Modes",-1)),o[38]||(o[38]=e("p",{class:"help-text"},"Select all fan speeds your device supports",-1)),e("div",ts,[e("label",os,[E(e("input",{type:"checkbox",value:"auto","onUpdate:modelValue":o[9]||(o[9]=i=>n.value.fanModes=i)},null,512),[[Q,n.value.fanModes]]),o[33]||(o[33]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-autorenew"}),x(" Auto ")],-1))]),e("label",ns,[E(e("input",{type:"checkbox",value:"low","onUpdate:modelValue":o[10]||(o[10]=i=>n.value.fanModes=i)},null,512),[[Q,n.value.fanModes]]),o[34]||(o[34]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-1"}),x(" Low ")],-1))]),e("label",ss,[E(e("input",{type:"checkbox",value:"medium","onUpdate:modelValue":o[11]||(o[11]=i=>n.value.fanModes=i)},null,512),[[Q,n.value.fanModes]]),o[35]||(o[35]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-2"}),x(" Medium ")],-1))]),e("label",ls,[E(e("input",{type:"checkbox",value:"high","onUpdate:modelValue":o[12]||(o[12]=i=>n.value.fanModes=i)},null,512),[[Q,n.value.fanModes]]),o[36]||(o[36]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-fan-speed-3"}),x(" High ")],-1))])])]),e("div",as,[o[43]||(o[43]=e("h4",null,"Swing Modes (Optional)",-1)),o[44]||(o[44]=e("p",{class:"help-text"},"Select if your device has swing/oscillation",-1)),e("div",is,[e("label",rs,[E(e("input",{type:"checkbox",value:"off","onUpdate:modelValue":o[13]||(o[13]=i=>n.value.swingModes=i)},null,512),[[Q,n.value.swingModes]]),o[39]||(o[39]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),x(" Off ")],-1))]),e("label",ds,[E(e("input",{type:"checkbox",value:"vertical","onUpdate:modelValue":o[14]||(o[14]=i=>n.value.swingModes=i)},null,512),[[Q,n.value.swingModes]]),o[40]||(o[40]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-vertical"}),x(" Vertical ")],-1))]),e("label",us,[E(e("input",{type:"checkbox",value:"horizontal","onUpdate:modelValue":o[15]||(o[15]=i=>n.value.swingModes=i)},null,512),[[Q,n.value.swingModes]]),o[41]||(o[41]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-swap-horizontal"}),x(" Horizontal ")],-1))]),e("label",cs,[E(e("input",{type:"checkbox",value:"both","onUpdate:modelValue":o[16]||(o[16]=i=>n.value.swingModes=i)},null,512),[[Q,n.value.swingModes]]),o[42]||(o[42]=e("span",{class:"checkbox-label"},[e("i",{class:"mdi mdi-arrow-all"}),x(" Both ")],-1))])])]),e("div",ms,[o[51]||(o[51]=e("h4",null,"Sensors (Optional)",-1)),o[52]||(o[52]=e("p",{class:"help-text"},"Link external sensors for better climate control",-1)),e("div",vs,[o[45]||(o[45]=e("label",null,"Temperature Sensor",-1)),E(e("input",{"onUpdate:modelValue":o[17]||(o[17]=i=>n.value.tempSensor=i),type:"text",placeholder:"sensor.living_room_temperature"},null,512),[[le,n.value.tempSensor]]),o[46]||(o[46]=e("small",null,"Entity ID of temperature sensor",-1))]),e("div",ps,[o[47]||(o[47]=e("label",null,"Humidity Sensor",-1)),E(e("input",{"onUpdate:modelValue":o[18]||(o[18]=i=>n.value.humiditySensor=i),type:"text",placeholder:"sensor.living_room_humidity"},null,512),[[le,n.value.humiditySensor]]),o[48]||(o[48]=e("small",null,"Entity ID of humidity sensor",-1))]),e("div",fs,[o[49]||(o[49]=e("label",null,"Power Sensor",-1)),E(e("input",{"onUpdate:modelValue":o[19]||(o[19]=i=>n.value.powerSensor=i),type:"text",placeholder:"binary_sensor.ac_power"},null,512),[[le,n.value.powerSensor]]),o[50]||(o[50]=e("small",null,"Entity ID of power sensor (to detect on/off state)",-1))])]),b.value.length>0?(r(),d("div",ys,[o[53]||(o[53]=e("h4",null,[e("i",{class:"mdi mdi-alert-circle"}),x(" Please fix the following: ")],-1)),e("ul",null,[(r(!0),d(q,null,J(b.value,(i,u)=>(r(),d("li",{key:u},g(i),1))),128))])])):A("",!0)]))}},bs=X(gs,[["__scopeId","data-v-691429a1"]]),ks={class:"command-wizard"},hs={key:0,class:"edit-mode-banner"},ws={class:"wizard-info"},$s={key:0},Cs={key:1},_s={class:"progress-info"},Ss={class:"progress-bar"},xs={class:"progress-text"},Ds={class:"commands-grid"},Is={class:"command-header"},Ts={class:"command-icon"},Ms={class:"command-info"},Rs={key:0,class:"learning-indicator"},Ls={key:0,class:"ir-learning-steps"},Vs={key:1,class:"rf-learning-steps"},As={class:"command-actions"},Es=["onClick","disabled"],Ps={key:1,class:"learned-status"},Os=["onClick"],Fs={class:"quick-actions"},js=["disabled"],Bs=["disabled"],Us={__name:"CommandLearningWizard",props:{modelValue:{type:Object,default:()=>({})},platform:{type:String,required:!0},config:{type:Object,required:!0},broadlinkDevice:{type:String,required:!0},manufacturer:{type:String,required:!0},model:{type:String,required:!0},commandType:{type:String,default:"ir"}},emits:["update:modelValue"],setup(l,{emit:f}){const p=l,L=f,n=S({...p.modelValue}),b=S(null),h=S(!1),o=S([]),i=S(!1),u=S({show:!1,commandKey:null,commandLabel:""}),s=S(!1),D=P(()=>{if(p.platform!=="climate")return[];const T=[],c=p.config.modes||[],_=p.config.fanModes||[],Y=p.config.minTemp||16,oe=p.config.maxTemp||30;return c.forEach(B=>{if(B==="off")T.push({key:"off",label:"Power Off",description:"Turn device off",icon:"mdi mdi-power",mode:"off"});else for(let V=Y;V<=oe;V++)_.forEach($=>{const U=`${B}_${V}_${$}`;T.push({key:U,label:`${B.toUpperCase()} ${V}Â°C ${$}`,description:`Mode: ${B}, Temp: ${V}Â°C, Fan: ${$}`,icon:F(B),mode:B,temp:V,fanMode:$})})}),T}),v=P(()=>D.value.length),M=P(()=>Object.keys(n.value).length),C=P(()=>v.value===0?0:Math.round(M.value/v.value*100));function F(T){return{off:"mdi mdi-power",auto:"mdi mdi-autorenew",cool:"mdi mdi-snowflake",heat:"mdi mdi-fire",dry:"mdi mdi-water-percent",fan_only:"mdi mdi-fan"}[T]||"mdi mdi-remote"}async function Z(T){if(!b.value){b.value=T.key;try{const c=p.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_"),_=p.model.toLowerCase().replace(/[^a-z0-9]+/g,"_"),Y=`${c}_${_}`,oe=await fetch("/api/commands/learn",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({entity_id:p.broadlinkDevice,device:Y,command:T.key,command_type:p.commandType})});if(!oe.ok)throw new Error(`Failed to learn command: ${oe.statusText}`);const B=await oe.json();if(B.success&&B.code)n.value[T.key]=B.code,L("update:modelValue",n.value),i.value=!0,h.value&&o.value.length>0&&setTimeout(()=>{const V=o.value.shift();V?Z(V):h.value=!1},1e3);else throw new Error(B.error||"Failed to learn command")}catch(c){console.error("Error learning command:",c),alert(`Error learning command: ${c.message}`),h.value=!1,o.value=[]}finally{h.value||(b.value=null)}}}function K(T){const c=D.value.find(_=>_.key===T);u.value={show:!0,commandKey:T,commandLabel:c?c.label:T}}function j(){const T=u.value.commandKey;delete n.value[T],L("update:modelValue",n.value),u.value.show=!1}function H(){const T=D.value.filter(_=>!n.value[_.key]);if(T.length===0)return;h.value=!0,o.value=[...T];const c=o.value.shift();c&&Z(c)}function W(){s.value=!0}function ne(){n.value={},L("update:modelValue",n.value),s.value=!1}return ae(()=>p.modelValue,T=>{n.value={...T}},{deep:!0}),(T,c)=>(r(),d("div",ks,[c[15]||(c[15]=e("h3",null,"Learn IR Commands",-1)),M.value>0&&!i.value?(r(),d("div",hs,[c[3]||(c[3]=e("i",{class:"mdi mdi-information-outline"},null,-1)),e("div",null,[c[2]||(c[2]=e("strong",null,"Editing Existing Profile",-1)),e("p",null,g(M.value)+" command"+g(M.value!==1?"s":"")+' already learned. You can re-learn any command by clicking the delete icon and then "Learn Command".',1)])])):A("",!0),e("div",ws,[c[7]||(c[7]=e("i",{class:"mdi mdi-information"},null,-1)),e("div",null,[c[6]||(c[6]=e("p",null,[e("strong",null,"How it works:")],-1)),l.commandType==="ir"?(r(),d("ol",$s,[...c[4]||(c[4]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Point your IR remote directly at the Broadlink device")],-1),e("li",null,"Press the button on your remote",-1),e("li",null,"Wait for confirmation (up to 30 seconds)",-1)])])):(r(),d("ol",Cs,[...c[5]||(c[5]=[e("li",null,'Click "Learn Command" for each combination',-1),e("li",null,[e("strong",null,"Step 1:"),x(" Hold button on remote - Broadlink scans for RF frequency")],-1),e("li",null,[e("strong",null,"Step 2:"),x(" Watch for Home Assistant notification, then press and release button")],-1),e("li",null,"Keep remote within 5cm of Broadlink (RF doesn't need line-of-sight)",-1),e("li",null,"Wait for confirmation (may take up to 30 seconds)",-1)])]))])]),e("div",_s,[e("div",Ss,[e("div",{class:"progress-fill",style:_e({width:C.value+"%"})},null,4)]),e("span",xs,g(M.value)+" / "+g(v.value)+" commands learned ("+g(C.value)+"%) ",1)]),e("div",Ds,[(r(!0),d(q,null,J(D.value,_=>(r(),d("div",{key:_.key,class:N(["command-card",{learned:n.value[_.key],learning:b.value===_.key}])},[e("div",Is,[e("div",Ts,[e("i",{class:N(_.icon)},null,2)]),e("div",Ms,[e("h4",null,g(_.label),1),e("p",null,g(_.description),1)])]),b.value===_.key?(r(),d("div",Rs,[l.commandType==="ir"?(r(),d("div",Ls,[...c[8]||(c[8]=[e("p",null,[e("strong",null,"Point your remote directly at the Broadlink device and press the button.")],-1),e("small",null,"Listening for up to 30 seconds...",-1)])])):(r(),d("div",Vs,[...c[9]||(c[9]=[e("p",{class:"rf-title"},[e("strong",null,"Learning request sent to device.")],-1),e("p",{class:"rf-subtitle"},[x("RF learning is a "),e("strong",null,"two-step process"),x(":")],-1),e("ol",null,[e("li",null,[e("strong",null,"Step 1 - Frequency Sweep (~10-15 seconds):"),x(" Press and hold the button on your remote until the notification updates. ")]),e("li",null,[e("strong",null,"Step 2 - Learn Signal:"),x(" Press and release the button once. ")])],-1),e("p",{class:"rf-note"},"Follow the Home Assistant notifications (ðŸ””) for real-time instructions.",-1)])]))])):A("",!0),e("div",As,[n.value[_.key]?(r(),d("div",Ps,[c[11]||(c[11]=e("i",{class:"mdi mdi-check-circle"},null,-1)),c[12]||(c[12]=e("span",null,"Learned",-1)),e("button",{onClick:Y=>K(_.key),class:"btn-delete",title:"Delete and re-learn"},[...c[10]||(c[10]=[e("i",{class:"mdi mdi-delete"},null,-1)])],8,Os)])):(r(),d("button",{key:0,onClick:Y=>Z(_),class:N(["btn-learn",{learning:b.value===_.key}]),disabled:b.value!==null},[e("i",{class:N(["mdi mdi-radio-tower",{"mdi-spin":b.value===_.key}])},null,2),x(" "+g(b.value===_.key?"Listening...":"Learn Command"),1)],10,Es))])],2))),128))]),e("div",Fs,[e("button",{onClick:H,class:"btn-secondary",disabled:b.value!==null||M.value===v.value},[...c[13]||(c[13]=[e("i",{class:"mdi mdi-play-circle"},null,-1),x(" Learn All Remaining ",-1)])],8,js),e("button",{onClick:W,class:"btn-text",disabled:M.value===0},[...c[14]||(c[14]=[e("i",{class:"mdi mdi-delete-sweep"},null,-1),x(" Clear All ",-1)])],8,Bs)]),G(pe,{isOpen:u.value.show,title:"Delete Learned Command?",message:`Are you sure you want to delete the '${u.value.commandLabel}' command?

You will need to re-learn this command.`,confirmText:"Delete",cancelText:"Cancel",dangerMode:!0,onConfirm:j,onCancel:c[0]||(c[0]=_=>u.value.show=!1)},null,8,["isOpen","message"]),G(pe,{isOpen:s.value,title:"Delete All Learned Commands?",message:"Are you sure you want to delete all learned commands? This cannot be undone.\\n\\nYou will need to re-learn all commands.",confirmText:"Delete All",cancelText:"Cancel",dangerMode:!0,onConfirm:ne,onCancel:c[1]||(c[1]=_=>s.value=!1)},null,8,["isOpen"])]))}},Ns=X(Us,[["__scopeId","data-v-77dd7593"]]),qs={class:"profile-preview"},Hs={class:"preview-summary"},zs={class:"summary-card"},Js={class:"stats-grid"},Ys={class:"stat-item"},Ws={class:"stat-value"},Gs={class:"stat-item"},Ks={class:"stat-value"},Qs={class:"stat-item"},Xs={class:"stat-value"},Zs={class:"preview-tabs"},el={class:"preview-content"},tl={key:0,class:"tab-content"},ol={class:"code-header"},nl={class:"code-block"},sl={key:1,class:"tab-content"},ll={class:"code-header"},al={class:"code-block"},il={key:2,class:"tab-content"},rl={class:"instructions"},dl={class:"step-item"},ul={class:"step-content"},cl={class:"code-path"},ml={__name:"ProfilePreview",props:{profile:{type:Object,required:!0},jsonData:{type:Object,required:!0},yamlConfig:{type:String,required:!0}},setup(l){const f=l,p=S("json"),L=S(!1),n=S(!1),b=P(()=>Object.keys(f.profile.commands||{}).length),h=P(()=>JSON.stringify(f.jsonData,null,2));async function o(){try{await navigator.clipboard.writeText(h.value),L.value=!0,setTimeout(()=>{L.value=!1},2e3)}catch(u){console.error("Failed to copy JSON:",u),alert("Failed to copy to clipboard")}}async function i(){try{await navigator.clipboard.writeText(f.yamlConfig),n.value=!0,setTimeout(()=>{n.value=!1},2e3)}catch(u){console.error("Failed to copy YAML:",u),alert("Failed to copy to clipboard")}}return(u,s)=>{var D;return r(),d("div",qs,[s[22]||(s[22]=e("h3",null,"Preview & Save",-1)),e("div",Hs,[e("div",zs,[s[4]||(s[4]=e("i",{class:"mdi mdi-check-circle"},null,-1)),e("div",null,[s[3]||(s[3]=e("h4",null,"Profile Ready!",-1)),e("p",null,g(l.profile.manufacturer)+" "+g(l.profile.model),1)])]),e("div",Js,[e("div",Ys,[e("span",Ws,g(b.value),1),s[5]||(s[5]=e("span",{class:"stat-label"},"Commands Learned",-1))]),e("div",Gs,[e("span",Ks,g(l.profile.platform),1),s[6]||(s[6]=e("span",{class:"stat-label"},"Platform",-1))]),e("div",Qs,[e("span",Xs,g(((D=l.profile.config.modes)==null?void 0:D.length)||0),1),s[7]||(s[7]=e("span",{class:"stat-label"},"HVAC Modes",-1))])])]),e("div",Zs,[e("button",{onClick:s[0]||(s[0]=v=>p.value="json"),class:N(["tab-button",{active:p.value==="json"}])},[...s[8]||(s[8]=[e("i",{class:"mdi mdi-code-json"},null,-1),x(" SmartIR JSON ",-1)])],2),e("button",{onClick:s[1]||(s[1]=v=>p.value="yaml"),class:N(["tab-button",{active:p.value==="yaml"}])},[...s[9]||(s[9]=[e("i",{class:"mdi mdi-file-code"},null,-1),x(" YAML Config ",-1)])],2),e("button",{onClick:s[2]||(s[2]=v=>p.value="instructions"),class:N(["tab-button",{active:p.value==="instructions"}])},[...s[10]||(s[10]=[e("i",{class:"mdi mdi-information"},null,-1),x(" Instructions ",-1)])],2)]),e("div",el,[p.value==="json"?(r(),d("div",tl,[e("div",ol,[s[12]||(s[12]=e("h4",null,"SmartIR Device Code JSON",-1)),e("button",{onClick:o,class:"btn-copy"},[s[11]||(s[11]=e("i",{class:"mdi mdi-content-copy"},null,-1)),x(" "+g(L.value?"Copied!":"Copy"),1)])]),e("pre",nl,[e("code",null,g(h.value),1)]),s[13]||(s[13]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),x(" Save this as "),e("code",null,"10000.json"),x(" in your SmartIR codes directory ")],-1))])):A("",!0),p.value==="yaml"?(r(),d("div",sl,[e("div",ll,[s[15]||(s[15]=e("h4",null,"Home Assistant Configuration",-1)),e("button",{onClick:i,class:"btn-copy"},[s[14]||(s[14]=e("i",{class:"mdi mdi-content-copy"},null,-1)),x(" "+g(n.value?"Copied!":"Copy"),1)])]),e("pre",al,[e("code",null,g(l.yamlConfig),1)]),s[16]||(s[16]=e("p",{class:"code-note"},[e("i",{class:"mdi mdi-information"}),x(" Add this to your "),e("code",null,"configuration.yaml"),x(" file ")],-1))])):A("",!0),p.value==="instructions"?(r(),d("div",il,[e("div",rl,[s[20]||(s[20]=e("h4",null,"Installation Steps",-1)),e("div",dl,[s[19]||(s[19]=e("div",{class:"step-number"},"1",-1)),e("div",ul,[s[17]||(s[17]=e("h5",null,"Get Next Code Number",-1)),s[18]||(s[18]=e("p",null,"Custom device codes start at 10000. Check your SmartIR codes directory to find the next available number.",-1)),e("div",cl,[e("code",null,"/config/custom_components/smartir/codes/"+g(l.profile.platform)+"/",1)])])]),s[21]||(s[21]=ye('<div class="step-item" data-v-3792f342><div class="step-number" data-v-3792f342>2</div><div class="step-content" data-v-3792f342><h5 data-v-3792f342>Save JSON File</h5><p data-v-3792f342>Copy the JSON from the &quot;SmartIR JSON&quot; tab and save it as <code data-v-3792f342>10000.json</code> (or your next available number) in the codes directory.</p></div></div><div class="step-item" data-v-3792f342><div class="step-number" data-v-3792f342>3</div><div class="step-content" data-v-3792f342><h5 data-v-3792f342>Update Configuration</h5><p data-v-3792f342>Copy the YAML from the &quot;YAML Config&quot; tab and add it to your <code data-v-3792f342>configuration.yaml</code> file. Update the <code data-v-3792f342>device_code</code> to match your JSON filename.</p></div></div><div class="step-item" data-v-3792f342><div class="step-number" data-v-3792f342>4</div><div class="step-content" data-v-3792f342><h5 data-v-3792f342>Restart Home Assistant</h5><p data-v-3792f342>Restart Home Assistant to load the new configuration. Your climate entity will appear in the UI.</p></div></div><div class="step-item" data-v-3792f342><div class="step-number" data-v-3792f342>5</div><div class="step-content" data-v-3792f342><h5 data-v-3792f342>Test Your Device</h5><p data-v-3792f342>Go to your climate entity and test different modes, temperatures, and fan speeds to ensure everything works correctly.</p></div></div><div class="tips-section" data-v-3792f342><h4 data-v-3792f342><i class="mdi mdi-lightbulb" data-v-3792f342></i> Tips </h4><ul data-v-3792f342><li data-v-3792f342>Keep a backup of your JSON file in case you need to modify it</li><li data-v-3792f342>Test all commands to ensure they work as expected</li><li data-v-3792f342>You can share your profile with the SmartIR community on GitHub</li><li data-v-3792f342>If a command doesn&#39;t work, you can re-learn it and update the JSON</li></ul></div>',5))])])):A("",!0)])])}}},vl=X(ml,[["__scopeId","data-v-3792f342"]]),pl={class:"wizard-body"},fl={key:0,class:"warning-section"},yl={class:"warning-box"},gl={class:"instructions"},bl={class:"code-block"},kl={class:"steps"},hl={key:0},wl={class:"help-section"},$l={key:0,class:"help-content"},Cl={class:"help-step"},_l={key:0,class:"help-step"},Sl={class:"help-step"},xl={class:"help-step"},Dl={class:"checklist"},Il={class:"checkbox-label"},Tl={key:0,class:"checkbox-label"},Ml={class:"wizard-footer"},Rl=["disabled"],Ll={__name:"SmartIRSetupWizard",props:{show:{type:Boolean,default:!1},platform:{type:String,required:!0},warnings:{type:Array,default:()=>[]},configPath:{type:String,default:"/config"}},emits:["close","complete"],setup(l,{emit:f}){const p=l,L=f,n=ue("toast"),b=S(!1),h=S(!1),o=S(!1),i=P(()=>p.warnings.length>0?b.value&&h.value:b.value);function u(){const D=`${p.platform}: !include smartir/${p.platform}.yaml`;navigator.clipboard.writeText(D).then(()=>{var v;(v=n.value)==null||v.success("Include line copied to clipboard!","âœ… Copied")}).catch(v=>{var M;console.error("Failed to copy:",v),(M=n.value)==null||M.error("Failed to copy to clipboard","âŒ Copy Failed")})}function s(){L("complete")}return(D,v)=>l.show?(r(),d("div",{key:0,class:"modal-overlay",onClick:v[5]||(v[5]=re(()=>{},["stop"]))},[e("div",{class:"setup-wizard",onClick:v[4]||(v[4]=re(()=>{},["stop"]))},[v[31]||(v[31]=e("div",{class:"wizard-header"},[e("h2",null,[e("i",{class:"mdi mdi-cog"}),x(" SmartIR Configuration Setup ")])],-1)),e("div",pl,[l.warnings.length>0?(r(),d("div",fl,[e("div",yl,[v[11]||(v[11]=e("i",{class:"mdi mdi-alert"},null,-1)),e("div",null,[v[9]||(v[9]=e("h3",null,"âš ï¸ Configuration Migration Needed",-1)),v[10]||(v[10]=e("p",null,"We detected existing platform entries in your configuration.yaml:",-1)),e("ul",null,[(r(!0),d(q,null,J(l.warnings,M=>(r(),d("li",{key:M.platform},[e("strong",null,g(M.platform)+":",1),x(" "+g(M.message),1)]))),128))]),e("p",null,[v[6]||(v[6]=e("strong",null,"Action Required:",-1)),v[7]||(v[7]=x(" Move these entries to ",-1)),e("code",null,"smartir/"+g(l.platform)+".yaml",1),v[8]||(v[8]=x(" before continuing.",-1))])])])])):A("",!0),e("div",gl,[v[27]||(v[27]=e("h3",null,"ðŸ“ One-Time Setup",-1)),v[28]||(v[28]=e("p",null,[x("To enable SmartIR device management, add this line to your "),e("code",null,"configuration.yaml"),x(":")],-1)),e("div",bl,[e("code",null,g(l.platform)+": !include smartir/"+g(l.platform)+".yaml",1),e("button",{onClick:u,class:"copy-btn",title:"Copy to clipboard"},[...v[12]||(v[12]=[e("i",{class:"mdi mdi-content-copy"},null,-1)])])]),e("div",kl,[v[19]||(v[19]=e("h4",null,"Steps:",-1)),e("ol",null,[l.warnings.length>0?(r(),d("li",hl,[v[13]||(v[13]=e("strong",null,"Move existing entries:",-1)),v[14]||(v[14]=x(" Copy any existing ",-1)),e("code",null,g(l.platform)+":",1),v[15]||(v[15]=x(" entries from configuration.yaml to ",-1)),e("code",null,"smartir/"+g(l.platform)+".yaml",1)])):A("",!0),v[16]||(v[16]=e("li",null,[e("strong",null,"Add include line:"),x(" Add the line above to your configuration.yaml ")],-1)),v[17]||(v[17]=e("li",null,[e("strong",null,"Save changes:"),x(" Save configuration.yaml ")],-1)),v[18]||(v[18]=e("li",null,[e("strong",null,"Continue here:"),x(` Click "I've Completed Setup" below `)],-1))])]),e("div",wl,[e("button",{onClick:v[0]||(v[0]=M=>o.value=!o.value),class:"help-toggle"},[e("i",{class:N(["mdi",o.value?"mdi-chevron-up":"mdi-chevron-down"])},null,2),x(" "+g(o.value?"Hide":"Show")+" Detailed Instructions ",1)]),o.value?(r(),d("div",$l,[v[26]||(v[26]=e("h4",null,"Detailed Setup Guide:",-1)),e("div",Cl,[v[21]||(v[21]=e("h5",null,"1. Open configuration.yaml",-1)),e("p",null,[v[20]||(v[20]=x("Location: ",-1)),e("code",null,g(l.configPath)+"/configuration.yaml",1)])]),l.warnings.length>0?(r(),d("div",_l,[v[22]||(v[22]=e("h5",null,"2. Migrate Existing Entries (If Any)",-1)),e("p",null,"If you have existing "+g(l.platform)+" entries, cut them from configuration.yaml and paste into:",1),e("p",null,[e("code",null,g(l.configPath)+"/smartir/"+g(l.platform)+".yaml",1)]),v[23]||(v[23]=e("p",{class:"note"},"Broadlink Manager will create this file automatically.",-1))])):A("",!0),e("div",Sl,[e("h5",null,g(l.warnings.length>0?"3":"2")+". Add Include Line",1),v[24]||(v[24]=e("p",null,"Add this to configuration.yaml:",-1)),e("pre",null,g(l.platform)+": !include smartir/"+g(l.platform)+".yaml",1)]),e("div",xl,[e("h5",null,g(l.warnings.length>0?"4":"3")+". Restart Home Assistant",1),v[25]||(v[25]=e("p",null,"After saving, you'll need to restart HA for changes to take effect.",-1))])])):A("",!0)])]),e("div",Dl,[e("label",Il,[E(e("input",{type:"checkbox","onUpdate:modelValue":v[1]||(v[1]=M=>b.value=M)},null,512),[[Q,b.value]]),v[29]||(v[29]=e("span",null,"I've added the include line to configuration.yaml",-1))]),l.warnings.length>0?(r(),d("label",Tl,[E(e("input",{type:"checkbox","onUpdate:modelValue":v[2]||(v[2]=M=>h.value=M)},null,512),[[Q,h.value]]),e("span",null,"I've migrated existing "+g(l.platform)+" entries (if any)",1)])):A("",!0)])]),e("div",Ml,[e("button",{onClick:v[3]||(v[3]=M=>D.$emit("close")),class:"btn-secondary"}," Cancel "),e("button",{onClick:s,class:"btn-primary",disabled:!i.value},[...v[30]||(v[30]=[e("i",{class:"mdi mdi-check"},null,-1),x(" I've Completed Setup ",-1)])],8,Rl)])])])):A("",!0)}},Vl=X(Ll,[["__scopeId","data-v-f6fe4c03"]]),Al={class:"modal-header"},El={class:"progress-steps"},Pl={class:"step-number"},Ol={key:0,class:"mdi mdi-check"},Fl={key:1},jl={class:"step-label"},Bl={class:"modal-body"},Ul={key:0,class:"step-content"},Nl={class:"form-group"},ql={class:"form-group"},Hl={class:"form-group"},zl={class:"form-group"},Jl=["value"],Yl={class:"form-group"},Wl={key:1,class:"step-content"},Gl={key:1,class:"platform-form"},Kl={key:2,class:"platform-form"},Ql={key:2,class:"step-content"},Xl={key:3,class:"step-content"},Zl={class:"modal-footer"},ea=["disabled"],ta={key:2,class:"save-buttons"},oa=["disabled"],na=["disabled"],sa={__name:"SmartIRProfileBuilder",props:{show:{type:Boolean,default:!1},editMode:{type:Boolean,default:!1},editData:{type:Object,default:null}},emits:["close","save"],setup(l,{emit:f}){const p=l,L=f,n=ue("toast"),b=S(0),h=S(!1),o=S([]),i=S(!1),u=S([]),s=S("/config"),D=S(!1),v=S(null),M=[{label:"Device Info",key:"info"},{label:"Configuration",key:"config"},{label:"Learn Commands",key:"commands"},{label:"Preview & Save",key:"preview"}],C=S({platform:"",manufacturer:"",model:"",broadlinkDevice:"",commandType:"ir",config:{},commands:{}});function F(a){const t=new Set,m=Object.keys(a);return m.some(k=>k==="off"||k.includes("_off"))&&t.add("off"),m.some(k=>k.includes("auto"))&&t.add("auto"),m.some(k=>k.includes("cool"))&&t.add("cool"),m.some(k=>k.includes("heat"))&&t.add("heat"),m.some(k=>k.includes("dry"))&&t.add("dry"),m.some(k=>k.includes("fan_only"))&&t.add("fan_only"),Array.from(t)}function Z(a){const t=new Set,m=Object.keys(a);return m.some(k=>k.includes("auto"))&&t.add("auto"),m.some(k=>k.includes("low"))&&t.add("low"),m.some(k=>k.includes("medium")||k.includes("mid"))&&t.add("medium"),m.some(k=>k.includes("high"))&&t.add("high"),Array.from(t)}function K(a){const t=new Set,m=Object.keys(a);return m.some(k=>k.includes("swing_off")||k.includes("_off"))&&t.add("off"),m.some(k=>k.includes("vertical"))&&t.add("vertical"),m.some(k=>k.includes("horizontal"))&&t.add("horizontal"),m.some(k=>k.includes("both"))&&t.add("both"),Array.from(t)}ae(()=>p.editData,async a=>{var t;if(a&&p.editMode){console.log("ðŸ”§ Edit mode activated, loading profile data:",a),o.value.length===0&&(console.log("ðŸ“¡ Loading Broadlink devices..."),await ee(),console.log("ðŸ“¡ Devices loaded:",o.value.length));const m=a.profile,k=m.controller_data;console.log("ðŸŽ® Controller data from profile:",k),console.log("ðŸŽ® Available devices:",o.value.map(te=>te.entity_id));const w=m.commands||{},y=m.operationModes||F(w),R=m.fanModes||Z(w),I=m.swingModes||K(w);console.log("ðŸ” Inferred modes:",y),console.log("ðŸ” Inferred fan modes:",R),console.log("ðŸ” Inferred swing modes:",I),C.value={platform:a.platform,manufacturer:m.manufacturer||"",model:((t=m.supportedModels)==null?void 0:t[0])||"",broadlinkDevice:k||"",config:{minTemp:m.minTemperature,maxTemp:m.maxTemperature,precision:m.precision,modes:y,fanModes:R,swingModes:I},commands:w},console.log("âœ… Profile populated:",C.value),console.log("âœ… Selected device:",C.value.broadlinkDevice)}},{immediate:!0});const j=P(()=>{var a;switch(b.value){case 0:return C.value.platform&&C.value.manufacturer&&C.value.model&&C.value.broadlinkDevice&&C.value.commandType;case 1:return C.value.platform==="climate"?C.value.config.minTemp&&C.value.config.maxTemp&&((a=C.value.config.modes)==null?void 0:a.length)>0:!0;case 2:return Object.keys(C.value.commands).length>0;case 3:return!0;default:return!1}}),H=P(()=>b.value!==3?null:$(C.value)),W=P(()=>b.value!==3?null:U(C.value));function ne(){C.value.config={},C.value.commands={}}function T(){j.value&&b.value<M.length-1&&b.value++}function c(){b.value>0&&b.value--}function _(){confirm("Are you sure you want to close? Your progress will be lost.")&&Y()}function Y(){L("close"),setTimeout(()=>{b.value=0,C.value={platform:"",manufacturer:"",model:"",broadlinkDevice:"",config:{},commands:{}}},300)}async function oe(){var a,t,m,k,w;h.value=!0;try{if(!D.value){const O=await fetch("/api/smartir/config/check");if(O.ok){const me=await O.json();if(!((a=me.platforms[C.value.platform])==null?void 0:a.file_exists)){u.value=me.configuration_warnings||[],s.value=me.config_path||"/config",v.value={platform:C.value.platform,json:H.value},i.value=!0,h.value=!1;return}}}let y;if(p.editMode&&((t=p.editData)!=null&&t.code))y=parseInt(p.editData.code),console.log("ðŸ“ Edit mode: Using existing code",y);else{const O=await fetch(`/api/smartir/platforms/${C.value.platform}/next-code`);if(!O.ok)throw new Error("Failed to get next code number");y=(await O.json()).next_code,console.log("âœ¨ New profile: Using next code",y)}const R=await fetch("/api/smartir/profiles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:C.value.platform,json:H.value,code_number:y})});if(!R.ok){const O=await R.json();throw new Error(O.error||"Failed to save profile")}const I=await R.json(),te={name:`${C.value.manufacturer} ${C.value.model}`,unique_id:`${C.value.manufacturer.toLowerCase().replace(/[^a-z0-9]+/g,"_")}_${C.value.model.toLowerCase().replace(/[^a-z0-9]+/g,"_")}`,device_code:y,controller_data:C.value.broadlinkDevice},se=await fetch("/api/smartir/config/add-device",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({platform:C.value.platform,device_config:te})});if(!se.ok){const O=await se.json();console.error("Failed to add device to config:",O),(m=n.value)==null||m.warning(`Profile saved but failed to add to config file: ${O.error}`,"âš ï¸ Partial Success")}L("save",{json:H.value,yaml:W.value,profile:C.value,saved_to:I.path}),(k=n.value)==null||k.success(`File: ${I.filename}
Device Code: ${y}
Added to: smartir/${C.value.platform}.yaml

âš ï¸ Restart Home Assistant to activate`,"âœ… Profile Saved Successfully!"),Y()}catch(y){console.error("Error saving profile:",y),(w=n.value)==null||w.error(y.message,"âŒ Error Saving Profile")}finally{h.value=!1}}async function B(){D.value=!0,i.value=!1,v.value&&(await oe(),v.value=null)}function V(){var a,t;try{const m=JSON.stringify(H.value,null,2),k=new Blob([m],{type:"application/json"}),w=URL.createObjectURL(k),y=document.createElement("a");y.href=w;const R=C.value.manufacturer.toLowerCase().replace(/\s+/g,"_"),I=C.value.model.toLowerCase().replace(/\s+/g,"_");y.download=`smartir_${C.value.platform}_${R}_${I}.json`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(w),(a=n.value)==null||a.success("You can manually upload this file to your SmartIR codes directory.","âœ… Profile Downloaded")}catch(m){console.error("Error downloading profile:",m),(t=n.value)==null||t.error(m.message,"âŒ Error Downloading Profile")}}function $(a){const t={manufacturer:a.manufacturer,supportedModels:[a.model],supportedController:"Broadlink",commandsEncoding:"Base64",commands:{}};return a.platform==="climate"&&(t.minTemperature=a.config.minTemp,t.maxTemperature=a.config.maxTemp,t.precision=a.config.precision||1,t.operationModes=a.config.modes||[],t.fanModes=a.config.fanModes&&a.config.fanModes.length>0?a.config.fanModes:["auto"],a.config.swingModes&&a.config.swingModes.length>0&&(t.swingModes=a.config.swingModes),t.commands=a.commands),t}function U(a){let t=`# SmartIR ${a.platform} configuration
`;return t+=`# Generated by Broadlink Manager v2

`,a.platform==="climate"&&(t+=`climate:
`,t+=`  - platform: smartir
`,t+=`    name: ${a.manufacturer} ${a.model}
`,t+=`    unique_id: ${a.manufacturer.toLowerCase()}_${a.model.toLowerCase().replace(/\s+/g,"_")}
`,t+=`    device_code: 10000  # Change this to your custom code number
`,t+=`    controller_data: ${a.broadlinkDevice}
`,a.config.tempSensor&&(t+=`    temperature_sensor: ${a.config.tempSensor}
`),a.config.humiditySensor&&(t+=`    humidity_sensor: ${a.config.humiditySensor}
`),a.config.powerSensor&&(t+=`    power_sensor: ${a.config.powerSensor}
`)),t}async function ee(){try{console.log("Fetching Broadlink devices from /api/broadlink/devices...");const a=await fetch("/api/broadlink/devices");if(console.log("Response status:",a.status,a.ok),a.ok){const t=await a.json();console.log("Loaded Broadlink devices response:",t);const m=t.devices||[];console.log("Extracted devices array:",m),console.log("Device count:",m.length),o.value=m,console.log("broadlinkDevices.value set to:",o.value),console.log("Final device count:",o.value.length)}else console.error("Response not OK:",a.status,a.statusText),o.value=[]}catch(a){console.error("Error loading Broadlink devices:",a),o.value=[]}}return ae(()=>p.show,a=>{a&&ee()}),ce(()=>{p.show&&ee()}),(a,t)=>l.show?(r(),d("div",{key:0,class:"modal-overlay",onClick:_},[e("div",{class:"modal-container",onClick:t[7]||(t[7]=re(()=>{},["stop"]))},[e("div",Al,[e("h2",null,[t[9]||(t[9]=e("i",{class:"mdi mdi-file-document-edit"},null,-1)),x(" "+g(l.editMode?"Edit SmartIR Profile":"Create SmartIR Profile"),1)]),e("button",{onClick:Y,class:"close-button"},[...t[10]||(t[10]=[e("i",{class:"mdi mdi-close"},null,-1)])])]),e("div",El,[(r(),d(q,null,J(M,(m,k)=>e("div",{key:k,class:N(["step",{active:b.value===k,completed:b.value>k}])},[e("div",Pl,[b.value>k?(r(),d("i",Ol)):(r(),d("span",Fl,g(k+1),1))]),e("span",jl,g(m.label),1)],2)),64))]),e("div",Bl,[b.value===0?(r(),d("div",Ul,[t[21]||(t[21]=e("h3",null,"Device Information",-1)),e("div",Nl,[t[12]||(t[12]=e("label",null,"Platform Type *",-1)),E(e("select",{"onUpdate:modelValue":t[0]||(t[0]=m=>C.value.platform=m),onChange:ne},[...t[11]||(t[11]=[e("option",{value:""},"Select platform...",-1),e("option",{value:"climate"},"ðŸŒ¡ï¸ Climate (AC, Heater, Heat Pump)",-1),e("option",{value:"media_player"},"ðŸ“º Media Player (TV, Receiver)",-1),e("option",{value:"fan"},"ðŸŒ€ Fan",-1)])],544),[[ie,C.value.platform]])]),e("div",ql,[t[13]||(t[13]=e("label",null,"Manufacturer *",-1)),E(e("input",{"onUpdate:modelValue":t[1]||(t[1]=m=>C.value.manufacturer=m),type:"text",placeholder:"e.g., Daikin, LG, Samsung"},null,512),[[le,C.value.manufacturer]])]),e("div",Hl,[t[14]||(t[14]=e("label",null,"Model(s) *",-1)),E(e("input",{"onUpdate:modelValue":t[2]||(t[2]=m=>C.value.model=m),type:"text",placeholder:"e.g., FTXS35K, Multiple models"},null,512),[[le,C.value.model]]),t[15]||(t[15]=e("small",null,'Enter model number or "Multiple" if it works with many models',-1))]),e("div",zl,[t[17]||(t[17]=e("label",null,"Broadlink Device *",-1)),E(e("select",{"onUpdate:modelValue":t[3]||(t[3]=m=>C.value.broadlinkDevice=m)},[t[16]||(t[16]=e("option",{value:""},"Select Broadlink device...",-1)),(r(!0),d(q,null,J(o.value,m=>(r(),d("option",{key:m.entity_id,value:m.entity_id},g(m.name)+" ("+g(m.area_name)+") ",9,Jl))),128))],512),[[ie,C.value.broadlinkDevice]]),e("small",null,"This device will be used to learn commands ("+g(o.value.length)+" devices found)",1)]),e("div",Yl,[t[19]||(t[19]=e("label",null,"Command Type *",-1)),E(e("select",{"onUpdate:modelValue":t[4]||(t[4]=m=>C.value.commandType=m)},[...t[18]||(t[18]=[e("option",{value:"ir"},"ðŸ“¡ Infrared (IR) - Most common for AC, TV, etc.",-1),e("option",{value:"rf"},"ðŸ“» Radio Frequency (RF) - For RF remotes",-1)])],512),[[ie,C.value.commandType]]),t[20]||(t[20]=e("small",null,"Select the type of commands your device uses",-1))])])):A("",!0),b.value===1?(r(),d("div",Wl,[C.value.platform==="climate"?(r(),fe(bs,{key:0,modelValue:C.value.config,"onUpdate:modelValue":t[5]||(t[5]=m=>C.value.config=m)},null,8,["modelValue"])):C.value.platform==="media_player"?(r(),d("div",Gl,[...t[22]||(t[22]=[e("h3",null,"Media Player Configuration",-1),e("p",{class:"info-message"},[e("i",{class:"mdi mdi-information"}),x(" Media player profiles coming soon! For now, focus on climate devices. ")],-1)])])):C.value.platform==="fan"?(r(),d("div",Kl,[...t[23]||(t[23]=[e("h3",null,"Fan Configuration",-1),e("p",{class:"info-message"},[e("i",{class:"mdi mdi-information"}),x(" Fan profiles coming soon! For now, focus on climate devices. ")],-1)])])):A("",!0)])):A("",!0),b.value===2?(r(),d("div",Ql,[G(Ns,{modelValue:C.value.commands,"onUpdate:modelValue":t[6]||(t[6]=m=>C.value.commands=m),platform:C.value.platform,config:C.value.config,broadlinkDevice:C.value.broadlinkDevice,manufacturer:C.value.manufacturer,model:C.value.model,commandType:C.value.commandType},null,8,["modelValue","platform","config","broadlinkDevice","manufacturer","model","commandType"])])):A("",!0),b.value===3?(r(),d("div",Xl,[G(vl,{profile:C.value,"json-data":H.value,"yaml-config":W.value},null,8,["profile","json-data","yaml-config"])])):A("",!0)]),e("div",Zl,[b.value>0?(r(),d("button",{key:0,onClick:c,class:"btn-secondary"},[...t[24]||(t[24]=[e("i",{class:"mdi mdi-arrow-left"},null,-1),x(" Back ",-1)])])):A("",!0),t[28]||(t[28]=e("div",{class:"spacer"},null,-1)),e("button",{onClick:Y,class:"btn-text"}," Cancel "),b.value<M.length-1?(r(),d("button",{key:1,onClick:T,class:"btn-primary",disabled:!j.value},[...t[25]||(t[25]=[x(" Next ",-1),e("i",{class:"mdi mdi-arrow-right"},null,-1)])],8,ea)):(r(),d("div",ta,[e("button",{onClick:oe,class:"btn-primary",disabled:h.value},[t[26]||(t[26]=e("i",{class:"mdi mdi-cloud-upload"},null,-1)),x(" "+g(h.value?"Saving...":"Save to SmartIR"),1)],8,oa),e("button",{onClick:V,class:"btn-secondary",disabled:h.value},[...t[27]||(t[27]=[e("i",{class:"mdi mdi-download"},null,-1),x(" Download JSON ",-1)])],8,na)]))])]),G(Vl,{show:i.value,platform:C.value.platform,warnings:u.value,"config-path":s.value,onClose:t[8]||(t[8]=m=>i.value=!1),onComplete:B},null,8,["show","platform","warnings","config-path"])])):A("",!0)}},la=X(sa,[["__scopeId","data-v-670794cb"]]),aa={class:"dashboard"},ia={__name:"Dashboard",setup(l){const f=S(!1),p=S(!1),L=S(null);function n(){p.value=!1,L.value=null,f.value=!0}async function b({platform:u,profile:s}){try{const D=await fetch(`/api/smartir/platforms/${u}/profiles/${s.code}`);if(!D.ok)throw new Error("Failed to load profile");const v=await D.json();let M="";try{const C=await fetch(`/api/smartir/config/get-device?platform=${u}&code=${s.code}`);C.ok?(M=(await C.json()).controller_data||"",console.log("âœ… Found controller_data from YAML:",M)):console.warn("âš ï¸ No YAML entry found for this profile (this is OK for profiles not yet added to config)")}catch(C){console.warn("âš ï¸ Could not fetch controller_data from config:",C)}p.value=!0,L.value={platform:u,code:s.code,profile:{...v.profile,controller_data:M}},f.value=!0}catch(D){console.error("Error loading profile for edit:",D),alert("Failed to load profile for editing")}}function h(){f.value=!1,p.value=!1,L.value=null}function o(){console.log("Show install guide clicked"),window.open("https://github.com/smartHomeHub/SmartIR","_blank")}function i(u){console.log("Profile saved:",u),h()}return(u,s)=>(r(),d("div",aa,[G(en),s[0]||(s[0]=ye('<div class="welcome-banner" data-v-6977eefd><div class="banner-content" data-v-6977eefd><div class="banner-icon" data-v-6977eefd><i class="mdi mdi-rocket-launch" data-v-6977eefd></i></div><div class="banner-text" data-v-6977eefd><h2 data-v-6977eefd>Welcome to Broadlink Manager v2!</h2><p data-v-6977eefd>Manage your IR/RF devices with a modern Vue 3 interface</p></div></div><div class="status-badges" data-v-6977eefd><span class="badge success" data-v-6977eefd><i class="mdi mdi-check-circle" data-v-6977eefd></i> Vue 3 Ready </span><span class="badge warning" data-v-6977eefd><i class="mdi mdi-beta" data-v-6977eefd></i> Beta </span></div></div>',1)),G(jn,{onCreateProfile:n,onEditProfile:b,onShowInstallGuide:o}),G(Wo),s[1]||(s[1]=ye('<div class="info-cards" data-v-6977eefd><div class="info-card" data-v-6977eefd><i class="mdi mdi-information" data-v-6977eefd></i><h3 data-v-6977eefd>Development Status</h3><p data-v-6977eefd>This is a beta version. Features are being migrated from v1 incrementally.</p></div><div class="info-card" data-v-6977eefd><i class="mdi mdi-github" data-v-6977eefd></i><h3 data-v-6977eefd>Repository</h3><p data-v-6977eefd><a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2" target="_blank" data-v-6977eefd> View on GitHub </a></p></div><div class="info-card" data-v-6977eefd><i class="mdi mdi-bug" data-v-6977eefd></i><h3 data-v-6977eefd>Report Issues</h3><p data-v-6977eefd> Found a bug? <a href="https://github.com/tonyperkins/homeassistant-broadlink-manager-v2/issues" target="_blank" data-v-6977eefd> Report it on GitHub Issues </a></p></div></div>',1)),G(la,{show:f.value,editMode:p.value,editData:L.value,onClose:h,onSave:i},null,8,["show","editMode","editData"])]))}},ra=X(ia,[["__scopeId","data-v-6977eefd"]]),da={class:"toast-container"},ua={class:"toast-content"},ca={key:0,class:"toast-title"},ma={class:"toast-message"},va=["onClick"],pa={__name:"Toast",setup(l,{expose:f}){const p=S([]);let L=0;function n(o){const i={success:"mdi-check-circle",error:"mdi-alert-circle",warning:"mdi-alert",info:"mdi-information"};return i[o]||i.info}function b({message:o,title:i,type:u="info",duration:s=5e3}){const D=L++,v={id:D,message:o,title:i,type:u};return p.value.push(v),s>0&&setTimeout(()=>{h(D)},s),D}function h(o){const i=p.value.findIndex(u=>u.id===o);i>-1&&p.value.splice(i,1)}return f({addToast:b,removeToast:h,success:(o,i)=>b({message:o,title:i,type:"success"}),error:(o,i)=>b({message:o,title:i,type:"error",duration:8e3}),warning:(o,i)=>b({message:o,title:i,type:"warning",duration:6e3}),info:(o,i)=>b({message:o,title:i,type:"info"})}),(o,i)=>(r(),fe(De,{to:"body"},[e("div",da,[G(xe,{name:"toast"},{default:Se(()=>[(r(!0),d(q,null,J(p.value,u=>(r(),d("div",{key:u.id,class:N(["toast",[`toast-${u.type}`]])},[e("i",{class:N(["mdi",n(u.type)])},null,2),e("div",ua,[u.title?(r(),d("div",ca,g(u.title),1)):A("",!0),e("div",ma,g(u.message),1)]),e("button",{onClick:s=>h(u.id),class:"toast-close"},[...i[0]||(i[0]=[e("i",{class:"mdi mdi-close"},null,-1)])],8,va)],2))),128))]),_:1})])]))}},fa=X(pa,[["__scopeId","data-v-f29583e3"]]),ya={id:"app",class:"app-container"},ga={class:"app-header"},ba={class:"header-content"},ka={class:"header-right"},ha={class:"app-main"},wa={__name:"App",setup(l){const f=S(null),p=S(!1),L=S(null),n=()=>{p.value=!p.value,document.body.classList.toggle("dark-mode",p.value),localStorage.setItem("darkMode",p.value)},b=async()=>{try{const h=await he.getStatus();L.value=h,h.installed?console.log("âœ… SmartIR detected:",h.version):console.log("â„¹ï¸ SmartIR not detected")}catch(h){console.error("Error checking SmartIR:",h),L.value={installed:!1,error:h.message}}};return ce(async()=>{localStorage.getItem("darkMode")==="true"&&(p.value=!0,document.body.classList.add("dark-mode")),await b();const o=Ie();o&&f.value&&(o.appContext.config.globalProperties.$toast=f.value)}),ge("smartirStatus",L),ge("refreshSmartIR",b),ge("toast",f),(h,o)=>(r(),d("div",ya,[e("header",ga,[e("div",ba,[o[0]||(o[0]=e("div",{class:"header-left"},[e("i",{class:"mdi mdi-remote"}),e("h1",null,"Broadlink Manager v2"),e("span",{class:"beta-badge"},"BETA")],-1)),e("div",ka,[e("button",{onClick:n,class:"icon-button",title:"Toggle Dark Mode"},[e("i",{class:N(p.value?"mdi mdi-weather-night":"mdi mdi-weather-sunny")},null,2)])])])]),e("main",ha,[G(ra)]),o[1]||(o[1]=e("footer",{class:"app-footer"},[e("p",null,"Broadlink Manager v2.0.0-beta.1 | Built with Vue 3")],-1)),G(fa,{ref_key:"toastRef",ref:f},null,512)]))}},$a=X(wa,[["__scopeId","data-v-1837295b"]]),we=Te($a),Ca=Me();we.use(Ca);we.mount("#app");
